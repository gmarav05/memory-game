import{s as i,b as a,a as u}from"./index-CuFCxNYP.js";var n=Symbol("verified"),y=e=>e instanceof Object;function c(e){if(!y(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let r=0;r<e.tags.length;r++){let t=e.tags[r];if(!Array.isArray(t))return!1;for(let f=0;f<t.length;f++)if(typeof t[f]!="string")return!1}return!0}new TextDecoder("utf-8");var l=new TextEncoder,g=class{generateSecretKey(){return i.utils.randomPrivateKey()}getPublicKey(e){return a(i.getPublicKey(e))}finalizeEvent(e,r){const t=e;return t.pubkey=a(i.getPublicKey(r)),t.id=o(t),t.sig=a(i.sign(o(t),r)),t[n]=!0,t}verifyEvent(e){if(typeof e[n]=="boolean")return e[n];const r=o(e);if(r!==e.id)return e[n]=!1,!1;try{const t=i.verify(e.sig,r,e.pubkey);return e[n]=t,t}catch{return e[n]=!1,!1}}};function b(e){if(!c(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function o(e){let r=u(l.encode(b(e)));return a(r)}var s=new g,p=s.generateSecretKey,d=s.getPublicKey,E=s.finalizeEvent;s.verifyEvent;export{E as finalizeEvent,p as generateSecretKey,o as getEventHash,d as getPublicKey,b as serializeEvent,c as validateEvent,n as verifiedSymbol};
