(function(){const $n=document.createElement("link").relList;if($n&&$n.supports&&$n.supports("modulepreload"))return;for(const Bn of document.querySelectorAll('link[rel="modulepreload"]'))Un(Bn);new MutationObserver(Bn=>{for(const In of Bn)if(In.type==="childList")for(const qn of In.addedNodes)qn.tagName==="LINK"&&qn.rel==="modulepreload"&&Un(qn)}).observe(document,{childList:!0,subtree:!0});function Dn(Bn){const In={};return Bn.integrity&&(In.integrity=Bn.integrity),Bn.referrerPolicy&&(In.referrerPolicy=Bn.referrerPolicy),Bn.crossOrigin==="use-credentials"?In.credentials="include":Bn.crossOrigin==="anonymous"?In.credentials="omit":In.credentials="same-origin",In}function Un(Bn){if(Bn.ep)return;Bn.ep=!0;const In=Dn(Bn);fetch(Bn.href,In)}})();var jsxRuntime={exports:{}},reactJsxRuntime_production={};var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var s=Symbol.for("react.transitional.element"),$n=Symbol.for("react.fragment");function Dn(Un,Bn,In){var qn=null;if(In!==void 0&&(qn=""+In),Bn.key!==void 0&&(qn=""+Bn.key),"key"in Bn){In={};for(var Fn in Bn)Fn!=="key"&&(In[Fn]=Bn[Fn])}else In=Bn;return Bn=In.ref,{$$typeof:s,type:Un,key:qn,ref:Bn!==void 0?Bn:null,props:In}}return reactJsxRuntime_production.Fragment=$n,reactJsxRuntime_production.jsx=Dn,reactJsxRuntime_production.jsxs=Dn,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var s=Symbol.for("react.transitional.element"),$n=Symbol.for("react.portal"),Dn=Symbol.for("react.fragment"),Un=Symbol.for("react.strict_mode"),Bn=Symbol.for("react.profiler"),In=Symbol.for("react.consumer"),qn=Symbol.for("react.context"),Fn=Symbol.for("react.forward_ref"),Kn=Symbol.for("react.suspense"),jn=Symbol.for("react.memo"),Yn=Symbol.for("react.lazy"),Zn=Symbol.for("react.activity"),Xn=Symbol.iterator;function Jn(rr){return rr===null||typeof rr!="object"?null:(rr=Xn&&rr[Xn]||rr["@@iterator"],typeof rr=="function"?rr:null)}var Wn={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tr=Object.assign,ir={};function sr(rr,gr,Tr){this.props=rr,this.context=gr,this.refs=ir,this.updater=Tr||Wn}sr.prototype.isReactComponent={},sr.prototype.setState=function(rr,gr){if(typeof rr!="object"&&typeof rr!="function"&&rr!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,rr,gr,"setState")},sr.prototype.forceUpdate=function(rr){this.updater.enqueueForceUpdate(this,rr,"forceUpdate")};function fr(){}fr.prototype=sr.prototype;function ur(rr,gr,Tr){this.props=rr,this.context=gr,this.refs=ir,this.updater=Tr||Wn}var br=ur.prototype=new fr;br.constructor=ur,tr(br,sr.prototype),br.isPureReactComponent=!0;var Nr=Array.isArray;function Ar(){}var _r={H:null,A:null,T:null,S:null},Rr=Object.prototype.hasOwnProperty;function Dr(rr,gr,Tr){var Br=Tr.ref;return{$$typeof:s,type:rr,key:gr,ref:Br!==void 0?Br:null,props:Tr}}function zr(rr,gr){return Dr(rr.type,gr,rr.props)}function dr(rr){return typeof rr=="object"&&rr!==null&&rr.$$typeof===s}function pr(rr){var gr={"=":"=0",":":"=2"};return"$"+rr.replace(/[=:]/g,function(Tr){return gr[Tr]})}var lr=/\/+/g;function mr(rr,gr){return typeof rr=="object"&&rr!==null&&rr.key!=null?pr(""+rr.key):gr.toString(36)}function ar(rr){switch(rr.status){case"fulfilled":return rr.value;case"rejected":throw rr.reason;default:switch(typeof rr.status=="string"?rr.then(Ar,Ar):(rr.status="pending",rr.then(function(gr){rr.status==="pending"&&(rr.status="fulfilled",rr.value=gr)},function(gr){rr.status==="pending"&&(rr.status="rejected",rr.reason=gr)})),rr.status){case"fulfilled":return rr.value;case"rejected":throw rr.reason}}throw rr}function er(rr,gr,Tr,Br,Ur){var qr=typeof rr;(qr==="undefined"||qr==="boolean")&&(rr=null);var Hr=!1;if(rr===null)Hr=!0;else switch(qr){case"bigint":case"string":case"number":Hr=!0;break;case"object":switch(rr.$$typeof){case s:case $n:Hr=!0;break;case Yn:return Hr=rr._init,er(Hr(rr._payload),gr,Tr,Br,Ur)}}if(Hr)return Ur=Ur(rr),Hr=Br===""?"."+mr(rr,0):Br,Nr(Ur)?(Tr="",Hr!=null&&(Tr=Hr.replace(lr,"$&/")+"/"),er(Ur,gr,Tr,"",function(si){return si})):Ur!=null&&(dr(Ur)&&(Ur=zr(Ur,Tr+(Ur.key==null||rr&&rr.key===Ur.key?"":(""+Ur.key).replace(lr,"$&/")+"/")+Hr)),gr.push(Ur)),1;Hr=0;var Yr=Br===""?".":Br+":";if(Nr(rr))for(var Kr=0;Kr<rr.length;Kr++)Br=rr[Kr],qr=Yr+mr(Br,Kr),Hr+=er(Br,gr,Tr,qr,Ur);else if(Kr=Jn(rr),typeof Kr=="function")for(rr=Kr.call(rr),Kr=0;!(Br=rr.next()).done;)Br=Br.value,qr=Yr+mr(Br,Kr++),Hr+=er(Br,gr,Tr,qr,Ur);else if(qr==="object"){if(typeof rr.then=="function")return er(ar(rr),gr,Tr,Br,Ur);throw gr=String(rr),Error("Objects are not valid as a React child (found: "+(gr==="[object Object]"?"object with keys {"+Object.keys(rr).join(", ")+"}":gr)+"). If you meant to render a collection of children, use an array instead.")}return Hr}function or(rr,gr,Tr){if(rr==null)return rr;var Br=[],Ur=0;return er(rr,Br,"","",function(qr){return gr.call(Tr,qr,Ur++)}),Br}function wr(rr){if(rr._status===-1){var gr=rr._result;gr=gr(),gr.then(function(Tr){(rr._status===0||rr._status===-1)&&(rr._status=1,rr._result=Tr)},function(Tr){(rr._status===0||rr._status===-1)&&(rr._status=2,rr._result=Tr)}),rr._status===-1&&(rr._status=0,rr._result=gr)}if(rr._status===1)return rr._result.default;throw rr._result}var vr=typeof reportError=="function"?reportError:function(rr){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var gr=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof rr=="object"&&rr!==null&&typeof rr.message=="string"?String(rr.message):String(rr),error:rr});if(!window.dispatchEvent(gr))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",rr);return}console.error(rr)},Sr={map:or,forEach:function(rr,gr,Tr){or(rr,function(){gr.apply(this,arguments)},Tr)},count:function(rr){var gr=0;return or(rr,function(){gr++}),gr},toArray:function(rr){return or(rr,function(gr){return gr})||[]},only:function(rr){if(!dr(rr))throw Error("React.Children.only expected to receive a single React element child.");return rr}};return react_production.Activity=Zn,react_production.Children=Sr,react_production.Component=sr,react_production.Fragment=Dn,react_production.Profiler=Bn,react_production.PureComponent=ur,react_production.StrictMode=Un,react_production.Suspense=Kn,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_r,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(rr){return _r.H.useMemoCache(rr)}},react_production.cache=function(rr){return function(){return rr.apply(null,arguments)}},react_production.cacheSignal=function(){return null},react_production.cloneElement=function(rr,gr,Tr){if(rr==null)throw Error("The argument must be a React element, but you passed "+rr+".");var Br=tr({},rr.props),Ur=rr.key;if(gr!=null)for(qr in gr.key!==void 0&&(Ur=""+gr.key),gr)!Rr.call(gr,qr)||qr==="key"||qr==="__self"||qr==="__source"||qr==="ref"&&gr.ref===void 0||(Br[qr]=gr[qr]);var qr=arguments.length-2;if(qr===1)Br.children=Tr;else if(1<qr){for(var Hr=Array(qr),Yr=0;Yr<qr;Yr++)Hr[Yr]=arguments[Yr+2];Br.children=Hr}return Dr(rr.type,Ur,Br)},react_production.createContext=function(rr){return rr={$$typeof:qn,_currentValue:rr,_currentValue2:rr,_threadCount:0,Provider:null,Consumer:null},rr.Provider=rr,rr.Consumer={$$typeof:In,_context:rr},rr},react_production.createElement=function(rr,gr,Tr){var Br,Ur={},qr=null;if(gr!=null)for(Br in gr.key!==void 0&&(qr=""+gr.key),gr)Rr.call(gr,Br)&&Br!=="key"&&Br!=="__self"&&Br!=="__source"&&(Ur[Br]=gr[Br]);var Hr=arguments.length-2;if(Hr===1)Ur.children=Tr;else if(1<Hr){for(var Yr=Array(Hr),Kr=0;Kr<Hr;Kr++)Yr[Kr]=arguments[Kr+2];Ur.children=Yr}if(rr&&rr.defaultProps)for(Br in Hr=rr.defaultProps,Hr)Ur[Br]===void 0&&(Ur[Br]=Hr[Br]);return Dr(rr,qr,Ur)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(rr){return{$$typeof:Fn,render:rr}},react_production.isValidElement=dr,react_production.lazy=function(rr){return{$$typeof:Yn,_payload:{_status:-1,_result:rr},_init:wr}},react_production.memo=function(rr,gr){return{$$typeof:jn,type:rr,compare:gr===void 0?null:gr}},react_production.startTransition=function(rr){var gr=_r.T,Tr={};_r.T=Tr;try{var Br=rr(),Ur=_r.S;Ur!==null&&Ur(Tr,Br),typeof Br=="object"&&Br!==null&&typeof Br.then=="function"&&Br.then(Ar,vr)}catch(qr){vr(qr)}finally{gr!==null&&Tr.types!==null&&(gr.types=Tr.types),_r.T=gr}},react_production.unstable_useCacheRefresh=function(){return _r.H.useCacheRefresh()},react_production.use=function(rr){return _r.H.use(rr)},react_production.useActionState=function(rr,gr,Tr){return _r.H.useActionState(rr,gr,Tr)},react_production.useCallback=function(rr,gr){return _r.H.useCallback(rr,gr)},react_production.useContext=function(rr){return _r.H.useContext(rr)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(rr,gr){return _r.H.useDeferredValue(rr,gr)},react_production.useEffect=function(rr,gr){return _r.H.useEffect(rr,gr)},react_production.useEffectEvent=function(rr){return _r.H.useEffectEvent(rr)},react_production.useId=function(){return _r.H.useId()},react_production.useImperativeHandle=function(rr,gr,Tr){return _r.H.useImperativeHandle(rr,gr,Tr)},react_production.useInsertionEffect=function(rr,gr){return _r.H.useInsertionEffect(rr,gr)},react_production.useLayoutEffect=function(rr,gr){return _r.H.useLayoutEffect(rr,gr)},react_production.useMemo=function(rr,gr){return _r.H.useMemo(rr,gr)},react_production.useOptimistic=function(rr,gr){return _r.H.useOptimistic(rr,gr)},react_production.useReducer=function(rr,gr,Tr){return _r.H.useReducer(rr,gr,Tr)},react_production.useRef=function(rr){return _r.H.useRef(rr)},react_production.useState=function(rr){return _r.H.useState(rr)},react_production.useSyncExternalStore=function(rr,gr,Tr){return _r.H.useSyncExternalStore(rr,gr,Tr)},react_production.useTransition=function(){return _r.H.useTransition()},react_production.version="19.2.3",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact(),client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(s){function $n(er,or){var wr=er.length;er.push(or);t:for(;0<wr;){var vr=wr-1>>>1,Sr=er[vr];if(0<Bn(Sr,or))er[vr]=or,er[wr]=Sr,wr=vr;else break t}}function Dn(er){return er.length===0?null:er[0]}function Un(er){if(er.length===0)return null;var or=er[0],wr=er.pop();if(wr!==or){er[0]=wr;t:for(var vr=0,Sr=er.length,rr=Sr>>>1;vr<rr;){var gr=2*(vr+1)-1,Tr=er[gr],Br=gr+1,Ur=er[Br];if(0>Bn(Tr,wr))Br<Sr&&0>Bn(Ur,Tr)?(er[vr]=Ur,er[Br]=wr,vr=Br):(er[vr]=Tr,er[gr]=wr,vr=gr);else if(Br<Sr&&0>Bn(Ur,wr))er[vr]=Ur,er[Br]=wr,vr=Br;else break t}}return or}function Bn(er,or){var wr=er.sortIndex-or.sortIndex;return wr!==0?wr:er.id-or.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var In=performance;s.unstable_now=function(){return In.now()}}else{var qn=Date,Fn=qn.now();s.unstable_now=function(){return qn.now()-Fn}}var Kn=[],jn=[],Yn=1,Zn=null,Xn=3,Jn=!1,Wn=!1,tr=!1,ir=!1,sr=typeof setTimeout=="function"?setTimeout:null,fr=typeof clearTimeout=="function"?clearTimeout:null,ur=typeof setImmediate<"u"?setImmediate:null;function br(er){for(var or=Dn(jn);or!==null;){if(or.callback===null)Un(jn);else if(or.startTime<=er)Un(jn),or.sortIndex=or.expirationTime,$n(Kn,or);else break;or=Dn(jn)}}function Nr(er){if(tr=!1,br(er),!Wn)if(Dn(Kn)!==null)Wn=!0,Ar||(Ar=!0,pr());else{var or=Dn(jn);or!==null&&ar(Nr,or.startTime-er)}}var Ar=!1,_r=-1,Rr=5,Dr=-1;function zr(){return ir?!0:!(s.unstable_now()-Dr<Rr)}function dr(){if(ir=!1,Ar){var er=s.unstable_now();Dr=er;var or=!0;try{t:{Wn=!1,tr&&(tr=!1,fr(_r),_r=-1),Jn=!0;var wr=Xn;try{e:{for(br(er),Zn=Dn(Kn);Zn!==null&&!(Zn.expirationTime>er&&zr());){var vr=Zn.callback;if(typeof vr=="function"){Zn.callback=null,Xn=Zn.priorityLevel;var Sr=vr(Zn.expirationTime<=er);if(er=s.unstable_now(),typeof Sr=="function"){Zn.callback=Sr,br(er),or=!0;break e}Zn===Dn(Kn)&&Un(Kn),br(er)}else Un(Kn);Zn=Dn(Kn)}if(Zn!==null)or=!0;else{var rr=Dn(jn);rr!==null&&ar(Nr,rr.startTime-er),or=!1}}break t}finally{Zn=null,Xn=wr,Jn=!1}or=void 0}}finally{or?pr():Ar=!1}}}var pr;if(typeof ur=="function")pr=function(){ur(dr)};else if(typeof MessageChannel<"u"){var lr=new MessageChannel,mr=lr.port2;lr.port1.onmessage=dr,pr=function(){mr.postMessage(null)}}else pr=function(){sr(dr,0)};function ar(er,or){_r=sr(function(){er(s.unstable_now())},or)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(er){er.callback=null},s.unstable_forceFrameRate=function(er){0>er||125<er?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Rr=0<er?Math.floor(1e3/er):5},s.unstable_getCurrentPriorityLevel=function(){return Xn},s.unstable_next=function(er){switch(Xn){case 1:case 2:case 3:var or=3;break;default:or=Xn}var wr=Xn;Xn=or;try{return er()}finally{Xn=wr}},s.unstable_requestPaint=function(){ir=!0},s.unstable_runWithPriority=function(er,or){switch(er){case 1:case 2:case 3:case 4:case 5:break;default:er=3}var wr=Xn;Xn=er;try{return or()}finally{Xn=wr}},s.unstable_scheduleCallback=function(er,or,wr){var vr=s.unstable_now();switch(typeof wr=="object"&&wr!==null?(wr=wr.delay,wr=typeof wr=="number"&&0<wr?vr+wr:vr):wr=vr,er){case 1:var Sr=-1;break;case 2:Sr=250;break;case 5:Sr=1073741823;break;case 4:Sr=1e4;break;default:Sr=5e3}return Sr=wr+Sr,er={id:Yn++,callback:or,priorityLevel:er,startTime:wr,expirationTime:Sr,sortIndex:-1},wr>vr?(er.sortIndex=wr,$n(jn,er),Dn(Kn)===null&&er===Dn(jn)&&(tr?(fr(_r),_r=-1):tr=!0,ar(Nr,wr-vr))):(er.sortIndex=Sr,$n(Kn,er),Wn||Jn||(Wn=!0,Ar||(Ar=!0,pr()))),er},s.unstable_shouldYield=zr,s.unstable_wrapCallback=function(er){var or=Xn;return function(){var wr=Xn;Xn=or;try{return er.apply(this,arguments)}finally{Xn=wr}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var s=requireReact();function $n(Kn){var jn="https://react.dev/errors/"+Kn;if(1<arguments.length){jn+="?args[]="+encodeURIComponent(arguments[1]);for(var Yn=2;Yn<arguments.length;Yn++)jn+="&args[]="+encodeURIComponent(arguments[Yn])}return"Minified React error #"+Kn+"; visit "+jn+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Dn(){}var Un={d:{f:Dn,r:function(){throw Error($n(522))},D:Dn,C:Dn,L:Dn,m:Dn,X:Dn,S:Dn,M:Dn},p:0,findDOMNode:null},Bn=Symbol.for("react.portal");function In(Kn,jn,Yn){var Zn=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bn,key:Zn==null?null:""+Zn,children:Kn,containerInfo:jn,implementation:Yn}}var qn=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Fn(Kn,jn){if(Kn==="font")return"";if(typeof jn=="string")return jn==="use-credentials"?jn:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Un,reactDom_production.createPortal=function(Kn,jn){var Yn=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jn||jn.nodeType!==1&&jn.nodeType!==9&&jn.nodeType!==11)throw Error($n(299));return In(Kn,jn,null,Yn)},reactDom_production.flushSync=function(Kn){var jn=qn.T,Yn=Un.p;try{if(qn.T=null,Un.p=2,Kn)return Kn()}finally{qn.T=jn,Un.p=Yn,Un.d.f()}},reactDom_production.preconnect=function(Kn,jn){typeof Kn=="string"&&(jn?(jn=jn.crossOrigin,jn=typeof jn=="string"?jn==="use-credentials"?jn:"":void 0):jn=null,Un.d.C(Kn,jn))},reactDom_production.prefetchDNS=function(Kn){typeof Kn=="string"&&Un.d.D(Kn)},reactDom_production.preinit=function(Kn,jn){if(typeof Kn=="string"&&jn&&typeof jn.as=="string"){var Yn=jn.as,Zn=Fn(Yn,jn.crossOrigin),Xn=typeof jn.integrity=="string"?jn.integrity:void 0,Jn=typeof jn.fetchPriority=="string"?jn.fetchPriority:void 0;Yn==="style"?Un.d.S(Kn,typeof jn.precedence=="string"?jn.precedence:void 0,{crossOrigin:Zn,integrity:Xn,fetchPriority:Jn}):Yn==="script"&&Un.d.X(Kn,{crossOrigin:Zn,integrity:Xn,fetchPriority:Jn,nonce:typeof jn.nonce=="string"?jn.nonce:void 0})}},reactDom_production.preinitModule=function(Kn,jn){if(typeof Kn=="string")if(typeof jn=="object"&&jn!==null){if(jn.as==null||jn.as==="script"){var Yn=Fn(jn.as,jn.crossOrigin);Un.d.M(Kn,{crossOrigin:Yn,integrity:typeof jn.integrity=="string"?jn.integrity:void 0,nonce:typeof jn.nonce=="string"?jn.nonce:void 0})}}else jn==null&&Un.d.M(Kn)},reactDom_production.preload=function(Kn,jn){if(typeof Kn=="string"&&typeof jn=="object"&&jn!==null&&typeof jn.as=="string"){var Yn=jn.as,Zn=Fn(Yn,jn.crossOrigin);Un.d.L(Kn,Yn,{crossOrigin:Zn,integrity:typeof jn.integrity=="string"?jn.integrity:void 0,nonce:typeof jn.nonce=="string"?jn.nonce:void 0,type:typeof jn.type=="string"?jn.type:void 0,fetchPriority:typeof jn.fetchPriority=="string"?jn.fetchPriority:void 0,referrerPolicy:typeof jn.referrerPolicy=="string"?jn.referrerPolicy:void 0,imageSrcSet:typeof jn.imageSrcSet=="string"?jn.imageSrcSet:void 0,imageSizes:typeof jn.imageSizes=="string"?jn.imageSizes:void 0,media:typeof jn.media=="string"?jn.media:void 0})}},reactDom_production.preloadModule=function(Kn,jn){if(typeof Kn=="string")if(jn){var Yn=Fn(jn.as,jn.crossOrigin);Un.d.m(Kn,{as:typeof jn.as=="string"&&jn.as!=="script"?jn.as:void 0,crossOrigin:Yn,integrity:typeof jn.integrity=="string"?jn.integrity:void 0})}else Un.d.m(Kn)},reactDom_production.requestFormReset=function(Kn){Un.d.r(Kn)},reactDom_production.unstable_batchedUpdates=function(Kn,jn){return Kn(jn)},reactDom_production.useFormState=function(Kn,jn,Yn){return qn.H.useFormState(Kn,jn,Yn)},reactDom_production.useFormStatus=function(){return qn.H.useHostTransitionStatus()},reactDom_production.version="19.2.3",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch($n){console.error($n)}}return s(),reactDom.exports=requireReactDom_production(),reactDom.exports}var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var s=requireScheduler(),$n=requireReact(),Dn=requireReactDom();function Un(Mn){var On="https://react.dev/errors/"+Mn;if(1<arguments.length){On+="?args[]="+encodeURIComponent(arguments[1]);for(var zn=2;zn<arguments.length;zn++)On+="&args[]="+encodeURIComponent(arguments[zn])}return"Minified React error #"+Mn+"; visit "+On+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Bn(Mn){return!(!Mn||Mn.nodeType!==1&&Mn.nodeType!==9&&Mn.nodeType!==11)}function In(Mn){var On=Mn,zn=Mn;if(Mn.alternate)for(;On.return;)On=On.return;else{Mn=On;do On=Mn,(On.flags&4098)!==0&&(zn=On.return),Mn=On.return;while(Mn)}return On.tag===3?zn:null}function qn(Mn){if(Mn.tag===13){var On=Mn.memoizedState;if(On===null&&(Mn=Mn.alternate,Mn!==null&&(On=Mn.memoizedState)),On!==null)return On.dehydrated}return null}function Fn(Mn){if(Mn.tag===31){var On=Mn.memoizedState;if(On===null&&(Mn=Mn.alternate,Mn!==null&&(On=Mn.memoizedState)),On!==null)return On.dehydrated}return null}function Kn(Mn){if(In(Mn)!==Mn)throw Error(Un(188))}function jn(Mn){var On=Mn.alternate;if(!On){if(On=In(Mn),On===null)throw Error(Un(188));return On!==Mn?null:Mn}for(var zn=Mn,Hn=On;;){var Vn=zn.return;if(Vn===null)break;var Gn=Vn.alternate;if(Gn===null){if(Hn=Vn.return,Hn!==null){zn=Hn;continue}break}if(Vn.child===Gn.child){for(Gn=Vn.child;Gn;){if(Gn===zn)return Kn(Vn),Mn;if(Gn===Hn)return Kn(Vn),On;Gn=Gn.sibling}throw Error(Un(188))}if(zn.return!==Hn.return)zn=Vn,Hn=Gn;else{for(var Qn=!1,nr=Vn.child;nr;){if(nr===zn){Qn=!0,zn=Vn,Hn=Gn;break}if(nr===Hn){Qn=!0,Hn=Vn,zn=Gn;break}nr=nr.sibling}if(!Qn){for(nr=Gn.child;nr;){if(nr===zn){Qn=!0,zn=Gn,Hn=Vn;break}if(nr===Hn){Qn=!0,Hn=Gn,zn=Vn;break}nr=nr.sibling}if(!Qn)throw Error(Un(189))}}if(zn.alternate!==Hn)throw Error(Un(190))}if(zn.tag!==3)throw Error(Un(188));return zn.stateNode.current===zn?Mn:On}function Yn(Mn){var On=Mn.tag;if(On===5||On===26||On===27||On===6)return Mn;for(Mn=Mn.child;Mn!==null;){if(On=Yn(Mn),On!==null)return On;Mn=Mn.sibling}return null}var Zn=Object.assign,Xn=Symbol.for("react.element"),Jn=Symbol.for("react.transitional.element"),Wn=Symbol.for("react.portal"),tr=Symbol.for("react.fragment"),ir=Symbol.for("react.strict_mode"),sr=Symbol.for("react.profiler"),fr=Symbol.for("react.consumer"),ur=Symbol.for("react.context"),br=Symbol.for("react.forward_ref"),Nr=Symbol.for("react.suspense"),Ar=Symbol.for("react.suspense_list"),_r=Symbol.for("react.memo"),Rr=Symbol.for("react.lazy"),Dr=Symbol.for("react.activity"),zr=Symbol.for("react.memo_cache_sentinel"),dr=Symbol.iterator;function pr(Mn){return Mn===null||typeof Mn!="object"?null:(Mn=dr&&Mn[dr]||Mn["@@iterator"],typeof Mn=="function"?Mn:null)}var lr=Symbol.for("react.client.reference");function mr(Mn){if(Mn==null)return null;if(typeof Mn=="function")return Mn.$$typeof===lr?null:Mn.displayName||Mn.name||null;if(typeof Mn=="string")return Mn;switch(Mn){case tr:return"Fragment";case sr:return"Profiler";case ir:return"StrictMode";case Nr:return"Suspense";case Ar:return"SuspenseList";case Dr:return"Activity"}if(typeof Mn=="object")switch(Mn.$$typeof){case Wn:return"Portal";case ur:return Mn.displayName||"Context";case fr:return(Mn._context.displayName||"Context")+".Consumer";case br:var On=Mn.render;return Mn=Mn.displayName,Mn||(Mn=On.displayName||On.name||"",Mn=Mn!==""?"ForwardRef("+Mn+")":"ForwardRef"),Mn;case _r:return On=Mn.displayName||null,On!==null?On:mr(Mn.type)||"Memo";case Rr:On=Mn._payload,Mn=Mn._init;try{return mr(Mn(On))}catch{}}return null}var ar=Array.isArray,er=$n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,or=Dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,wr={pending:!1,data:null,method:null,action:null},vr=[],Sr=-1;function rr(Mn){return{current:Mn}}function gr(Mn){0>Sr||(Mn.current=vr[Sr],vr[Sr]=null,Sr--)}function Tr(Mn,On){Sr++,vr[Sr]=Mn.current,Mn.current=On}var Br=rr(null),Ur=rr(null),qr=rr(null),Hr=rr(null);function Yr(Mn,On){switch(Tr(qr,On),Tr(Ur,Mn),Tr(Br,null),On.nodeType){case 9:case 11:Mn=(Mn=On.documentElement)&&(Mn=Mn.namespaceURI)?mm(Mn):0;break;default:if(Mn=On.tagName,On=On.namespaceURI)On=mm(On),Mn=ym(On,Mn);else switch(Mn){case"svg":Mn=1;break;case"math":Mn=2;break;default:Mn=0}}gr(Br),Tr(Br,Mn)}function Kr(){gr(Br),gr(Ur),gr(qr)}function si(Mn){Mn.memoizedState!==null&&Tr(Hr,Mn);var On=Br.current,zn=ym(On,Mn.type);On!==zn&&(Tr(Ur,Mn),Tr(Br,zn))}function zi(Mn){Ur.current===Mn&&(gr(Br),gr(Ur)),Hr.current===Mn&&(gr(Hr),Nl._currentValue=wr)}var Ai,Li;function Ii(Mn){if(Ai===void 0)try{throw Error()}catch(zn){var On=zn.stack.trim().match(/\n( *(at )?)/);Ai=On&&On[1]||"",Li=-1<zn.stack.indexOf(`
    at`)?" (<anonymous>)":-1<zn.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ai+Mn+Li}var ji=!1;function Ts(Mn,On){if(!Mn||ji)return"";ji=!0;var zn=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var Hn={DetermineComponentFrameRoot:function(){try{if(On){var Or=function(){throw Error()};if(Object.defineProperty(Or.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Or,[])}catch(Cr){var kr=Cr}Reflect.construct(Mn,[],Or)}else{try{Or.call()}catch(Cr){kr=Cr}Mn.call(Or.prototype)}}else{try{throw Error()}catch(Cr){kr=Cr}(Or=Mn())&&typeof Or.catch=="function"&&Or.catch(function(){})}}catch(Cr){if(Cr&&kr&&typeof Cr.stack=="string")return[Cr.stack,kr.stack]}return[null,null]}};Hn.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var Vn=Object.getOwnPropertyDescriptor(Hn.DetermineComponentFrameRoot,"name");Vn&&Vn.configurable&&Object.defineProperty(Hn.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Gn=Hn.DetermineComponentFrameRoot(),Qn=Gn[0],nr=Gn[1];if(Qn&&nr){var hr=Qn.split(`
`),xr=nr.split(`
`);for(Vn=Hn=0;Hn<hr.length&&!hr[Hn].includes("DetermineComponentFrameRoot");)Hn++;for(;Vn<xr.length&&!xr[Vn].includes("DetermineComponentFrameRoot");)Vn++;if(Hn===hr.length||Vn===xr.length)for(Hn=hr.length-1,Vn=xr.length-1;1<=Hn&&0<=Vn&&hr[Hn]!==xr[Vn];)Vn--;for(;1<=Hn&&0<=Vn;Hn--,Vn--)if(hr[Hn]!==xr[Vn]){if(Hn!==1||Vn!==1)do if(Hn--,Vn--,0>Vn||hr[Hn]!==xr[Vn]){var Lr=`
`+hr[Hn].replace(" at new "," at ");return Mn.displayName&&Lr.includes("<anonymous>")&&(Lr=Lr.replace("<anonymous>",Mn.displayName)),Lr}while(1<=Hn&&0<=Vn);break}}}finally{ji=!1,Error.prepareStackTrace=zn}return(zn=Mn?Mn.displayName||Mn.name:"")?Ii(zn):""}function Oo(Mn,On){switch(Mn.tag){case 26:case 27:case 5:return Ii(Mn.type);case 16:return Ii("Lazy");case 13:return Mn.child!==On&&On!==null?Ii("Suspense Fallback"):Ii("Suspense");case 19:return Ii("SuspenseList");case 0:case 15:return Ts(Mn.type,!1);case 11:return Ts(Mn.type.render,!1);case 1:return Ts(Mn.type,!0);case 31:return Ii("Activity");default:return""}}function Ms(Mn){try{var On="",zn=null;do On+=Oo(Mn,zn),zn=Mn,Mn=Mn.return;while(Mn);return On}catch(Hn){return`
Error generating stack: `+Hn.message+`
`+Hn.stack}}var sa=Object.prototype.hasOwnProperty,aa=s.unstable_scheduleCallback,Ja=s.unstable_cancelCallback,Ul=s.unstable_shouldYield,Gu=s.unstable_requestPaint,qi=s.unstable_now,La=s.unstable_getCurrentPriorityLevel,Us=s.unstable_ImmediatePriority,es=s.unstable_UserBlockingPriority,oa=s.unstable_NormalPriority,Ol=s.unstable_LowPriority,Bo=s.unstable_IdlePriority,zo=s.log,Bl=s.unstable_setDisableYieldValue,Cs=null,Ui=null;function Oi(Mn){if(typeof zo=="function"&&Bl(Mn),Ui&&typeof Ui.setStrictMode=="function")try{Ui.setStrictMode(Cs,Mn)}catch{}}var _i=Math.clz32?Math.clz32:Yu,Io=Math.log,qo=Math.LN2;function Yu(Mn){return Mn>>>=0,Mn===0?32:31-(Io(Mn)/qo|0)|0}var Os=256,Bs=262144,Wa=4194304;function ns(Mn){var On=Mn&42;if(On!==0)return On;switch(Mn&-Mn){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return Mn&261888;case 262144:case 524288:case 1048576:case 2097152:return Mn&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return Mn&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return Mn}}function to(Mn,On,zn){var Hn=Mn.pendingLanes;if(Hn===0)return 0;var Vn=0,Gn=Mn.suspendedLanes,Qn=Mn.pingedLanes;Mn=Mn.warmLanes;var nr=Hn&134217727;return nr!==0?(Hn=nr&~Gn,Hn!==0?Vn=ns(Hn):(Qn&=nr,Qn!==0?Vn=ns(Qn):zn||(zn=nr&~Mn,zn!==0&&(Vn=ns(zn))))):(nr=Hn&~Gn,nr!==0?Vn=ns(nr):Qn!==0?Vn=ns(Qn):zn||(zn=Hn&~Mn,zn!==0&&(Vn=ns(zn)))),Vn===0?0:On!==0&&On!==Vn&&(On&Gn)===0&&(Gn=Vn&-Vn,zn=On&-On,Gn>=zn||Gn===32&&(zn&4194048)!==0)?On:Vn}function Ma(Mn,On){return(Mn.pendingLanes&~(Mn.suspendedLanes&~Mn.pingedLanes)&On)===0}function xi(Mn,On){switch(Mn){case 1:case 2:case 4:case 8:case 64:return On+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return On+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zs(){var Mn=Wa;return Wa<<=1,(Wa&62914560)===0&&(Wa=4194304),Mn}function Ho(Mn){for(var On=[],zn=0;31>zn;zn++)On.push(Mn);return On}function la(Mn,On){Mn.pendingLanes|=On,On!==268435456&&(Mn.suspendedLanes=0,Mn.pingedLanes=0,Mn.warmLanes=0)}function Po(Mn,On,zn,Hn,Vn,Gn){var Qn=Mn.pendingLanes;Mn.pendingLanes=zn,Mn.suspendedLanes=0,Mn.pingedLanes=0,Mn.warmLanes=0,Mn.expiredLanes&=zn,Mn.entangledLanes&=zn,Mn.errorRecoveryDisabledLanes&=zn,Mn.shellSuspendCounter=0;var nr=Mn.entanglements,hr=Mn.expirationTimes,xr=Mn.hiddenUpdates;for(zn=Qn&~zn;0<zn;){var Lr=31-_i(zn),Or=1<<Lr;nr[Lr]=0,hr[Lr]=-1;var kr=xr[Lr];if(kr!==null)for(xr[Lr]=null,Lr=0;Lr<kr.length;Lr++){var Cr=kr[Lr];Cr!==null&&(Cr.lane&=-536870913)}zn&=~Or}Hn!==0&&Fo(Mn,Hn,0),Gn!==0&&Vn===0&&Mn.tag!==0&&(Mn.suspendedLanes|=Gn&~(Qn&~On))}function Fo(Mn,On,zn){Mn.pendingLanes|=On,Mn.suspendedLanes&=~On;var Hn=31-_i(On);Mn.entangledLanes|=On,Mn.entanglements[Hn]=Mn.entanglements[Hn]|1073741824|zn&261930}function Ko(Mn,On){var zn=Mn.entangledLanes|=On;for(Mn=Mn.entanglements;zn;){var Hn=31-_i(zn),Vn=1<<Hn;Vn&On|Mn[Hn]&On&&(Mn[Hn]|=On),zn&=~Vn}}function zl(Mn,On){var zn=On&-On;return zn=(zn&42)!==0?1:$s(zn),(zn&(Mn.suspendedLanes|On))!==0?0:zn}function $s(Mn){switch(Mn){case 2:Mn=1;break;case 8:Mn=4;break;case 32:Mn=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:Mn=128;break;case 268435456:Mn=134217728;break;default:Mn=0}return Mn}function xs(Mn){return Mn&=-Mn,2<Mn?8<Mn?(Mn&134217727)!==0?32:268435456:8:2}function Vo(){var Mn=or.p;return Mn!==0?Mn:(Mn=window.event,Mn===void 0?32:qm(Mn.type))}function jo(Mn,On){var zn=or.p;try{return or.p=Mn,On()}finally{or.p=zn}}var us=Math.random().toString(36).slice(2),Ti="__reactFiber$"+us,yi="__reactProps$"+us,Is="__reactContainer$"+us,eo="__reactEvents$"+us,Il="__reactListeners$"+us,ql="__reactHandles$"+us,Hl="__reactResources$"+us,cr="__reactMarker$"+us;function Pr(Mn){delete Mn[Ti],delete Mn[yi],delete Mn[eo],delete Mn[Il],delete Mn[ql]}function Ir(Mn){var On=Mn[Ti];if(On)return On;for(var zn=Mn.parentNode;zn;){if(On=zn[Is]||zn[Ti]){if(zn=On.alternate,On.child!==null||zn!==null&&zn.child!==null)for(Mn=km(Mn);Mn!==null;){if(zn=Mn[Ti])return zn;Mn=km(Mn)}return On}Mn=zn,zn=Mn.parentNode}return null}function Wr(Mn){if(Mn=Mn[Ti]||Mn[Is]){var On=Mn.tag;if(On===5||On===6||On===13||On===31||On===26||On===27||On===3)return Mn}return null}function wi(Mn){var On=Mn.tag;if(On===5||On===26||On===27||On===6)return Mn.stateNode;throw Error(Un(33))}function oi(Mn){var On=Mn[Hl];return On||(On=Mn[Hl]={hoistableStyles:new Map,hoistableScripts:new Map}),On}function ui(Mn){Mn[cr]=!0}var Gi=new Set,Yi={};function ks(Mn,On){bi(Mn,On),bi(Mn+"Capture",On)}function bi(Mn,On){for(Yi[Mn]=On,Mn=0;Mn<On.length;Mn++)Gi.add(On[Mn])}var Pl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fl={},af={};function Xm(Mn){return sa.call(af,Mn)?!0:sa.call(Fl,Mn)?!1:Pl.test(Mn)?af[Mn]=!0:(Fl[Mn]=!0,!1)}function Kl(Mn,On,zn){if(Xm(On))if(zn===null)Mn.removeAttribute(On);else{switch(typeof zn){case"undefined":case"function":case"symbol":Mn.removeAttribute(On);return;case"boolean":var Hn=On.toLowerCase().slice(0,5);if(Hn!=="data-"&&Hn!=="aria-"){Mn.removeAttribute(On);return}}Mn.setAttribute(On,""+zn)}}function Vl(Mn,On,zn){if(zn===null)Mn.removeAttribute(On);else{switch(typeof zn){case"undefined":case"function":case"symbol":case"boolean":Mn.removeAttribute(On);return}Mn.setAttribute(On,""+zn)}}function qs(Mn,On,zn,Hn){if(Hn===null)Mn.removeAttribute(zn);else{switch(typeof Hn){case"undefined":case"function":case"symbol":case"boolean":Mn.removeAttribute(zn);return}Mn.setAttributeNS(On,zn,""+Hn)}}function hs(Mn){switch(typeof Mn){case"bigint":case"boolean":case"number":case"string":case"undefined":return Mn;case"object":return Mn;default:return""}}function of(Mn){var On=Mn.type;return(Mn=Mn.nodeName)&&Mn.toLowerCase()==="input"&&(On==="checkbox"||On==="radio")}function Qm(Mn,On,zn){var Hn=Object.getOwnPropertyDescriptor(Mn.constructor.prototype,On);if(!Mn.hasOwnProperty(On)&&typeof Hn<"u"&&typeof Hn.get=="function"&&typeof Hn.set=="function"){var Vn=Hn.get,Gn=Hn.set;return Object.defineProperty(Mn,On,{configurable:!0,get:function(){return Vn.call(this)},set:function(Qn){zn=""+Qn,Gn.call(this,Qn)}}),Object.defineProperty(Mn,On,{enumerable:Hn.enumerable}),{getValue:function(){return zn},setValue:function(Qn){zn=""+Qn},stopTracking:function(){Mn._valueTracker=null,delete Mn[On]}}}}function Xu(Mn){if(!Mn._valueTracker){var On=of(Mn)?"checked":"value";Mn._valueTracker=Qm(Mn,On,""+Mn[On])}}function lf(Mn){if(!Mn)return!1;var On=Mn._valueTracker;if(!On)return!0;var zn=On.getValue(),Hn="";return Mn&&(Hn=of(Mn)?Mn.checked?"true":"false":Mn.value),Mn=Hn,Mn!==zn?(On.setValue(Mn),!0):!1}function jl(Mn){if(Mn=Mn||(typeof document<"u"?document:void 0),typeof Mn>"u")return null;try{return Mn.activeElement||Mn.body}catch{return Mn.body}}var Jm=/[\n"\\]/g;function ds(Mn){return Mn.replace(Jm,function(On){return"\\"+On.charCodeAt(0).toString(16)+" "})}function Ju(Mn,On,zn,Hn,Vn,Gn,Qn,nr){Mn.name="",Qn!=null&&typeof Qn!="function"&&typeof Qn!="symbol"&&typeof Qn!="boolean"?Mn.type=Qn:Mn.removeAttribute("type"),On!=null?Qn==="number"?(On===0&&Mn.value===""||Mn.value!=On)&&(Mn.value=""+hs(On)):Mn.value!==""+hs(On)&&(Mn.value=""+hs(On)):Qn!=="submit"&&Qn!=="reset"||Mn.removeAttribute("value"),On!=null?th(Mn,Qn,hs(On)):zn!=null?th(Mn,Qn,hs(zn)):Hn!=null&&Mn.removeAttribute("value"),Vn==null&&Gn!=null&&(Mn.defaultChecked=!!Gn),Vn!=null&&(Mn.checked=Vn&&typeof Vn!="function"&&typeof Vn!="symbol"),nr!=null&&typeof nr!="function"&&typeof nr!="symbol"&&typeof nr!="boolean"?Mn.name=""+hs(nr):Mn.removeAttribute("name")}function cf(Mn,On,zn,Hn,Vn,Gn,Qn,nr){if(Gn!=null&&typeof Gn!="function"&&typeof Gn!="symbol"&&typeof Gn!="boolean"&&(Mn.type=Gn),On!=null||zn!=null){if(!(Gn!=="submit"&&Gn!=="reset"||On!=null)){Xu(Mn);return}zn=zn!=null?""+hs(zn):"",On=On!=null?""+hs(On):zn,nr||On===Mn.value||(Mn.value=On),Mn.defaultValue=On}Hn=Hn??Vn,Hn=typeof Hn!="function"&&typeof Hn!="symbol"&&!!Hn,Mn.checked=nr?Mn.checked:!!Hn,Mn.defaultChecked=!!Hn,Qn!=null&&typeof Qn!="function"&&typeof Qn!="symbol"&&typeof Qn!="boolean"&&(Mn.name=Qn),Xu(Mn)}function th(Mn,On,zn){On==="number"&&jl(Mn.ownerDocument)===Mn||Mn.defaultValue===""+zn||(Mn.defaultValue=""+zn)}function no(Mn,On,zn,Hn){if(Mn=Mn.options,On){On={};for(var Vn=0;Vn<zn.length;Vn++)On["$"+zn[Vn]]=!0;for(zn=0;zn<Mn.length;zn++)Vn=On.hasOwnProperty("$"+Mn[zn].value),Mn[zn].selected!==Vn&&(Mn[zn].selected=Vn),Vn&&Hn&&(Mn[zn].defaultSelected=!0)}else{for(zn=""+hs(zn),On=null,Vn=0;Vn<Mn.length;Vn++){if(Mn[Vn].value===zn){Mn[Vn].selected=!0,Hn&&(Mn[Vn].defaultSelected=!0);return}On!==null||Mn[Vn].disabled||(On=Mn[Vn])}On!==null&&(On.selected=!0)}}function uf(Mn,On,zn){if(On!=null&&(On=""+hs(On),On!==Mn.value&&(Mn.value=On),zn==null)){Mn.defaultValue!==On&&(Mn.defaultValue=On);return}Mn.defaultValue=zn!=null?""+hs(zn):""}function hf(Mn,On,zn,Hn){if(On==null){if(Hn!=null){if(zn!=null)throw Error(Un(92));if(ar(Hn)){if(1<Hn.length)throw Error(Un(93));Hn=Hn[0]}zn=Hn}zn==null&&(zn=""),On=zn}zn=hs(On),Mn.defaultValue=zn,Hn=Mn.textContent,Hn===zn&&Hn!==""&&Hn!==null&&(Mn.value=Hn),Xu(Mn)}function ro(Mn,On){if(On){var zn=Mn.firstChild;if(zn&&zn===Mn.lastChild&&zn.nodeType===3){zn.nodeValue=On;return}}Mn.textContent=On}var Wm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function df(Mn,On,zn){var Hn=On.indexOf("--")===0;zn==null||typeof zn=="boolean"||zn===""?Hn?Mn.setProperty(On,""):On==="float"?Mn.cssFloat="":Mn[On]="":Hn?Mn.setProperty(On,zn):typeof zn!="number"||zn===0||Wm.has(On)?On==="float"?Mn.cssFloat=zn:Mn[On]=(""+zn).trim():Mn[On]=zn+"px"}function ff(Mn,On,zn){if(On!=null&&typeof On!="object")throw Error(Un(62));if(Mn=Mn.style,zn!=null){for(var Hn in zn)!zn.hasOwnProperty(Hn)||On!=null&&On.hasOwnProperty(Hn)||(Hn.indexOf("--")===0?Mn.setProperty(Hn,""):Hn==="float"?Mn.cssFloat="":Mn[Hn]="");for(var Vn in On)Hn=On[Vn],On.hasOwnProperty(Vn)&&zn[Vn]!==Hn&&df(Mn,Vn,Hn)}else for(var Gn in On)On.hasOwnProperty(Gn)&&df(Mn,Gn,On[Gn])}function eh(Mn){if(Mn.indexOf("-")===-1)return!1;switch(Mn){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ty=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ey=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gl(Mn){return ey.test(""+Mn)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":Mn}function Hs(){}var nh=null;function rh(Mn){return Mn=Mn.target||Mn.srcElement||window,Mn.correspondingUseElement&&(Mn=Mn.correspondingUseElement),Mn.nodeType===3?Mn.parentNode:Mn}var io=null,so=null;function pf(Mn){var On=Wr(Mn);if(On&&(Mn=On.stateNode)){var zn=Mn[yi]||null;t:switch(Mn=On.stateNode,On.type){case"input":if(Ju(Mn,zn.value,zn.defaultValue,zn.defaultValue,zn.checked,zn.defaultChecked,zn.type,zn.name),On=zn.name,zn.type==="radio"&&On!=null){for(zn=Mn;zn.parentNode;)zn=zn.parentNode;for(zn=zn.querySelectorAll('input[name="'+ds(""+On)+'"][type="radio"]'),On=0;On<zn.length;On++){var Hn=zn[On];if(Hn!==Mn&&Hn.form===Mn.form){var Vn=Hn[yi]||null;if(!Vn)throw Error(Un(90));Ju(Hn,Vn.value,Vn.defaultValue,Vn.defaultValue,Vn.checked,Vn.defaultChecked,Vn.type,Vn.name)}}for(On=0;On<zn.length;On++)Hn=zn[On],Hn.form===Mn.form&&lf(Hn)}break t;case"textarea":uf(Mn,zn.value,zn.defaultValue);break t;case"select":On=zn.value,On!=null&&no(Mn,!!zn.multiple,On,!1)}}}var ih=!1;function gf(Mn,On,zn){if(ih)return Mn(On,zn);ih=!0;try{var Hn=Mn(On);return Hn}finally{if(ih=!1,(io!==null||so!==null)&&(Mc(),io&&(On=io,Mn=so,so=io=null,pf(On),Mn)))for(On=0;On<Mn.length;On++)pf(Mn[On])}}function Go(Mn,On){var zn=Mn.stateNode;if(zn===null)return null;var Hn=zn[yi]||null;if(Hn===null)return null;zn=Hn[On];t:switch(On){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(Hn=!Hn.disabled)||(Mn=Mn.type,Hn=!(Mn==="button"||Mn==="input"||Mn==="select"||Mn==="textarea")),Mn=!Hn;break t;default:Mn=!1}if(Mn)return null;if(zn&&typeof zn!="function")throw Error(Un(231,On,typeof zn));return zn}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sh=!1;if(Ps)try{var Yo={};Object.defineProperty(Yo,"passive",{get:function(){sh=!0}}),window.addEventListener("test",Yo,Yo),window.removeEventListener("test",Yo,Yo)}catch{sh=!1}var ca=null,ah=null,Yl=null;function mf(){if(Yl)return Yl;var Mn,On=ah,zn=On.length,Hn,Vn="value"in ca?ca.value:ca.textContent,Gn=Vn.length;for(Mn=0;Mn<zn&&On[Mn]===Vn[Mn];Mn++);var Qn=zn-Mn;for(Hn=1;Hn<=Qn&&On[zn-Hn]===Vn[Gn-Hn];Hn++);return Yl=Vn.slice(Mn,1<Hn?1-Hn:void 0)}function Zl(Mn){var On=Mn.keyCode;return"charCode"in Mn?(Mn=Mn.charCode,Mn===0&&On===13&&(Mn=13)):Mn=On,Mn===10&&(Mn=13),32<=Mn||Mn===13?Mn:0}function Xl(){return!0}function yf(){return!1}function Zi(Mn){function On(zn,Hn,Vn,Gn,Qn){this._reactName=zn,this._targetInst=Vn,this.type=Hn,this.nativeEvent=Gn,this.target=Qn,this.currentTarget=null;for(var nr in Mn)Mn.hasOwnProperty(nr)&&(zn=Mn[nr],this[nr]=zn?zn(Gn):Gn[nr]);return this.isDefaultPrevented=(Gn.defaultPrevented!=null?Gn.defaultPrevented:Gn.returnValue===!1)?Xl:yf,this.isPropagationStopped=yf,this}return Zn(On.prototype,{preventDefault:function(){this.defaultPrevented=!0;var zn=this.nativeEvent;zn&&(zn.preventDefault?zn.preventDefault():typeof zn.returnValue!="unknown"&&(zn.returnValue=!1),this.isDefaultPrevented=Xl)},stopPropagation:function(){var zn=this.nativeEvent;zn&&(zn.stopPropagation?zn.stopPropagation():typeof zn.cancelBubble!="unknown"&&(zn.cancelBubble=!0),this.isPropagationStopped=Xl)},persist:function(){},isPersistent:Xl}),On}var Ua={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(Mn){return Mn.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ql=Zi(Ua),Zo=Zn({},Ua,{view:0,detail:0}),ny=Zi(Zo),oh,lh,Xo,Jl=Zn({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uh,button:0,buttons:0,relatedTarget:function(Mn){return Mn.relatedTarget===void 0?Mn.fromElement===Mn.srcElement?Mn.toElement:Mn.fromElement:Mn.relatedTarget},movementX:function(Mn){return"movementX"in Mn?Mn.movementX:(Mn!==Xo&&(Xo&&Mn.type==="mousemove"?(oh=Mn.screenX-Xo.screenX,lh=Mn.screenY-Xo.screenY):lh=oh=0,Xo=Mn),oh)},movementY:function(Mn){return"movementY"in Mn?Mn.movementY:lh}}),bf=Zi(Jl),ry=Zn({},Jl,{dataTransfer:0}),iy=Zi(ry),sy=Zn({},Zo,{relatedTarget:0}),ch=Zi(sy),ay=Zn({},Ua,{animationName:0,elapsedTime:0,pseudoElement:0}),oy=Zi(ay),ly=Zn({},Ua,{clipboardData:function(Mn){return"clipboardData"in Mn?Mn.clipboardData:window.clipboardData}}),cy=Zi(ly),uy=Zn({},Ua,{data:0}),vf=Zi(uy),hy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function py(Mn){var On=this.nativeEvent;return On.getModifierState?On.getModifierState(Mn):(Mn=fy[Mn])?!!On[Mn]:!1}function uh(){return py}var gy=Zn({},Zo,{key:function(Mn){if(Mn.key){var On=hy[Mn.key]||Mn.key;if(On!=="Unidentified")return On}return Mn.type==="keypress"?(Mn=Zl(Mn),Mn===13?"Enter":String.fromCharCode(Mn)):Mn.type==="keydown"||Mn.type==="keyup"?dy[Mn.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uh,charCode:function(Mn){return Mn.type==="keypress"?Zl(Mn):0},keyCode:function(Mn){return Mn.type==="keydown"||Mn.type==="keyup"?Mn.keyCode:0},which:function(Mn){return Mn.type==="keypress"?Zl(Mn):Mn.type==="keydown"||Mn.type==="keyup"?Mn.keyCode:0}}),my=Zi(gy),yy=Zn({},Jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wf=Zi(yy),by=Zn({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uh}),vy=Zi(by),wy=Zn({},Ua,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ey=Zi(wy),$y=Zn({},Jl,{deltaX:function(Mn){return"deltaX"in Mn?Mn.deltaX:"wheelDeltaX"in Mn?-Mn.wheelDeltaX:0},deltaY:function(Mn){return"deltaY"in Mn?Mn.deltaY:"wheelDeltaY"in Mn?-Mn.wheelDeltaY:"wheelDelta"in Mn?-Mn.wheelDelta:0},deltaZ:0,deltaMode:0}),xy=Zi($y),ky=Zn({},Ua,{newState:0,oldState:0}),Sy=Zi(ky),Ay=[9,13,27,32],hh=Ps&&"CompositionEvent"in window,Qo=null;Ps&&"documentMode"in document&&(Qo=document.documentMode);var _y=Ps&&"TextEvent"in window&&!Qo,Ef=Ps&&(!hh||Qo&&8<Qo&&11>=Qo),$f=" ",xf=!1;function kf(Mn,On){switch(Mn){case"keyup":return Ay.indexOf(On.keyCode)!==-1;case"keydown":return On.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sf(Mn){return Mn=Mn.detail,typeof Mn=="object"&&"data"in Mn?Mn.data:null}var ao=!1;function Ty(Mn,On){switch(Mn){case"compositionend":return Sf(On);case"keypress":return On.which!==32?null:(xf=!0,$f);case"textInput":return Mn=On.data,Mn===$f&&xf?null:Mn;default:return null}}function Cy(Mn,On){if(ao)return Mn==="compositionend"||!hh&&kf(Mn,On)?(Mn=mf(),Yl=ah=ca=null,ao=!1,Mn):null;switch(Mn){case"paste":return null;case"keypress":if(!(On.ctrlKey||On.altKey||On.metaKey)||On.ctrlKey&&On.altKey){if(On.char&&1<On.char.length)return On.char;if(On.which)return String.fromCharCode(On.which)}return null;case"compositionend":return Ef&&On.locale!=="ko"?null:On.data;default:return null}}var Ny={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Af(Mn){var On=Mn&&Mn.nodeName&&Mn.nodeName.toLowerCase();return On==="input"?!!Ny[Mn.type]:On==="textarea"}function _f(Mn,On,zn,Hn){io?so?so.push(Hn):so=[Hn]:io=Hn,On=Hc(On,"onChange"),0<On.length&&(zn=new Ql("onChange","change",null,zn,Hn),Mn.push({event:zn,listeners:On}))}var Jo=null,Wo=null;function Ry(Mn){um(Mn,0)}function Wl(Mn){var On=wi(Mn);if(lf(On))return Mn}function Tf(Mn,On){if(Mn==="change")return On}var Cf=!1;if(Ps){var dh;if(Ps){var fh="oninput"in document;if(!fh){var Nf=document.createElement("div");Nf.setAttribute("oninput","return;"),fh=typeof Nf.oninput=="function"}dh=fh}else dh=!1;Cf=dh&&(!document.documentMode||9<document.documentMode)}function Rf(){Jo&&(Jo.detachEvent("onpropertychange",Df),Wo=Jo=null)}function Df(Mn){if(Mn.propertyName==="value"&&Wl(Wo)){var On=[];_f(On,Wo,Mn,rh(Mn)),gf(Ry,On)}}function Dy(Mn,On,zn){Mn==="focusin"?(Rf(),Jo=On,Wo=zn,Jo.attachEvent("onpropertychange",Df)):Mn==="focusout"&&Rf()}function Ly(Mn){if(Mn==="selectionchange"||Mn==="keyup"||Mn==="keydown")return Wl(Wo)}function My(Mn,On){if(Mn==="click")return Wl(On)}function Uy(Mn,On){if(Mn==="input"||Mn==="change")return Wl(On)}function Oy(Mn,On){return Mn===On&&(Mn!==0||1/Mn===1/On)||Mn!==Mn&&On!==On}var rs=typeof Object.is=="function"?Object.is:Oy;function tl(Mn,On){if(rs(Mn,On))return!0;if(typeof Mn!="object"||Mn===null||typeof On!="object"||On===null)return!1;var zn=Object.keys(Mn),Hn=Object.keys(On);if(zn.length!==Hn.length)return!1;for(Hn=0;Hn<zn.length;Hn++){var Vn=zn[Hn];if(!sa.call(On,Vn)||!rs(Mn[Vn],On[Vn]))return!1}return!0}function Lf(Mn){for(;Mn&&Mn.firstChild;)Mn=Mn.firstChild;return Mn}function Mf(Mn,On){var zn=Lf(Mn);Mn=0;for(var Hn;zn;){if(zn.nodeType===3){if(Hn=Mn+zn.textContent.length,Mn<=On&&Hn>=On)return{node:zn,offset:On-Mn};Mn=Hn}t:{for(;zn;){if(zn.nextSibling){zn=zn.nextSibling;break t}zn=zn.parentNode}zn=void 0}zn=Lf(zn)}}function Uf(Mn,On){return Mn&&On?Mn===On?!0:Mn&&Mn.nodeType===3?!1:On&&On.nodeType===3?Uf(Mn,On.parentNode):"contains"in Mn?Mn.contains(On):Mn.compareDocumentPosition?!!(Mn.compareDocumentPosition(On)&16):!1:!1}function Of(Mn){Mn=Mn!=null&&Mn.ownerDocument!=null&&Mn.ownerDocument.defaultView!=null?Mn.ownerDocument.defaultView:window;for(var On=jl(Mn.document);On instanceof Mn.HTMLIFrameElement;){try{var zn=typeof On.contentWindow.location.href=="string"}catch{zn=!1}if(zn)Mn=On.contentWindow;else break;On=jl(Mn.document)}return On}function ph(Mn){var On=Mn&&Mn.nodeName&&Mn.nodeName.toLowerCase();return On&&(On==="input"&&(Mn.type==="text"||Mn.type==="search"||Mn.type==="tel"||Mn.type==="url"||Mn.type==="password")||On==="textarea"||Mn.contentEditable==="true")}var By=Ps&&"documentMode"in document&&11>=document.documentMode,oo=null,gh=null,el=null,mh=!1;function Bf(Mn,On,zn){var Hn=zn.window===zn?zn.document:zn.nodeType===9?zn:zn.ownerDocument;mh||oo==null||oo!==jl(Hn)||(Hn=oo,"selectionStart"in Hn&&ph(Hn)?Hn={start:Hn.selectionStart,end:Hn.selectionEnd}:(Hn=(Hn.ownerDocument&&Hn.ownerDocument.defaultView||window).getSelection(),Hn={anchorNode:Hn.anchorNode,anchorOffset:Hn.anchorOffset,focusNode:Hn.focusNode,focusOffset:Hn.focusOffset}),el&&tl(el,Hn)||(el=Hn,Hn=Hc(gh,"onSelect"),0<Hn.length&&(On=new Ql("onSelect","select",null,On,zn),Mn.push({event:On,listeners:Hn}),On.target=oo)))}function Oa(Mn,On){var zn={};return zn[Mn.toLowerCase()]=On.toLowerCase(),zn["Webkit"+Mn]="webkit"+On,zn["Moz"+Mn]="moz"+On,zn}var lo={animationend:Oa("Animation","AnimationEnd"),animationiteration:Oa("Animation","AnimationIteration"),animationstart:Oa("Animation","AnimationStart"),transitionrun:Oa("Transition","TransitionRun"),transitionstart:Oa("Transition","TransitionStart"),transitioncancel:Oa("Transition","TransitionCancel"),transitionend:Oa("Transition","TransitionEnd")},yh={},zf={};Ps&&(zf=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function Ba(Mn){if(yh[Mn])return yh[Mn];if(!lo[Mn])return Mn;var On=lo[Mn],zn;for(zn in On)if(On.hasOwnProperty(zn)&&zn in zf)return yh[Mn]=On[zn];return Mn}var If=Ba("animationend"),qf=Ba("animationiteration"),Hf=Ba("animationstart"),zy=Ba("transitionrun"),Iy=Ba("transitionstart"),qy=Ba("transitioncancel"),Pf=Ba("transitionend"),Ff=new Map,bh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bh.push("scrollEnd");function Ss(Mn,On){Ff.set(Mn,On),ks(On,[Mn])}var tc=typeof reportError=="function"?reportError:function(Mn){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var On=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Mn=="object"&&Mn!==null&&typeof Mn.message=="string"?String(Mn.message):String(Mn),error:Mn});if(!window.dispatchEvent(On))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Mn);return}console.error(Mn)},fs=[],co=0,vh=0;function ec(){for(var Mn=co,On=vh=co=0;On<Mn;){var zn=fs[On];fs[On++]=null;var Hn=fs[On];fs[On++]=null;var Vn=fs[On];fs[On++]=null;var Gn=fs[On];if(fs[On++]=null,Hn!==null&&Vn!==null){var Qn=Hn.pending;Qn===null?Vn.next=Vn:(Vn.next=Qn.next,Qn.next=Vn),Hn.pending=Vn}Gn!==0&&Kf(zn,Vn,Gn)}}function nc(Mn,On,zn,Hn){fs[co++]=Mn,fs[co++]=On,fs[co++]=zn,fs[co++]=Hn,vh|=Hn,Mn.lanes|=Hn,Mn=Mn.alternate,Mn!==null&&(Mn.lanes|=Hn)}function wh(Mn,On,zn,Hn){return nc(Mn,On,zn,Hn),rc(Mn)}function za(Mn,On){return nc(Mn,null,null,On),rc(Mn)}function Kf(Mn,On,zn){Mn.lanes|=zn;var Hn=Mn.alternate;Hn!==null&&(Hn.lanes|=zn);for(var Vn=!1,Gn=Mn.return;Gn!==null;)Gn.childLanes|=zn,Hn=Gn.alternate,Hn!==null&&(Hn.childLanes|=zn),Gn.tag===22&&(Mn=Gn.stateNode,Mn===null||Mn._visibility&1||(Vn=!0)),Mn=Gn,Gn=Gn.return;return Mn.tag===3?(Gn=Mn.stateNode,Vn&&On!==null&&(Vn=31-_i(zn),Mn=Gn.hiddenUpdates,Hn=Mn[Vn],Hn===null?Mn[Vn]=[On]:Hn.push(On),On.lane=zn|536870912),Gn):null}function rc(Mn){if(50<xl)throw xl=0,Cd=null,Error(Un(185));for(var On=Mn.return;On!==null;)Mn=On,On=Mn.return;return Mn.tag===3?Mn.stateNode:null}var uo={};function Hy(Mn,On,zn,Hn){this.tag=Mn,this.key=zn,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=On,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Hn,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function is(Mn,On,zn,Hn){return new Hy(Mn,On,zn,Hn)}function Eh(Mn){return Mn=Mn.prototype,!(!Mn||!Mn.isReactComponent)}function Fs(Mn,On){var zn=Mn.alternate;return zn===null?(zn=is(Mn.tag,On,Mn.key,Mn.mode),zn.elementType=Mn.elementType,zn.type=Mn.type,zn.stateNode=Mn.stateNode,zn.alternate=Mn,Mn.alternate=zn):(zn.pendingProps=On,zn.type=Mn.type,zn.flags=0,zn.subtreeFlags=0,zn.deletions=null),zn.flags=Mn.flags&65011712,zn.childLanes=Mn.childLanes,zn.lanes=Mn.lanes,zn.child=Mn.child,zn.memoizedProps=Mn.memoizedProps,zn.memoizedState=Mn.memoizedState,zn.updateQueue=Mn.updateQueue,On=Mn.dependencies,zn.dependencies=On===null?null:{lanes:On.lanes,firstContext:On.firstContext},zn.sibling=Mn.sibling,zn.index=Mn.index,zn.ref=Mn.ref,zn.refCleanup=Mn.refCleanup,zn}function Vf(Mn,On){Mn.flags&=65011714;var zn=Mn.alternate;return zn===null?(Mn.childLanes=0,Mn.lanes=On,Mn.child=null,Mn.subtreeFlags=0,Mn.memoizedProps=null,Mn.memoizedState=null,Mn.updateQueue=null,Mn.dependencies=null,Mn.stateNode=null):(Mn.childLanes=zn.childLanes,Mn.lanes=zn.lanes,Mn.child=zn.child,Mn.subtreeFlags=0,Mn.deletions=null,Mn.memoizedProps=zn.memoizedProps,Mn.memoizedState=zn.memoizedState,Mn.updateQueue=zn.updateQueue,Mn.type=zn.type,On=zn.dependencies,Mn.dependencies=On===null?null:{lanes:On.lanes,firstContext:On.firstContext}),Mn}function ic(Mn,On,zn,Hn,Vn,Gn){var Qn=0;if(Hn=Mn,typeof Mn=="function")Eh(Mn)&&(Qn=1);else if(typeof Mn=="string")Qn=jb(Mn,zn,Br.current)?26:Mn==="html"||Mn==="head"||Mn==="body"?27:5;else t:switch(Mn){case Dr:return Mn=is(31,zn,On,Vn),Mn.elementType=Dr,Mn.lanes=Gn,Mn;case tr:return Ia(zn.children,Vn,Gn,On);case ir:Qn=8,Vn|=24;break;case sr:return Mn=is(12,zn,On,Vn|2),Mn.elementType=sr,Mn.lanes=Gn,Mn;case Nr:return Mn=is(13,zn,On,Vn),Mn.elementType=Nr,Mn.lanes=Gn,Mn;case Ar:return Mn=is(19,zn,On,Vn),Mn.elementType=Ar,Mn.lanes=Gn,Mn;default:if(typeof Mn=="object"&&Mn!==null)switch(Mn.$$typeof){case ur:Qn=10;break t;case fr:Qn=9;break t;case br:Qn=11;break t;case _r:Qn=14;break t;case Rr:Qn=16,Hn=null;break t}Qn=29,zn=Error(Un(130,Mn===null?"null":typeof Mn,"")),Hn=null}return On=is(Qn,zn,On,Vn),On.elementType=Mn,On.type=Hn,On.lanes=Gn,On}function Ia(Mn,On,zn,Hn){return Mn=is(7,Mn,Hn,On),Mn.lanes=zn,Mn}function $h(Mn,On,zn){return Mn=is(6,Mn,null,On),Mn.lanes=zn,Mn}function jf(Mn){var On=is(18,null,null,0);return On.stateNode=Mn,On}function xh(Mn,On,zn){return On=is(4,Mn.children!==null?Mn.children:[],Mn.key,On),On.lanes=zn,On.stateNode={containerInfo:Mn.containerInfo,pendingChildren:null,implementation:Mn.implementation},On}var Gf=new WeakMap;function ps(Mn,On){if(typeof Mn=="object"&&Mn!==null){var zn=Gf.get(Mn);return zn!==void 0?zn:(On={value:Mn,source:On,stack:Ms(On)},Gf.set(Mn,On),On)}return{value:Mn,source:On,stack:Ms(On)}}var ho=[],fo=0,sc=null,nl=0,gs=[],ys=0,ua=null,Ns=1,Rs="";function Ks(Mn,On){ho[fo++]=nl,ho[fo++]=sc,sc=Mn,nl=On}function Yf(Mn,On,zn){gs[ys++]=Ns,gs[ys++]=Rs,gs[ys++]=ua,ua=Mn;var Hn=Ns;Mn=Rs;var Vn=32-_i(Hn)-1;Hn&=~(1<<Vn),zn+=1;var Gn=32-_i(On)+Vn;if(30<Gn){var Qn=Vn-Vn%5;Gn=(Hn&(1<<Qn)-1).toString(32),Hn>>=Qn,Vn-=Qn,Ns=1<<32-_i(On)+Vn|zn<<Vn|Hn,Rs=Gn+Mn}else Ns=1<<Gn|zn<<Vn|Hn,Rs=Mn}function kh(Mn){Mn.return!==null&&(Ks(Mn,1),Yf(Mn,1,0))}function Sh(Mn){for(;Mn===sc;)sc=ho[--fo],ho[fo]=null,nl=ho[--fo],ho[fo]=null;for(;Mn===ua;)ua=gs[--ys],gs[ys]=null,Rs=gs[--ys],gs[ys]=null,Ns=gs[--ys],gs[ys]=null}function Zf(Mn,On){gs[ys++]=Ns,gs[ys++]=Rs,gs[ys++]=ua,Ns=On.id,Rs=On.overflow,ua=Mn}var Hi=null,gi=null,ni=!1,ha=null,bs=!1,Ah=Error(Un(519));function da(Mn){var On=Error(Un(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw rl(ps(On,Mn)),Ah}function Xf(Mn){var On=Mn.stateNode,zn=Mn.type,Hn=Mn.memoizedProps;switch(On[Ti]=Mn,On[yi]=Hn,zn){case"dialog":Jr("cancel",On),Jr("close",On);break;case"iframe":case"object":case"embed":Jr("load",On);break;case"video":case"audio":for(zn=0;zn<Sl.length;zn++)Jr(Sl[zn],On);break;case"source":Jr("error",On);break;case"img":case"image":case"link":Jr("error",On),Jr("load",On);break;case"details":Jr("toggle",On);break;case"input":Jr("invalid",On),cf(On,Hn.value,Hn.defaultValue,Hn.checked,Hn.defaultChecked,Hn.type,Hn.name,!0);break;case"select":Jr("invalid",On);break;case"textarea":Jr("invalid",On),hf(On,Hn.value,Hn.defaultValue,Hn.children)}zn=Hn.children,typeof zn!="string"&&typeof zn!="number"&&typeof zn!="bigint"||On.textContent===""+zn||Hn.suppressHydrationWarning===!0||pm(On.textContent,zn)?(Hn.popover!=null&&(Jr("beforetoggle",On),Jr("toggle",On)),Hn.onScroll!=null&&Jr("scroll",On),Hn.onScrollEnd!=null&&Jr("scrollend",On),Hn.onClick!=null&&(On.onclick=Hs),On=!0):On=!1,On||da(Mn,!0)}function Qf(Mn){for(Hi=Mn.return;Hi;)switch(Hi.tag){case 5:case 31:case 13:bs=!1;return;case 27:case 3:bs=!0;return;default:Hi=Hi.return}}function po(Mn){if(Mn!==Hi)return!1;if(!ni)return Qf(Mn),ni=!0,!1;var On=Mn.tag,zn;if((zn=On!==3&&On!==27)&&((zn=On===5)&&(zn=Mn.type,zn=!(zn!=="form"&&zn!=="button")||Kd(Mn.type,Mn.memoizedProps)),zn=!zn),zn&&gi&&da(Mn),Qf(Mn),On===13){if(Mn=Mn.memoizedState,Mn=Mn!==null?Mn.dehydrated:null,!Mn)throw Error(Un(317));gi=xm(Mn)}else if(On===31){if(Mn=Mn.memoizedState,Mn=Mn!==null?Mn.dehydrated:null,!Mn)throw Error(Un(317));gi=xm(Mn)}else On===27?(On=gi,Aa(Mn.type)?(Mn=Zd,Zd=null,gi=Mn):gi=On):gi=Hi?ws(Mn.stateNode.nextSibling):null;return!0}function qa(){gi=Hi=null,ni=!1}function _h(){var Mn=ha;return Mn!==null&&(Wi===null?Wi=Mn:Wi.push.apply(Wi,Mn),ha=null),Mn}function rl(Mn){ha===null?ha=[Mn]:ha.push(Mn)}var Th=rr(null),Ha=null,Vs=null;function fa(Mn,On,zn){Tr(Th,On._currentValue),On._currentValue=zn}function js(Mn){Mn._currentValue=Th.current,gr(Th)}function Ch(Mn,On,zn){for(;Mn!==null;){var Hn=Mn.alternate;if((Mn.childLanes&On)!==On?(Mn.childLanes|=On,Hn!==null&&(Hn.childLanes|=On)):Hn!==null&&(Hn.childLanes&On)!==On&&(Hn.childLanes|=On),Mn===zn)break;Mn=Mn.return}}function Nh(Mn,On,zn,Hn){var Vn=Mn.child;for(Vn!==null&&(Vn.return=Mn);Vn!==null;){var Gn=Vn.dependencies;if(Gn!==null){var Qn=Vn.child;Gn=Gn.firstContext;t:for(;Gn!==null;){var nr=Gn;Gn=Vn;for(var hr=0;hr<On.length;hr++)if(nr.context===On[hr]){Gn.lanes|=zn,nr=Gn.alternate,nr!==null&&(nr.lanes|=zn),Ch(Gn.return,zn,Mn),Hn||(Qn=null);break t}Gn=nr.next}}else if(Vn.tag===18){if(Qn=Vn.return,Qn===null)throw Error(Un(341));Qn.lanes|=zn,Gn=Qn.alternate,Gn!==null&&(Gn.lanes|=zn),Ch(Qn,zn,Mn),Qn=null}else Qn=Vn.child;if(Qn!==null)Qn.return=Vn;else for(Qn=Vn;Qn!==null;){if(Qn===Mn){Qn=null;break}if(Vn=Qn.sibling,Vn!==null){Vn.return=Qn.return,Qn=Vn;break}Qn=Qn.return}Vn=Qn}}function go(Mn,On,zn,Hn){Mn=null;for(var Vn=On,Gn=!1;Vn!==null;){if(!Gn){if((Vn.flags&524288)!==0)Gn=!0;else if((Vn.flags&262144)!==0)break}if(Vn.tag===10){var Qn=Vn.alternate;if(Qn===null)throw Error(Un(387));if(Qn=Qn.memoizedProps,Qn!==null){var nr=Vn.type;rs(Vn.pendingProps.value,Qn.value)||(Mn!==null?Mn.push(nr):Mn=[nr])}}else if(Vn===Hr.current){if(Qn=Vn.alternate,Qn===null)throw Error(Un(387));Qn.memoizedState.memoizedState!==Vn.memoizedState.memoizedState&&(Mn!==null?Mn.push(Nl):Mn=[Nl])}Vn=Vn.return}Mn!==null&&Nh(On,Mn,zn,Hn),On.flags|=262144}function ac(Mn){for(Mn=Mn.firstContext;Mn!==null;){if(!rs(Mn.context._currentValue,Mn.memoizedValue))return!0;Mn=Mn.next}return!1}function Pa(Mn){Ha=Mn,Vs=null,Mn=Mn.dependencies,Mn!==null&&(Mn.firstContext=null)}function Pi(Mn){return Jf(Ha,Mn)}function oc(Mn,On){return Ha===null&&Pa(Mn),Jf(Mn,On)}function Jf(Mn,On){var zn=On._currentValue;if(On={context:On,memoizedValue:zn,next:null},Vs===null){if(Mn===null)throw Error(Un(308));Vs=On,Mn.dependencies={lanes:0,firstContext:On},Mn.flags|=524288}else Vs=Vs.next=On;return zn}var Py=typeof AbortController<"u"?AbortController:function(){var Mn=[],On=this.signal={aborted:!1,addEventListener:function(zn,Hn){Mn.push(Hn)}};this.abort=function(){On.aborted=!0,Mn.forEach(function(zn){return zn()})}},Fy=s.unstable_scheduleCallback,Ky=s.unstable_NormalPriority,Ci={$$typeof:ur,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rh(){return{controller:new Py,data:new Map,refCount:0}}function il(Mn){Mn.refCount--,Mn.refCount===0&&Fy(Ky,function(){Mn.controller.abort()})}var sl=null,Dh=0,mo=0,yo=null;function Vy(Mn,On){if(sl===null){var zn=sl=[];Dh=0,mo=Ud(),yo={status:"pending",value:void 0,then:function(Hn){zn.push(Hn)}}}return Dh++,On.then(Wf,Wf),On}function Wf(){if(--Dh===0&&sl!==null){yo!==null&&(yo.status="fulfilled");var Mn=sl;sl=null,mo=0,yo=null;for(var On=0;On<Mn.length;On++)(0,Mn[On])()}}function jy(Mn,On){var zn=[],Hn={status:"pending",value:null,reason:null,then:function(Vn){zn.push(Vn)}};return Mn.then(function(){Hn.status="fulfilled",Hn.value=On;for(var Vn=0;Vn<zn.length;Vn++)(0,zn[Vn])(On)},function(Vn){for(Hn.status="rejected",Hn.reason=Vn,Vn=0;Vn<zn.length;Vn++)(0,zn[Vn])(void 0)}),Hn}var tp=er.S;er.S=function(Mn,On){zg=qi(),typeof On=="object"&&On!==null&&typeof On.then=="function"&&Vy(Mn,On),tp!==null&&tp(Mn,On)};var Fa=rr(null);function Lh(){var Mn=Fa.current;return Mn!==null?Mn:pi.pooledCache}function lc(Mn,On){On===null?Tr(Fa,Fa.current):Tr(Fa,On.pool)}function ep(){var Mn=Lh();return Mn===null?null:{parent:Ci._currentValue,pool:Mn}}var bo=Error(Un(460)),Mh=Error(Un(474)),cc=Error(Un(542)),uc={then:function(){}};function np(Mn){return Mn=Mn.status,Mn==="fulfilled"||Mn==="rejected"}function rp(Mn,On,zn){switch(zn=Mn[zn],zn===void 0?Mn.push(On):zn!==On&&(On.then(Hs,Hs),On=zn),On.status){case"fulfilled":return On.value;case"rejected":throw Mn=On.reason,sp(Mn),Mn;default:if(typeof On.status=="string")On.then(Hs,Hs);else{if(Mn=pi,Mn!==null&&100<Mn.shellSuspendCounter)throw Error(Un(482));Mn=On,Mn.status="pending",Mn.then(function(Hn){if(On.status==="pending"){var Vn=On;Vn.status="fulfilled",Vn.value=Hn}},function(Hn){if(On.status==="pending"){var Vn=On;Vn.status="rejected",Vn.reason=Hn}})}switch(On.status){case"fulfilled":return On.value;case"rejected":throw Mn=On.reason,sp(Mn),Mn}throw Va=On,bo}}function Ka(Mn){try{var On=Mn._init;return On(Mn._payload)}catch(zn){throw zn!==null&&typeof zn=="object"&&typeof zn.then=="function"?(Va=zn,bo):zn}}var Va=null;function ip(){if(Va===null)throw Error(Un(459));var Mn=Va;return Va=null,Mn}function sp(Mn){if(Mn===bo||Mn===cc)throw Error(Un(483))}var vo=null,al=0;function hc(Mn){var On=al;return al+=1,vo===null&&(vo=[]),rp(vo,Mn,On)}function ol(Mn,On){On=On.props.ref,Mn.ref=On!==void 0?On:null}function dc(Mn,On){throw On.$$typeof===Xn?Error(Un(525)):(Mn=Object.prototype.toString.call(On),Error(Un(31,Mn==="[object Object]"?"object with keys {"+Object.keys(On).join(", ")+"}":Mn)))}function ap(Mn){function On(Er,yr){if(Mn){var $r=Er.deletions;$r===null?(Er.deletions=[yr],Er.flags|=16):$r.push(yr)}}function zn(Er,yr){if(!Mn)return null;for(;yr!==null;)On(Er,yr),yr=yr.sibling;return null}function Hn(Er){for(var yr=new Map;Er!==null;)Er.key!==null?yr.set(Er.key,Er):yr.set(Er.index,Er),Er=Er.sibling;return yr}function Vn(Er,yr){return Er=Fs(Er,yr),Er.index=0,Er.sibling=null,Er}function Gn(Er,yr,$r){return Er.index=$r,Mn?($r=Er.alternate,$r!==null?($r=$r.index,$r<yr?(Er.flags|=67108866,yr):$r):(Er.flags|=67108866,yr)):(Er.flags|=1048576,yr)}function Qn(Er){return Mn&&Er.alternate===null&&(Er.flags|=67108866),Er}function nr(Er,yr,$r,Mr){return yr===null||yr.tag!==6?(yr=$h($r,Er.mode,Mr),yr.return=Er,yr):(yr=Vn(yr,$r),yr.return=Er,yr)}function hr(Er,yr,$r,Mr){var jr=$r.type;return jr===tr?Lr(Er,yr,$r.props.children,Mr,$r.key):yr!==null&&(yr.elementType===jr||typeof jr=="object"&&jr!==null&&jr.$$typeof===Rr&&Ka(jr)===yr.type)?(yr=Vn(yr,$r.props),ol(yr,$r),yr.return=Er,yr):(yr=ic($r.type,$r.key,$r.props,null,Er.mode,Mr),ol(yr,$r),yr.return=Er,yr)}function xr(Er,yr,$r,Mr){return yr===null||yr.tag!==4||yr.stateNode.containerInfo!==$r.containerInfo||yr.stateNode.implementation!==$r.implementation?(yr=xh($r,Er.mode,Mr),yr.return=Er,yr):(yr=Vn(yr,$r.children||[]),yr.return=Er,yr)}function Lr(Er,yr,$r,Mr,jr){return yr===null||yr.tag!==7?(yr=Ia($r,Er.mode,Mr,jr),yr.return=Er,yr):(yr=Vn(yr,$r),yr.return=Er,yr)}function Or(Er,yr,$r){if(typeof yr=="string"&&yr!==""||typeof yr=="number"||typeof yr=="bigint")return yr=$h(""+yr,Er.mode,$r),yr.return=Er,yr;if(typeof yr=="object"&&yr!==null){switch(yr.$$typeof){case Jn:return $r=ic(yr.type,yr.key,yr.props,null,Er.mode,$r),ol($r,yr),$r.return=Er,$r;case Wn:return yr=xh(yr,Er.mode,$r),yr.return=Er,yr;case Rr:return yr=Ka(yr),Or(Er,yr,$r)}if(ar(yr)||pr(yr))return yr=Ia(yr,Er.mode,$r,null),yr.return=Er,yr;if(typeof yr.then=="function")return Or(Er,hc(yr),$r);if(yr.$$typeof===ur)return Or(Er,oc(Er,yr),$r);dc(Er,yr)}return null}function kr(Er,yr,$r,Mr){var jr=yr!==null?yr.key:null;if(typeof $r=="string"&&$r!==""||typeof $r=="number"||typeof $r=="bigint")return jr!==null?null:nr(Er,yr,""+$r,Mr);if(typeof $r=="object"&&$r!==null){switch($r.$$typeof){case Jn:return $r.key===jr?hr(Er,yr,$r,Mr):null;case Wn:return $r.key===jr?xr(Er,yr,$r,Mr):null;case Rr:return $r=Ka($r),kr(Er,yr,$r,Mr)}if(ar($r)||pr($r))return jr!==null?null:Lr(Er,yr,$r,Mr,null);if(typeof $r.then=="function")return kr(Er,yr,hc($r),Mr);if($r.$$typeof===ur)return kr(Er,yr,oc(Er,$r),Mr);dc(Er,$r)}return null}function Cr(Er,yr,$r,Mr,jr){if(typeof Mr=="string"&&Mr!==""||typeof Mr=="number"||typeof Mr=="bigint")return Er=Er.get($r)||null,nr(yr,Er,""+Mr,jr);if(typeof Mr=="object"&&Mr!==null){switch(Mr.$$typeof){case Jn:return Er=Er.get(Mr.key===null?$r:Mr.key)||null,hr(yr,Er,Mr,jr);case Wn:return Er=Er.get(Mr.key===null?$r:Mr.key)||null,xr(yr,Er,Mr,jr);case Rr:return Mr=Ka(Mr),Cr(Er,yr,$r,Mr,jr)}if(ar(Mr)||pr(Mr))return Er=Er.get($r)||null,Lr(yr,Er,Mr,jr,null);if(typeof Mr.then=="function")return Cr(Er,yr,$r,hc(Mr),jr);if(Mr.$$typeof===ur)return Cr(Er,yr,$r,oc(yr,Mr),jr);dc(yr,Mr)}return null}function Fr(Er,yr,$r,Mr){for(var jr=null,ri=null,Vr=yr,Xr=yr=0,ei=null;Vr!==null&&Xr<$r.length;Xr++){Vr.index>Xr?(ei=Vr,Vr=null):ei=Vr.sibling;var ii=kr(Er,Vr,$r[Xr],Mr);if(ii===null){Vr===null&&(Vr=ei);break}Mn&&Vr&&ii.alternate===null&&On(Er,Vr),yr=Gn(ii,yr,Xr),ri===null?jr=ii:ri.sibling=ii,ri=ii,Vr=ei}if(Xr===$r.length)return zn(Er,Vr),ni&&Ks(Er,Xr),jr;if(Vr===null){for(;Xr<$r.length;Xr++)Vr=Or(Er,$r[Xr],Mr),Vr!==null&&(yr=Gn(Vr,yr,Xr),ri===null?jr=Vr:ri.sibling=Vr,ri=Vr);return ni&&Ks(Er,Xr),jr}for(Vr=Hn(Vr);Xr<$r.length;Xr++)ei=Cr(Vr,Er,Xr,$r[Xr],Mr),ei!==null&&(Mn&&ei.alternate!==null&&Vr.delete(ei.key===null?Xr:ei.key),yr=Gn(ei,yr,Xr),ri===null?jr=ei:ri.sibling=ei,ri=ei);return Mn&&Vr.forEach(function(Da){return On(Er,Da)}),ni&&Ks(Er,Xr),jr}function Gr(Er,yr,$r,Mr){if($r==null)throw Error(Un(151));for(var jr=null,ri=null,Vr=yr,Xr=yr=0,ei=null,ii=$r.next();Vr!==null&&!ii.done;Xr++,ii=$r.next()){Vr.index>Xr?(ei=Vr,Vr=null):ei=Vr.sibling;var Da=kr(Er,Vr,ii.value,Mr);if(Da===null){Vr===null&&(Vr=ei);break}Mn&&Vr&&Da.alternate===null&&On(Er,Vr),yr=Gn(Da,yr,Xr),ri===null?jr=Da:ri.sibling=Da,ri=Da,Vr=ei}if(ii.done)return zn(Er,Vr),ni&&Ks(Er,Xr),jr;if(Vr===null){for(;!ii.done;Xr++,ii=$r.next())ii=Or(Er,ii.value,Mr),ii!==null&&(yr=Gn(ii,yr,Xr),ri===null?jr=ii:ri.sibling=ii,ri=ii);return ni&&Ks(Er,Xr),jr}for(Vr=Hn(Vr);!ii.done;Xr++,ii=$r.next())ii=Cr(Vr,Er,Xr,ii.value,Mr),ii!==null&&(Mn&&ii.alternate!==null&&Vr.delete(ii.key===null?Xr:ii.key),yr=Gn(ii,yr,Xr),ri===null?jr=ii:ri.sibling=ii,ri=ii);return Mn&&Vr.forEach(function(y0){return On(Er,y0)}),ni&&Ks(Er,Xr),jr}function fi(Er,yr,$r,Mr){if(typeof $r=="object"&&$r!==null&&$r.type===tr&&$r.key===null&&($r=$r.props.children),typeof $r=="object"&&$r!==null){switch($r.$$typeof){case Jn:t:{for(var jr=$r.key;yr!==null;){if(yr.key===jr){if(jr=$r.type,jr===tr){if(yr.tag===7){zn(Er,yr.sibling),Mr=Vn(yr,$r.props.children),Mr.return=Er,Er=Mr;break t}}else if(yr.elementType===jr||typeof jr=="object"&&jr!==null&&jr.$$typeof===Rr&&Ka(jr)===yr.type){zn(Er,yr.sibling),Mr=Vn(yr,$r.props),ol(Mr,$r),Mr.return=Er,Er=Mr;break t}zn(Er,yr);break}else On(Er,yr);yr=yr.sibling}$r.type===tr?(Mr=Ia($r.props.children,Er.mode,Mr,$r.key),Mr.return=Er,Er=Mr):(Mr=ic($r.type,$r.key,$r.props,null,Er.mode,Mr),ol(Mr,$r),Mr.return=Er,Er=Mr)}return Qn(Er);case Wn:t:{for(jr=$r.key;yr!==null;){if(yr.key===jr)if(yr.tag===4&&yr.stateNode.containerInfo===$r.containerInfo&&yr.stateNode.implementation===$r.implementation){zn(Er,yr.sibling),Mr=Vn(yr,$r.children||[]),Mr.return=Er,Er=Mr;break t}else{zn(Er,yr);break}else On(Er,yr);yr=yr.sibling}Mr=xh($r,Er.mode,Mr),Mr.return=Er,Er=Mr}return Qn(Er);case Rr:return $r=Ka($r),fi(Er,yr,$r,Mr)}if(ar($r))return Fr(Er,yr,$r,Mr);if(pr($r)){if(jr=pr($r),typeof jr!="function")throw Error(Un(150));return $r=jr.call($r),Gr(Er,yr,$r,Mr)}if(typeof $r.then=="function")return fi(Er,yr,hc($r),Mr);if($r.$$typeof===ur)return fi(Er,yr,oc(Er,$r),Mr);dc(Er,$r)}return typeof $r=="string"&&$r!==""||typeof $r=="number"||typeof $r=="bigint"?($r=""+$r,yr!==null&&yr.tag===6?(zn(Er,yr.sibling),Mr=Vn(yr,$r),Mr.return=Er,Er=Mr):(zn(Er,yr),Mr=$h($r,Er.mode,Mr),Mr.return=Er,Er=Mr),Qn(Er)):zn(Er,yr)}return function(Er,yr,$r,Mr){try{al=0;var jr=fi(Er,yr,$r,Mr);return vo=null,jr}catch(Vr){if(Vr===bo||Vr===cc)throw Vr;var ri=is(29,Vr,null,Er.mode);return ri.lanes=Mr,ri.return=Er,ri}}}var ja=ap(!0),op=ap(!1),pa=!1;function Uh(Mn){Mn.updateQueue={baseState:Mn.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Oh(Mn,On){Mn=Mn.updateQueue,On.updateQueue===Mn&&(On.updateQueue={baseState:Mn.baseState,firstBaseUpdate:Mn.firstBaseUpdate,lastBaseUpdate:Mn.lastBaseUpdate,shared:Mn.shared,callbacks:null})}function ga(Mn){return{lane:Mn,tag:0,payload:null,callback:null,next:null}}function ma(Mn,On,zn){var Hn=Mn.updateQueue;if(Hn===null)return null;if(Hn=Hn.shared,(ai&2)!==0){var Vn=Hn.pending;return Vn===null?On.next=On:(On.next=Vn.next,Vn.next=On),Hn.pending=On,On=rc(Mn),Kf(Mn,null,zn),On}return nc(Mn,Hn,On,zn),rc(Mn)}function ll(Mn,On,zn){if(On=On.updateQueue,On!==null&&(On=On.shared,(zn&4194048)!==0)){var Hn=On.lanes;Hn&=Mn.pendingLanes,zn|=Hn,On.lanes=zn,Ko(Mn,zn)}}function Bh(Mn,On){var zn=Mn.updateQueue,Hn=Mn.alternate;if(Hn!==null&&(Hn=Hn.updateQueue,zn===Hn)){var Vn=null,Gn=null;if(zn=zn.firstBaseUpdate,zn!==null){do{var Qn={lane:zn.lane,tag:zn.tag,payload:zn.payload,callback:null,next:null};Gn===null?Vn=Gn=Qn:Gn=Gn.next=Qn,zn=zn.next}while(zn!==null);Gn===null?Vn=Gn=On:Gn=Gn.next=On}else Vn=Gn=On;zn={baseState:Hn.baseState,firstBaseUpdate:Vn,lastBaseUpdate:Gn,shared:Hn.shared,callbacks:Hn.callbacks},Mn.updateQueue=zn;return}Mn=zn.lastBaseUpdate,Mn===null?zn.firstBaseUpdate=On:Mn.next=On,zn.lastBaseUpdate=On}var zh=!1;function cl(){if(zh){var Mn=yo;if(Mn!==null)throw Mn}}function ul(Mn,On,zn,Hn){zh=!1;var Vn=Mn.updateQueue;pa=!1;var Gn=Vn.firstBaseUpdate,Qn=Vn.lastBaseUpdate,nr=Vn.shared.pending;if(nr!==null){Vn.shared.pending=null;var hr=nr,xr=hr.next;hr.next=null,Qn===null?Gn=xr:Qn.next=xr,Qn=hr;var Lr=Mn.alternate;Lr!==null&&(Lr=Lr.updateQueue,nr=Lr.lastBaseUpdate,nr!==Qn&&(nr===null?Lr.firstBaseUpdate=xr:nr.next=xr,Lr.lastBaseUpdate=hr))}if(Gn!==null){var Or=Vn.baseState;Qn=0,Lr=xr=hr=null,nr=Gn;do{var kr=nr.lane&-536870913,Cr=kr!==nr.lane;if(Cr?(ti&kr)===kr:(Hn&kr)===kr){kr!==0&&kr===mo&&(zh=!0),Lr!==null&&(Lr=Lr.next={lane:0,tag:nr.tag,payload:nr.payload,callback:null,next:null});t:{var Fr=Mn,Gr=nr;kr=On;var fi=zn;switch(Gr.tag){case 1:if(Fr=Gr.payload,typeof Fr=="function"){Or=Fr.call(fi,Or,kr);break t}Or=Fr;break t;case 3:Fr.flags=Fr.flags&-65537|128;case 0:if(Fr=Gr.payload,kr=typeof Fr=="function"?Fr.call(fi,Or,kr):Fr,kr==null)break t;Or=Zn({},Or,kr);break t;case 2:pa=!0}}kr=nr.callback,kr!==null&&(Mn.flags|=64,Cr&&(Mn.flags|=8192),Cr=Vn.callbacks,Cr===null?Vn.callbacks=[kr]:Cr.push(kr))}else Cr={lane:kr,tag:nr.tag,payload:nr.payload,callback:nr.callback,next:null},Lr===null?(xr=Lr=Cr,hr=Or):Lr=Lr.next=Cr,Qn|=kr;if(nr=nr.next,nr===null){if(nr=Vn.shared.pending,nr===null)break;Cr=nr,nr=Cr.next,Cr.next=null,Vn.lastBaseUpdate=Cr,Vn.shared.pending=null}}while(!0);Lr===null&&(hr=Or),Vn.baseState=hr,Vn.firstBaseUpdate=xr,Vn.lastBaseUpdate=Lr,Gn===null&&(Vn.shared.lanes=0),Ea|=Qn,Mn.lanes=Qn,Mn.memoizedState=Or}}function lp(Mn,On){if(typeof Mn!="function")throw Error(Un(191,Mn));Mn.call(On)}function cp(Mn,On){var zn=Mn.callbacks;if(zn!==null)for(Mn.callbacks=null,Mn=0;Mn<zn.length;Mn++)lp(zn[Mn],On)}var wo=rr(null),fc=rr(0);function up(Mn,On){Mn=ea,Tr(fc,Mn),Tr(wo,On),ea=Mn|On.baseLanes}function Ih(){Tr(fc,ea),Tr(wo,wo.current)}function qh(){ea=fc.current,gr(wo),gr(fc)}var ss=rr(null),vs=null;function ya(Mn){var On=Mn.alternate;Tr(ki,ki.current&1),Tr(ss,Mn),vs===null&&(On===null||wo.current!==null||On.memoizedState!==null)&&(vs=Mn)}function Hh(Mn){Tr(ki,ki.current),Tr(ss,Mn),vs===null&&(vs=Mn)}function hp(Mn){Mn.tag===22?(Tr(ki,ki.current),Tr(ss,Mn),vs===null&&(vs=Mn)):ba()}function ba(){Tr(ki,ki.current),Tr(ss,ss.current)}function as(Mn){gr(ss),vs===Mn&&(vs=null),gr(ki)}var ki=rr(0);function pc(Mn){for(var On=Mn;On!==null;){if(On.tag===13){var zn=On.memoizedState;if(zn!==null&&(zn=zn.dehydrated,zn===null||Gd(zn)||Yd(zn)))return On}else if(On.tag===19&&(On.memoizedProps.revealOrder==="forwards"||On.memoizedProps.revealOrder==="backwards"||On.memoizedProps.revealOrder==="unstable_legacy-backwards"||On.memoizedProps.revealOrder==="together")){if((On.flags&128)!==0)return On}else if(On.child!==null){On.child.return=On,On=On.child;continue}if(On===Mn)break;for(;On.sibling===null;){if(On.return===null||On.return===Mn)return null;On=On.return}On.sibling.return=On.return,On=On.sibling}return null}var Gs=0,Zr=null,hi=null,Ni=null,gc=!1,Eo=!1,Ga=!1,mc=0,hl=0,$o=null,Gy=0;function Ei(){throw Error(Un(321))}function Ph(Mn,On){if(On===null)return!1;for(var zn=0;zn<On.length&&zn<Mn.length;zn++)if(!rs(Mn[zn],On[zn]))return!1;return!0}function Fh(Mn,On,zn,Hn,Vn,Gn){return Gs=Gn,Zr=On,On.memoizedState=null,On.updateQueue=null,On.lanes=0,er.H=Mn===null||Mn.memoizedState===null?Zp:id,Ga=!1,Gn=zn(Hn,Vn),Ga=!1,Eo&&(Gn=fp(On,zn,Hn,Vn)),dp(Mn),Gn}function dp(Mn){er.H=pl;var On=hi!==null&&hi.next!==null;if(Gs=0,Ni=hi=Zr=null,gc=!1,hl=0,$o=null,On)throw Error(Un(300));Mn===null||Ri||(Mn=Mn.dependencies,Mn!==null&&ac(Mn)&&(Ri=!0))}function fp(Mn,On,zn,Hn){Zr=Mn;var Vn=0;do{if(Eo&&($o=null),hl=0,Eo=!1,25<=Vn)throw Error(Un(301));if(Vn+=1,Ni=hi=null,Mn.updateQueue!=null){var Gn=Mn.updateQueue;Gn.lastEffect=null,Gn.events=null,Gn.stores=null,Gn.memoCache!=null&&(Gn.memoCache.index=0)}er.H=Xp,Gn=On(zn,Hn)}while(Eo);return Gn}function Yy(){var Mn=er.H,On=Mn.useState()[0];return On=typeof On.then=="function"?dl(On):On,Mn=Mn.useState()[0],(hi!==null?hi.memoizedState:null)!==Mn&&(Zr.flags|=1024),On}function Kh(){var Mn=mc!==0;return mc=0,Mn}function Vh(Mn,On,zn){On.updateQueue=Mn.updateQueue,On.flags&=-2053,Mn.lanes&=~zn}function jh(Mn){if(gc){for(Mn=Mn.memoizedState;Mn!==null;){var On=Mn.queue;On!==null&&(On.pending=null),Mn=Mn.next}gc=!1}Gs=0,Ni=hi=Zr=null,Eo=!1,hl=mc=0,$o=null}function Vi(){var Mn={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ni===null?Zr.memoizedState=Ni=Mn:Ni=Ni.next=Mn,Ni}function Si(){if(hi===null){var Mn=Zr.alternate;Mn=Mn!==null?Mn.memoizedState:null}else Mn=hi.next;var On=Ni===null?Zr.memoizedState:Ni.next;if(On!==null)Ni=On,hi=Mn;else{if(Mn===null)throw Zr.alternate===null?Error(Un(467)):Error(Un(310));hi=Mn,Mn={memoizedState:hi.memoizedState,baseState:hi.baseState,baseQueue:hi.baseQueue,queue:hi.queue,next:null},Ni===null?Zr.memoizedState=Ni=Mn:Ni=Ni.next=Mn}return Ni}function yc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dl(Mn){var On=hl;return hl+=1,$o===null&&($o=[]),Mn=rp($o,Mn,On),On=Zr,(Ni===null?On.memoizedState:Ni.next)===null&&(On=On.alternate,er.H=On===null||On.memoizedState===null?Zp:id),Mn}function bc(Mn){if(Mn!==null&&typeof Mn=="object"){if(typeof Mn.then=="function")return dl(Mn);if(Mn.$$typeof===ur)return Pi(Mn)}throw Error(Un(438,String(Mn)))}function Gh(Mn){var On=null,zn=Zr.updateQueue;if(zn!==null&&(On=zn.memoCache),On==null){var Hn=Zr.alternate;Hn!==null&&(Hn=Hn.updateQueue,Hn!==null&&(Hn=Hn.memoCache,Hn!=null&&(On={data:Hn.data.map(function(Vn){return Vn.slice()}),index:0})))}if(On==null&&(On={data:[],index:0}),zn===null&&(zn=yc(),Zr.updateQueue=zn),zn.memoCache=On,zn=On.data[On.index],zn===void 0)for(zn=On.data[On.index]=Array(Mn),Hn=0;Hn<Mn;Hn++)zn[Hn]=zr;return On.index++,zn}function Ys(Mn,On){return typeof On=="function"?On(Mn):On}function vc(Mn){var On=Si();return Yh(On,hi,Mn)}function Yh(Mn,On,zn){var Hn=Mn.queue;if(Hn===null)throw Error(Un(311));Hn.lastRenderedReducer=zn;var Vn=Mn.baseQueue,Gn=Hn.pending;if(Gn!==null){if(Vn!==null){var Qn=Vn.next;Vn.next=Gn.next,Gn.next=Qn}On.baseQueue=Vn=Gn,Hn.pending=null}if(Gn=Mn.baseState,Vn===null)Mn.memoizedState=Gn;else{On=Vn.next;var nr=Qn=null,hr=null,xr=On,Lr=!1;do{var Or=xr.lane&-536870913;if(Or!==xr.lane?(ti&Or)===Or:(Gs&Or)===Or){var kr=xr.revertLane;if(kr===0)hr!==null&&(hr=hr.next={lane:0,revertLane:0,gesture:null,action:xr.action,hasEagerState:xr.hasEagerState,eagerState:xr.eagerState,next:null}),Or===mo&&(Lr=!0);else if((Gs&kr)===kr){xr=xr.next,kr===mo&&(Lr=!0);continue}else Or={lane:0,revertLane:xr.revertLane,gesture:null,action:xr.action,hasEagerState:xr.hasEagerState,eagerState:xr.eagerState,next:null},hr===null?(nr=hr=Or,Qn=Gn):hr=hr.next=Or,Zr.lanes|=kr,Ea|=kr;Or=xr.action,Ga&&zn(Gn,Or),Gn=xr.hasEagerState?xr.eagerState:zn(Gn,Or)}else kr={lane:Or,revertLane:xr.revertLane,gesture:xr.gesture,action:xr.action,hasEagerState:xr.hasEagerState,eagerState:xr.eagerState,next:null},hr===null?(nr=hr=kr,Qn=Gn):hr=hr.next=kr,Zr.lanes|=Or,Ea|=Or;xr=xr.next}while(xr!==null&&xr!==On);if(hr===null?Qn=Gn:hr.next=nr,!rs(Gn,Mn.memoizedState)&&(Ri=!0,Lr&&(zn=yo,zn!==null)))throw zn;Mn.memoizedState=Gn,Mn.baseState=Qn,Mn.baseQueue=hr,Hn.lastRenderedState=Gn}return Vn===null&&(Hn.lanes=0),[Mn.memoizedState,Hn.dispatch]}function Zh(Mn){var On=Si(),zn=On.queue;if(zn===null)throw Error(Un(311));zn.lastRenderedReducer=Mn;var Hn=zn.dispatch,Vn=zn.pending,Gn=On.memoizedState;if(Vn!==null){zn.pending=null;var Qn=Vn=Vn.next;do Gn=Mn(Gn,Qn.action),Qn=Qn.next;while(Qn!==Vn);rs(Gn,On.memoizedState)||(Ri=!0),On.memoizedState=Gn,On.baseQueue===null&&(On.baseState=Gn),zn.lastRenderedState=Gn}return[Gn,Hn]}function pp(Mn,On,zn){var Hn=Zr,Vn=Si(),Gn=ni;if(Gn){if(zn===void 0)throw Error(Un(407));zn=zn()}else zn=On();var Qn=!rs((hi||Vn).memoizedState,zn);if(Qn&&(Vn.memoizedState=zn,Ri=!0),Vn=Vn.queue,Jh(yp.bind(null,Hn,Vn,Mn),[Mn]),Vn.getSnapshot!==On||Qn||Ni!==null&&Ni.memoizedState.tag&1){if(Hn.flags|=2048,xo(9,{destroy:void 0},mp.bind(null,Hn,Vn,zn,On),null),pi===null)throw Error(Un(349));Gn||(Gs&127)!==0||gp(Hn,On,zn)}return zn}function gp(Mn,On,zn){Mn.flags|=16384,Mn={getSnapshot:On,value:zn},On=Zr.updateQueue,On===null?(On=yc(),Zr.updateQueue=On,On.stores=[Mn]):(zn=On.stores,zn===null?On.stores=[Mn]:zn.push(Mn))}function mp(Mn,On,zn,Hn){On.value=zn,On.getSnapshot=Hn,bp(On)&&vp(Mn)}function yp(Mn,On,zn){return zn(function(){bp(On)&&vp(Mn)})}function bp(Mn){var On=Mn.getSnapshot;Mn=Mn.value;try{var zn=On();return!rs(Mn,zn)}catch{return!0}}function vp(Mn){var On=za(Mn,2);On!==null&&ts(On,Mn,2)}function Xh(Mn){var On=Vi();if(typeof Mn=="function"){var zn=Mn;if(Mn=zn(),Ga){Oi(!0);try{zn()}finally{Oi(!1)}}}return On.memoizedState=On.baseState=Mn,On.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:Mn},On}function wp(Mn,On,zn,Hn){return Mn.baseState=zn,Yh(Mn,hi,typeof Hn=="function"?Hn:Ys)}function Zy(Mn,On,zn,Hn,Vn){if($c(Mn))throw Error(Un(485));if(Mn=On.action,Mn!==null){var Gn={payload:Vn,action:Mn,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Qn){Gn.listeners.push(Qn)}};er.T!==null?zn(!0):Gn.isTransition=!1,Hn(Gn),zn=On.pending,zn===null?(Gn.next=On.pending=Gn,Ep(On,Gn)):(Gn.next=zn.next,On.pending=zn.next=Gn)}}function Ep(Mn,On){var zn=On.action,Hn=On.payload,Vn=Mn.state;if(On.isTransition){var Gn=er.T,Qn={};er.T=Qn;try{var nr=zn(Vn,Hn),hr=er.S;hr!==null&&hr(Qn,nr),$p(Mn,On,nr)}catch(xr){Qh(Mn,On,xr)}finally{Gn!==null&&Qn.types!==null&&(Gn.types=Qn.types),er.T=Gn}}else try{Gn=zn(Vn,Hn),$p(Mn,On,Gn)}catch(xr){Qh(Mn,On,xr)}}function $p(Mn,On,zn){zn!==null&&typeof zn=="object"&&typeof zn.then=="function"?zn.then(function(Hn){xp(Mn,On,Hn)},function(Hn){return Qh(Mn,On,Hn)}):xp(Mn,On,zn)}function xp(Mn,On,zn){On.status="fulfilled",On.value=zn,kp(On),Mn.state=zn,On=Mn.pending,On!==null&&(zn=On.next,zn===On?Mn.pending=null:(zn=zn.next,On.next=zn,Ep(Mn,zn)))}function Qh(Mn,On,zn){var Hn=Mn.pending;if(Mn.pending=null,Hn!==null){Hn=Hn.next;do On.status="rejected",On.reason=zn,kp(On),On=On.next;while(On!==Hn)}Mn.action=null}function kp(Mn){Mn=Mn.listeners;for(var On=0;On<Mn.length;On++)(0,Mn[On])()}function Sp(Mn,On){return On}function Ap(Mn,On){if(ni){var zn=pi.formState;if(zn!==null){t:{var Hn=Zr;if(ni){if(gi){e:{for(var Vn=gi,Gn=bs;Vn.nodeType!==8;){if(!Gn){Vn=null;break e}if(Vn=ws(Vn.nextSibling),Vn===null){Vn=null;break e}}Gn=Vn.data,Vn=Gn==="F!"||Gn==="F"?Vn:null}if(Vn){gi=ws(Vn.nextSibling),Hn=Vn.data==="F!";break t}}da(Hn)}Hn=!1}Hn&&(On=zn[0])}}return zn=Vi(),zn.memoizedState=zn.baseState=On,Hn={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sp,lastRenderedState:On},zn.queue=Hn,zn=jp.bind(null,Zr,Hn),Hn.dispatch=zn,Hn=Xh(!1),Gn=rd.bind(null,Zr,!1,Hn.queue),Hn=Vi(),Vn={state:On,dispatch:null,action:Mn,pending:null},Hn.queue=Vn,zn=Zy.bind(null,Zr,Vn,Gn,zn),Vn.dispatch=zn,Hn.memoizedState=Mn,[On,zn,!1]}function _p(Mn){var On=Si();return Tp(On,hi,Mn)}function Tp(Mn,On,zn){if(On=Yh(Mn,On,Sp)[0],Mn=vc(Ys)[0],typeof On=="object"&&On!==null&&typeof On.then=="function")try{var Hn=dl(On)}catch(Qn){throw Qn===bo?cc:Qn}else Hn=On;On=Si();var Vn=On.queue,Gn=Vn.dispatch;return zn!==On.memoizedState&&(Zr.flags|=2048,xo(9,{destroy:void 0},Xy.bind(null,Vn,zn),null)),[Hn,Gn,Mn]}function Xy(Mn,On){Mn.action=On}function Cp(Mn){var On=Si(),zn=hi;if(zn!==null)return Tp(On,zn,Mn);Si(),On=On.memoizedState,zn=Si();var Hn=zn.queue.dispatch;return zn.memoizedState=Mn,[On,Hn,!1]}function xo(Mn,On,zn,Hn){return Mn={tag:Mn,create:zn,deps:Hn,inst:On,next:null},On=Zr.updateQueue,On===null&&(On=yc(),Zr.updateQueue=On),zn=On.lastEffect,zn===null?On.lastEffect=Mn.next=Mn:(Hn=zn.next,zn.next=Mn,Mn.next=Hn,On.lastEffect=Mn),Mn}function Np(){return Si().memoizedState}function wc(Mn,On,zn,Hn){var Vn=Vi();Zr.flags|=Mn,Vn.memoizedState=xo(1|On,{destroy:void 0},zn,Hn===void 0?null:Hn)}function Ec(Mn,On,zn,Hn){var Vn=Si();Hn=Hn===void 0?null:Hn;var Gn=Vn.memoizedState.inst;hi!==null&&Hn!==null&&Ph(Hn,hi.memoizedState.deps)?Vn.memoizedState=xo(On,Gn,zn,Hn):(Zr.flags|=Mn,Vn.memoizedState=xo(1|On,Gn,zn,Hn))}function Rp(Mn,On){wc(8390656,8,Mn,On)}function Jh(Mn,On){Ec(2048,8,Mn,On)}function Qy(Mn){Zr.flags|=4;var On=Zr.updateQueue;if(On===null)On=yc(),Zr.updateQueue=On,On.events=[Mn];else{var zn=On.events;zn===null?On.events=[Mn]:zn.push(Mn)}}function Dp(Mn){var On=Si().memoizedState;return Qy({ref:On,nextImpl:Mn}),function(){if((ai&2)!==0)throw Error(Un(440));return On.impl.apply(void 0,arguments)}}function Lp(Mn,On){return Ec(4,2,Mn,On)}function Mp(Mn,On){return Ec(4,4,Mn,On)}function Up(Mn,On){if(typeof On=="function"){Mn=Mn();var zn=On(Mn);return function(){typeof zn=="function"?zn():On(null)}}if(On!=null)return Mn=Mn(),On.current=Mn,function(){On.current=null}}function Op(Mn,On,zn){zn=zn!=null?zn.concat([Mn]):null,Ec(4,4,Up.bind(null,On,Mn),zn)}function Wh(){}function Bp(Mn,On){var zn=Si();On=On===void 0?null:On;var Hn=zn.memoizedState;return On!==null&&Ph(On,Hn[1])?Hn[0]:(zn.memoizedState=[Mn,On],Mn)}function zp(Mn,On){var zn=Si();On=On===void 0?null:On;var Hn=zn.memoizedState;if(On!==null&&Ph(On,Hn[1]))return Hn[0];if(Hn=Mn(),Ga){Oi(!0);try{Mn()}finally{Oi(!1)}}return zn.memoizedState=[Hn,On],Hn}function td(Mn,On,zn){return zn===void 0||(Gs&1073741824)!==0&&(ti&261930)===0?Mn.memoizedState=On:(Mn.memoizedState=zn,Mn=qg(),Zr.lanes|=Mn,Ea|=Mn,zn)}function Ip(Mn,On,zn,Hn){return rs(zn,On)?zn:wo.current!==null?(Mn=td(Mn,zn,Hn),rs(Mn,On)||(Ri=!0),Mn):(Gs&42)===0||(Gs&1073741824)!==0&&(ti&261930)===0?(Ri=!0,Mn.memoizedState=zn):(Mn=qg(),Zr.lanes|=Mn,Ea|=Mn,On)}function qp(Mn,On,zn,Hn,Vn){var Gn=or.p;or.p=Gn!==0&&8>Gn?Gn:8;var Qn=er.T,nr={};er.T=nr,rd(Mn,!1,On,zn);try{var hr=Vn(),xr=er.S;if(xr!==null&&xr(nr,hr),hr!==null&&typeof hr=="object"&&typeof hr.then=="function"){var Lr=jy(hr,Hn);fl(Mn,On,Lr,cs(Mn))}else fl(Mn,On,Hn,cs(Mn))}catch(Or){fl(Mn,On,{then:function(){},status:"rejected",reason:Or},cs())}finally{or.p=Gn,Qn!==null&&nr.types!==null&&(Qn.types=nr.types),er.T=Qn}}function Jy(){}function ed(Mn,On,zn,Hn){if(Mn.tag!==5)throw Error(Un(476));var Vn=Hp(Mn).queue;qp(Mn,Vn,On,wr,zn===null?Jy:function(){return Pp(Mn),zn(Hn)})}function Hp(Mn){var On=Mn.memoizedState;if(On!==null)return On;On={memoizedState:wr,baseState:wr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:wr},next:null};var zn={};return On.next={memoizedState:zn,baseState:zn,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:zn},next:null},Mn.memoizedState=On,Mn=Mn.alternate,Mn!==null&&(Mn.memoizedState=On),On}function Pp(Mn){var On=Hp(Mn);On.next===null&&(On=Mn.alternate.memoizedState),fl(Mn,On.next.queue,{},cs())}function nd(){return Pi(Nl)}function Kp(){return Si().memoizedState}function Vp(){return Si().memoizedState}function Wy(Mn){for(var On=Mn.return;On!==null;){switch(On.tag){case 24:case 3:var zn=cs();Mn=ga(zn);var Hn=ma(On,Mn,zn);Hn!==null&&(ts(Hn,On,zn),ll(Hn,On,zn)),On={cache:Rh()},Mn.payload=On;return}On=On.return}}function tb(Mn,On,zn){var Hn=cs();zn={lane:Hn,revertLane:0,gesture:null,action:zn,hasEagerState:!1,eagerState:null,next:null},$c(Mn)?Gp(On,zn):(zn=wh(Mn,On,zn,Hn),zn!==null&&(ts(zn,Mn,Hn),Yp(zn,On,Hn)))}function jp(Mn,On,zn){var Hn=cs();fl(Mn,On,zn,Hn)}function fl(Mn,On,zn,Hn){var Vn={lane:Hn,revertLane:0,gesture:null,action:zn,hasEagerState:!1,eagerState:null,next:null};if($c(Mn))Gp(On,Vn);else{var Gn=Mn.alternate;if(Mn.lanes===0&&(Gn===null||Gn.lanes===0)&&(Gn=On.lastRenderedReducer,Gn!==null))try{var Qn=On.lastRenderedState,nr=Gn(Qn,zn);if(Vn.hasEagerState=!0,Vn.eagerState=nr,rs(nr,Qn))return nc(Mn,On,Vn,0),pi===null&&ec(),!1}catch{}if(zn=wh(Mn,On,Vn,Hn),zn!==null)return ts(zn,Mn,Hn),Yp(zn,On,Hn),!0}return!1}function rd(Mn,On,zn,Hn){if(Hn={lane:2,revertLane:Ud(),gesture:null,action:Hn,hasEagerState:!1,eagerState:null,next:null},$c(Mn)){if(On)throw Error(Un(479))}else On=wh(Mn,zn,Hn,2),On!==null&&ts(On,Mn,2)}function $c(Mn){var On=Mn.alternate;return Mn===Zr||On!==null&&On===Zr}function Gp(Mn,On){Eo=gc=!0;var zn=Mn.pending;zn===null?On.next=On:(On.next=zn.next,zn.next=On),Mn.pending=On}function Yp(Mn,On,zn){if((zn&4194048)!==0){var Hn=On.lanes;Hn&=Mn.pendingLanes,zn|=Hn,On.lanes=zn,Ko(Mn,zn)}}var pl={readContext:Pi,use:bc,useCallback:Ei,useContext:Ei,useEffect:Ei,useImperativeHandle:Ei,useLayoutEffect:Ei,useInsertionEffect:Ei,useMemo:Ei,useReducer:Ei,useRef:Ei,useState:Ei,useDebugValue:Ei,useDeferredValue:Ei,useTransition:Ei,useSyncExternalStore:Ei,useId:Ei,useHostTransitionStatus:Ei,useFormState:Ei,useActionState:Ei,useOptimistic:Ei,useMemoCache:Ei,useCacheRefresh:Ei};pl.useEffectEvent=Ei;var Zp={readContext:Pi,use:bc,useCallback:function(Mn,On){return Vi().memoizedState=[Mn,On===void 0?null:On],Mn},useContext:Pi,useEffect:Rp,useImperativeHandle:function(Mn,On,zn){zn=zn!=null?zn.concat([Mn]):null,wc(4194308,4,Up.bind(null,On,Mn),zn)},useLayoutEffect:function(Mn,On){return wc(4194308,4,Mn,On)},useInsertionEffect:function(Mn,On){wc(4,2,Mn,On)},useMemo:function(Mn,On){var zn=Vi();On=On===void 0?null:On;var Hn=Mn();if(Ga){Oi(!0);try{Mn()}finally{Oi(!1)}}return zn.memoizedState=[Hn,On],Hn},useReducer:function(Mn,On,zn){var Hn=Vi();if(zn!==void 0){var Vn=zn(On);if(Ga){Oi(!0);try{zn(On)}finally{Oi(!1)}}}else Vn=On;return Hn.memoizedState=Hn.baseState=Vn,Mn={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mn,lastRenderedState:Vn},Hn.queue=Mn,Mn=Mn.dispatch=tb.bind(null,Zr,Mn),[Hn.memoizedState,Mn]},useRef:function(Mn){var On=Vi();return Mn={current:Mn},On.memoizedState=Mn},useState:function(Mn){Mn=Xh(Mn);var On=Mn.queue,zn=jp.bind(null,Zr,On);return On.dispatch=zn,[Mn.memoizedState,zn]},useDebugValue:Wh,useDeferredValue:function(Mn,On){var zn=Vi();return td(zn,Mn,On)},useTransition:function(){var Mn=Xh(!1);return Mn=qp.bind(null,Zr,Mn.queue,!0,!1),Vi().memoizedState=Mn,[!1,Mn]},useSyncExternalStore:function(Mn,On,zn){var Hn=Zr,Vn=Vi();if(ni){if(zn===void 0)throw Error(Un(407));zn=zn()}else{if(zn=On(),pi===null)throw Error(Un(349));(ti&127)!==0||gp(Hn,On,zn)}Vn.memoizedState=zn;var Gn={value:zn,getSnapshot:On};return Vn.queue=Gn,Rp(yp.bind(null,Hn,Gn,Mn),[Mn]),Hn.flags|=2048,xo(9,{destroy:void 0},mp.bind(null,Hn,Gn,zn,On),null),zn},useId:function(){var Mn=Vi(),On=pi.identifierPrefix;if(ni){var zn=Rs,Hn=Ns;zn=(Hn&~(1<<32-_i(Hn)-1)).toString(32)+zn,On="_"+On+"R_"+zn,zn=mc++,0<zn&&(On+="H"+zn.toString(32)),On+="_"}else zn=Gy++,On="_"+On+"r_"+zn.toString(32)+"_";return Mn.memoizedState=On},useHostTransitionStatus:nd,useFormState:Ap,useActionState:Ap,useOptimistic:function(Mn){var On=Vi();On.memoizedState=On.baseState=Mn;var zn={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return On.queue=zn,On=rd.bind(null,Zr,!0,zn),zn.dispatch=On,[Mn,On]},useMemoCache:Gh,useCacheRefresh:function(){return Vi().memoizedState=Wy.bind(null,Zr)},useEffectEvent:function(Mn){var On=Vi(),zn={impl:Mn};return On.memoizedState=zn,function(){if((ai&2)!==0)throw Error(Un(440));return zn.impl.apply(void 0,arguments)}}},id={readContext:Pi,use:bc,useCallback:Bp,useContext:Pi,useEffect:Jh,useImperativeHandle:Op,useInsertionEffect:Lp,useLayoutEffect:Mp,useMemo:zp,useReducer:vc,useRef:Np,useState:function(){return vc(Ys)},useDebugValue:Wh,useDeferredValue:function(Mn,On){var zn=Si();return Ip(zn,hi.memoizedState,Mn,On)},useTransition:function(){var Mn=vc(Ys)[0],On=Si().memoizedState;return[typeof Mn=="boolean"?Mn:dl(Mn),On]},useSyncExternalStore:pp,useId:Kp,useHostTransitionStatus:nd,useFormState:_p,useActionState:_p,useOptimistic:function(Mn,On){var zn=Si();return wp(zn,hi,Mn,On)},useMemoCache:Gh,useCacheRefresh:Vp};id.useEffectEvent=Dp;var Xp={readContext:Pi,use:bc,useCallback:Bp,useContext:Pi,useEffect:Jh,useImperativeHandle:Op,useInsertionEffect:Lp,useLayoutEffect:Mp,useMemo:zp,useReducer:Zh,useRef:Np,useState:function(){return Zh(Ys)},useDebugValue:Wh,useDeferredValue:function(Mn,On){var zn=Si();return hi===null?td(zn,Mn,On):Ip(zn,hi.memoizedState,Mn,On)},useTransition:function(){var Mn=Zh(Ys)[0],On=Si().memoizedState;return[typeof Mn=="boolean"?Mn:dl(Mn),On]},useSyncExternalStore:pp,useId:Kp,useHostTransitionStatus:nd,useFormState:Cp,useActionState:Cp,useOptimistic:function(Mn,On){var zn=Si();return hi!==null?wp(zn,hi,Mn,On):(zn.baseState=Mn,[Mn,zn.queue.dispatch])},useMemoCache:Gh,useCacheRefresh:Vp};Xp.useEffectEvent=Dp;function sd(Mn,On,zn,Hn){On=Mn.memoizedState,zn=zn(Hn,On),zn=zn==null?On:Zn({},On,zn),Mn.memoizedState=zn,Mn.lanes===0&&(Mn.updateQueue.baseState=zn)}var ad={enqueueSetState:function(Mn,On,zn){Mn=Mn._reactInternals;var Hn=cs(),Vn=ga(Hn);Vn.payload=On,zn!=null&&(Vn.callback=zn),On=ma(Mn,Vn,Hn),On!==null&&(ts(On,Mn,Hn),ll(On,Mn,Hn))},enqueueReplaceState:function(Mn,On,zn){Mn=Mn._reactInternals;var Hn=cs(),Vn=ga(Hn);Vn.tag=1,Vn.payload=On,zn!=null&&(Vn.callback=zn),On=ma(Mn,Vn,Hn),On!==null&&(ts(On,Mn,Hn),ll(On,Mn,Hn))},enqueueForceUpdate:function(Mn,On){Mn=Mn._reactInternals;var zn=cs(),Hn=ga(zn);Hn.tag=2,On!=null&&(Hn.callback=On),On=ma(Mn,Hn,zn),On!==null&&(ts(On,Mn,zn),ll(On,Mn,zn))}};function Qp(Mn,On,zn,Hn,Vn,Gn,Qn){return Mn=Mn.stateNode,typeof Mn.shouldComponentUpdate=="function"?Mn.shouldComponentUpdate(Hn,Gn,Qn):On.prototype&&On.prototype.isPureReactComponent?!tl(zn,Hn)||!tl(Vn,Gn):!0}function Jp(Mn,On,zn,Hn){Mn=On.state,typeof On.componentWillReceiveProps=="function"&&On.componentWillReceiveProps(zn,Hn),typeof On.UNSAFE_componentWillReceiveProps=="function"&&On.UNSAFE_componentWillReceiveProps(zn,Hn),On.state!==Mn&&ad.enqueueReplaceState(On,On.state,null)}function Ya(Mn,On){var zn=On;if("ref"in On){zn={};for(var Hn in On)Hn!=="ref"&&(zn[Hn]=On[Hn])}if(Mn=Mn.defaultProps){zn===On&&(zn=Zn({},zn));for(var Vn in Mn)zn[Vn]===void 0&&(zn[Vn]=Mn[Vn])}return zn}function Wp(Mn){tc(Mn)}function tg(Mn){console.error(Mn)}function eg(Mn){tc(Mn)}function xc(Mn,On){try{var zn=Mn.onUncaughtError;zn(On.value,{componentStack:On.stack})}catch(Hn){setTimeout(function(){throw Hn})}}function ng(Mn,On,zn){try{var Hn=Mn.onCaughtError;Hn(zn.value,{componentStack:zn.stack,errorBoundary:On.tag===1?On.stateNode:null})}catch(Vn){setTimeout(function(){throw Vn})}}function od(Mn,On,zn){return zn=ga(zn),zn.tag=3,zn.payload={element:null},zn.callback=function(){xc(Mn,On)},zn}function rg(Mn){return Mn=ga(Mn),Mn.tag=3,Mn}function ig(Mn,On,zn,Hn){var Vn=zn.type.getDerivedStateFromError;if(typeof Vn=="function"){var Gn=Hn.value;Mn.payload=function(){return Vn(Gn)},Mn.callback=function(){ng(On,zn,Hn)}}var Qn=zn.stateNode;Qn!==null&&typeof Qn.componentDidCatch=="function"&&(Mn.callback=function(){ng(On,zn,Hn),typeof Vn!="function"&&($a===null?$a=new Set([this]):$a.add(this));var nr=Hn.stack;this.componentDidCatch(Hn.value,{componentStack:nr!==null?nr:""})})}function eb(Mn,On,zn,Hn,Vn){if(zn.flags|=32768,Hn!==null&&typeof Hn=="object"&&typeof Hn.then=="function"){if(On=zn.alternate,On!==null&&go(On,zn,Vn,!0),zn=ss.current,zn!==null){switch(zn.tag){case 31:case 13:return vs===null?Uc():zn.alternate===null&&$i===0&&($i=3),zn.flags&=-257,zn.flags|=65536,zn.lanes=Vn,Hn===uc?zn.flags|=16384:(On=zn.updateQueue,On===null?zn.updateQueue=new Set([Hn]):On.add(Hn),Dd(Mn,Hn,Vn)),!1;case 22:return zn.flags|=65536,Hn===uc?zn.flags|=16384:(On=zn.updateQueue,On===null?(On={transitions:null,markerInstances:null,retryQueue:new Set([Hn])},zn.updateQueue=On):(zn=On.retryQueue,zn===null?On.retryQueue=new Set([Hn]):zn.add(Hn)),Dd(Mn,Hn,Vn)),!1}throw Error(Un(435,zn.tag))}return Dd(Mn,Hn,Vn),Uc(),!1}if(ni)return On=ss.current,On!==null?((On.flags&65536)===0&&(On.flags|=256),On.flags|=65536,On.lanes=Vn,Hn!==Ah&&(Mn=Error(Un(422),{cause:Hn}),rl(ps(Mn,zn)))):(Hn!==Ah&&(On=Error(Un(423),{cause:Hn}),rl(ps(On,zn))),Mn=Mn.current.alternate,Mn.flags|=65536,Vn&=-Vn,Mn.lanes|=Vn,Hn=ps(Hn,zn),Vn=od(Mn.stateNode,Hn,Vn),Bh(Mn,Vn),$i!==4&&($i=2)),!1;var Gn=Error(Un(520),{cause:Hn});if(Gn=ps(Gn,zn),$l===null?$l=[Gn]:$l.push(Gn),$i!==4&&($i=2),On===null)return!0;Hn=ps(Hn,zn),zn=On;do{switch(zn.tag){case 3:return zn.flags|=65536,Mn=Vn&-Vn,zn.lanes|=Mn,Mn=od(zn.stateNode,Hn,Mn),Bh(zn,Mn),!1;case 1:if(On=zn.type,Gn=zn.stateNode,(zn.flags&128)===0&&(typeof On.getDerivedStateFromError=="function"||Gn!==null&&typeof Gn.componentDidCatch=="function"&&($a===null||!$a.has(Gn))))return zn.flags|=65536,Vn&=-Vn,zn.lanes|=Vn,Vn=rg(Vn),ig(Vn,Mn,zn,Hn),Bh(zn,Vn),!1}zn=zn.return}while(zn!==null);return!1}var ld=Error(Un(461)),Ri=!1;function Fi(Mn,On,zn,Hn){On.child=Mn===null?op(On,null,zn,Hn):ja(On,Mn.child,zn,Hn)}function sg(Mn,On,zn,Hn,Vn){zn=zn.render;var Gn=On.ref;if("ref"in Hn){var Qn={};for(var nr in Hn)nr!=="ref"&&(Qn[nr]=Hn[nr])}else Qn=Hn;return Pa(On),Hn=Fh(Mn,On,zn,Qn,Gn,Vn),nr=Kh(),Mn!==null&&!Ri?(Vh(Mn,On,Vn),Zs(Mn,On,Vn)):(ni&&nr&&kh(On),On.flags|=1,Fi(Mn,On,Hn,Vn),On.child)}function ag(Mn,On,zn,Hn,Vn){if(Mn===null){var Gn=zn.type;return typeof Gn=="function"&&!Eh(Gn)&&Gn.defaultProps===void 0&&zn.compare===null?(On.tag=15,On.type=Gn,og(Mn,On,Gn,Hn,Vn)):(Mn=ic(zn.type,null,Hn,On,On.mode,Vn),Mn.ref=On.ref,Mn.return=On,On.child=Mn)}if(Gn=Mn.child,!md(Mn,Vn)){var Qn=Gn.memoizedProps;if(zn=zn.compare,zn=zn!==null?zn:tl,zn(Qn,Hn)&&Mn.ref===On.ref)return Zs(Mn,On,Vn)}return On.flags|=1,Mn=Fs(Gn,Hn),Mn.ref=On.ref,Mn.return=On,On.child=Mn}function og(Mn,On,zn,Hn,Vn){if(Mn!==null){var Gn=Mn.memoizedProps;if(tl(Gn,Hn)&&Mn.ref===On.ref)if(Ri=!1,On.pendingProps=Hn=Gn,md(Mn,Vn))(Mn.flags&131072)!==0&&(Ri=!0);else return On.lanes=Mn.lanes,Zs(Mn,On,Vn)}return cd(Mn,On,zn,Hn,Vn)}function lg(Mn,On,zn,Hn){var Vn=Hn.children,Gn=Mn!==null?Mn.memoizedState:null;if(Mn===null&&On.stateNode===null&&(On.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),Hn.mode==="hidden"){if((On.flags&128)!==0){if(Gn=Gn!==null?Gn.baseLanes|zn:zn,Mn!==null){for(Hn=On.child=Mn.child,Vn=0;Hn!==null;)Vn=Vn|Hn.lanes|Hn.childLanes,Hn=Hn.sibling;Hn=Vn&~Gn}else Hn=0,On.child=null;return cg(Mn,On,Gn,zn,Hn)}if((zn&536870912)!==0)On.memoizedState={baseLanes:0,cachePool:null},Mn!==null&&lc(On,Gn!==null?Gn.cachePool:null),Gn!==null?up(On,Gn):Ih(),hp(On);else return Hn=On.lanes=536870912,cg(Mn,On,Gn!==null?Gn.baseLanes|zn:zn,zn,Hn)}else Gn!==null?(lc(On,Gn.cachePool),up(On,Gn),ba(),On.memoizedState=null):(Mn!==null&&lc(On,null),Ih(),ba());return Fi(Mn,On,Vn,zn),On.child}function gl(Mn,On){return Mn!==null&&Mn.tag===22||On.stateNode!==null||(On.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),On.sibling}function cg(Mn,On,zn,Hn,Vn){var Gn=Lh();return Gn=Gn===null?null:{parent:Ci._currentValue,pool:Gn},On.memoizedState={baseLanes:zn,cachePool:Gn},Mn!==null&&lc(On,null),Ih(),hp(On),Mn!==null&&go(Mn,On,Hn,!0),On.childLanes=Vn,null}function kc(Mn,On){return On=Ac({mode:On.mode,children:On.children},Mn.mode),On.ref=Mn.ref,Mn.child=On,On.return=Mn,On}function ug(Mn,On,zn){return ja(On,Mn.child,null,zn),Mn=kc(On,On.pendingProps),Mn.flags|=2,as(On),On.memoizedState=null,Mn}function nb(Mn,On,zn){var Hn=On.pendingProps,Vn=(On.flags&128)!==0;if(On.flags&=-129,Mn===null){if(ni){if(Hn.mode==="hidden")return Mn=kc(On,Hn),On.lanes=536870912,gl(null,Mn);if(Hh(On),(Mn=gi)?(Mn=$m(Mn,bs),Mn=Mn!==null&&Mn.data==="&"?Mn:null,Mn!==null&&(On.memoizedState={dehydrated:Mn,treeContext:ua!==null?{id:Ns,overflow:Rs}:null,retryLane:536870912,hydrationErrors:null},zn=jf(Mn),zn.return=On,On.child=zn,Hi=On,gi=null)):Mn=null,Mn===null)throw da(On);return On.lanes=536870912,null}return kc(On,Hn)}var Gn=Mn.memoizedState;if(Gn!==null){var Qn=Gn.dehydrated;if(Hh(On),Vn)if(On.flags&256)On.flags&=-257,On=ug(Mn,On,zn);else if(On.memoizedState!==null)On.child=Mn.child,On.flags|=128,On=null;else throw Error(Un(558));else if(Ri||go(Mn,On,zn,!1),Vn=(zn&Mn.childLanes)!==0,Ri||Vn){if(Hn=pi,Hn!==null&&(Qn=zl(Hn,zn),Qn!==0&&Qn!==Gn.retryLane))throw Gn.retryLane=Qn,za(Mn,Qn),ts(Hn,Mn,Qn),ld;Uc(),On=ug(Mn,On,zn)}else Mn=Gn.treeContext,gi=ws(Qn.nextSibling),Hi=On,ni=!0,ha=null,bs=!1,Mn!==null&&Zf(On,Mn),On=kc(On,Hn),On.flags|=4096;return On}return Mn=Fs(Mn.child,{mode:Hn.mode,children:Hn.children}),Mn.ref=On.ref,On.child=Mn,Mn.return=On,Mn}function Sc(Mn,On){var zn=On.ref;if(zn===null)Mn!==null&&Mn.ref!==null&&(On.flags|=4194816);else{if(typeof zn!="function"&&typeof zn!="object")throw Error(Un(284));(Mn===null||Mn.ref!==zn)&&(On.flags|=4194816)}}function cd(Mn,On,zn,Hn,Vn){return Pa(On),zn=Fh(Mn,On,zn,Hn,void 0,Vn),Hn=Kh(),Mn!==null&&!Ri?(Vh(Mn,On,Vn),Zs(Mn,On,Vn)):(ni&&Hn&&kh(On),On.flags|=1,Fi(Mn,On,zn,Vn),On.child)}function hg(Mn,On,zn,Hn,Vn,Gn){return Pa(On),On.updateQueue=null,zn=fp(On,Hn,zn,Vn),dp(Mn),Hn=Kh(),Mn!==null&&!Ri?(Vh(Mn,On,Gn),Zs(Mn,On,Gn)):(ni&&Hn&&kh(On),On.flags|=1,Fi(Mn,On,zn,Gn),On.child)}function dg(Mn,On,zn,Hn,Vn){if(Pa(On),On.stateNode===null){var Gn=uo,Qn=zn.contextType;typeof Qn=="object"&&Qn!==null&&(Gn=Pi(Qn)),Gn=new zn(Hn,Gn),On.memoizedState=Gn.state!==null&&Gn.state!==void 0?Gn.state:null,Gn.updater=ad,On.stateNode=Gn,Gn._reactInternals=On,Gn=On.stateNode,Gn.props=Hn,Gn.state=On.memoizedState,Gn.refs={},Uh(On),Qn=zn.contextType,Gn.context=typeof Qn=="object"&&Qn!==null?Pi(Qn):uo,Gn.state=On.memoizedState,Qn=zn.getDerivedStateFromProps,typeof Qn=="function"&&(sd(On,zn,Qn,Hn),Gn.state=On.memoizedState),typeof zn.getDerivedStateFromProps=="function"||typeof Gn.getSnapshotBeforeUpdate=="function"||typeof Gn.UNSAFE_componentWillMount!="function"&&typeof Gn.componentWillMount!="function"||(Qn=Gn.state,typeof Gn.componentWillMount=="function"&&Gn.componentWillMount(),typeof Gn.UNSAFE_componentWillMount=="function"&&Gn.UNSAFE_componentWillMount(),Qn!==Gn.state&&ad.enqueueReplaceState(Gn,Gn.state,null),ul(On,Hn,Gn,Vn),cl(),Gn.state=On.memoizedState),typeof Gn.componentDidMount=="function"&&(On.flags|=4194308),Hn=!0}else if(Mn===null){Gn=On.stateNode;var nr=On.memoizedProps,hr=Ya(zn,nr);Gn.props=hr;var xr=Gn.context,Lr=zn.contextType;Qn=uo,typeof Lr=="object"&&Lr!==null&&(Qn=Pi(Lr));var Or=zn.getDerivedStateFromProps;Lr=typeof Or=="function"||typeof Gn.getSnapshotBeforeUpdate=="function",nr=On.pendingProps!==nr,Lr||typeof Gn.UNSAFE_componentWillReceiveProps!="function"&&typeof Gn.componentWillReceiveProps!="function"||(nr||xr!==Qn)&&Jp(On,Gn,Hn,Qn),pa=!1;var kr=On.memoizedState;Gn.state=kr,ul(On,Hn,Gn,Vn),cl(),xr=On.memoizedState,nr||kr!==xr||pa?(typeof Or=="function"&&(sd(On,zn,Or,Hn),xr=On.memoizedState),(hr=pa||Qp(On,zn,hr,Hn,kr,xr,Qn))?(Lr||typeof Gn.UNSAFE_componentWillMount!="function"&&typeof Gn.componentWillMount!="function"||(typeof Gn.componentWillMount=="function"&&Gn.componentWillMount(),typeof Gn.UNSAFE_componentWillMount=="function"&&Gn.UNSAFE_componentWillMount()),typeof Gn.componentDidMount=="function"&&(On.flags|=4194308)):(typeof Gn.componentDidMount=="function"&&(On.flags|=4194308),On.memoizedProps=Hn,On.memoizedState=xr),Gn.props=Hn,Gn.state=xr,Gn.context=Qn,Hn=hr):(typeof Gn.componentDidMount=="function"&&(On.flags|=4194308),Hn=!1)}else{Gn=On.stateNode,Oh(Mn,On),Qn=On.memoizedProps,Lr=Ya(zn,Qn),Gn.props=Lr,Or=On.pendingProps,kr=Gn.context,xr=zn.contextType,hr=uo,typeof xr=="object"&&xr!==null&&(hr=Pi(xr)),nr=zn.getDerivedStateFromProps,(xr=typeof nr=="function"||typeof Gn.getSnapshotBeforeUpdate=="function")||typeof Gn.UNSAFE_componentWillReceiveProps!="function"&&typeof Gn.componentWillReceiveProps!="function"||(Qn!==Or||kr!==hr)&&Jp(On,Gn,Hn,hr),pa=!1,kr=On.memoizedState,Gn.state=kr,ul(On,Hn,Gn,Vn),cl();var Cr=On.memoizedState;Qn!==Or||kr!==Cr||pa||Mn!==null&&Mn.dependencies!==null&&ac(Mn.dependencies)?(typeof nr=="function"&&(sd(On,zn,nr,Hn),Cr=On.memoizedState),(Lr=pa||Qp(On,zn,Lr,Hn,kr,Cr,hr)||Mn!==null&&Mn.dependencies!==null&&ac(Mn.dependencies))?(xr||typeof Gn.UNSAFE_componentWillUpdate!="function"&&typeof Gn.componentWillUpdate!="function"||(typeof Gn.componentWillUpdate=="function"&&Gn.componentWillUpdate(Hn,Cr,hr),typeof Gn.UNSAFE_componentWillUpdate=="function"&&Gn.UNSAFE_componentWillUpdate(Hn,Cr,hr)),typeof Gn.componentDidUpdate=="function"&&(On.flags|=4),typeof Gn.getSnapshotBeforeUpdate=="function"&&(On.flags|=1024)):(typeof Gn.componentDidUpdate!="function"||Qn===Mn.memoizedProps&&kr===Mn.memoizedState||(On.flags|=4),typeof Gn.getSnapshotBeforeUpdate!="function"||Qn===Mn.memoizedProps&&kr===Mn.memoizedState||(On.flags|=1024),On.memoizedProps=Hn,On.memoizedState=Cr),Gn.props=Hn,Gn.state=Cr,Gn.context=hr,Hn=Lr):(typeof Gn.componentDidUpdate!="function"||Qn===Mn.memoizedProps&&kr===Mn.memoizedState||(On.flags|=4),typeof Gn.getSnapshotBeforeUpdate!="function"||Qn===Mn.memoizedProps&&kr===Mn.memoizedState||(On.flags|=1024),Hn=!1)}return Gn=Hn,Sc(Mn,On),Hn=(On.flags&128)!==0,Gn||Hn?(Gn=On.stateNode,zn=Hn&&typeof zn.getDerivedStateFromError!="function"?null:Gn.render(),On.flags|=1,Mn!==null&&Hn?(On.child=ja(On,Mn.child,null,Vn),On.child=ja(On,null,zn,Vn)):Fi(Mn,On,zn,Vn),On.memoizedState=Gn.state,Mn=On.child):Mn=Zs(Mn,On,Vn),Mn}function fg(Mn,On,zn,Hn){return qa(),On.flags|=256,Fi(Mn,On,zn,Hn),On.child}var ud={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hd(Mn){return{baseLanes:Mn,cachePool:ep()}}function dd(Mn,On,zn){return Mn=Mn!==null?Mn.childLanes&~zn:0,On&&(Mn|=ls),Mn}function pg(Mn,On,zn){var Hn=On.pendingProps,Vn=!1,Gn=(On.flags&128)!==0,Qn;if((Qn=Gn)||(Qn=Mn!==null&&Mn.memoizedState===null?!1:(ki.current&2)!==0),Qn&&(Vn=!0,On.flags&=-129),Qn=(On.flags&32)!==0,On.flags&=-33,Mn===null){if(ni){if(Vn?ya(On):ba(),(Mn=gi)?(Mn=$m(Mn,bs),Mn=Mn!==null&&Mn.data!=="&"?Mn:null,Mn!==null&&(On.memoizedState={dehydrated:Mn,treeContext:ua!==null?{id:Ns,overflow:Rs}:null,retryLane:536870912,hydrationErrors:null},zn=jf(Mn),zn.return=On,On.child=zn,Hi=On,gi=null)):Mn=null,Mn===null)throw da(On);return Yd(Mn)?On.lanes=32:On.lanes=536870912,null}var nr=Hn.children;return Hn=Hn.fallback,Vn?(ba(),Vn=On.mode,nr=Ac({mode:"hidden",children:nr},Vn),Hn=Ia(Hn,Vn,zn,null),nr.return=On,Hn.return=On,nr.sibling=Hn,On.child=nr,Hn=On.child,Hn.memoizedState=hd(zn),Hn.childLanes=dd(Mn,Qn,zn),On.memoizedState=ud,gl(null,Hn)):(ya(On),fd(On,nr))}var hr=Mn.memoizedState;if(hr!==null&&(nr=hr.dehydrated,nr!==null)){if(Gn)On.flags&256?(ya(On),On.flags&=-257,On=pd(Mn,On,zn)):On.memoizedState!==null?(ba(),On.child=Mn.child,On.flags|=128,On=null):(ba(),nr=Hn.fallback,Vn=On.mode,Hn=Ac({mode:"visible",children:Hn.children},Vn),nr=Ia(nr,Vn,zn,null),nr.flags|=2,Hn.return=On,nr.return=On,Hn.sibling=nr,On.child=Hn,ja(On,Mn.child,null,zn),Hn=On.child,Hn.memoizedState=hd(zn),Hn.childLanes=dd(Mn,Qn,zn),On.memoizedState=ud,On=gl(null,Hn));else if(ya(On),Yd(nr)){if(Qn=nr.nextSibling&&nr.nextSibling.dataset,Qn)var xr=Qn.dgst;Qn=xr,Hn=Error(Un(419)),Hn.stack="",Hn.digest=Qn,rl({value:Hn,source:null,stack:null}),On=pd(Mn,On,zn)}else if(Ri||go(Mn,On,zn,!1),Qn=(zn&Mn.childLanes)!==0,Ri||Qn){if(Qn=pi,Qn!==null&&(Hn=zl(Qn,zn),Hn!==0&&Hn!==hr.retryLane))throw hr.retryLane=Hn,za(Mn,Hn),ts(Qn,Mn,Hn),ld;Gd(nr)||Uc(),On=pd(Mn,On,zn)}else Gd(nr)?(On.flags|=192,On.child=Mn.child,On=null):(Mn=hr.treeContext,gi=ws(nr.nextSibling),Hi=On,ni=!0,ha=null,bs=!1,Mn!==null&&Zf(On,Mn),On=fd(On,Hn.children),On.flags|=4096);return On}return Vn?(ba(),nr=Hn.fallback,Vn=On.mode,hr=Mn.child,xr=hr.sibling,Hn=Fs(hr,{mode:"hidden",children:Hn.children}),Hn.subtreeFlags=hr.subtreeFlags&65011712,xr!==null?nr=Fs(xr,nr):(nr=Ia(nr,Vn,zn,null),nr.flags|=2),nr.return=On,Hn.return=On,Hn.sibling=nr,On.child=Hn,gl(null,Hn),Hn=On.child,nr=Mn.child.memoizedState,nr===null?nr=hd(zn):(Vn=nr.cachePool,Vn!==null?(hr=Ci._currentValue,Vn=Vn.parent!==hr?{parent:hr,pool:hr}:Vn):Vn=ep(),nr={baseLanes:nr.baseLanes|zn,cachePool:Vn}),Hn.memoizedState=nr,Hn.childLanes=dd(Mn,Qn,zn),On.memoizedState=ud,gl(Mn.child,Hn)):(ya(On),zn=Mn.child,Mn=zn.sibling,zn=Fs(zn,{mode:"visible",children:Hn.children}),zn.return=On,zn.sibling=null,Mn!==null&&(Qn=On.deletions,Qn===null?(On.deletions=[Mn],On.flags|=16):Qn.push(Mn)),On.child=zn,On.memoizedState=null,zn)}function fd(Mn,On){return On=Ac({mode:"visible",children:On},Mn.mode),On.return=Mn,Mn.child=On}function Ac(Mn,On){return Mn=is(22,Mn,null,On),Mn.lanes=0,Mn}function pd(Mn,On,zn){return ja(On,Mn.child,null,zn),Mn=fd(On,On.pendingProps.children),Mn.flags|=2,On.memoizedState=null,Mn}function gg(Mn,On,zn){Mn.lanes|=On;var Hn=Mn.alternate;Hn!==null&&(Hn.lanes|=On),Ch(Mn.return,On,zn)}function gd(Mn,On,zn,Hn,Vn,Gn){var Qn=Mn.memoizedState;Qn===null?Mn.memoizedState={isBackwards:On,rendering:null,renderingStartTime:0,last:Hn,tail:zn,tailMode:Vn,treeForkCount:Gn}:(Qn.isBackwards=On,Qn.rendering=null,Qn.renderingStartTime=0,Qn.last=Hn,Qn.tail=zn,Qn.tailMode=Vn,Qn.treeForkCount=Gn)}function mg(Mn,On,zn){var Hn=On.pendingProps,Vn=Hn.revealOrder,Gn=Hn.tail;Hn=Hn.children;var Qn=ki.current,nr=(Qn&2)!==0;if(nr?(Qn=Qn&1|2,On.flags|=128):Qn&=1,Tr(ki,Qn),Fi(Mn,On,Hn,zn),Hn=ni?nl:0,!nr&&Mn!==null&&(Mn.flags&128)!==0)t:for(Mn=On.child;Mn!==null;){if(Mn.tag===13)Mn.memoizedState!==null&&gg(Mn,zn,On);else if(Mn.tag===19)gg(Mn,zn,On);else if(Mn.child!==null){Mn.child.return=Mn,Mn=Mn.child;continue}if(Mn===On)break t;for(;Mn.sibling===null;){if(Mn.return===null||Mn.return===On)break t;Mn=Mn.return}Mn.sibling.return=Mn.return,Mn=Mn.sibling}switch(Vn){case"forwards":for(zn=On.child,Vn=null;zn!==null;)Mn=zn.alternate,Mn!==null&&pc(Mn)===null&&(Vn=zn),zn=zn.sibling;zn=Vn,zn===null?(Vn=On.child,On.child=null):(Vn=zn.sibling,zn.sibling=null),gd(On,!1,Vn,zn,Gn,Hn);break;case"backwards":case"unstable_legacy-backwards":for(zn=null,Vn=On.child,On.child=null;Vn!==null;){if(Mn=Vn.alternate,Mn!==null&&pc(Mn)===null){On.child=Vn;break}Mn=Vn.sibling,Vn.sibling=zn,zn=Vn,Vn=Mn}gd(On,!0,zn,null,Gn,Hn);break;case"together":gd(On,!1,null,null,void 0,Hn);break;default:On.memoizedState=null}return On.child}function Zs(Mn,On,zn){if(Mn!==null&&(On.dependencies=Mn.dependencies),Ea|=On.lanes,(zn&On.childLanes)===0)if(Mn!==null){if(go(Mn,On,zn,!1),(zn&On.childLanes)===0)return null}else return null;if(Mn!==null&&On.child!==Mn.child)throw Error(Un(153));if(On.child!==null){for(Mn=On.child,zn=Fs(Mn,Mn.pendingProps),On.child=zn,zn.return=On;Mn.sibling!==null;)Mn=Mn.sibling,zn=zn.sibling=Fs(Mn,Mn.pendingProps),zn.return=On;zn.sibling=null}return On.child}function md(Mn,On){return(Mn.lanes&On)!==0?!0:(Mn=Mn.dependencies,!!(Mn!==null&&ac(Mn)))}function rb(Mn,On,zn){switch(On.tag){case 3:Yr(On,On.stateNode.containerInfo),fa(On,Ci,Mn.memoizedState.cache),qa();break;case 27:case 5:si(On);break;case 4:Yr(On,On.stateNode.containerInfo);break;case 10:fa(On,On.type,On.memoizedProps.value);break;case 31:if(On.memoizedState!==null)return On.flags|=128,Hh(On),null;break;case 13:var Hn=On.memoizedState;if(Hn!==null)return Hn.dehydrated!==null?(ya(On),On.flags|=128,null):(zn&On.child.childLanes)!==0?pg(Mn,On,zn):(ya(On),Mn=Zs(Mn,On,zn),Mn!==null?Mn.sibling:null);ya(On);break;case 19:var Vn=(Mn.flags&128)!==0;if(Hn=(zn&On.childLanes)!==0,Hn||(go(Mn,On,zn,!1),Hn=(zn&On.childLanes)!==0),Vn){if(Hn)return mg(Mn,On,zn);On.flags|=128}if(Vn=On.memoizedState,Vn!==null&&(Vn.rendering=null,Vn.tail=null,Vn.lastEffect=null),Tr(ki,ki.current),Hn)break;return null;case 22:return On.lanes=0,lg(Mn,On,zn,On.pendingProps);case 24:fa(On,Ci,Mn.memoizedState.cache)}return Zs(Mn,On,zn)}function yg(Mn,On,zn){if(Mn!==null)if(Mn.memoizedProps!==On.pendingProps)Ri=!0;else{if(!md(Mn,zn)&&(On.flags&128)===0)return Ri=!1,rb(Mn,On,zn);Ri=(Mn.flags&131072)!==0}else Ri=!1,ni&&(On.flags&1048576)!==0&&Yf(On,nl,On.index);switch(On.lanes=0,On.tag){case 16:t:{var Hn=On.pendingProps;if(Mn=Ka(On.elementType),On.type=Mn,typeof Mn=="function")Eh(Mn)?(Hn=Ya(Mn,Hn),On.tag=1,On=dg(null,On,Mn,Hn,zn)):(On.tag=0,On=cd(null,On,Mn,Hn,zn));else{if(Mn!=null){var Vn=Mn.$$typeof;if(Vn===br){On.tag=11,On=sg(null,On,Mn,Hn,zn);break t}else if(Vn===_r){On.tag=14,On=ag(null,On,Mn,Hn,zn);break t}}throw On=mr(Mn)||Mn,Error(Un(306,On,""))}}return On;case 0:return cd(Mn,On,On.type,On.pendingProps,zn);case 1:return Hn=On.type,Vn=Ya(Hn,On.pendingProps),dg(Mn,On,Hn,Vn,zn);case 3:t:{if(Yr(On,On.stateNode.containerInfo),Mn===null)throw Error(Un(387));Hn=On.pendingProps;var Gn=On.memoizedState;Vn=Gn.element,Oh(Mn,On),ul(On,Hn,null,zn);var Qn=On.memoizedState;if(Hn=Qn.cache,fa(On,Ci,Hn),Hn!==Gn.cache&&Nh(On,[Ci],zn,!0),cl(),Hn=Qn.element,Gn.isDehydrated)if(Gn={element:Hn,isDehydrated:!1,cache:Qn.cache},On.updateQueue.baseState=Gn,On.memoizedState=Gn,On.flags&256){On=fg(Mn,On,Hn,zn);break t}else if(Hn!==Vn){Vn=ps(Error(Un(424)),On),rl(Vn),On=fg(Mn,On,Hn,zn);break t}else for(Mn=On.stateNode.containerInfo,Mn.nodeType===9?Mn=Mn.body:Mn=Mn.nodeName==="HTML"?Mn.ownerDocument.body:Mn,gi=ws(Mn.firstChild),Hi=On,ni=!0,ha=null,bs=!0,zn=op(On,null,Hn,zn),On.child=zn;zn;)zn.flags=zn.flags&-3|4096,zn=zn.sibling;else{if(qa(),Hn===Vn){On=Zs(Mn,On,zn);break t}Fi(Mn,On,Hn,zn)}On=On.child}return On;case 26:return Sc(Mn,On),Mn===null?(zn=Tm(On.type,null,On.pendingProps,null))?On.memoizedState=zn:ni||(zn=On.type,Mn=On.pendingProps,Hn=Pc(qr.current).createElement(zn),Hn[Ti]=On,Hn[yi]=Mn,Ki(Hn,zn,Mn),ui(Hn),On.stateNode=Hn):On.memoizedState=Tm(On.type,Mn.memoizedProps,On.pendingProps,Mn.memoizedState),null;case 27:return si(On),Mn===null&&ni&&(Hn=On.stateNode=Sm(On.type,On.pendingProps,qr.current),Hi=On,bs=!0,Vn=gi,Aa(On.type)?(Zd=Vn,gi=ws(Hn.firstChild)):gi=Vn),Fi(Mn,On,On.pendingProps.children,zn),Sc(Mn,On),Mn===null&&(On.flags|=4194304),On.child;case 5:return Mn===null&&ni&&((Vn=Hn=gi)&&(Hn=Lb(Hn,On.type,On.pendingProps,bs),Hn!==null?(On.stateNode=Hn,Hi=On,gi=ws(Hn.firstChild),bs=!1,Vn=!0):Vn=!1),Vn||da(On)),si(On),Vn=On.type,Gn=On.pendingProps,Qn=Mn!==null?Mn.memoizedProps:null,Hn=Gn.children,Kd(Vn,Gn)?Hn=null:Qn!==null&&Kd(Vn,Qn)&&(On.flags|=32),On.memoizedState!==null&&(Vn=Fh(Mn,On,Yy,null,null,zn),Nl._currentValue=Vn),Sc(Mn,On),Fi(Mn,On,Hn,zn),On.child;case 6:return Mn===null&&ni&&((Mn=zn=gi)&&(zn=Mb(zn,On.pendingProps,bs),zn!==null?(On.stateNode=zn,Hi=On,gi=null,Mn=!0):Mn=!1),Mn||da(On)),null;case 13:return pg(Mn,On,zn);case 4:return Yr(On,On.stateNode.containerInfo),Hn=On.pendingProps,Mn===null?On.child=ja(On,null,Hn,zn):Fi(Mn,On,Hn,zn),On.child;case 11:return sg(Mn,On,On.type,On.pendingProps,zn);case 7:return Fi(Mn,On,On.pendingProps,zn),On.child;case 8:return Fi(Mn,On,On.pendingProps.children,zn),On.child;case 12:return Fi(Mn,On,On.pendingProps.children,zn),On.child;case 10:return Hn=On.pendingProps,fa(On,On.type,Hn.value),Fi(Mn,On,Hn.children,zn),On.child;case 9:return Vn=On.type._context,Hn=On.pendingProps.children,Pa(On),Vn=Pi(Vn),Hn=Hn(Vn),On.flags|=1,Fi(Mn,On,Hn,zn),On.child;case 14:return ag(Mn,On,On.type,On.pendingProps,zn);case 15:return og(Mn,On,On.type,On.pendingProps,zn);case 19:return mg(Mn,On,zn);case 31:return nb(Mn,On,zn);case 22:return lg(Mn,On,zn,On.pendingProps);case 24:return Pa(On),Hn=Pi(Ci),Mn===null?(Vn=Lh(),Vn===null&&(Vn=pi,Gn=Rh(),Vn.pooledCache=Gn,Gn.refCount++,Gn!==null&&(Vn.pooledCacheLanes|=zn),Vn=Gn),On.memoizedState={parent:Hn,cache:Vn},Uh(On),fa(On,Ci,Vn)):((Mn.lanes&zn)!==0&&(Oh(Mn,On),ul(On,null,null,zn),cl()),Vn=Mn.memoizedState,Gn=On.memoizedState,Vn.parent!==Hn?(Vn={parent:Hn,cache:Hn},On.memoizedState=Vn,On.lanes===0&&(On.memoizedState=On.updateQueue.baseState=Vn),fa(On,Ci,Hn)):(Hn=Gn.cache,fa(On,Ci,Hn),Hn!==Vn.cache&&Nh(On,[Ci],zn,!0))),Fi(Mn,On,On.pendingProps.children,zn),On.child;case 29:throw On.pendingProps}throw Error(Un(156,On.tag))}function Xs(Mn){Mn.flags|=4}function yd(Mn,On,zn,Hn,Vn){if((On=(Mn.mode&32)!==0)&&(On=!1),On){if(Mn.flags|=16777216,(Vn&335544128)===Vn)if(Mn.stateNode.complete)Mn.flags|=8192;else if(Kg())Mn.flags|=8192;else throw Va=uc,Mh}else Mn.flags&=-16777217}function bg(Mn,On){if(On.type!=="stylesheet"||(On.state.loading&4)!==0)Mn.flags&=-16777217;else if(Mn.flags|=16777216,!Lm(On))if(Kg())Mn.flags|=8192;else throw Va=uc,Mh}function _c(Mn,On){On!==null&&(Mn.flags|=4),Mn.flags&16384&&(On=Mn.tag!==22?zs():536870912,Mn.lanes|=On,_o|=On)}function ml(Mn,On){if(!ni)switch(Mn.tailMode){case"hidden":On=Mn.tail;for(var zn=null;On!==null;)On.alternate!==null&&(zn=On),On=On.sibling;zn===null?Mn.tail=null:zn.sibling=null;break;case"collapsed":zn=Mn.tail;for(var Hn=null;zn!==null;)zn.alternate!==null&&(Hn=zn),zn=zn.sibling;Hn===null?On||Mn.tail===null?Mn.tail=null:Mn.tail.sibling=null:Hn.sibling=null}}function mi(Mn){var On=Mn.alternate!==null&&Mn.alternate.child===Mn.child,zn=0,Hn=0;if(On)for(var Vn=Mn.child;Vn!==null;)zn|=Vn.lanes|Vn.childLanes,Hn|=Vn.subtreeFlags&65011712,Hn|=Vn.flags&65011712,Vn.return=Mn,Vn=Vn.sibling;else for(Vn=Mn.child;Vn!==null;)zn|=Vn.lanes|Vn.childLanes,Hn|=Vn.subtreeFlags,Hn|=Vn.flags,Vn.return=Mn,Vn=Vn.sibling;return Mn.subtreeFlags|=Hn,Mn.childLanes=zn,On}function ib(Mn,On,zn){var Hn=On.pendingProps;switch(Sh(On),On.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mi(On),null;case 1:return mi(On),null;case 3:return zn=On.stateNode,Hn=null,Mn!==null&&(Hn=Mn.memoizedState.cache),On.memoizedState.cache!==Hn&&(On.flags|=2048),js(Ci),Kr(),zn.pendingContext&&(zn.context=zn.pendingContext,zn.pendingContext=null),(Mn===null||Mn.child===null)&&(po(On)?Xs(On):Mn===null||Mn.memoizedState.isDehydrated&&(On.flags&256)===0||(On.flags|=1024,_h())),mi(On),null;case 26:var Vn=On.type,Gn=On.memoizedState;return Mn===null?(Xs(On),Gn!==null?(mi(On),bg(On,Gn)):(mi(On),yd(On,Vn,null,Hn,zn))):Gn?Gn!==Mn.memoizedState?(Xs(On),mi(On),bg(On,Gn)):(mi(On),On.flags&=-16777217):(Mn=Mn.memoizedProps,Mn!==Hn&&Xs(On),mi(On),yd(On,Vn,Mn,Hn,zn)),null;case 27:if(zi(On),zn=qr.current,Vn=On.type,Mn!==null&&On.stateNode!=null)Mn.memoizedProps!==Hn&&Xs(On);else{if(!Hn){if(On.stateNode===null)throw Error(Un(166));return mi(On),null}Mn=Br.current,po(On)?Xf(On):(Mn=Sm(Vn,Hn,zn),On.stateNode=Mn,Xs(On))}return mi(On),null;case 5:if(zi(On),Vn=On.type,Mn!==null&&On.stateNode!=null)Mn.memoizedProps!==Hn&&Xs(On);else{if(!Hn){if(On.stateNode===null)throw Error(Un(166));return mi(On),null}if(Gn=Br.current,po(On))Xf(On);else{var Qn=Pc(qr.current);switch(Gn){case 1:Gn=Qn.createElementNS("http://www.w3.org/2000/svg",Vn);break;case 2:Gn=Qn.createElementNS("http://www.w3.org/1998/Math/MathML",Vn);break;default:switch(Vn){case"svg":Gn=Qn.createElementNS("http://www.w3.org/2000/svg",Vn);break;case"math":Gn=Qn.createElementNS("http://www.w3.org/1998/Math/MathML",Vn);break;case"script":Gn=Qn.createElement("div"),Gn.innerHTML="<script><\/script>",Gn=Gn.removeChild(Gn.firstChild);break;case"select":Gn=typeof Hn.is=="string"?Qn.createElement("select",{is:Hn.is}):Qn.createElement("select"),Hn.multiple?Gn.multiple=!0:Hn.size&&(Gn.size=Hn.size);break;default:Gn=typeof Hn.is=="string"?Qn.createElement(Vn,{is:Hn.is}):Qn.createElement(Vn)}}Gn[Ti]=On,Gn[yi]=Hn;t:for(Qn=On.child;Qn!==null;){if(Qn.tag===5||Qn.tag===6)Gn.appendChild(Qn.stateNode);else if(Qn.tag!==4&&Qn.tag!==27&&Qn.child!==null){Qn.child.return=Qn,Qn=Qn.child;continue}if(Qn===On)break t;for(;Qn.sibling===null;){if(Qn.return===null||Qn.return===On)break t;Qn=Qn.return}Qn.sibling.return=Qn.return,Qn=Qn.sibling}On.stateNode=Gn;t:switch(Ki(Gn,Vn,Hn),Vn){case"button":case"input":case"select":case"textarea":Hn=!!Hn.autoFocus;break t;case"img":Hn=!0;break t;default:Hn=!1}Hn&&Xs(On)}}return mi(On),yd(On,On.type,Mn===null?null:Mn.memoizedProps,On.pendingProps,zn),null;case 6:if(Mn&&On.stateNode!=null)Mn.memoizedProps!==Hn&&Xs(On);else{if(typeof Hn!="string"&&On.stateNode===null)throw Error(Un(166));if(Mn=qr.current,po(On)){if(Mn=On.stateNode,zn=On.memoizedProps,Hn=null,Vn=Hi,Vn!==null)switch(Vn.tag){case 27:case 5:Hn=Vn.memoizedProps}Mn[Ti]=On,Mn=!!(Mn.nodeValue===zn||Hn!==null&&Hn.suppressHydrationWarning===!0||pm(Mn.nodeValue,zn)),Mn||da(On,!0)}else Mn=Pc(Mn).createTextNode(Hn),Mn[Ti]=On,On.stateNode=Mn}return mi(On),null;case 31:if(zn=On.memoizedState,Mn===null||Mn.memoizedState!==null){if(Hn=po(On),zn!==null){if(Mn===null){if(!Hn)throw Error(Un(318));if(Mn=On.memoizedState,Mn=Mn!==null?Mn.dehydrated:null,!Mn)throw Error(Un(557));Mn[Ti]=On}else qa(),(On.flags&128)===0&&(On.memoizedState=null),On.flags|=4;mi(On),Mn=!1}else zn=_h(),Mn!==null&&Mn.memoizedState!==null&&(Mn.memoizedState.hydrationErrors=zn),Mn=!0;if(!Mn)return On.flags&256?(as(On),On):(as(On),null);if((On.flags&128)!==0)throw Error(Un(558))}return mi(On),null;case 13:if(Hn=On.memoizedState,Mn===null||Mn.memoizedState!==null&&Mn.memoizedState.dehydrated!==null){if(Vn=po(On),Hn!==null&&Hn.dehydrated!==null){if(Mn===null){if(!Vn)throw Error(Un(318));if(Vn=On.memoizedState,Vn=Vn!==null?Vn.dehydrated:null,!Vn)throw Error(Un(317));Vn[Ti]=On}else qa(),(On.flags&128)===0&&(On.memoizedState=null),On.flags|=4;mi(On),Vn=!1}else Vn=_h(),Mn!==null&&Mn.memoizedState!==null&&(Mn.memoizedState.hydrationErrors=Vn),Vn=!0;if(!Vn)return On.flags&256?(as(On),On):(as(On),null)}return as(On),(On.flags&128)!==0?(On.lanes=zn,On):(zn=Hn!==null,Mn=Mn!==null&&Mn.memoizedState!==null,zn&&(Hn=On.child,Vn=null,Hn.alternate!==null&&Hn.alternate.memoizedState!==null&&Hn.alternate.memoizedState.cachePool!==null&&(Vn=Hn.alternate.memoizedState.cachePool.pool),Gn=null,Hn.memoizedState!==null&&Hn.memoizedState.cachePool!==null&&(Gn=Hn.memoizedState.cachePool.pool),Gn!==Vn&&(Hn.flags|=2048)),zn!==Mn&&zn&&(On.child.flags|=8192),_c(On,On.updateQueue),mi(On),null);case 4:return Kr(),Mn===null&&Id(On.stateNode.containerInfo),mi(On),null;case 10:return js(On.type),mi(On),null;case 19:if(gr(ki),Hn=On.memoizedState,Hn===null)return mi(On),null;if(Vn=(On.flags&128)!==0,Gn=Hn.rendering,Gn===null)if(Vn)ml(Hn,!1);else{if($i!==0||Mn!==null&&(Mn.flags&128)!==0)for(Mn=On.child;Mn!==null;){if(Gn=pc(Mn),Gn!==null){for(On.flags|=128,ml(Hn,!1),Mn=Gn.updateQueue,On.updateQueue=Mn,_c(On,Mn),On.subtreeFlags=0,Mn=zn,zn=On.child;zn!==null;)Vf(zn,Mn),zn=zn.sibling;return Tr(ki,ki.current&1|2),ni&&Ks(On,Hn.treeForkCount),On.child}Mn=Mn.sibling}Hn.tail!==null&&qi()>Dc&&(On.flags|=128,Vn=!0,ml(Hn,!1),On.lanes=4194304)}else{if(!Vn)if(Mn=pc(Gn),Mn!==null){if(On.flags|=128,Vn=!0,Mn=Mn.updateQueue,On.updateQueue=Mn,_c(On,Mn),ml(Hn,!0),Hn.tail===null&&Hn.tailMode==="hidden"&&!Gn.alternate&&!ni)return mi(On),null}else 2*qi()-Hn.renderingStartTime>Dc&&zn!==536870912&&(On.flags|=128,Vn=!0,ml(Hn,!1),On.lanes=4194304);Hn.isBackwards?(Gn.sibling=On.child,On.child=Gn):(Mn=Hn.last,Mn!==null?Mn.sibling=Gn:On.child=Gn,Hn.last=Gn)}return Hn.tail!==null?(Mn=Hn.tail,Hn.rendering=Mn,Hn.tail=Mn.sibling,Hn.renderingStartTime=qi(),Mn.sibling=null,zn=ki.current,Tr(ki,Vn?zn&1|2:zn&1),ni&&Ks(On,Hn.treeForkCount),Mn):(mi(On),null);case 22:case 23:return as(On),qh(),Hn=On.memoizedState!==null,Mn!==null?Mn.memoizedState!==null!==Hn&&(On.flags|=8192):Hn&&(On.flags|=8192),Hn?(zn&536870912)!==0&&(On.flags&128)===0&&(mi(On),On.subtreeFlags&6&&(On.flags|=8192)):mi(On),zn=On.updateQueue,zn!==null&&_c(On,zn.retryQueue),zn=null,Mn!==null&&Mn.memoizedState!==null&&Mn.memoizedState.cachePool!==null&&(zn=Mn.memoizedState.cachePool.pool),Hn=null,On.memoizedState!==null&&On.memoizedState.cachePool!==null&&(Hn=On.memoizedState.cachePool.pool),Hn!==zn&&(On.flags|=2048),Mn!==null&&gr(Fa),null;case 24:return zn=null,Mn!==null&&(zn=Mn.memoizedState.cache),On.memoizedState.cache!==zn&&(On.flags|=2048),js(Ci),mi(On),null;case 25:return null;case 30:return null}throw Error(Un(156,On.tag))}function sb(Mn,On){switch(Sh(On),On.tag){case 1:return Mn=On.flags,Mn&65536?(On.flags=Mn&-65537|128,On):null;case 3:return js(Ci),Kr(),Mn=On.flags,(Mn&65536)!==0&&(Mn&128)===0?(On.flags=Mn&-65537|128,On):null;case 26:case 27:case 5:return zi(On),null;case 31:if(On.memoizedState!==null){if(as(On),On.alternate===null)throw Error(Un(340));qa()}return Mn=On.flags,Mn&65536?(On.flags=Mn&-65537|128,On):null;case 13:if(as(On),Mn=On.memoizedState,Mn!==null&&Mn.dehydrated!==null){if(On.alternate===null)throw Error(Un(340));qa()}return Mn=On.flags,Mn&65536?(On.flags=Mn&-65537|128,On):null;case 19:return gr(ki),null;case 4:return Kr(),null;case 10:return js(On.type),null;case 22:case 23:return as(On),qh(),Mn!==null&&gr(Fa),Mn=On.flags,Mn&65536?(On.flags=Mn&-65537|128,On):null;case 24:return js(Ci),null;case 25:return null;default:return null}}function vg(Mn,On){switch(Sh(On),On.tag){case 3:js(Ci),Kr();break;case 26:case 27:case 5:zi(On);break;case 4:Kr();break;case 31:On.memoizedState!==null&&as(On);break;case 13:as(On);break;case 19:gr(ki);break;case 10:js(On.type);break;case 22:case 23:as(On),qh(),Mn!==null&&gr(Fa);break;case 24:js(Ci)}}function yl(Mn,On){try{var zn=On.updateQueue,Hn=zn!==null?zn.lastEffect:null;if(Hn!==null){var Vn=Hn.next;zn=Vn;do{if((zn.tag&Mn)===Mn){Hn=void 0;var Gn=zn.create,Qn=zn.inst;Hn=Gn(),Qn.destroy=Hn}zn=zn.next}while(zn!==Vn)}}catch(nr){ci(On,On.return,nr)}}function va(Mn,On,zn){try{var Hn=On.updateQueue,Vn=Hn!==null?Hn.lastEffect:null;if(Vn!==null){var Gn=Vn.next;Hn=Gn;do{if((Hn.tag&Mn)===Mn){var Qn=Hn.inst,nr=Qn.destroy;if(nr!==void 0){Qn.destroy=void 0,Vn=On;var hr=zn,xr=nr;try{xr()}catch(Lr){ci(Vn,hr,Lr)}}}Hn=Hn.next}while(Hn!==Gn)}}catch(Lr){ci(On,On.return,Lr)}}function wg(Mn){var On=Mn.updateQueue;if(On!==null){var zn=Mn.stateNode;try{cp(On,zn)}catch(Hn){ci(Mn,Mn.return,Hn)}}}function Eg(Mn,On,zn){zn.props=Ya(Mn.type,Mn.memoizedProps),zn.state=Mn.memoizedState;try{zn.componentWillUnmount()}catch(Hn){ci(Mn,On,Hn)}}function bl(Mn,On){try{var zn=Mn.ref;if(zn!==null){switch(Mn.tag){case 26:case 27:case 5:var Hn=Mn.stateNode;break;case 30:Hn=Mn.stateNode;break;default:Hn=Mn.stateNode}typeof zn=="function"?Mn.refCleanup=zn(Hn):zn.current=Hn}}catch(Vn){ci(Mn,On,Vn)}}function Ds(Mn,On){var zn=Mn.ref,Hn=Mn.refCleanup;if(zn!==null)if(typeof Hn=="function")try{Hn()}catch(Vn){ci(Mn,On,Vn)}finally{Mn.refCleanup=null,Mn=Mn.alternate,Mn!=null&&(Mn.refCleanup=null)}else if(typeof zn=="function")try{zn(null)}catch(Vn){ci(Mn,On,Vn)}else zn.current=null}function $g(Mn){var On=Mn.type,zn=Mn.memoizedProps,Hn=Mn.stateNode;try{t:switch(On){case"button":case"input":case"select":case"textarea":zn.autoFocus&&Hn.focus();break t;case"img":zn.src?Hn.src=zn.src:zn.srcSet&&(Hn.srcset=zn.srcSet)}}catch(Vn){ci(Mn,Mn.return,Vn)}}function bd(Mn,On,zn){try{var Hn=Mn.stateNode;_b(Hn,Mn.type,zn,On),Hn[yi]=On}catch(Vn){ci(Mn,Mn.return,Vn)}}function xg(Mn){return Mn.tag===5||Mn.tag===3||Mn.tag===26||Mn.tag===27&&Aa(Mn.type)||Mn.tag===4}function vd(Mn){t:for(;;){for(;Mn.sibling===null;){if(Mn.return===null||xg(Mn.return))return null;Mn=Mn.return}for(Mn.sibling.return=Mn.return,Mn=Mn.sibling;Mn.tag!==5&&Mn.tag!==6&&Mn.tag!==18;){if(Mn.tag===27&&Aa(Mn.type)||Mn.flags&2||Mn.child===null||Mn.tag===4)continue t;Mn.child.return=Mn,Mn=Mn.child}if(!(Mn.flags&2))return Mn.stateNode}}function wd(Mn,On,zn){var Hn=Mn.tag;if(Hn===5||Hn===6)Mn=Mn.stateNode,On?(zn.nodeType===9?zn.body:zn.nodeName==="HTML"?zn.ownerDocument.body:zn).insertBefore(Mn,On):(On=zn.nodeType===9?zn.body:zn.nodeName==="HTML"?zn.ownerDocument.body:zn,On.appendChild(Mn),zn=zn._reactRootContainer,zn!=null||On.onclick!==null||(On.onclick=Hs));else if(Hn!==4&&(Hn===27&&Aa(Mn.type)&&(zn=Mn.stateNode,On=null),Mn=Mn.child,Mn!==null))for(wd(Mn,On,zn),Mn=Mn.sibling;Mn!==null;)wd(Mn,On,zn),Mn=Mn.sibling}function Tc(Mn,On,zn){var Hn=Mn.tag;if(Hn===5||Hn===6)Mn=Mn.stateNode,On?zn.insertBefore(Mn,On):zn.appendChild(Mn);else if(Hn!==4&&(Hn===27&&Aa(Mn.type)&&(zn=Mn.stateNode),Mn=Mn.child,Mn!==null))for(Tc(Mn,On,zn),Mn=Mn.sibling;Mn!==null;)Tc(Mn,On,zn),Mn=Mn.sibling}function kg(Mn){var On=Mn.stateNode,zn=Mn.memoizedProps;try{for(var Hn=Mn.type,Vn=On.attributes;Vn.length;)On.removeAttributeNode(Vn[0]);Ki(On,Hn,zn),On[Ti]=Mn,On[yi]=zn}catch(Gn){ci(Mn,Mn.return,Gn)}}var Qs=!1,Di=!1,Ed=!1,Sg=typeof WeakSet=="function"?WeakSet:Set,Bi=null;function ab(Mn,On){if(Mn=Mn.containerInfo,Pd=Zc,Mn=Of(Mn),ph(Mn)){if("selectionStart"in Mn)var zn={start:Mn.selectionStart,end:Mn.selectionEnd};else t:{zn=(zn=Mn.ownerDocument)&&zn.defaultView||window;var Hn=zn.getSelection&&zn.getSelection();if(Hn&&Hn.rangeCount!==0){zn=Hn.anchorNode;var Vn=Hn.anchorOffset,Gn=Hn.focusNode;Hn=Hn.focusOffset;try{zn.nodeType,Gn.nodeType}catch{zn=null;break t}var Qn=0,nr=-1,hr=-1,xr=0,Lr=0,Or=Mn,kr=null;e:for(;;){for(var Cr;Or!==zn||Vn!==0&&Or.nodeType!==3||(nr=Qn+Vn),Or!==Gn||Hn!==0&&Or.nodeType!==3||(hr=Qn+Hn),Or.nodeType===3&&(Qn+=Or.nodeValue.length),(Cr=Or.firstChild)!==null;)kr=Or,Or=Cr;for(;;){if(Or===Mn)break e;if(kr===zn&&++xr===Vn&&(nr=Qn),kr===Gn&&++Lr===Hn&&(hr=Qn),(Cr=Or.nextSibling)!==null)break;Or=kr,kr=Or.parentNode}Or=Cr}zn=nr===-1||hr===-1?null:{start:nr,end:hr}}else zn=null}zn=zn||{start:0,end:0}}else zn=null;for(Fd={focusedElem:Mn,selectionRange:zn},Zc=!1,Bi=On;Bi!==null;)if(On=Bi,Mn=On.child,(On.subtreeFlags&1028)!==0&&Mn!==null)Mn.return=On,Bi=Mn;else for(;Bi!==null;){switch(On=Bi,Gn=On.alternate,Mn=On.flags,On.tag){case 0:if((Mn&4)!==0&&(Mn=On.updateQueue,Mn=Mn!==null?Mn.events:null,Mn!==null))for(zn=0;zn<Mn.length;zn++)Vn=Mn[zn],Vn.ref.impl=Vn.nextImpl;break;case 11:case 15:break;case 1:if((Mn&1024)!==0&&Gn!==null){Mn=void 0,zn=On,Vn=Gn.memoizedProps,Gn=Gn.memoizedState,Hn=zn.stateNode;try{var Fr=Ya(zn.type,Vn);Mn=Hn.getSnapshotBeforeUpdate(Fr,Gn),Hn.__reactInternalSnapshotBeforeUpdate=Mn}catch(Gr){ci(zn,zn.return,Gr)}}break;case 3:if((Mn&1024)!==0){if(Mn=On.stateNode.containerInfo,zn=Mn.nodeType,zn===9)jd(Mn);else if(zn===1)switch(Mn.nodeName){case"HEAD":case"HTML":case"BODY":jd(Mn);break;default:Mn.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((Mn&1024)!==0)throw Error(Un(163))}if(Mn=On.sibling,Mn!==null){Mn.return=On.return,Bi=Mn;break}Bi=On.return}}function Ag(Mn,On,zn){var Hn=zn.flags;switch(zn.tag){case 0:case 11:case 15:Ws(Mn,zn),Hn&4&&yl(5,zn);break;case 1:if(Ws(Mn,zn),Hn&4)if(Mn=zn.stateNode,On===null)try{Mn.componentDidMount()}catch(Qn){ci(zn,zn.return,Qn)}else{var Vn=Ya(zn.type,On.memoizedProps);On=On.memoizedState;try{Mn.componentDidUpdate(Vn,On,Mn.__reactInternalSnapshotBeforeUpdate)}catch(Qn){ci(zn,zn.return,Qn)}}Hn&64&&wg(zn),Hn&512&&bl(zn,zn.return);break;case 3:if(Ws(Mn,zn),Hn&64&&(Mn=zn.updateQueue,Mn!==null)){if(On=null,zn.child!==null)switch(zn.child.tag){case 27:case 5:On=zn.child.stateNode;break;case 1:On=zn.child.stateNode}try{cp(Mn,On)}catch(Qn){ci(zn,zn.return,Qn)}}break;case 27:On===null&&Hn&4&&kg(zn);case 26:case 5:Ws(Mn,zn),On===null&&Hn&4&&$g(zn),Hn&512&&bl(zn,zn.return);break;case 12:Ws(Mn,zn);break;case 31:Ws(Mn,zn),Hn&4&&Cg(Mn,zn);break;case 13:Ws(Mn,zn),Hn&4&&Ng(Mn,zn),Hn&64&&(Mn=zn.memoizedState,Mn!==null&&(Mn=Mn.dehydrated,Mn!==null&&(zn=gb.bind(null,zn),Ub(Mn,zn))));break;case 22:if(Hn=zn.memoizedState!==null||Qs,!Hn){On=On!==null&&On.memoizedState!==null||Di,Vn=Qs;var Gn=Di;Qs=Hn,(Di=On)&&!Gn?ta(Mn,zn,(zn.subtreeFlags&8772)!==0):Ws(Mn,zn),Qs=Vn,Di=Gn}break;case 30:break;default:Ws(Mn,zn)}}function _g(Mn){var On=Mn.alternate;On!==null&&(Mn.alternate=null,_g(On)),Mn.child=null,Mn.deletions=null,Mn.sibling=null,Mn.tag===5&&(On=Mn.stateNode,On!==null&&Pr(On)),Mn.stateNode=null,Mn.return=null,Mn.dependencies=null,Mn.memoizedProps=null,Mn.memoizedState=null,Mn.pendingProps=null,Mn.stateNode=null,Mn.updateQueue=null}var vi=null,Xi=!1;function Js(Mn,On,zn){for(zn=zn.child;zn!==null;)Tg(Mn,On,zn),zn=zn.sibling}function Tg(Mn,On,zn){if(Ui&&typeof Ui.onCommitFiberUnmount=="function")try{Ui.onCommitFiberUnmount(Cs,zn)}catch{}switch(zn.tag){case 26:Di||Ds(zn,On),Js(Mn,On,zn),zn.memoizedState?zn.memoizedState.count--:zn.stateNode&&(zn=zn.stateNode,zn.parentNode.removeChild(zn));break;case 27:Di||Ds(zn,On);var Hn=vi,Vn=Xi;Aa(zn.type)&&(vi=zn.stateNode,Xi=!1),Js(Mn,On,zn),_l(zn.stateNode),vi=Hn,Xi=Vn;break;case 5:Di||Ds(zn,On);case 6:if(Hn=vi,Vn=Xi,vi=null,Js(Mn,On,zn),vi=Hn,Xi=Vn,vi!==null)if(Xi)try{(vi.nodeType===9?vi.body:vi.nodeName==="HTML"?vi.ownerDocument.body:vi).removeChild(zn.stateNode)}catch(Gn){ci(zn,On,Gn)}else try{vi.removeChild(zn.stateNode)}catch(Gn){ci(zn,On,Gn)}break;case 18:vi!==null&&(Xi?(Mn=vi,wm(Mn.nodeType===9?Mn.body:Mn.nodeName==="HTML"?Mn.ownerDocument.body:Mn,zn.stateNode),Uo(Mn)):wm(vi,zn.stateNode));break;case 4:Hn=vi,Vn=Xi,vi=zn.stateNode.containerInfo,Xi=!0,Js(Mn,On,zn),vi=Hn,Xi=Vn;break;case 0:case 11:case 14:case 15:va(2,zn,On),Di||va(4,zn,On),Js(Mn,On,zn);break;case 1:Di||(Ds(zn,On),Hn=zn.stateNode,typeof Hn.componentWillUnmount=="function"&&Eg(zn,On,Hn)),Js(Mn,On,zn);break;case 21:Js(Mn,On,zn);break;case 22:Di=(Hn=Di)||zn.memoizedState!==null,Js(Mn,On,zn),Di=Hn;break;default:Js(Mn,On,zn)}}function Cg(Mn,On){if(On.memoizedState===null&&(Mn=On.alternate,Mn!==null&&(Mn=Mn.memoizedState,Mn!==null))){Mn=Mn.dehydrated;try{Uo(Mn)}catch(zn){ci(On,On.return,zn)}}}function Ng(Mn,On){if(On.memoizedState===null&&(Mn=On.alternate,Mn!==null&&(Mn=Mn.memoizedState,Mn!==null&&(Mn=Mn.dehydrated,Mn!==null))))try{Uo(Mn)}catch(zn){ci(On,On.return,zn)}}function ob(Mn){switch(Mn.tag){case 31:case 13:case 19:var On=Mn.stateNode;return On===null&&(On=Mn.stateNode=new Sg),On;case 22:return Mn=Mn.stateNode,On=Mn._retryCache,On===null&&(On=Mn._retryCache=new Sg),On;default:throw Error(Un(435,Mn.tag))}}function Cc(Mn,On){var zn=ob(Mn);On.forEach(function(Hn){if(!zn.has(Hn)){zn.add(Hn);var Vn=mb.bind(null,Mn,Hn);Hn.then(Vn,Vn)}})}function Qi(Mn,On){var zn=On.deletions;if(zn!==null)for(var Hn=0;Hn<zn.length;Hn++){var Vn=zn[Hn],Gn=Mn,Qn=On,nr=Qn;t:for(;nr!==null;){switch(nr.tag){case 27:if(Aa(nr.type)){vi=nr.stateNode,Xi=!1;break t}break;case 5:vi=nr.stateNode,Xi=!1;break t;case 3:case 4:vi=nr.stateNode.containerInfo,Xi=!0;break t}nr=nr.return}if(vi===null)throw Error(Un(160));Tg(Gn,Qn,Vn),vi=null,Xi=!1,Gn=Vn.alternate,Gn!==null&&(Gn.return=null),Vn.return=null}if(On.subtreeFlags&13886)for(On=On.child;On!==null;)Rg(On,Mn),On=On.sibling}var As=null;function Rg(Mn,On){var zn=Mn.alternate,Hn=Mn.flags;switch(Mn.tag){case 0:case 11:case 14:case 15:Qi(On,Mn),Ji(Mn),Hn&4&&(va(3,Mn,Mn.return),yl(3,Mn),va(5,Mn,Mn.return));break;case 1:Qi(On,Mn),Ji(Mn),Hn&512&&(Di||zn===null||Ds(zn,zn.return)),Hn&64&&Qs&&(Mn=Mn.updateQueue,Mn!==null&&(Hn=Mn.callbacks,Hn!==null&&(zn=Mn.shared.hiddenCallbacks,Mn.shared.hiddenCallbacks=zn===null?Hn:zn.concat(Hn))));break;case 26:var Vn=As;if(Qi(On,Mn),Ji(Mn),Hn&512&&(Di||zn===null||Ds(zn,zn.return)),Hn&4){var Gn=zn!==null?zn.memoizedState:null;if(Hn=Mn.memoizedState,zn===null)if(Hn===null)if(Mn.stateNode===null){t:{Hn=Mn.type,zn=Mn.memoizedProps,Vn=Vn.ownerDocument||Vn;e:switch(Hn){case"title":Gn=Vn.getElementsByTagName("title")[0],(!Gn||Gn[cr]||Gn[Ti]||Gn.namespaceURI==="http://www.w3.org/2000/svg"||Gn.hasAttribute("itemprop"))&&(Gn=Vn.createElement(Hn),Vn.head.insertBefore(Gn,Vn.querySelector("head > title"))),Ki(Gn,Hn,zn),Gn[Ti]=Mn,ui(Gn),Hn=Gn;break t;case"link":var Qn=Rm("link","href",Vn).get(Hn+(zn.href||""));if(Qn){for(var nr=0;nr<Qn.length;nr++)if(Gn=Qn[nr],Gn.getAttribute("href")===(zn.href==null||zn.href===""?null:zn.href)&&Gn.getAttribute("rel")===(zn.rel==null?null:zn.rel)&&Gn.getAttribute("title")===(zn.title==null?null:zn.title)&&Gn.getAttribute("crossorigin")===(zn.crossOrigin==null?null:zn.crossOrigin)){Qn.splice(nr,1);break e}}Gn=Vn.createElement(Hn),Ki(Gn,Hn,zn),Vn.head.appendChild(Gn);break;case"meta":if(Qn=Rm("meta","content",Vn).get(Hn+(zn.content||""))){for(nr=0;nr<Qn.length;nr++)if(Gn=Qn[nr],Gn.getAttribute("content")===(zn.content==null?null:""+zn.content)&&Gn.getAttribute("name")===(zn.name==null?null:zn.name)&&Gn.getAttribute("property")===(zn.property==null?null:zn.property)&&Gn.getAttribute("http-equiv")===(zn.httpEquiv==null?null:zn.httpEquiv)&&Gn.getAttribute("charset")===(zn.charSet==null?null:zn.charSet)){Qn.splice(nr,1);break e}}Gn=Vn.createElement(Hn),Ki(Gn,Hn,zn),Vn.head.appendChild(Gn);break;default:throw Error(Un(468,Hn))}Gn[Ti]=Mn,ui(Gn),Hn=Gn}Mn.stateNode=Hn}else Dm(Vn,Mn.type,Mn.stateNode);else Mn.stateNode=Nm(Vn,Hn,Mn.memoizedProps);else Gn!==Hn?(Gn===null?zn.stateNode!==null&&(zn=zn.stateNode,zn.parentNode.removeChild(zn)):Gn.count--,Hn===null?Dm(Vn,Mn.type,Mn.stateNode):Nm(Vn,Hn,Mn.memoizedProps)):Hn===null&&Mn.stateNode!==null&&bd(Mn,Mn.memoizedProps,zn.memoizedProps)}break;case 27:Qi(On,Mn),Ji(Mn),Hn&512&&(Di||zn===null||Ds(zn,zn.return)),zn!==null&&Hn&4&&bd(Mn,Mn.memoizedProps,zn.memoizedProps);break;case 5:if(Qi(On,Mn),Ji(Mn),Hn&512&&(Di||zn===null||Ds(zn,zn.return)),Mn.flags&32){Vn=Mn.stateNode;try{ro(Vn,"")}catch(Fr){ci(Mn,Mn.return,Fr)}}Hn&4&&Mn.stateNode!=null&&(Vn=Mn.memoizedProps,bd(Mn,Vn,zn!==null?zn.memoizedProps:Vn)),Hn&1024&&(Ed=!0);break;case 6:if(Qi(On,Mn),Ji(Mn),Hn&4){if(Mn.stateNode===null)throw Error(Un(162));Hn=Mn.memoizedProps,zn=Mn.stateNode;try{zn.nodeValue=Hn}catch(Fr){ci(Mn,Mn.return,Fr)}}break;case 3:if(Vc=null,Vn=As,As=Fc(On.containerInfo),Qi(On,Mn),As=Vn,Ji(Mn),Hn&4&&zn!==null&&zn.memoizedState.isDehydrated)try{Uo(On.containerInfo)}catch(Fr){ci(Mn,Mn.return,Fr)}Ed&&(Ed=!1,Dg(Mn));break;case 4:Hn=As,As=Fc(Mn.stateNode.containerInfo),Qi(On,Mn),Ji(Mn),As=Hn;break;case 12:Qi(On,Mn),Ji(Mn);break;case 31:Qi(On,Mn),Ji(Mn),Hn&4&&(Hn=Mn.updateQueue,Hn!==null&&(Mn.updateQueue=null,Cc(Mn,Hn)));break;case 13:Qi(On,Mn),Ji(Mn),Mn.child.flags&8192&&Mn.memoizedState!==null!=(zn!==null&&zn.memoizedState!==null)&&(Rc=qi()),Hn&4&&(Hn=Mn.updateQueue,Hn!==null&&(Mn.updateQueue=null,Cc(Mn,Hn)));break;case 22:Vn=Mn.memoizedState!==null;var hr=zn!==null&&zn.memoizedState!==null,xr=Qs,Lr=Di;if(Qs=xr||Vn,Di=Lr||hr,Qi(On,Mn),Di=Lr,Qs=xr,Ji(Mn),Hn&8192)t:for(On=Mn.stateNode,On._visibility=Vn?On._visibility&-2:On._visibility|1,Vn&&(zn===null||hr||Qs||Di||Za(Mn)),zn=null,On=Mn;;){if(On.tag===5||On.tag===26){if(zn===null){hr=zn=On;try{if(Gn=hr.stateNode,Vn)Qn=Gn.style,typeof Qn.setProperty=="function"?Qn.setProperty("display","none","important"):Qn.display="none";else{nr=hr.stateNode;var Or=hr.memoizedProps.style,kr=Or!=null&&Or.hasOwnProperty("display")?Or.display:null;nr.style.display=kr==null||typeof kr=="boolean"?"":(""+kr).trim()}}catch(Fr){ci(hr,hr.return,Fr)}}}else if(On.tag===6){if(zn===null){hr=On;try{hr.stateNode.nodeValue=Vn?"":hr.memoizedProps}catch(Fr){ci(hr,hr.return,Fr)}}}else if(On.tag===18){if(zn===null){hr=On;try{var Cr=hr.stateNode;Vn?Em(Cr,!0):Em(hr.stateNode,!1)}catch(Fr){ci(hr,hr.return,Fr)}}}else if((On.tag!==22&&On.tag!==23||On.memoizedState===null||On===Mn)&&On.child!==null){On.child.return=On,On=On.child;continue}if(On===Mn)break t;for(;On.sibling===null;){if(On.return===null||On.return===Mn)break t;zn===On&&(zn=null),On=On.return}zn===On&&(zn=null),On.sibling.return=On.return,On=On.sibling}Hn&4&&(Hn=Mn.updateQueue,Hn!==null&&(zn=Hn.retryQueue,zn!==null&&(Hn.retryQueue=null,Cc(Mn,zn))));break;case 19:Qi(On,Mn),Ji(Mn),Hn&4&&(Hn=Mn.updateQueue,Hn!==null&&(Mn.updateQueue=null,Cc(Mn,Hn)));break;case 30:break;case 21:break;default:Qi(On,Mn),Ji(Mn)}}function Ji(Mn){var On=Mn.flags;if(On&2){try{for(var zn,Hn=Mn.return;Hn!==null;){if(xg(Hn)){zn=Hn;break}Hn=Hn.return}if(zn==null)throw Error(Un(160));switch(zn.tag){case 27:var Vn=zn.stateNode,Gn=vd(Mn);Tc(Mn,Gn,Vn);break;case 5:var Qn=zn.stateNode;zn.flags&32&&(ro(Qn,""),zn.flags&=-33);var nr=vd(Mn);Tc(Mn,nr,Qn);break;case 3:case 4:var hr=zn.stateNode.containerInfo,xr=vd(Mn);wd(Mn,xr,hr);break;default:throw Error(Un(161))}}catch(Lr){ci(Mn,Mn.return,Lr)}Mn.flags&=-3}On&4096&&(Mn.flags&=-4097)}function Dg(Mn){if(Mn.subtreeFlags&1024)for(Mn=Mn.child;Mn!==null;){var On=Mn;Dg(On),On.tag===5&&On.flags&1024&&On.stateNode.reset(),Mn=Mn.sibling}}function Ws(Mn,On){if(On.subtreeFlags&8772)for(On=On.child;On!==null;)Ag(Mn,On.alternate,On),On=On.sibling}function Za(Mn){for(Mn=Mn.child;Mn!==null;){var On=Mn;switch(On.tag){case 0:case 11:case 14:case 15:va(4,On,On.return),Za(On);break;case 1:Ds(On,On.return);var zn=On.stateNode;typeof zn.componentWillUnmount=="function"&&Eg(On,On.return,zn),Za(On);break;case 27:_l(On.stateNode);case 26:case 5:Ds(On,On.return),Za(On);break;case 22:On.memoizedState===null&&Za(On);break;case 30:Za(On);break;default:Za(On)}Mn=Mn.sibling}}function ta(Mn,On,zn){for(zn=zn&&(On.subtreeFlags&8772)!==0,On=On.child;On!==null;){var Hn=On.alternate,Vn=Mn,Gn=On,Qn=Gn.flags;switch(Gn.tag){case 0:case 11:case 15:ta(Vn,Gn,zn),yl(4,Gn);break;case 1:if(ta(Vn,Gn,zn),Hn=Gn,Vn=Hn.stateNode,typeof Vn.componentDidMount=="function")try{Vn.componentDidMount()}catch(xr){ci(Hn,Hn.return,xr)}if(Hn=Gn,Vn=Hn.updateQueue,Vn!==null){var nr=Hn.stateNode;try{var hr=Vn.shared.hiddenCallbacks;if(hr!==null)for(Vn.shared.hiddenCallbacks=null,Vn=0;Vn<hr.length;Vn++)lp(hr[Vn],nr)}catch(xr){ci(Hn,Hn.return,xr)}}zn&&Qn&64&&wg(Gn),bl(Gn,Gn.return);break;case 27:kg(Gn);case 26:case 5:ta(Vn,Gn,zn),zn&&Hn===null&&Qn&4&&$g(Gn),bl(Gn,Gn.return);break;case 12:ta(Vn,Gn,zn);break;case 31:ta(Vn,Gn,zn),zn&&Qn&4&&Cg(Vn,Gn);break;case 13:ta(Vn,Gn,zn),zn&&Qn&4&&Ng(Vn,Gn);break;case 22:Gn.memoizedState===null&&ta(Vn,Gn,zn),bl(Gn,Gn.return);break;case 30:break;default:ta(Vn,Gn,zn)}On=On.sibling}}function $d(Mn,On){var zn=null;Mn!==null&&Mn.memoizedState!==null&&Mn.memoizedState.cachePool!==null&&(zn=Mn.memoizedState.cachePool.pool),Mn=null,On.memoizedState!==null&&On.memoizedState.cachePool!==null&&(Mn=On.memoizedState.cachePool.pool),Mn!==zn&&(Mn!=null&&Mn.refCount++,zn!=null&&il(zn))}function xd(Mn,On){Mn=null,On.alternate!==null&&(Mn=On.alternate.memoizedState.cache),On=On.memoizedState.cache,On!==Mn&&(On.refCount++,Mn!=null&&il(Mn))}function _s(Mn,On,zn,Hn){if(On.subtreeFlags&10256)for(On=On.child;On!==null;)Lg(Mn,On,zn,Hn),On=On.sibling}function Lg(Mn,On,zn,Hn){var Vn=On.flags;switch(On.tag){case 0:case 11:case 15:_s(Mn,On,zn,Hn),Vn&2048&&yl(9,On);break;case 1:_s(Mn,On,zn,Hn);break;case 3:_s(Mn,On,zn,Hn),Vn&2048&&(Mn=null,On.alternate!==null&&(Mn=On.alternate.memoizedState.cache),On=On.memoizedState.cache,On!==Mn&&(On.refCount++,Mn!=null&&il(Mn)));break;case 12:if(Vn&2048){_s(Mn,On,zn,Hn),Mn=On.stateNode;try{var Gn=On.memoizedProps,Qn=Gn.id,nr=Gn.onPostCommit;typeof nr=="function"&&nr(Qn,On.alternate===null?"mount":"update",Mn.passiveEffectDuration,-0)}catch(hr){ci(On,On.return,hr)}}else _s(Mn,On,zn,Hn);break;case 31:_s(Mn,On,zn,Hn);break;case 13:_s(Mn,On,zn,Hn);break;case 23:break;case 22:Gn=On.stateNode,Qn=On.alternate,On.memoizedState!==null?Gn._visibility&2?_s(Mn,On,zn,Hn):vl(Mn,On):Gn._visibility&2?_s(Mn,On,zn,Hn):(Gn._visibility|=2,ko(Mn,On,zn,Hn,(On.subtreeFlags&10256)!==0||!1)),Vn&2048&&$d(Qn,On);break;case 24:_s(Mn,On,zn,Hn),Vn&2048&&xd(On.alternate,On);break;default:_s(Mn,On,zn,Hn)}}function ko(Mn,On,zn,Hn,Vn){for(Vn=Vn&&((On.subtreeFlags&10256)!==0||!1),On=On.child;On!==null;){var Gn=Mn,Qn=On,nr=zn,hr=Hn,xr=Qn.flags;switch(Qn.tag){case 0:case 11:case 15:ko(Gn,Qn,nr,hr,Vn),yl(8,Qn);break;case 23:break;case 22:var Lr=Qn.stateNode;Qn.memoizedState!==null?Lr._visibility&2?ko(Gn,Qn,nr,hr,Vn):vl(Gn,Qn):(Lr._visibility|=2,ko(Gn,Qn,nr,hr,Vn)),Vn&&xr&2048&&$d(Qn.alternate,Qn);break;case 24:ko(Gn,Qn,nr,hr,Vn),Vn&&xr&2048&&xd(Qn.alternate,Qn);break;default:ko(Gn,Qn,nr,hr,Vn)}On=On.sibling}}function vl(Mn,On){if(On.subtreeFlags&10256)for(On=On.child;On!==null;){var zn=Mn,Hn=On,Vn=Hn.flags;switch(Hn.tag){case 22:vl(zn,Hn),Vn&2048&&$d(Hn.alternate,Hn);break;case 24:vl(zn,Hn),Vn&2048&&xd(Hn.alternate,Hn);break;default:vl(zn,Hn)}On=On.sibling}}var wl=8192;function So(Mn,On,zn){if(Mn.subtreeFlags&wl)for(Mn=Mn.child;Mn!==null;)Mg(Mn,On,zn),Mn=Mn.sibling}function Mg(Mn,On,zn){switch(Mn.tag){case 26:So(Mn,On,zn),Mn.flags&wl&&Mn.memoizedState!==null&&Gb(zn,As,Mn.memoizedState,Mn.memoizedProps);break;case 5:So(Mn,On,zn);break;case 3:case 4:var Hn=As;As=Fc(Mn.stateNode.containerInfo),So(Mn,On,zn),As=Hn;break;case 22:Mn.memoizedState===null&&(Hn=Mn.alternate,Hn!==null&&Hn.memoizedState!==null?(Hn=wl,wl=16777216,So(Mn,On,zn),wl=Hn):So(Mn,On,zn));break;default:So(Mn,On,zn)}}function Ug(Mn){var On=Mn.alternate;if(On!==null&&(Mn=On.child,Mn!==null)){On.child=null;do On=Mn.sibling,Mn.sibling=null,Mn=On;while(Mn!==null)}}function El(Mn){var On=Mn.deletions;if((Mn.flags&16)!==0){if(On!==null)for(var zn=0;zn<On.length;zn++){var Hn=On[zn];Bi=Hn,Bg(Hn,Mn)}Ug(Mn)}if(Mn.subtreeFlags&10256)for(Mn=Mn.child;Mn!==null;)Og(Mn),Mn=Mn.sibling}function Og(Mn){switch(Mn.tag){case 0:case 11:case 15:El(Mn),Mn.flags&2048&&va(9,Mn,Mn.return);break;case 3:El(Mn);break;case 12:El(Mn);break;case 22:var On=Mn.stateNode;Mn.memoizedState!==null&&On._visibility&2&&(Mn.return===null||Mn.return.tag!==13)?(On._visibility&=-3,Nc(Mn)):El(Mn);break;default:El(Mn)}}function Nc(Mn){var On=Mn.deletions;if((Mn.flags&16)!==0){if(On!==null)for(var zn=0;zn<On.length;zn++){var Hn=On[zn];Bi=Hn,Bg(Hn,Mn)}Ug(Mn)}for(Mn=Mn.child;Mn!==null;){switch(On=Mn,On.tag){case 0:case 11:case 15:va(8,On,On.return),Nc(On);break;case 22:zn=On.stateNode,zn._visibility&2&&(zn._visibility&=-3,Nc(On));break;default:Nc(On)}Mn=Mn.sibling}}function Bg(Mn,On){for(;Bi!==null;){var zn=Bi;switch(zn.tag){case 0:case 11:case 15:va(8,zn,On);break;case 23:case 22:if(zn.memoizedState!==null&&zn.memoizedState.cachePool!==null){var Hn=zn.memoizedState.cachePool.pool;Hn!=null&&Hn.refCount++}break;case 24:il(zn.memoizedState.cache)}if(Hn=zn.child,Hn!==null)Hn.return=zn,Bi=Hn;else t:for(zn=Mn;Bi!==null;){Hn=Bi;var Vn=Hn.sibling,Gn=Hn.return;if(_g(Hn),Hn===zn){Bi=null;break t}if(Vn!==null){Vn.return=Gn,Bi=Vn;break t}Bi=Gn}}}var lb={getCacheForType:function(Mn){var On=Pi(Ci),zn=On.data.get(Mn);return zn===void 0&&(zn=Mn(),On.data.set(Mn,zn)),zn},cacheSignal:function(){return Pi(Ci).controller.signal}},cb=typeof WeakMap=="function"?WeakMap:Map,ai=0,pi=null,Qr=null,ti=0,li=0,os=null,wa=!1,Ao=!1,kd=!1,ea=0,$i=0,Ea=0,Xa=0,Sd=0,ls=0,_o=0,$l=null,Wi=null,Ad=!1,Rc=0,zg=0,Dc=1/0,Lc=null,$a=null,Mi=0,xa=null,To=null,na=0,_d=0,Td=null,Ig=null,xl=0,Cd=null;function cs(){return(ai&2)!==0&&ti!==0?ti&-ti:er.T!==null?Ud():Vo()}function qg(){if(ls===0)if((ti&536870912)===0||ni){var Mn=Bs;Bs<<=1,(Bs&3932160)===0&&(Bs=262144),ls=Mn}else ls=536870912;return Mn=ss.current,Mn!==null&&(Mn.flags|=32),ls}function ts(Mn,On,zn){(Mn===pi&&(li===2||li===9)||Mn.cancelPendingCommit!==null)&&(Co(Mn,0),ka(Mn,ti,ls,!1)),la(Mn,zn),((ai&2)===0||Mn!==pi)&&(Mn===pi&&((ai&2)===0&&(Xa|=zn),$i===4&&ka(Mn,ti,ls,!1)),Ls(Mn))}function Hg(Mn,On,zn){if((ai&6)!==0)throw Error(Un(327));var Hn=!zn&&(On&127)===0&&(On&Mn.expiredLanes)===0||Ma(Mn,On),Vn=Hn?db(Mn,On):Rd(Mn,On,!0),Gn=Hn;do{if(Vn===0){Ao&&!Hn&&ka(Mn,On,0,!1);break}else{if(zn=Mn.current.alternate,Gn&&!ub(zn)){Vn=Rd(Mn,On,!1),Gn=!1;continue}if(Vn===2){if(Gn=On,Mn.errorRecoveryDisabledLanes&Gn)var Qn=0;else Qn=Mn.pendingLanes&-536870913,Qn=Qn!==0?Qn:Qn&536870912?536870912:0;if(Qn!==0){On=Qn;t:{var nr=Mn;Vn=$l;var hr=nr.current.memoizedState.isDehydrated;if(hr&&(Co(nr,Qn).flags|=256),Qn=Rd(nr,Qn,!1),Qn!==2){if(kd&&!hr){nr.errorRecoveryDisabledLanes|=Gn,Xa|=Gn,Vn=4;break t}Gn=Wi,Wi=Vn,Gn!==null&&(Wi===null?Wi=Gn:Wi.push.apply(Wi,Gn))}Vn=Qn}if(Gn=!1,Vn!==2)continue}}if(Vn===1){Co(Mn,0),ka(Mn,On,0,!0);break}t:{switch(Hn=Mn,Gn=Vn,Gn){case 0:case 1:throw Error(Un(345));case 4:if((On&4194048)!==On)break;case 6:ka(Hn,On,ls,!wa);break t;case 2:Wi=null;break;case 3:case 5:break;default:throw Error(Un(329))}if((On&62914560)===On&&(Vn=Rc+300-qi(),10<Vn)){if(ka(Hn,On,ls,!wa),to(Hn,0,!0)!==0)break t;na=On,Hn.timeoutHandle=bm(Pg.bind(null,Hn,zn,Wi,Lc,Ad,On,ls,Xa,_o,wa,Gn,"Throttled",-0,0),Vn);break t}Pg(Hn,zn,Wi,Lc,Ad,On,ls,Xa,_o,wa,Gn,null,-0,0)}}break}while(!0);Ls(Mn)}function Pg(Mn,On,zn,Hn,Vn,Gn,Qn,nr,hr,xr,Lr,Or,kr,Cr){if(Mn.timeoutHandle=-1,Or=On.subtreeFlags,Or&8192||(Or&16785408)===16785408){Or={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Hs},Mg(On,Gn,Or);var Fr=(Gn&62914560)===Gn?Rc-qi():(Gn&4194048)===Gn?zg-qi():0;if(Fr=Yb(Or,Fr),Fr!==null){na=Gn,Mn.cancelPendingCommit=Fr(Xg.bind(null,Mn,On,Gn,zn,Hn,Vn,Qn,nr,hr,Lr,Or,null,kr,Cr)),ka(Mn,Gn,Qn,!xr);return}}Xg(Mn,On,Gn,zn,Hn,Vn,Qn,nr,hr)}function ub(Mn){for(var On=Mn;;){var zn=On.tag;if((zn===0||zn===11||zn===15)&&On.flags&16384&&(zn=On.updateQueue,zn!==null&&(zn=zn.stores,zn!==null)))for(var Hn=0;Hn<zn.length;Hn++){var Vn=zn[Hn],Gn=Vn.getSnapshot;Vn=Vn.value;try{if(!rs(Gn(),Vn))return!1}catch{return!1}}if(zn=On.child,On.subtreeFlags&16384&&zn!==null)zn.return=On,On=zn;else{if(On===Mn)break;for(;On.sibling===null;){if(On.return===null||On.return===Mn)return!0;On=On.return}On.sibling.return=On.return,On=On.sibling}}return!0}function ka(Mn,On,zn,Hn){On&=~Sd,On&=~Xa,Mn.suspendedLanes|=On,Mn.pingedLanes&=~On,Hn&&(Mn.warmLanes|=On),Hn=Mn.expirationTimes;for(var Vn=On;0<Vn;){var Gn=31-_i(Vn),Qn=1<<Gn;Hn[Gn]=-1,Vn&=~Qn}zn!==0&&Fo(Mn,zn,On)}function Mc(){return(ai&6)===0?(kl(0),!1):!0}function Nd(){if(Qr!==null){if(li===0)var Mn=Qr.return;else Mn=Qr,Vs=Ha=null,jh(Mn),vo=null,al=0,Mn=Qr;for(;Mn!==null;)vg(Mn.alternate,Mn),Mn=Mn.return;Qr=null}}function Co(Mn,On){var zn=Mn.timeoutHandle;zn!==-1&&(Mn.timeoutHandle=-1,Nb(zn)),zn=Mn.cancelPendingCommit,zn!==null&&(Mn.cancelPendingCommit=null,zn()),na=0,Nd(),pi=Mn,Qr=zn=Fs(Mn.current,null),ti=On,li=0,os=null,wa=!1,Ao=Ma(Mn,On),kd=!1,_o=ls=Sd=Xa=Ea=$i=0,Wi=$l=null,Ad=!1,(On&8)!==0&&(On|=On&32);var Hn=Mn.entangledLanes;if(Hn!==0)for(Mn=Mn.entanglements,Hn&=On;0<Hn;){var Vn=31-_i(Hn),Gn=1<<Vn;On|=Mn[Vn],Hn&=~Gn}return ea=On,ec(),zn}function Fg(Mn,On){Zr=null,er.H=pl,On===bo||On===cc?(On=ip(),li=3):On===Mh?(On=ip(),li=4):li=On===ld?8:On!==null&&typeof On=="object"&&typeof On.then=="function"?6:1,os=On,Qr===null&&($i=1,xc(Mn,ps(On,Mn.current)))}function Kg(){var Mn=ss.current;return Mn===null?!0:(ti&4194048)===ti?vs===null:(ti&62914560)===ti||(ti&536870912)!==0?Mn===vs:!1}function Vg(){var Mn=er.H;return er.H=pl,Mn===null?pl:Mn}function jg(){var Mn=er.A;return er.A=lb,Mn}function Uc(){$i=4,wa||(ti&4194048)!==ti&&ss.current!==null||(Ao=!0),(Ea&134217727)===0&&(Xa&134217727)===0||pi===null||ka(pi,ti,ls,!1)}function Rd(Mn,On,zn){var Hn=ai;ai|=2;var Vn=Vg(),Gn=jg();(pi!==Mn||ti!==On)&&(Lc=null,Co(Mn,On)),On=!1;var Qn=$i;t:do try{if(li!==0&&Qr!==null){var nr=Qr,hr=os;switch(li){case 8:Nd(),Qn=6;break t;case 3:case 2:case 9:case 6:ss.current===null&&(On=!0);var xr=li;if(li=0,os=null,No(Mn,nr,hr,xr),zn&&Ao){Qn=0;break t}break;default:xr=li,li=0,os=null,No(Mn,nr,hr,xr)}}hb(),Qn=$i;break}catch(Lr){Fg(Mn,Lr)}while(!0);return On&&Mn.shellSuspendCounter++,Vs=Ha=null,ai=Hn,er.H=Vn,er.A=Gn,Qr===null&&(pi=null,ti=0,ec()),Qn}function hb(){for(;Qr!==null;)Gg(Qr)}function db(Mn,On){var zn=ai;ai|=2;var Hn=Vg(),Vn=jg();pi!==Mn||ti!==On?(Lc=null,Dc=qi()+500,Co(Mn,On)):Ao=Ma(Mn,On);t:do try{if(li!==0&&Qr!==null){On=Qr;var Gn=os;e:switch(li){case 1:li=0,os=null,No(Mn,On,Gn,1);break;case 2:case 9:if(np(Gn)){li=0,os=null,Yg(On);break}On=function(){li!==2&&li!==9||pi!==Mn||(li=7),Ls(Mn)},Gn.then(On,On);break t;case 3:li=7;break t;case 4:li=5;break t;case 7:np(Gn)?(li=0,os=null,Yg(On)):(li=0,os=null,No(Mn,On,Gn,7));break;case 5:var Qn=null;switch(Qr.tag){case 26:Qn=Qr.memoizedState;case 5:case 27:var nr=Qr;if(Qn?Lm(Qn):nr.stateNode.complete){li=0,os=null;var hr=nr.sibling;if(hr!==null)Qr=hr;else{var xr=nr.return;xr!==null?(Qr=xr,Oc(xr)):Qr=null}break e}}li=0,os=null,No(Mn,On,Gn,5);break;case 6:li=0,os=null,No(Mn,On,Gn,6);break;case 8:Nd(),$i=6;break t;default:throw Error(Un(462))}}fb();break}catch(Lr){Fg(Mn,Lr)}while(!0);return Vs=Ha=null,er.H=Hn,er.A=Vn,ai=zn,Qr!==null?0:(pi=null,ti=0,ec(),$i)}function fb(){for(;Qr!==null&&!Ul();)Gg(Qr)}function Gg(Mn){var On=yg(Mn.alternate,Mn,ea);Mn.memoizedProps=Mn.pendingProps,On===null?Oc(Mn):Qr=On}function Yg(Mn){var On=Mn,zn=On.alternate;switch(On.tag){case 15:case 0:On=hg(zn,On,On.pendingProps,On.type,void 0,ti);break;case 11:On=hg(zn,On,On.pendingProps,On.type.render,On.ref,ti);break;case 5:jh(On);default:vg(zn,On),On=Qr=Vf(On,ea),On=yg(zn,On,ea)}Mn.memoizedProps=Mn.pendingProps,On===null?Oc(Mn):Qr=On}function No(Mn,On,zn,Hn){Vs=Ha=null,jh(On),vo=null,al=0;var Vn=On.return;try{if(eb(Mn,Vn,On,zn,ti)){$i=1,xc(Mn,ps(zn,Mn.current)),Qr=null;return}}catch(Gn){if(Vn!==null)throw Qr=Vn,Gn;$i=1,xc(Mn,ps(zn,Mn.current)),Qr=null;return}On.flags&32768?(ni||Hn===1?Mn=!0:Ao||(ti&536870912)!==0?Mn=!1:(wa=Mn=!0,(Hn===2||Hn===9||Hn===3||Hn===6)&&(Hn=ss.current,Hn!==null&&Hn.tag===13&&(Hn.flags|=16384))),Zg(On,Mn)):Oc(On)}function Oc(Mn){var On=Mn;do{if((On.flags&32768)!==0){Zg(On,wa);return}Mn=On.return;var zn=ib(On.alternate,On,ea);if(zn!==null){Qr=zn;return}if(On=On.sibling,On!==null){Qr=On;return}Qr=On=Mn}while(On!==null);$i===0&&($i=5)}function Zg(Mn,On){do{var zn=sb(Mn.alternate,Mn);if(zn!==null){zn.flags&=32767,Qr=zn;return}if(zn=Mn.return,zn!==null&&(zn.flags|=32768,zn.subtreeFlags=0,zn.deletions=null),!On&&(Mn=Mn.sibling,Mn!==null)){Qr=Mn;return}Qr=Mn=zn}while(Mn!==null);$i=6,Qr=null}function Xg(Mn,On,zn,Hn,Vn,Gn,Qn,nr,hr){Mn.cancelPendingCommit=null;do Bc();while(Mi!==0);if((ai&6)!==0)throw Error(Un(327));if(On!==null){if(On===Mn.current)throw Error(Un(177));if(Gn=On.lanes|On.childLanes,Gn|=vh,Po(Mn,zn,Gn,Qn,nr,hr),Mn===pi&&(Qr=pi=null,ti=0),To=On,xa=Mn,na=zn,_d=Gn,Td=Vn,Ig=Hn,(On.subtreeFlags&10256)!==0||(On.flags&10256)!==0?(Mn.callbackNode=null,Mn.callbackPriority=0,yb(oa,function(){return em(),null})):(Mn.callbackNode=null,Mn.callbackPriority=0),Hn=(On.flags&13878)!==0,(On.subtreeFlags&13878)!==0||Hn){Hn=er.T,er.T=null,Vn=or.p,or.p=2,Qn=ai,ai|=4;try{ab(Mn,On,zn)}finally{ai=Qn,or.p=Vn,er.T=Hn}}Mi=1,Qg(),Jg(),Wg()}}function Qg(){if(Mi===1){Mi=0;var Mn=xa,On=To,zn=(On.flags&13878)!==0;if((On.subtreeFlags&13878)!==0||zn){zn=er.T,er.T=null;var Hn=or.p;or.p=2;var Vn=ai;ai|=4;try{Rg(On,Mn);var Gn=Fd,Qn=Of(Mn.containerInfo),nr=Gn.focusedElem,hr=Gn.selectionRange;if(Qn!==nr&&nr&&nr.ownerDocument&&Uf(nr.ownerDocument.documentElement,nr)){if(hr!==null&&ph(nr)){var xr=hr.start,Lr=hr.end;if(Lr===void 0&&(Lr=xr),"selectionStart"in nr)nr.selectionStart=xr,nr.selectionEnd=Math.min(Lr,nr.value.length);else{var Or=nr.ownerDocument||document,kr=Or&&Or.defaultView||window;if(kr.getSelection){var Cr=kr.getSelection(),Fr=nr.textContent.length,Gr=Math.min(hr.start,Fr),fi=hr.end===void 0?Gr:Math.min(hr.end,Fr);!Cr.extend&&Gr>fi&&(Qn=fi,fi=Gr,Gr=Qn);var Er=Mf(nr,Gr),yr=Mf(nr,fi);if(Er&&yr&&(Cr.rangeCount!==1||Cr.anchorNode!==Er.node||Cr.anchorOffset!==Er.offset||Cr.focusNode!==yr.node||Cr.focusOffset!==yr.offset)){var $r=Or.createRange();$r.setStart(Er.node,Er.offset),Cr.removeAllRanges(),Gr>fi?(Cr.addRange($r),Cr.extend(yr.node,yr.offset)):($r.setEnd(yr.node,yr.offset),Cr.addRange($r))}}}}for(Or=[],Cr=nr;Cr=Cr.parentNode;)Cr.nodeType===1&&Or.push({element:Cr,left:Cr.scrollLeft,top:Cr.scrollTop});for(typeof nr.focus=="function"&&nr.focus(),nr=0;nr<Or.length;nr++){var Mr=Or[nr];Mr.element.scrollLeft=Mr.left,Mr.element.scrollTop=Mr.top}}Zc=!!Pd,Fd=Pd=null}finally{ai=Vn,or.p=Hn,er.T=zn}}Mn.current=On,Mi=2}}function Jg(){if(Mi===2){Mi=0;var Mn=xa,On=To,zn=(On.flags&8772)!==0;if((On.subtreeFlags&8772)!==0||zn){zn=er.T,er.T=null;var Hn=or.p;or.p=2;var Vn=ai;ai|=4;try{Ag(Mn,On.alternate,On)}finally{ai=Vn,or.p=Hn,er.T=zn}}Mi=3}}function Wg(){if(Mi===4||Mi===3){Mi=0,Gu();var Mn=xa,On=To,zn=na,Hn=Ig;(On.subtreeFlags&10256)!==0||(On.flags&10256)!==0?Mi=5:(Mi=0,To=xa=null,tm(Mn,Mn.pendingLanes));var Vn=Mn.pendingLanes;if(Vn===0&&($a=null),xs(zn),On=On.stateNode,Ui&&typeof Ui.onCommitFiberRoot=="function")try{Ui.onCommitFiberRoot(Cs,On,void 0,(On.current.flags&128)===128)}catch{}if(Hn!==null){On=er.T,Vn=or.p,or.p=2,er.T=null;try{for(var Gn=Mn.onRecoverableError,Qn=0;Qn<Hn.length;Qn++){var nr=Hn[Qn];Gn(nr.value,{componentStack:nr.stack})}}finally{er.T=On,or.p=Vn}}(na&3)!==0&&Bc(),Ls(Mn),Vn=Mn.pendingLanes,(zn&261930)!==0&&(Vn&42)!==0?Mn===Cd?xl++:(xl=0,Cd=Mn):xl=0,kl(0)}}function tm(Mn,On){(Mn.pooledCacheLanes&=On)===0&&(On=Mn.pooledCache,On!=null&&(Mn.pooledCache=null,il(On)))}function Bc(){return Qg(),Jg(),Wg(),em()}function em(){if(Mi!==5)return!1;var Mn=xa,On=_d;_d=0;var zn=xs(na),Hn=er.T,Vn=or.p;try{or.p=32>zn?32:zn,er.T=null,zn=Td,Td=null;var Gn=xa,Qn=na;if(Mi=0,To=xa=null,na=0,(ai&6)!==0)throw Error(Un(331));var nr=ai;if(ai|=4,Og(Gn.current),Lg(Gn,Gn.current,Qn,zn),ai=nr,kl(0,!1),Ui&&typeof Ui.onPostCommitFiberRoot=="function")try{Ui.onPostCommitFiberRoot(Cs,Gn)}catch{}return!0}finally{or.p=Vn,er.T=Hn,tm(Mn,On)}}function nm(Mn,On,zn){On=ps(zn,On),On=od(Mn.stateNode,On,2),Mn=ma(Mn,On,2),Mn!==null&&(la(Mn,2),Ls(Mn))}function ci(Mn,On,zn){if(Mn.tag===3)nm(Mn,Mn,zn);else for(;On!==null;){if(On.tag===3){nm(On,Mn,zn);break}else if(On.tag===1){var Hn=On.stateNode;if(typeof On.type.getDerivedStateFromError=="function"||typeof Hn.componentDidCatch=="function"&&($a===null||!$a.has(Hn))){Mn=ps(zn,Mn),zn=rg(2),Hn=ma(On,zn,2),Hn!==null&&(ig(zn,Hn,On,Mn),la(Hn,2),Ls(Hn));break}}On=On.return}}function Dd(Mn,On,zn){var Hn=Mn.pingCache;if(Hn===null){Hn=Mn.pingCache=new cb;var Vn=new Set;Hn.set(On,Vn)}else Vn=Hn.get(On),Vn===void 0&&(Vn=new Set,Hn.set(On,Vn));Vn.has(zn)||(kd=!0,Vn.add(zn),Mn=pb.bind(null,Mn,On,zn),On.then(Mn,Mn))}function pb(Mn,On,zn){var Hn=Mn.pingCache;Hn!==null&&Hn.delete(On),Mn.pingedLanes|=Mn.suspendedLanes&zn,Mn.warmLanes&=~zn,pi===Mn&&(ti&zn)===zn&&($i===4||$i===3&&(ti&62914560)===ti&&300>qi()-Rc?(ai&2)===0&&Co(Mn,0):Sd|=zn,_o===ti&&(_o=0)),Ls(Mn)}function rm(Mn,On){On===0&&(On=zs()),Mn=za(Mn,On),Mn!==null&&(la(Mn,On),Ls(Mn))}function gb(Mn){var On=Mn.memoizedState,zn=0;On!==null&&(zn=On.retryLane),rm(Mn,zn)}function mb(Mn,On){var zn=0;switch(Mn.tag){case 31:case 13:var Hn=Mn.stateNode,Vn=Mn.memoizedState;Vn!==null&&(zn=Vn.retryLane);break;case 19:Hn=Mn.stateNode;break;case 22:Hn=Mn.stateNode._retryCache;break;default:throw Error(Un(314))}Hn!==null&&Hn.delete(On),rm(Mn,zn)}function yb(Mn,On){return aa(Mn,On)}var zc=null,Ro=null,Ld=!1,Ic=!1,Md=!1,Sa=0;function Ls(Mn){Mn!==Ro&&Mn.next===null&&(Ro===null?zc=Ro=Mn:Ro=Ro.next=Mn),Ic=!0,Ld||(Ld=!0,vb())}function kl(Mn,On){if(!Md&&Ic){Md=!0;do for(var zn=!1,Hn=zc;Hn!==null;){if(Mn!==0){var Vn=Hn.pendingLanes;if(Vn===0)var Gn=0;else{var Qn=Hn.suspendedLanes,nr=Hn.pingedLanes;Gn=(1<<31-_i(42|Mn)+1)-1,Gn&=Vn&~(Qn&~nr),Gn=Gn&201326741?Gn&201326741|1:Gn?Gn|2:0}Gn!==0&&(zn=!0,om(Hn,Gn))}else Gn=ti,Gn=to(Hn,Hn===pi?Gn:0,Hn.cancelPendingCommit!==null||Hn.timeoutHandle!==-1),(Gn&3)===0||Ma(Hn,Gn)||(zn=!0,om(Hn,Gn));Hn=Hn.next}while(zn);Md=!1}}function bb(){im()}function im(){Ic=Ld=!1;var Mn=0;Sa!==0&&Cb()&&(Mn=Sa);for(var On=qi(),zn=null,Hn=zc;Hn!==null;){var Vn=Hn.next,Gn=sm(Hn,On);Gn===0?(Hn.next=null,zn===null?zc=Vn:zn.next=Vn,Vn===null&&(Ro=zn)):(zn=Hn,(Mn!==0||(Gn&3)!==0)&&(Ic=!0)),Hn=Vn}Mi!==0&&Mi!==5||kl(Mn),Sa!==0&&(Sa=0)}function sm(Mn,On){for(var zn=Mn.suspendedLanes,Hn=Mn.pingedLanes,Vn=Mn.expirationTimes,Gn=Mn.pendingLanes&-62914561;0<Gn;){var Qn=31-_i(Gn),nr=1<<Qn,hr=Vn[Qn];hr===-1?((nr&zn)===0||(nr&Hn)!==0)&&(Vn[Qn]=xi(nr,On)):hr<=On&&(Mn.expiredLanes|=nr),Gn&=~nr}if(On=pi,zn=ti,zn=to(Mn,Mn===On?zn:0,Mn.cancelPendingCommit!==null||Mn.timeoutHandle!==-1),Hn=Mn.callbackNode,zn===0||Mn===On&&(li===2||li===9)||Mn.cancelPendingCommit!==null)return Hn!==null&&Hn!==null&&Ja(Hn),Mn.callbackNode=null,Mn.callbackPriority=0;if((zn&3)===0||Ma(Mn,zn)){if(On=zn&-zn,On===Mn.callbackPriority)return On;switch(Hn!==null&&Ja(Hn),xs(zn)){case 2:case 8:zn=es;break;case 32:zn=oa;break;case 268435456:zn=Bo;break;default:zn=oa}return Hn=am.bind(null,Mn),zn=aa(zn,Hn),Mn.callbackPriority=On,Mn.callbackNode=zn,On}return Hn!==null&&Hn!==null&&Ja(Hn),Mn.callbackPriority=2,Mn.callbackNode=null,2}function am(Mn,On){if(Mi!==0&&Mi!==5)return Mn.callbackNode=null,Mn.callbackPriority=0,null;var zn=Mn.callbackNode;if(Bc()&&Mn.callbackNode!==zn)return null;var Hn=ti;return Hn=to(Mn,Mn===pi?Hn:0,Mn.cancelPendingCommit!==null||Mn.timeoutHandle!==-1),Hn===0?null:(Hg(Mn,Hn,On),sm(Mn,qi()),Mn.callbackNode!=null&&Mn.callbackNode===zn?am.bind(null,Mn):null)}function om(Mn,On){if(Bc())return null;Hg(Mn,On,!0)}function vb(){Rb(function(){(ai&6)!==0?aa(Us,bb):im()})}function Ud(){if(Sa===0){var Mn=mo;Mn===0&&(Mn=Os,Os<<=1,(Os&261888)===0&&(Os=256)),Sa=Mn}return Sa}function lm(Mn){return Mn==null||typeof Mn=="symbol"||typeof Mn=="boolean"?null:typeof Mn=="function"?Mn:Gl(""+Mn)}function cm(Mn,On){var zn=On.ownerDocument.createElement("input");return zn.name=On.name,zn.value=On.value,Mn.id&&zn.setAttribute("form",Mn.id),On.parentNode.insertBefore(zn,On),Mn=new FormData(Mn),zn.parentNode.removeChild(zn),Mn}function wb(Mn,On,zn,Hn,Vn){if(On==="submit"&&zn&&zn.stateNode===Vn){var Gn=lm((Vn[yi]||null).action),Qn=Hn.submitter;Qn&&(On=(On=Qn[yi]||null)?lm(On.formAction):Qn.getAttribute("formAction"),On!==null&&(Gn=On,Qn=null));var nr=new Ql("action","action",null,Hn,Vn);Mn.push({event:nr,listeners:[{instance:null,listener:function(){if(Hn.defaultPrevented){if(Sa!==0){var hr=Qn?cm(Vn,Qn):new FormData(Vn);ed(zn,{pending:!0,data:hr,method:Vn.method,action:Gn},null,hr)}}else typeof Gn=="function"&&(nr.preventDefault(),hr=Qn?cm(Vn,Qn):new FormData(Vn),ed(zn,{pending:!0,data:hr,method:Vn.method,action:Gn},Gn,hr))},currentTarget:Vn}]})}}for(var Od=0;Od<bh.length;Od++){var Bd=bh[Od],Eb=Bd.toLowerCase(),$b=Bd[0].toUpperCase()+Bd.slice(1);Ss(Eb,"on"+$b)}Ss(If,"onAnimationEnd"),Ss(qf,"onAnimationIteration"),Ss(Hf,"onAnimationStart"),Ss("dblclick","onDoubleClick"),Ss("focusin","onFocus"),Ss("focusout","onBlur"),Ss(zy,"onTransitionRun"),Ss(Iy,"onTransitionStart"),Ss(qy,"onTransitionCancel"),Ss(Pf,"onTransitionEnd"),bi("onMouseEnter",["mouseout","mouseover"]),bi("onMouseLeave",["mouseout","mouseover"]),bi("onPointerEnter",["pointerout","pointerover"]),bi("onPointerLeave",["pointerout","pointerover"]),ks("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ks("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ks("onBeforeInput",["compositionend","keypress","textInput","paste"]),ks("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ks("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ks("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sl));function um(Mn,On){On=(On&4)!==0;for(var zn=0;zn<Mn.length;zn++){var Hn=Mn[zn],Vn=Hn.event;Hn=Hn.listeners;t:{var Gn=void 0;if(On)for(var Qn=Hn.length-1;0<=Qn;Qn--){var nr=Hn[Qn],hr=nr.instance,xr=nr.currentTarget;if(nr=nr.listener,hr!==Gn&&Vn.isPropagationStopped())break t;Gn=nr,Vn.currentTarget=xr;try{Gn(Vn)}catch(Lr){tc(Lr)}Vn.currentTarget=null,Gn=hr}else for(Qn=0;Qn<Hn.length;Qn++){if(nr=Hn[Qn],hr=nr.instance,xr=nr.currentTarget,nr=nr.listener,hr!==Gn&&Vn.isPropagationStopped())break t;Gn=nr,Vn.currentTarget=xr;try{Gn(Vn)}catch(Lr){tc(Lr)}Vn.currentTarget=null,Gn=hr}}}}function Jr(Mn,On){var zn=On[eo];zn===void 0&&(zn=On[eo]=new Set);var Hn=Mn+"__bubble";zn.has(Hn)||(hm(On,Mn,2,!1),zn.add(Hn))}function zd(Mn,On,zn){var Hn=0;On&&(Hn|=4),hm(zn,Mn,Hn,On)}var qc="_reactListening"+Math.random().toString(36).slice(2);function Id(Mn){if(!Mn[qc]){Mn[qc]=!0,Gi.forEach(function(zn){zn!=="selectionchange"&&(xb.has(zn)||zd(zn,!1,Mn),zd(zn,!0,Mn))});var On=Mn.nodeType===9?Mn:Mn.ownerDocument;On===null||On[qc]||(On[qc]=!0,zd("selectionchange",!1,On))}}function hm(Mn,On,zn,Hn){switch(qm(On)){case 2:var Vn=Qb;break;case 8:Vn=Jb;break;default:Vn=tf}zn=Vn.bind(null,On,zn,Mn),Vn=void 0,!sh||On!=="touchstart"&&On!=="touchmove"&&On!=="wheel"||(Vn=!0),Hn?Vn!==void 0?Mn.addEventListener(On,zn,{capture:!0,passive:Vn}):Mn.addEventListener(On,zn,!0):Vn!==void 0?Mn.addEventListener(On,zn,{passive:Vn}):Mn.addEventListener(On,zn,!1)}function qd(Mn,On,zn,Hn,Vn){var Gn=Hn;if((On&1)===0&&(On&2)===0&&Hn!==null)t:for(;;){if(Hn===null)return;var Qn=Hn.tag;if(Qn===3||Qn===4){var nr=Hn.stateNode.containerInfo;if(nr===Vn)break;if(Qn===4)for(Qn=Hn.return;Qn!==null;){var hr=Qn.tag;if((hr===3||hr===4)&&Qn.stateNode.containerInfo===Vn)return;Qn=Qn.return}for(;nr!==null;){if(Qn=Ir(nr),Qn===null)return;if(hr=Qn.tag,hr===5||hr===6||hr===26||hr===27){Hn=Gn=Qn;continue t}nr=nr.parentNode}}Hn=Hn.return}gf(function(){var xr=Gn,Lr=rh(zn),Or=[];t:{var kr=Ff.get(Mn);if(kr!==void 0){var Cr=Ql,Fr=Mn;switch(Mn){case"keypress":if(Zl(zn)===0)break t;case"keydown":case"keyup":Cr=my;break;case"focusin":Fr="focus",Cr=ch;break;case"focusout":Fr="blur",Cr=ch;break;case"beforeblur":case"afterblur":Cr=ch;break;case"click":if(zn.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Cr=bf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Cr=iy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Cr=vy;break;case If:case qf:case Hf:Cr=oy;break;case Pf:Cr=Ey;break;case"scroll":case"scrollend":Cr=ny;break;case"wheel":Cr=xy;break;case"copy":case"cut":case"paste":Cr=cy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Cr=wf;break;case"toggle":case"beforetoggle":Cr=Sy}var Gr=(On&4)!==0,fi=!Gr&&(Mn==="scroll"||Mn==="scrollend"),Er=Gr?kr!==null?kr+"Capture":null:kr;Gr=[];for(var yr=xr,$r;yr!==null;){var Mr=yr;if($r=Mr.stateNode,Mr=Mr.tag,Mr!==5&&Mr!==26&&Mr!==27||$r===null||Er===null||(Mr=Go(yr,Er),Mr!=null&&Gr.push(Al(yr,Mr,$r))),fi)break;yr=yr.return}0<Gr.length&&(kr=new Cr(kr,Fr,null,zn,Lr),Or.push({event:kr,listeners:Gr}))}}if((On&7)===0){t:{if(kr=Mn==="mouseover"||Mn==="pointerover",Cr=Mn==="mouseout"||Mn==="pointerout",kr&&zn!==nh&&(Fr=zn.relatedTarget||zn.fromElement)&&(Ir(Fr)||Fr[Is]))break t;if((Cr||kr)&&(kr=Lr.window===Lr?Lr:(kr=Lr.ownerDocument)?kr.defaultView||kr.parentWindow:window,Cr?(Fr=zn.relatedTarget||zn.toElement,Cr=xr,Fr=Fr?Ir(Fr):null,Fr!==null&&(fi=In(Fr),Gr=Fr.tag,Fr!==fi||Gr!==5&&Gr!==27&&Gr!==6)&&(Fr=null)):(Cr=null,Fr=xr),Cr!==Fr)){if(Gr=bf,Mr="onMouseLeave",Er="onMouseEnter",yr="mouse",(Mn==="pointerout"||Mn==="pointerover")&&(Gr=wf,Mr="onPointerLeave",Er="onPointerEnter",yr="pointer"),fi=Cr==null?kr:wi(Cr),$r=Fr==null?kr:wi(Fr),kr=new Gr(Mr,yr+"leave",Cr,zn,Lr),kr.target=fi,kr.relatedTarget=$r,Mr=null,Ir(Lr)===xr&&(Gr=new Gr(Er,yr+"enter",Fr,zn,Lr),Gr.target=$r,Gr.relatedTarget=fi,Mr=Gr),fi=Mr,Cr&&Fr)e:{for(Gr=kb,Er=Cr,yr=Fr,$r=0,Mr=Er;Mr;Mr=Gr(Mr))$r++;Mr=0;for(var jr=yr;jr;jr=Gr(jr))Mr++;for(;0<$r-Mr;)Er=Gr(Er),$r--;for(;0<Mr-$r;)yr=Gr(yr),Mr--;for(;$r--;){if(Er===yr||yr!==null&&Er===yr.alternate){Gr=Er;break e}Er=Gr(Er),yr=Gr(yr)}Gr=null}else Gr=null;Cr!==null&&dm(Or,kr,Cr,Gr,!1),Fr!==null&&fi!==null&&dm(Or,fi,Fr,Gr,!0)}}t:{if(kr=xr?wi(xr):window,Cr=kr.nodeName&&kr.nodeName.toLowerCase(),Cr==="select"||Cr==="input"&&kr.type==="file")var ri=Tf;else if(Af(kr))if(Cf)ri=Uy;else{ri=Ly;var Vr=Dy}else Cr=kr.nodeName,!Cr||Cr.toLowerCase()!=="input"||kr.type!=="checkbox"&&kr.type!=="radio"?xr&&eh(xr.elementType)&&(ri=Tf):ri=My;if(ri&&(ri=ri(Mn,xr))){_f(Or,ri,zn,Lr);break t}Vr&&Vr(Mn,kr,xr),Mn==="focusout"&&xr&&kr.type==="number"&&xr.memoizedProps.value!=null&&th(kr,"number",kr.value)}switch(Vr=xr?wi(xr):window,Mn){case"focusin":(Af(Vr)||Vr.contentEditable==="true")&&(oo=Vr,gh=xr,el=null);break;case"focusout":el=gh=oo=null;break;case"mousedown":mh=!0;break;case"contextmenu":case"mouseup":case"dragend":mh=!1,Bf(Or,zn,Lr);break;case"selectionchange":if(By)break;case"keydown":case"keyup":Bf(Or,zn,Lr)}var Xr;if(hh)t:{switch(Mn){case"compositionstart":var ei="onCompositionStart";break t;case"compositionend":ei="onCompositionEnd";break t;case"compositionupdate":ei="onCompositionUpdate";break t}ei=void 0}else ao?kf(Mn,zn)&&(ei="onCompositionEnd"):Mn==="keydown"&&zn.keyCode===229&&(ei="onCompositionStart");ei&&(Ef&&zn.locale!=="ko"&&(ao||ei!=="onCompositionStart"?ei==="onCompositionEnd"&&ao&&(Xr=mf()):(ca=Lr,ah="value"in ca?ca.value:ca.textContent,ao=!0)),Vr=Hc(xr,ei),0<Vr.length&&(ei=new vf(ei,Mn,null,zn,Lr),Or.push({event:ei,listeners:Vr}),Xr?ei.data=Xr:(Xr=Sf(zn),Xr!==null&&(ei.data=Xr)))),(Xr=_y?Ty(Mn,zn):Cy(Mn,zn))&&(ei=Hc(xr,"onBeforeInput"),0<ei.length&&(Vr=new vf("onBeforeInput","beforeinput",null,zn,Lr),Or.push({event:Vr,listeners:ei}),Vr.data=Xr)),wb(Or,Mn,xr,zn,Lr)}um(Or,On)})}function Al(Mn,On,zn){return{instance:Mn,listener:On,currentTarget:zn}}function Hc(Mn,On){for(var zn=On+"Capture",Hn=[];Mn!==null;){var Vn=Mn,Gn=Vn.stateNode;if(Vn=Vn.tag,Vn!==5&&Vn!==26&&Vn!==27||Gn===null||(Vn=Go(Mn,zn),Vn!=null&&Hn.unshift(Al(Mn,Vn,Gn)),Vn=Go(Mn,On),Vn!=null&&Hn.push(Al(Mn,Vn,Gn))),Mn.tag===3)return Hn;Mn=Mn.return}return[]}function kb(Mn){if(Mn===null)return null;do Mn=Mn.return;while(Mn&&Mn.tag!==5&&Mn.tag!==27);return Mn||null}function dm(Mn,On,zn,Hn,Vn){for(var Gn=On._reactName,Qn=[];zn!==null&&zn!==Hn;){var nr=zn,hr=nr.alternate,xr=nr.stateNode;if(nr=nr.tag,hr!==null&&hr===Hn)break;nr!==5&&nr!==26&&nr!==27||xr===null||(hr=xr,Vn?(xr=Go(zn,Gn),xr!=null&&Qn.unshift(Al(zn,xr,hr))):Vn||(xr=Go(zn,Gn),xr!=null&&Qn.push(Al(zn,xr,hr)))),zn=zn.return}Qn.length!==0&&Mn.push({event:On,listeners:Qn})}var Sb=/\r\n?/g,Ab=/\u0000|\uFFFD/g;function fm(Mn){return(typeof Mn=="string"?Mn:""+Mn).replace(Sb,`
`).replace(Ab,"")}function pm(Mn,On){return On=fm(On),fm(Mn)===On}function di(Mn,On,zn,Hn,Vn,Gn){switch(zn){case"children":typeof Hn=="string"?On==="body"||On==="textarea"&&Hn===""||ro(Mn,Hn):(typeof Hn=="number"||typeof Hn=="bigint")&&On!=="body"&&ro(Mn,""+Hn);break;case"className":Vl(Mn,"class",Hn);break;case"tabIndex":Vl(Mn,"tabindex",Hn);break;case"dir":case"role":case"viewBox":case"width":case"height":Vl(Mn,zn,Hn);break;case"style":ff(Mn,Hn,Gn);break;case"data":if(On!=="object"){Vl(Mn,"data",Hn);break}case"src":case"href":if(Hn===""&&(On!=="a"||zn!=="href")){Mn.removeAttribute(zn);break}if(Hn==null||typeof Hn=="function"||typeof Hn=="symbol"||typeof Hn=="boolean"){Mn.removeAttribute(zn);break}Hn=Gl(""+Hn),Mn.setAttribute(zn,Hn);break;case"action":case"formAction":if(typeof Hn=="function"){Mn.setAttribute(zn,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof Gn=="function"&&(zn==="formAction"?(On!=="input"&&di(Mn,On,"name",Vn.name,Vn,null),di(Mn,On,"formEncType",Vn.formEncType,Vn,null),di(Mn,On,"formMethod",Vn.formMethod,Vn,null),di(Mn,On,"formTarget",Vn.formTarget,Vn,null)):(di(Mn,On,"encType",Vn.encType,Vn,null),di(Mn,On,"method",Vn.method,Vn,null),di(Mn,On,"target",Vn.target,Vn,null)));if(Hn==null||typeof Hn=="symbol"||typeof Hn=="boolean"){Mn.removeAttribute(zn);break}Hn=Gl(""+Hn),Mn.setAttribute(zn,Hn);break;case"onClick":Hn!=null&&(Mn.onclick=Hs);break;case"onScroll":Hn!=null&&Jr("scroll",Mn);break;case"onScrollEnd":Hn!=null&&Jr("scrollend",Mn);break;case"dangerouslySetInnerHTML":if(Hn!=null){if(typeof Hn!="object"||!("__html"in Hn))throw Error(Un(61));if(zn=Hn.__html,zn!=null){if(Vn.children!=null)throw Error(Un(60));Mn.innerHTML=zn}}break;case"multiple":Mn.multiple=Hn&&typeof Hn!="function"&&typeof Hn!="symbol";break;case"muted":Mn.muted=Hn&&typeof Hn!="function"&&typeof Hn!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(Hn==null||typeof Hn=="function"||typeof Hn=="boolean"||typeof Hn=="symbol"){Mn.removeAttribute("xlink:href");break}zn=Gl(""+Hn),Mn.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",zn);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":Hn!=null&&typeof Hn!="function"&&typeof Hn!="symbol"?Mn.setAttribute(zn,""+Hn):Mn.removeAttribute(zn);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":Hn&&typeof Hn!="function"&&typeof Hn!="symbol"?Mn.setAttribute(zn,""):Mn.removeAttribute(zn);break;case"capture":case"download":Hn===!0?Mn.setAttribute(zn,""):Hn!==!1&&Hn!=null&&typeof Hn!="function"&&typeof Hn!="symbol"?Mn.setAttribute(zn,Hn):Mn.removeAttribute(zn);break;case"cols":case"rows":case"size":case"span":Hn!=null&&typeof Hn!="function"&&typeof Hn!="symbol"&&!isNaN(Hn)&&1<=Hn?Mn.setAttribute(zn,Hn):Mn.removeAttribute(zn);break;case"rowSpan":case"start":Hn==null||typeof Hn=="function"||typeof Hn=="symbol"||isNaN(Hn)?Mn.removeAttribute(zn):Mn.setAttribute(zn,Hn);break;case"popover":Jr("beforetoggle",Mn),Jr("toggle",Mn),Kl(Mn,"popover",Hn);break;case"xlinkActuate":qs(Mn,"http://www.w3.org/1999/xlink","xlink:actuate",Hn);break;case"xlinkArcrole":qs(Mn,"http://www.w3.org/1999/xlink","xlink:arcrole",Hn);break;case"xlinkRole":qs(Mn,"http://www.w3.org/1999/xlink","xlink:role",Hn);break;case"xlinkShow":qs(Mn,"http://www.w3.org/1999/xlink","xlink:show",Hn);break;case"xlinkTitle":qs(Mn,"http://www.w3.org/1999/xlink","xlink:title",Hn);break;case"xlinkType":qs(Mn,"http://www.w3.org/1999/xlink","xlink:type",Hn);break;case"xmlBase":qs(Mn,"http://www.w3.org/XML/1998/namespace","xml:base",Hn);break;case"xmlLang":qs(Mn,"http://www.w3.org/XML/1998/namespace","xml:lang",Hn);break;case"xmlSpace":qs(Mn,"http://www.w3.org/XML/1998/namespace","xml:space",Hn);break;case"is":Kl(Mn,"is",Hn);break;case"innerText":case"textContent":break;default:(!(2<zn.length)||zn[0]!=="o"&&zn[0]!=="O"||zn[1]!=="n"&&zn[1]!=="N")&&(zn=ty.get(zn)||zn,Kl(Mn,zn,Hn))}}function Hd(Mn,On,zn,Hn,Vn,Gn){switch(zn){case"style":ff(Mn,Hn,Gn);break;case"dangerouslySetInnerHTML":if(Hn!=null){if(typeof Hn!="object"||!("__html"in Hn))throw Error(Un(61));if(zn=Hn.__html,zn!=null){if(Vn.children!=null)throw Error(Un(60));Mn.innerHTML=zn}}break;case"children":typeof Hn=="string"?ro(Mn,Hn):(typeof Hn=="number"||typeof Hn=="bigint")&&ro(Mn,""+Hn);break;case"onScroll":Hn!=null&&Jr("scroll",Mn);break;case"onScrollEnd":Hn!=null&&Jr("scrollend",Mn);break;case"onClick":Hn!=null&&(Mn.onclick=Hs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yi.hasOwnProperty(zn))t:{if(zn[0]==="o"&&zn[1]==="n"&&(Vn=zn.endsWith("Capture"),On=zn.slice(2,Vn?zn.length-7:void 0),Gn=Mn[yi]||null,Gn=Gn!=null?Gn[zn]:null,typeof Gn=="function"&&Mn.removeEventListener(On,Gn,Vn),typeof Hn=="function")){typeof Gn!="function"&&Gn!==null&&(zn in Mn?Mn[zn]=null:Mn.hasAttribute(zn)&&Mn.removeAttribute(zn)),Mn.addEventListener(On,Hn,Vn);break t}zn in Mn?Mn[zn]=Hn:Hn===!0?Mn.setAttribute(zn,""):Kl(Mn,zn,Hn)}}}function Ki(Mn,On,zn){switch(On){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Jr("error",Mn),Jr("load",Mn);var Hn=!1,Vn=!1,Gn;for(Gn in zn)if(zn.hasOwnProperty(Gn)){var Qn=zn[Gn];if(Qn!=null)switch(Gn){case"src":Hn=!0;break;case"srcSet":Vn=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Un(137,On));default:di(Mn,On,Gn,Qn,zn,null)}}Vn&&di(Mn,On,"srcSet",zn.srcSet,zn,null),Hn&&di(Mn,On,"src",zn.src,zn,null);return;case"input":Jr("invalid",Mn);var nr=Gn=Qn=Vn=null,hr=null,xr=null;for(Hn in zn)if(zn.hasOwnProperty(Hn)){var Lr=zn[Hn];if(Lr!=null)switch(Hn){case"name":Vn=Lr;break;case"type":Qn=Lr;break;case"checked":hr=Lr;break;case"defaultChecked":xr=Lr;break;case"value":Gn=Lr;break;case"defaultValue":nr=Lr;break;case"children":case"dangerouslySetInnerHTML":if(Lr!=null)throw Error(Un(137,On));break;default:di(Mn,On,Hn,Lr,zn,null)}}cf(Mn,Gn,nr,hr,xr,Qn,Vn,!1);return;case"select":Jr("invalid",Mn),Hn=Qn=Gn=null;for(Vn in zn)if(zn.hasOwnProperty(Vn)&&(nr=zn[Vn],nr!=null))switch(Vn){case"value":Gn=nr;break;case"defaultValue":Qn=nr;break;case"multiple":Hn=nr;default:di(Mn,On,Vn,nr,zn,null)}On=Gn,zn=Qn,Mn.multiple=!!Hn,On!=null?no(Mn,!!Hn,On,!1):zn!=null&&no(Mn,!!Hn,zn,!0);return;case"textarea":Jr("invalid",Mn),Gn=Vn=Hn=null;for(Qn in zn)if(zn.hasOwnProperty(Qn)&&(nr=zn[Qn],nr!=null))switch(Qn){case"value":Hn=nr;break;case"defaultValue":Vn=nr;break;case"children":Gn=nr;break;case"dangerouslySetInnerHTML":if(nr!=null)throw Error(Un(91));break;default:di(Mn,On,Qn,nr,zn,null)}hf(Mn,Hn,Vn,Gn);return;case"option":for(hr in zn)zn.hasOwnProperty(hr)&&(Hn=zn[hr],Hn!=null)&&(hr==="selected"?Mn.selected=Hn&&typeof Hn!="function"&&typeof Hn!="symbol":di(Mn,On,hr,Hn,zn,null));return;case"dialog":Jr("beforetoggle",Mn),Jr("toggle",Mn),Jr("cancel",Mn),Jr("close",Mn);break;case"iframe":case"object":Jr("load",Mn);break;case"video":case"audio":for(Hn=0;Hn<Sl.length;Hn++)Jr(Sl[Hn],Mn);break;case"image":Jr("error",Mn),Jr("load",Mn);break;case"details":Jr("toggle",Mn);break;case"embed":case"source":case"link":Jr("error",Mn),Jr("load",Mn);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(xr in zn)if(zn.hasOwnProperty(xr)&&(Hn=zn[xr],Hn!=null))switch(xr){case"children":case"dangerouslySetInnerHTML":throw Error(Un(137,On));default:di(Mn,On,xr,Hn,zn,null)}return;default:if(eh(On)){for(Lr in zn)zn.hasOwnProperty(Lr)&&(Hn=zn[Lr],Hn!==void 0&&Hd(Mn,On,Lr,Hn,zn,void 0));return}}for(nr in zn)zn.hasOwnProperty(nr)&&(Hn=zn[nr],Hn!=null&&di(Mn,On,nr,Hn,zn,null))}function _b(Mn,On,zn,Hn){switch(On){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var Vn=null,Gn=null,Qn=null,nr=null,hr=null,xr=null,Lr=null;for(Cr in zn){var Or=zn[Cr];if(zn.hasOwnProperty(Cr)&&Or!=null)switch(Cr){case"checked":break;case"value":break;case"defaultValue":hr=Or;default:Hn.hasOwnProperty(Cr)||di(Mn,On,Cr,null,Hn,Or)}}for(var kr in Hn){var Cr=Hn[kr];if(Or=zn[kr],Hn.hasOwnProperty(kr)&&(Cr!=null||Or!=null))switch(kr){case"type":Gn=Cr;break;case"name":Vn=Cr;break;case"checked":xr=Cr;break;case"defaultChecked":Lr=Cr;break;case"value":Qn=Cr;break;case"defaultValue":nr=Cr;break;case"children":case"dangerouslySetInnerHTML":if(Cr!=null)throw Error(Un(137,On));break;default:Cr!==Or&&di(Mn,On,kr,Cr,Hn,Or)}}Ju(Mn,Qn,nr,hr,xr,Lr,Gn,Vn);return;case"select":Cr=Qn=nr=kr=null;for(Gn in zn)if(hr=zn[Gn],zn.hasOwnProperty(Gn)&&hr!=null)switch(Gn){case"value":break;case"multiple":Cr=hr;default:Hn.hasOwnProperty(Gn)||di(Mn,On,Gn,null,Hn,hr)}for(Vn in Hn)if(Gn=Hn[Vn],hr=zn[Vn],Hn.hasOwnProperty(Vn)&&(Gn!=null||hr!=null))switch(Vn){case"value":kr=Gn;break;case"defaultValue":nr=Gn;break;case"multiple":Qn=Gn;default:Gn!==hr&&di(Mn,On,Vn,Gn,Hn,hr)}On=nr,zn=Qn,Hn=Cr,kr!=null?no(Mn,!!zn,kr,!1):!!Hn!=!!zn&&(On!=null?no(Mn,!!zn,On,!0):no(Mn,!!zn,zn?[]:"",!1));return;case"textarea":Cr=kr=null;for(nr in zn)if(Vn=zn[nr],zn.hasOwnProperty(nr)&&Vn!=null&&!Hn.hasOwnProperty(nr))switch(nr){case"value":break;case"children":break;default:di(Mn,On,nr,null,Hn,Vn)}for(Qn in Hn)if(Vn=Hn[Qn],Gn=zn[Qn],Hn.hasOwnProperty(Qn)&&(Vn!=null||Gn!=null))switch(Qn){case"value":kr=Vn;break;case"defaultValue":Cr=Vn;break;case"children":break;case"dangerouslySetInnerHTML":if(Vn!=null)throw Error(Un(91));break;default:Vn!==Gn&&di(Mn,On,Qn,Vn,Hn,Gn)}uf(Mn,kr,Cr);return;case"option":for(var Fr in zn)kr=zn[Fr],zn.hasOwnProperty(Fr)&&kr!=null&&!Hn.hasOwnProperty(Fr)&&(Fr==="selected"?Mn.selected=!1:di(Mn,On,Fr,null,Hn,kr));for(hr in Hn)kr=Hn[hr],Cr=zn[hr],Hn.hasOwnProperty(hr)&&kr!==Cr&&(kr!=null||Cr!=null)&&(hr==="selected"?Mn.selected=kr&&typeof kr!="function"&&typeof kr!="symbol":di(Mn,On,hr,kr,Hn,Cr));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Gr in zn)kr=zn[Gr],zn.hasOwnProperty(Gr)&&kr!=null&&!Hn.hasOwnProperty(Gr)&&di(Mn,On,Gr,null,Hn,kr);for(xr in Hn)if(kr=Hn[xr],Cr=zn[xr],Hn.hasOwnProperty(xr)&&kr!==Cr&&(kr!=null||Cr!=null))switch(xr){case"children":case"dangerouslySetInnerHTML":if(kr!=null)throw Error(Un(137,On));break;default:di(Mn,On,xr,kr,Hn,Cr)}return;default:if(eh(On)){for(var fi in zn)kr=zn[fi],zn.hasOwnProperty(fi)&&kr!==void 0&&!Hn.hasOwnProperty(fi)&&Hd(Mn,On,fi,void 0,Hn,kr);for(Lr in Hn)kr=Hn[Lr],Cr=zn[Lr],!Hn.hasOwnProperty(Lr)||kr===Cr||kr===void 0&&Cr===void 0||Hd(Mn,On,Lr,kr,Hn,Cr);return}}for(var Er in zn)kr=zn[Er],zn.hasOwnProperty(Er)&&kr!=null&&!Hn.hasOwnProperty(Er)&&di(Mn,On,Er,null,Hn,kr);for(Or in Hn)kr=Hn[Or],Cr=zn[Or],!Hn.hasOwnProperty(Or)||kr===Cr||kr==null&&Cr==null||di(Mn,On,Or,kr,Hn,Cr)}function gm(Mn){switch(Mn){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Tb(){if(typeof performance.getEntriesByType=="function"){for(var Mn=0,On=0,zn=performance.getEntriesByType("resource"),Hn=0;Hn<zn.length;Hn++){var Vn=zn[Hn],Gn=Vn.transferSize,Qn=Vn.initiatorType,nr=Vn.duration;if(Gn&&nr&&gm(Qn)){for(Qn=0,nr=Vn.responseEnd,Hn+=1;Hn<zn.length;Hn++){var hr=zn[Hn],xr=hr.startTime;if(xr>nr)break;var Lr=hr.transferSize,Or=hr.initiatorType;Lr&&gm(Or)&&(hr=hr.responseEnd,Qn+=Lr*(hr<nr?1:(nr-xr)/(hr-xr)))}if(--Hn,On+=8*(Gn+Qn)/(Vn.duration/1e3),Mn++,10<Mn)break}}if(0<Mn)return On/Mn/1e6}return navigator.connection&&(Mn=navigator.connection.downlink,typeof Mn=="number")?Mn:5}var Pd=null,Fd=null;function Pc(Mn){return Mn.nodeType===9?Mn:Mn.ownerDocument}function mm(Mn){switch(Mn){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ym(Mn,On){if(Mn===0)switch(On){case"svg":return 1;case"math":return 2;default:return 0}return Mn===1&&On==="foreignObject"?0:Mn}function Kd(Mn,On){return Mn==="textarea"||Mn==="noscript"||typeof On.children=="string"||typeof On.children=="number"||typeof On.children=="bigint"||typeof On.dangerouslySetInnerHTML=="object"&&On.dangerouslySetInnerHTML!==null&&On.dangerouslySetInnerHTML.__html!=null}var Vd=null;function Cb(){var Mn=window.event;return Mn&&Mn.type==="popstate"?Mn===Vd?!1:(Vd=Mn,!0):(Vd=null,!1)}var bm=typeof setTimeout=="function"?setTimeout:void 0,Nb=typeof clearTimeout=="function"?clearTimeout:void 0,vm=typeof Promise=="function"?Promise:void 0,Rb=typeof queueMicrotask=="function"?queueMicrotask:typeof vm<"u"?function(Mn){return vm.resolve(null).then(Mn).catch(Db)}:bm;function Db(Mn){setTimeout(function(){throw Mn})}function Aa(Mn){return Mn==="head"}function wm(Mn,On){var zn=On,Hn=0;do{var Vn=zn.nextSibling;if(Mn.removeChild(zn),Vn&&Vn.nodeType===8)if(zn=Vn.data,zn==="/$"||zn==="/&"){if(Hn===0){Mn.removeChild(Vn),Uo(On);return}Hn--}else if(zn==="$"||zn==="$?"||zn==="$~"||zn==="$!"||zn==="&")Hn++;else if(zn==="html")_l(Mn.ownerDocument.documentElement);else if(zn==="head"){zn=Mn.ownerDocument.head,_l(zn);for(var Gn=zn.firstChild;Gn;){var Qn=Gn.nextSibling,nr=Gn.nodeName;Gn[cr]||nr==="SCRIPT"||nr==="STYLE"||nr==="LINK"&&Gn.rel.toLowerCase()==="stylesheet"||zn.removeChild(Gn),Gn=Qn}}else zn==="body"&&_l(Mn.ownerDocument.body);zn=Vn}while(zn);Uo(On)}function Em(Mn,On){var zn=Mn;Mn=0;do{var Hn=zn.nextSibling;if(zn.nodeType===1?On?(zn._stashedDisplay=zn.style.display,zn.style.display="none"):(zn.style.display=zn._stashedDisplay||"",zn.getAttribute("style")===""&&zn.removeAttribute("style")):zn.nodeType===3&&(On?(zn._stashedText=zn.nodeValue,zn.nodeValue=""):zn.nodeValue=zn._stashedText||""),Hn&&Hn.nodeType===8)if(zn=Hn.data,zn==="/$"){if(Mn===0)break;Mn--}else zn!=="$"&&zn!=="$?"&&zn!=="$~"&&zn!=="$!"||Mn++;zn=Hn}while(zn)}function jd(Mn){var On=Mn.firstChild;for(On&&On.nodeType===10&&(On=On.nextSibling);On;){var zn=On;switch(On=On.nextSibling,zn.nodeName){case"HTML":case"HEAD":case"BODY":jd(zn),Pr(zn);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(zn.rel.toLowerCase()==="stylesheet")continue}Mn.removeChild(zn)}}function Lb(Mn,On,zn,Hn){for(;Mn.nodeType===1;){var Vn=zn;if(Mn.nodeName.toLowerCase()!==On.toLowerCase()){if(!Hn&&(Mn.nodeName!=="INPUT"||Mn.type!=="hidden"))break}else if(Hn){if(!Mn[cr])switch(On){case"meta":if(!Mn.hasAttribute("itemprop"))break;return Mn;case"link":if(Gn=Mn.getAttribute("rel"),Gn==="stylesheet"&&Mn.hasAttribute("data-precedence"))break;if(Gn!==Vn.rel||Mn.getAttribute("href")!==(Vn.href==null||Vn.href===""?null:Vn.href)||Mn.getAttribute("crossorigin")!==(Vn.crossOrigin==null?null:Vn.crossOrigin)||Mn.getAttribute("title")!==(Vn.title==null?null:Vn.title))break;return Mn;case"style":if(Mn.hasAttribute("data-precedence"))break;return Mn;case"script":if(Gn=Mn.getAttribute("src"),(Gn!==(Vn.src==null?null:Vn.src)||Mn.getAttribute("type")!==(Vn.type==null?null:Vn.type)||Mn.getAttribute("crossorigin")!==(Vn.crossOrigin==null?null:Vn.crossOrigin))&&Gn&&Mn.hasAttribute("async")&&!Mn.hasAttribute("itemprop"))break;return Mn;default:return Mn}}else if(On==="input"&&Mn.type==="hidden"){var Gn=Vn.name==null?null:""+Vn.name;if(Vn.type==="hidden"&&Mn.getAttribute("name")===Gn)return Mn}else return Mn;if(Mn=ws(Mn.nextSibling),Mn===null)break}return null}function Mb(Mn,On,zn){if(On==="")return null;for(;Mn.nodeType!==3;)if((Mn.nodeType!==1||Mn.nodeName!=="INPUT"||Mn.type!=="hidden")&&!zn||(Mn=ws(Mn.nextSibling),Mn===null))return null;return Mn}function $m(Mn,On){for(;Mn.nodeType!==8;)if((Mn.nodeType!==1||Mn.nodeName!=="INPUT"||Mn.type!=="hidden")&&!On||(Mn=ws(Mn.nextSibling),Mn===null))return null;return Mn}function Gd(Mn){return Mn.data==="$?"||Mn.data==="$~"}function Yd(Mn){return Mn.data==="$!"||Mn.data==="$?"&&Mn.ownerDocument.readyState!=="loading"}function Ub(Mn,On){var zn=Mn.ownerDocument;if(Mn.data==="$~")Mn._reactRetry=On;else if(Mn.data!=="$?"||zn.readyState!=="loading")On();else{var Hn=function(){On(),zn.removeEventListener("DOMContentLoaded",Hn)};zn.addEventListener("DOMContentLoaded",Hn),Mn._reactRetry=Hn}}function ws(Mn){for(;Mn!=null;Mn=Mn.nextSibling){var On=Mn.nodeType;if(On===1||On===3)break;if(On===8){if(On=Mn.data,On==="$"||On==="$!"||On==="$?"||On==="$~"||On==="&"||On==="F!"||On==="F")break;if(On==="/$"||On==="/&")return null}}return Mn}var Zd=null;function xm(Mn){Mn=Mn.nextSibling;for(var On=0;Mn;){if(Mn.nodeType===8){var zn=Mn.data;if(zn==="/$"||zn==="/&"){if(On===0)return ws(Mn.nextSibling);On--}else zn!=="$"&&zn!=="$!"&&zn!=="$?"&&zn!=="$~"&&zn!=="&"||On++}Mn=Mn.nextSibling}return null}function km(Mn){Mn=Mn.previousSibling;for(var On=0;Mn;){if(Mn.nodeType===8){var zn=Mn.data;if(zn==="$"||zn==="$!"||zn==="$?"||zn==="$~"||zn==="&"){if(On===0)return Mn;On--}else zn!=="/$"&&zn!=="/&"||On++}Mn=Mn.previousSibling}return null}function Sm(Mn,On,zn){switch(On=Pc(zn),Mn){case"html":if(Mn=On.documentElement,!Mn)throw Error(Un(452));return Mn;case"head":if(Mn=On.head,!Mn)throw Error(Un(453));return Mn;case"body":if(Mn=On.body,!Mn)throw Error(Un(454));return Mn;default:throw Error(Un(451))}}function _l(Mn){for(var On=Mn.attributes;On.length;)Mn.removeAttributeNode(On[0]);Pr(Mn)}var Es=new Map,Am=new Set;function Fc(Mn){return typeof Mn.getRootNode=="function"?Mn.getRootNode():Mn.nodeType===9?Mn:Mn.ownerDocument}var ra=or.d;or.d={f:Ob,r:Bb,D:zb,C:Ib,L:qb,m:Hb,X:Fb,S:Pb,M:Kb};function Ob(){var Mn=ra.f(),On=Mc();return Mn||On}function Bb(Mn){var On=Wr(Mn);On!==null&&On.tag===5&&On.type==="form"?Pp(On):ra.r(Mn)}var Do=typeof document>"u"?null:document;function _m(Mn,On,zn){var Hn=Do;if(Hn&&typeof On=="string"&&On){var Vn=ds(On);Vn='link[rel="'+Mn+'"][href="'+Vn+'"]',typeof zn=="string"&&(Vn+='[crossorigin="'+zn+'"]'),Am.has(Vn)||(Am.add(Vn),Mn={rel:Mn,crossOrigin:zn,href:On},Hn.querySelector(Vn)===null&&(On=Hn.createElement("link"),Ki(On,"link",Mn),ui(On),Hn.head.appendChild(On)))}}function zb(Mn){ra.D(Mn),_m("dns-prefetch",Mn,null)}function Ib(Mn,On){ra.C(Mn,On),_m("preconnect",Mn,On)}function qb(Mn,On,zn){ra.L(Mn,On,zn);var Hn=Do;if(Hn&&Mn&&On){var Vn='link[rel="preload"][as="'+ds(On)+'"]';On==="image"&&zn&&zn.imageSrcSet?(Vn+='[imagesrcset="'+ds(zn.imageSrcSet)+'"]',typeof zn.imageSizes=="string"&&(Vn+='[imagesizes="'+ds(zn.imageSizes)+'"]')):Vn+='[href="'+ds(Mn)+'"]';var Gn=Vn;switch(On){case"style":Gn=Lo(Mn);break;case"script":Gn=Mo(Mn)}Es.has(Gn)||(Mn=Zn({rel:"preload",href:On==="image"&&zn&&zn.imageSrcSet?void 0:Mn,as:On},zn),Es.set(Gn,Mn),Hn.querySelector(Vn)!==null||On==="style"&&Hn.querySelector(Tl(Gn))||On==="script"&&Hn.querySelector(Cl(Gn))||(On=Hn.createElement("link"),Ki(On,"link",Mn),ui(On),Hn.head.appendChild(On)))}}function Hb(Mn,On){ra.m(Mn,On);var zn=Do;if(zn&&Mn){var Hn=On&&typeof On.as=="string"?On.as:"script",Vn='link[rel="modulepreload"][as="'+ds(Hn)+'"][href="'+ds(Mn)+'"]',Gn=Vn;switch(Hn){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":Gn=Mo(Mn)}if(!Es.has(Gn)&&(Mn=Zn({rel:"modulepreload",href:Mn},On),Es.set(Gn,Mn),zn.querySelector(Vn)===null)){switch(Hn){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(zn.querySelector(Cl(Gn)))return}Hn=zn.createElement("link"),Ki(Hn,"link",Mn),ui(Hn),zn.head.appendChild(Hn)}}}function Pb(Mn,On,zn){ra.S(Mn,On,zn);var Hn=Do;if(Hn&&Mn){var Vn=oi(Hn).hoistableStyles,Gn=Lo(Mn);On=On||"default";var Qn=Vn.get(Gn);if(!Qn){var nr={loading:0,preload:null};if(Qn=Hn.querySelector(Tl(Gn)))nr.loading=5;else{Mn=Zn({rel:"stylesheet",href:Mn,"data-precedence":On},zn),(zn=Es.get(Gn))&&Xd(Mn,zn);var hr=Qn=Hn.createElement("link");ui(hr),Ki(hr,"link",Mn),hr._p=new Promise(function(xr,Lr){hr.onload=xr,hr.onerror=Lr}),hr.addEventListener("load",function(){nr.loading|=1}),hr.addEventListener("error",function(){nr.loading|=2}),nr.loading|=4,Kc(Qn,On,Hn)}Qn={type:"stylesheet",instance:Qn,count:1,state:nr},Vn.set(Gn,Qn)}}}function Fb(Mn,On){ra.X(Mn,On);var zn=Do;if(zn&&Mn){var Hn=oi(zn).hoistableScripts,Vn=Mo(Mn),Gn=Hn.get(Vn);Gn||(Gn=zn.querySelector(Cl(Vn)),Gn||(Mn=Zn({src:Mn,async:!0},On),(On=Es.get(Vn))&&Qd(Mn,On),Gn=zn.createElement("script"),ui(Gn),Ki(Gn,"link",Mn),zn.head.appendChild(Gn)),Gn={type:"script",instance:Gn,count:1,state:null},Hn.set(Vn,Gn))}}function Kb(Mn,On){ra.M(Mn,On);var zn=Do;if(zn&&Mn){var Hn=oi(zn).hoistableScripts,Vn=Mo(Mn),Gn=Hn.get(Vn);Gn||(Gn=zn.querySelector(Cl(Vn)),Gn||(Mn=Zn({src:Mn,async:!0,type:"module"},On),(On=Es.get(Vn))&&Qd(Mn,On),Gn=zn.createElement("script"),ui(Gn),Ki(Gn,"link",Mn),zn.head.appendChild(Gn)),Gn={type:"script",instance:Gn,count:1,state:null},Hn.set(Vn,Gn))}}function Tm(Mn,On,zn,Hn){var Vn=(Vn=qr.current)?Fc(Vn):null;if(!Vn)throw Error(Un(446));switch(Mn){case"meta":case"title":return null;case"style":return typeof zn.precedence=="string"&&typeof zn.href=="string"?(On=Lo(zn.href),zn=oi(Vn).hoistableStyles,Hn=zn.get(On),Hn||(Hn={type:"style",instance:null,count:0,state:null},zn.set(On,Hn)),Hn):{type:"void",instance:null,count:0,state:null};case"link":if(zn.rel==="stylesheet"&&typeof zn.href=="string"&&typeof zn.precedence=="string"){Mn=Lo(zn.href);var Gn=oi(Vn).hoistableStyles,Qn=Gn.get(Mn);if(Qn||(Vn=Vn.ownerDocument||Vn,Qn={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},Gn.set(Mn,Qn),(Gn=Vn.querySelector(Tl(Mn)))&&!Gn._p&&(Qn.instance=Gn,Qn.state.loading=5),Es.has(Mn)||(zn={rel:"preload",as:"style",href:zn.href,crossOrigin:zn.crossOrigin,integrity:zn.integrity,media:zn.media,hrefLang:zn.hrefLang,referrerPolicy:zn.referrerPolicy},Es.set(Mn,zn),Gn||Vb(Vn,Mn,zn,Qn.state))),On&&Hn===null)throw Error(Un(528,""));return Qn}if(On&&Hn!==null)throw Error(Un(529,""));return null;case"script":return On=zn.async,zn=zn.src,typeof zn=="string"&&On&&typeof On!="function"&&typeof On!="symbol"?(On=Mo(zn),zn=oi(Vn).hoistableScripts,Hn=zn.get(On),Hn||(Hn={type:"script",instance:null,count:0,state:null},zn.set(On,Hn)),Hn):{type:"void",instance:null,count:0,state:null};default:throw Error(Un(444,Mn))}}function Lo(Mn){return'href="'+ds(Mn)+'"'}function Tl(Mn){return'link[rel="stylesheet"]['+Mn+"]"}function Cm(Mn){return Zn({},Mn,{"data-precedence":Mn.precedence,precedence:null})}function Vb(Mn,On,zn,Hn){Mn.querySelector('link[rel="preload"][as="style"]['+On+"]")?Hn.loading=1:(On=Mn.createElement("link"),Hn.preload=On,On.addEventListener("load",function(){return Hn.loading|=1}),On.addEventListener("error",function(){return Hn.loading|=2}),Ki(On,"link",zn),ui(On),Mn.head.appendChild(On))}function Mo(Mn){return'[src="'+ds(Mn)+'"]'}function Cl(Mn){return"script[async]"+Mn}function Nm(Mn,On,zn){if(On.count++,On.instance===null)switch(On.type){case"style":var Hn=Mn.querySelector('style[data-href~="'+ds(zn.href)+'"]');if(Hn)return On.instance=Hn,ui(Hn),Hn;var Vn=Zn({},zn,{"data-href":zn.href,"data-precedence":zn.precedence,href:null,precedence:null});return Hn=(Mn.ownerDocument||Mn).createElement("style"),ui(Hn),Ki(Hn,"style",Vn),Kc(Hn,zn.precedence,Mn),On.instance=Hn;case"stylesheet":Vn=Lo(zn.href);var Gn=Mn.querySelector(Tl(Vn));if(Gn)return On.state.loading|=4,On.instance=Gn,ui(Gn),Gn;Hn=Cm(zn),(Vn=Es.get(Vn))&&Xd(Hn,Vn),Gn=(Mn.ownerDocument||Mn).createElement("link"),ui(Gn);var Qn=Gn;return Qn._p=new Promise(function(nr,hr){Qn.onload=nr,Qn.onerror=hr}),Ki(Gn,"link",Hn),On.state.loading|=4,Kc(Gn,zn.precedence,Mn),On.instance=Gn;case"script":return Gn=Mo(zn.src),(Vn=Mn.querySelector(Cl(Gn)))?(On.instance=Vn,ui(Vn),Vn):(Hn=zn,(Vn=Es.get(Gn))&&(Hn=Zn({},zn),Qd(Hn,Vn)),Mn=Mn.ownerDocument||Mn,Vn=Mn.createElement("script"),ui(Vn),Ki(Vn,"link",Hn),Mn.head.appendChild(Vn),On.instance=Vn);case"void":return null;default:throw Error(Un(443,On.type))}else On.type==="stylesheet"&&(On.state.loading&4)===0&&(Hn=On.instance,On.state.loading|=4,Kc(Hn,zn.precedence,Mn));return On.instance}function Kc(Mn,On,zn){for(var Hn=zn.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),Vn=Hn.length?Hn[Hn.length-1]:null,Gn=Vn,Qn=0;Qn<Hn.length;Qn++){var nr=Hn[Qn];if(nr.dataset.precedence===On)Gn=nr;else if(Gn!==Vn)break}Gn?Gn.parentNode.insertBefore(Mn,Gn.nextSibling):(On=zn.nodeType===9?zn.head:zn,On.insertBefore(Mn,On.firstChild))}function Xd(Mn,On){Mn.crossOrigin==null&&(Mn.crossOrigin=On.crossOrigin),Mn.referrerPolicy==null&&(Mn.referrerPolicy=On.referrerPolicy),Mn.title==null&&(Mn.title=On.title)}function Qd(Mn,On){Mn.crossOrigin==null&&(Mn.crossOrigin=On.crossOrigin),Mn.referrerPolicy==null&&(Mn.referrerPolicy=On.referrerPolicy),Mn.integrity==null&&(Mn.integrity=On.integrity)}var Vc=null;function Rm(Mn,On,zn){if(Vc===null){var Hn=new Map,Vn=Vc=new Map;Vn.set(zn,Hn)}else Vn=Vc,Hn=Vn.get(zn),Hn||(Hn=new Map,Vn.set(zn,Hn));if(Hn.has(Mn))return Hn;for(Hn.set(Mn,null),zn=zn.getElementsByTagName(Mn),Vn=0;Vn<zn.length;Vn++){var Gn=zn[Vn];if(!(Gn[cr]||Gn[Ti]||Mn==="link"&&Gn.getAttribute("rel")==="stylesheet")&&Gn.namespaceURI!=="http://www.w3.org/2000/svg"){var Qn=Gn.getAttribute(On)||"";Qn=Mn+Qn;var nr=Hn.get(Qn);nr?nr.push(Gn):Hn.set(Qn,[Gn])}}return Hn}function Dm(Mn,On,zn){Mn=Mn.ownerDocument||Mn,Mn.head.insertBefore(zn,On==="title"?Mn.querySelector("head > title"):null)}function jb(Mn,On,zn){if(zn===1||On.itemProp!=null)return!1;switch(Mn){case"meta":case"title":return!0;case"style":if(typeof On.precedence!="string"||typeof On.href!="string"||On.href==="")break;return!0;case"link":if(typeof On.rel!="string"||typeof On.href!="string"||On.href===""||On.onLoad||On.onError)break;return On.rel==="stylesheet"?(Mn=On.disabled,typeof On.precedence=="string"&&Mn==null):!0;case"script":if(On.async&&typeof On.async!="function"&&typeof On.async!="symbol"&&!On.onLoad&&!On.onError&&On.src&&typeof On.src=="string")return!0}return!1}function Lm(Mn){return!(Mn.type==="stylesheet"&&(Mn.state.loading&3)===0)}function Gb(Mn,On,zn,Hn){if(zn.type==="stylesheet"&&(typeof Hn.media!="string"||matchMedia(Hn.media).matches!==!1)&&(zn.state.loading&4)===0){if(zn.instance===null){var Vn=Lo(Hn.href),Gn=On.querySelector(Tl(Vn));if(Gn){On=Gn._p,On!==null&&typeof On=="object"&&typeof On.then=="function"&&(Mn.count++,Mn=jc.bind(Mn),On.then(Mn,Mn)),zn.state.loading|=4,zn.instance=Gn,ui(Gn);return}Gn=On.ownerDocument||On,Hn=Cm(Hn),(Vn=Es.get(Vn))&&Xd(Hn,Vn),Gn=Gn.createElement("link"),ui(Gn);var Qn=Gn;Qn._p=new Promise(function(nr,hr){Qn.onload=nr,Qn.onerror=hr}),Ki(Gn,"link",Hn),zn.instance=Gn}Mn.stylesheets===null&&(Mn.stylesheets=new Map),Mn.stylesheets.set(zn,On),(On=zn.state.preload)&&(zn.state.loading&3)===0&&(Mn.count++,zn=jc.bind(Mn),On.addEventListener("load",zn),On.addEventListener("error",zn))}}var Jd=0;function Yb(Mn,On){return Mn.stylesheets&&Mn.count===0&&Yc(Mn,Mn.stylesheets),0<Mn.count||0<Mn.imgCount?function(zn){var Hn=setTimeout(function(){if(Mn.stylesheets&&Yc(Mn,Mn.stylesheets),Mn.unsuspend){var Gn=Mn.unsuspend;Mn.unsuspend=null,Gn()}},6e4+On);0<Mn.imgBytes&&Jd===0&&(Jd=62500*Tb());var Vn=setTimeout(function(){if(Mn.waitingForImages=!1,Mn.count===0&&(Mn.stylesheets&&Yc(Mn,Mn.stylesheets),Mn.unsuspend)){var Gn=Mn.unsuspend;Mn.unsuspend=null,Gn()}},(Mn.imgBytes>Jd?50:800)+On);return Mn.unsuspend=zn,function(){Mn.unsuspend=null,clearTimeout(Hn),clearTimeout(Vn)}}:null}function jc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Yc(this,this.stylesheets);else if(this.unsuspend){var Mn=this.unsuspend;this.unsuspend=null,Mn()}}}var Gc=null;function Yc(Mn,On){Mn.stylesheets=null,Mn.unsuspend!==null&&(Mn.count++,Gc=new Map,On.forEach(Zb,Mn),Gc=null,jc.call(Mn))}function Zb(Mn,On){if(!(On.state.loading&4)){var zn=Gc.get(Mn);if(zn)var Hn=zn.get(null);else{zn=new Map,Gc.set(Mn,zn);for(var Vn=Mn.querySelectorAll("link[data-precedence],style[data-precedence]"),Gn=0;Gn<Vn.length;Gn++){var Qn=Vn[Gn];(Qn.nodeName==="LINK"||Qn.getAttribute("media")!=="not all")&&(zn.set(Qn.dataset.precedence,Qn),Hn=Qn)}Hn&&zn.set(null,Hn)}Vn=On.instance,Qn=Vn.getAttribute("data-precedence"),Gn=zn.get(Qn)||Hn,Gn===Hn&&zn.set(null,Vn),zn.set(Qn,Vn),this.count++,Hn=jc.bind(this),Vn.addEventListener("load",Hn),Vn.addEventListener("error",Hn),Gn?Gn.parentNode.insertBefore(Vn,Gn.nextSibling):(Mn=Mn.nodeType===9?Mn.head:Mn,Mn.insertBefore(Vn,Mn.firstChild)),On.state.loading|=4}}var Nl={$$typeof:ur,Provider:null,Consumer:null,_currentValue:wr,_currentValue2:wr,_threadCount:0};function Xb(Mn,On,zn,Hn,Vn,Gn,Qn,nr,hr){this.tag=1,this.containerInfo=Mn,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ho(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ho(0),this.hiddenUpdates=Ho(null),this.identifierPrefix=Hn,this.onUncaughtError=Vn,this.onCaughtError=Gn,this.onRecoverableError=Qn,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=hr,this.incompleteTransitions=new Map}function Mm(Mn,On,zn,Hn,Vn,Gn,Qn,nr,hr,xr,Lr,Or){return Mn=new Xb(Mn,On,zn,Qn,hr,xr,Lr,Or,nr),On=1,Gn===!0&&(On|=24),Gn=is(3,null,null,On),Mn.current=Gn,Gn.stateNode=Mn,On=Rh(),On.refCount++,Mn.pooledCache=On,On.refCount++,Gn.memoizedState={element:Hn,isDehydrated:zn,cache:On},Uh(Gn),Mn}function Um(Mn){return Mn?(Mn=uo,Mn):uo}function Om(Mn,On,zn,Hn,Vn,Gn){Vn=Um(Vn),Hn.context===null?Hn.context=Vn:Hn.pendingContext=Vn,Hn=ga(On),Hn.payload={element:zn},Gn=Gn===void 0?null:Gn,Gn!==null&&(Hn.callback=Gn),zn=ma(Mn,Hn,On),zn!==null&&(ts(zn,Mn,On),ll(zn,Mn,On))}function Bm(Mn,On){if(Mn=Mn.memoizedState,Mn!==null&&Mn.dehydrated!==null){var zn=Mn.retryLane;Mn.retryLane=zn!==0&&zn<On?zn:On}}function Wd(Mn,On){Bm(Mn,On),(Mn=Mn.alternate)&&Bm(Mn,On)}function zm(Mn){if(Mn.tag===13||Mn.tag===31){var On=za(Mn,67108864);On!==null&&ts(On,Mn,67108864),Wd(Mn,67108864)}}function Im(Mn){if(Mn.tag===13||Mn.tag===31){var On=cs();On=$s(On);var zn=za(Mn,On);zn!==null&&ts(zn,Mn,On),Wd(Mn,On)}}var Zc=!0;function Qb(Mn,On,zn,Hn){var Vn=er.T;er.T=null;var Gn=or.p;try{or.p=2,tf(Mn,On,zn,Hn)}finally{or.p=Gn,er.T=Vn}}function Jb(Mn,On,zn,Hn){var Vn=er.T;er.T=null;var Gn=or.p;try{or.p=8,tf(Mn,On,zn,Hn)}finally{or.p=Gn,er.T=Vn}}function tf(Mn,On,zn,Hn){if(Zc){var Vn=ef(Hn);if(Vn===null)qd(Mn,On,Hn,Xc,zn),Hm(Mn,Hn);else if(p0(Vn,Mn,On,zn,Hn))Hn.stopPropagation();else if(Hm(Mn,Hn),On&4&&-1<Wb.indexOf(Mn)){for(;Vn!==null;){var Gn=Wr(Vn);if(Gn!==null)switch(Gn.tag){case 3:if(Gn=Gn.stateNode,Gn.current.memoizedState.isDehydrated){var Qn=ns(Gn.pendingLanes);if(Qn!==0){var nr=Gn;for(nr.pendingLanes|=2,nr.entangledLanes|=2;Qn;){var hr=1<<31-_i(Qn);nr.entanglements[1]|=hr,Qn&=~hr}Ls(Gn),(ai&6)===0&&(Dc=qi()+500,kl(0))}}break;case 31:case 13:nr=za(Gn,2),nr!==null&&ts(nr,Gn,2),Mc(),Wd(Gn,2)}if(Gn=ef(Hn),Gn===null&&qd(Mn,On,Hn,Xc,zn),Gn===Vn)break;Vn=Gn}Vn!==null&&Hn.stopPropagation()}else qd(Mn,On,Hn,null,zn)}}function ef(Mn){return Mn=rh(Mn),nf(Mn)}var Xc=null;function nf(Mn){if(Xc=null,Mn=Ir(Mn),Mn!==null){var On=In(Mn);if(On===null)Mn=null;else{var zn=On.tag;if(zn===13){if(Mn=qn(On),Mn!==null)return Mn;Mn=null}else if(zn===31){if(Mn=Fn(On),Mn!==null)return Mn;Mn=null}else if(zn===3){if(On.stateNode.current.memoizedState.isDehydrated)return On.tag===3?On.stateNode.containerInfo:null;Mn=null}else On!==Mn&&(Mn=null)}}return Xc=Mn,null}function qm(Mn){switch(Mn){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(La()){case Us:return 2;case es:return 8;case oa:case Ol:return 32;case Bo:return 268435456;default:return 32}default:return 32}}var rf=!1,Ta=null,Ca=null,Na=null,Rl=new Map,Dl=new Map,Ra=[],Wb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Hm(Mn,On){switch(Mn){case"focusin":case"focusout":Ta=null;break;case"dragenter":case"dragleave":Ca=null;break;case"mouseover":case"mouseout":Na=null;break;case"pointerover":case"pointerout":Rl.delete(On.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dl.delete(On.pointerId)}}function Ll(Mn,On,zn,Hn,Vn,Gn){return Mn===null||Mn.nativeEvent!==Gn?(Mn={blockedOn:On,domEventName:zn,eventSystemFlags:Hn,nativeEvent:Gn,targetContainers:[Vn]},On!==null&&(On=Wr(On),On!==null&&zm(On)),Mn):(Mn.eventSystemFlags|=Hn,On=Mn.targetContainers,Vn!==null&&On.indexOf(Vn)===-1&&On.push(Vn),Mn)}function p0(Mn,On,zn,Hn,Vn){switch(On){case"focusin":return Ta=Ll(Ta,Mn,On,zn,Hn,Vn),!0;case"dragenter":return Ca=Ll(Ca,Mn,On,zn,Hn,Vn),!0;case"mouseover":return Na=Ll(Na,Mn,On,zn,Hn,Vn),!0;case"pointerover":var Gn=Vn.pointerId;return Rl.set(Gn,Ll(Rl.get(Gn)||null,Mn,On,zn,Hn,Vn)),!0;case"gotpointercapture":return Gn=Vn.pointerId,Dl.set(Gn,Ll(Dl.get(Gn)||null,Mn,On,zn,Hn,Vn)),!0}return!1}function Pm(Mn){var On=Ir(Mn.target);if(On!==null){var zn=In(On);if(zn!==null){if(On=zn.tag,On===13){if(On=qn(zn),On!==null){Mn.blockedOn=On,jo(Mn.priority,function(){Im(zn)});return}}else if(On===31){if(On=Fn(zn),On!==null){Mn.blockedOn=On,jo(Mn.priority,function(){Im(zn)});return}}else if(On===3&&zn.stateNode.current.memoizedState.isDehydrated){Mn.blockedOn=zn.tag===3?zn.stateNode.containerInfo:null;return}}}Mn.blockedOn=null}function Qc(Mn){if(Mn.blockedOn!==null)return!1;for(var On=Mn.targetContainers;0<On.length;){var zn=ef(Mn.nativeEvent);if(zn===null){zn=Mn.nativeEvent;var Hn=new zn.constructor(zn.type,zn);nh=Hn,zn.target.dispatchEvent(Hn),nh=null}else return On=Wr(zn),On!==null&&zm(On),Mn.blockedOn=zn,!1;On.shift()}return!0}function Fm(Mn,On,zn){Qc(Mn)&&zn.delete(On)}function g0(){rf=!1,Ta!==null&&Qc(Ta)&&(Ta=null),Ca!==null&&Qc(Ca)&&(Ca=null),Na!==null&&Qc(Na)&&(Na=null),Rl.forEach(Fm),Dl.forEach(Fm)}function Jc(Mn,On){Mn.blockedOn===On&&(Mn.blockedOn=null,rf||(rf=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,g0)))}var Wc=null;function Km(Mn){Wc!==Mn&&(Wc=Mn,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Wc===Mn&&(Wc=null);for(var On=0;On<Mn.length;On+=3){var zn=Mn[On],Hn=Mn[On+1],Vn=Mn[On+2];if(typeof Hn!="function"){if(nf(Hn||zn)===null)continue;break}var Gn=Wr(zn);Gn!==null&&(Mn.splice(On,3),On-=3,ed(Gn,{pending:!0,data:Vn,method:zn.method,action:Hn},Hn,Vn))}}))}function Uo(Mn){function On(hr){return Jc(hr,Mn)}Ta!==null&&Jc(Ta,Mn),Ca!==null&&Jc(Ca,Mn),Na!==null&&Jc(Na,Mn),Rl.forEach(On),Dl.forEach(On);for(var zn=0;zn<Ra.length;zn++){var Hn=Ra[zn];Hn.blockedOn===Mn&&(Hn.blockedOn=null)}for(;0<Ra.length&&(zn=Ra[0],zn.blockedOn===null);)Pm(zn),zn.blockedOn===null&&Ra.shift();if(zn=(Mn.ownerDocument||Mn).$$reactFormReplay,zn!=null)for(Hn=0;Hn<zn.length;Hn+=3){var Vn=zn[Hn],Gn=zn[Hn+1],Qn=Vn[yi]||null;if(typeof Gn=="function")Qn||Km(zn);else if(Qn){var nr=null;if(Gn&&Gn.hasAttribute("formAction")){if(Vn=Gn,Qn=Gn[yi]||null)nr=Qn.formAction;else if(nf(Vn)!==null)continue}else nr=Qn.action;typeof nr=="function"?zn[Hn+1]=nr:(zn.splice(Hn,3),Hn-=3),Km(zn)}}}function Vm(){function Mn(Gn){Gn.canIntercept&&Gn.info==="react-transition"&&Gn.intercept({handler:function(){return new Promise(function(Qn){return Vn=Qn})},focusReset:"manual",scroll:"manual"})}function On(){Vn!==null&&(Vn(),Vn=null),Hn||setTimeout(zn,20)}function zn(){if(!Hn&&!navigation.transition){var Gn=navigation.currentEntry;Gn&&Gn.url!=null&&navigation.navigate(Gn.url,{state:Gn.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var Hn=!1,Vn=null;return navigation.addEventListener("navigate",Mn),navigation.addEventListener("navigatesuccess",On),navigation.addEventListener("navigateerror",On),setTimeout(zn,100),function(){Hn=!0,navigation.removeEventListener("navigate",Mn),navigation.removeEventListener("navigatesuccess",On),navigation.removeEventListener("navigateerror",On),Vn!==null&&(Vn(),Vn=null)}}}function sf(Mn){this._internalRoot=Mn}tu.prototype.render=sf.prototype.render=function(Mn){var On=this._internalRoot;if(On===null)throw Error(Un(409));var zn=On.current,Hn=cs();Om(zn,Hn,Mn,On,null,null)},tu.prototype.unmount=sf.prototype.unmount=function(){var Mn=this._internalRoot;if(Mn!==null){this._internalRoot=null;var On=Mn.containerInfo;Om(Mn.current,2,null,Mn,null,null),Mc(),On[Is]=null}};function tu(Mn){this._internalRoot=Mn}tu.prototype.unstable_scheduleHydration=function(Mn){if(Mn){var On=Vo();Mn={blockedOn:null,target:Mn,priority:On};for(var zn=0;zn<Ra.length&&On!==0&&On<Ra[zn].priority;zn++);Ra.splice(zn,0,Mn),zn===0&&Pm(Mn)}};var jm=$n.version;if(jm!=="19.2.3")throw Error(Un(527,jm,"19.2.3"));or.findDOMNode=function(Mn){var On=Mn._reactInternals;if(On===void 0)throw typeof Mn.render=="function"?Error(Un(188)):(Mn=Object.keys(Mn).join(","),Error(Un(268,Mn)));return Mn=jn(On),Mn=Mn!==null?Yn(Mn):null,Mn=Mn===null?null:Mn.stateNode,Mn};var m0={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:er,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hu.isDisabled&&hu.supportsFiber)try{Cs=hu.inject(m0),Ui=hu}catch{}}return reactDomClient_production.createRoot=function(Mn,On){if(!Bn(Mn))throw Error(Un(299));var zn=!1,Hn="",Vn=Wp,Gn=tg,Qn=eg;return On!=null&&(On.unstable_strictMode===!0&&(zn=!0),On.identifierPrefix!==void 0&&(Hn=On.identifierPrefix),On.onUncaughtError!==void 0&&(Vn=On.onUncaughtError),On.onCaughtError!==void 0&&(Gn=On.onCaughtError),On.onRecoverableError!==void 0&&(Qn=On.onRecoverableError)),On=Mm(Mn,1,!1,null,null,zn,Hn,null,Vn,Gn,Qn,Vm),Mn[Is]=On.current,Id(Mn),new sf(On)},reactDomClient_production.hydrateRoot=function(Mn,On,zn){if(!Bn(Mn))throw Error(Un(299));var Hn=!1,Vn="",Gn=Wp,Qn=tg,nr=eg,hr=null;return zn!=null&&(zn.unstable_strictMode===!0&&(Hn=!0),zn.identifierPrefix!==void 0&&(Vn=zn.identifierPrefix),zn.onUncaughtError!==void 0&&(Gn=zn.onUncaughtError),zn.onCaughtError!==void 0&&(Qn=zn.onCaughtError),zn.onRecoverableError!==void 0&&(nr=zn.onRecoverableError),zn.formState!==void 0&&(hr=zn.formState)),On=Mm(Mn,1,!0,On,zn??null,Hn,Vn,hr,Gn,Qn,nr,Vm),On.context=Um(null),zn=On.current,Hn=cs(),Hn=$s(Hn),Vn=ga(Hn),Vn.callback=null,ma(zn,Vn,Hn),zn=Hn,On.current.lanes=zn,la(On,zn),Ls(On),Mn[Is]=On.current,Id(Mn),new tu(On)},reactDomClient_production.version="19.2.3",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch($n){console.error($n)}}return s(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient(),je$2=Object.defineProperty,qe$3=(s,$n,Dn)=>$n in s?je$2(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,g$3=(s,$n,Dn)=>qe$3(s,typeof $n!="symbol"?$n+"":$n,Dn),commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var lib$1={},types={};Object.defineProperty(types,"__esModule",{value:!0});var ee={},taskCollection$1={},taskCollection={},utils$1={};Object.defineProperty(utils$1,"__esModule",{value:!0});utils$1._fast_remove_single=void 0;function _fast_remove_single(s,$n){$n!==-1&&($n===0?s.shift():$n===s.length-1?s.length=s.length-1:s.splice($n,1))}utils$1._fast_remove_single=_fast_remove_single;var bakeCollection={};(function(exports$1){Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.bakeCollectionVariadic=exports$1.bakeCollectionAwait=exports$1.bakeCollection=exports$1.BAKED_EMPTY_FUNC=void 0,exports$1.BAKED_EMPTY_FUNC=function(){};var FORLOOP_FALLBACK=1500;function generateArgsDefCode(s){var $n="";if(s===0)return $n;for(var Dn=0;Dn<s-1;++Dn)$n+="arg"+String(Dn)+", ";return $n+="arg"+String(s-1),$n}function generateBodyPartsCode(s,$n){for(var Dn="",Un="",Bn=0;Bn<$n;++Bn)Dn+="var f".concat(Bn," = collection[").concat(Bn,`];
`),Un+="f".concat(Bn,"(").concat(s,`)
`);return{funcDefCode:Dn,funcCallCode:Un}}function generateBodyPartsVariadicCode(s){for(var $n="",Dn="",Un=0;Un<s;++Un)$n+="var f".concat(Un," = collection[").concat(Un,`];
`),Dn+="f".concat(Un,`.apply(undefined, arguments)
`);return{funcDefCode:$n,funcCallCode:Dn}}function bakeCollection(collection,fixedArgsNum){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                `).concat(funcCallCode,`
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);collection.length%10===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 10) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                        collection[i+4](`).concat(argsDefCode,`);
                        collection[i+5](`).concat(argsDefCode,`);
                        collection[i+6](`).concat(argsDefCode,`);
                        collection[i+7](`).concat(argsDefCode,`);
                        collection[i+8](`).concat(argsDefCode,`);
                        collection[i+9](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%4===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 4) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%3===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 3) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                    }
                });
            })`):funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; ++i) {
                        collection[i](`).concat(argsDefCode,`);
                    }
                });
            })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollection=bakeCollection;function bakeCollectionAwait(collection,fixedArgsNum){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                return Promise.all([ `).concat(funcCallCode,` ]);
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=`(function(collection) {
            return (function(`.concat(argsDefCode,`) {
                var promises = Array(collection.length);
                for (var i = 0; i < collection.length; ++i) {
                    promises[i] = collection[i](`).concat(argsDefCode,`);
                }
                return Promise.all(promises);
            });
        })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollectionAwait=bakeCollectionAwait;function bakeCollectionVariadic(collection){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function() {
                `).concat(funcCallCode,`
            });
        })`)}else funcFactoryCode=`(function(collection) {
            return (function() {
                for (var i = 0; i < collection.length; ++i) {
                    collection[i].apply(undefined, arguments);
                }
            });
        })`;{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollectionVariadic=bakeCollectionVariadic})(bakeCollection);var __spreadArray$1=commonjsGlobal&&commonjsGlobal.__spreadArray||function(s,$n,Dn){if(Dn||arguments.length===2)for(var Un=0,Bn=$n.length,In;Un<Bn;Un++)(In||!(Un in $n))&&(In||(In=Array.prototype.slice.call($n,0,Un)),In[Un]=$n[Un]);return s.concat(In||Array.prototype.slice.call($n))};Object.defineProperty(taskCollection,"__esModule",{value:!0});taskCollection.TaskCollection=void 0;var utils_1$1=utils$1,bake_collection_1=bakeCollection;function push_norebuild(s,$n){var Dn=this.length;if(Dn>1)if($n){var Un;(Un=this._tasks).push.apply(Un,arguments),this.length+=arguments.length}else this._tasks.push(s),this.length++;else if($n){if(Dn===1){var Bn=Array(1+arguments.length);Bn.push(Bn),Bn.push.apply(Bn,arguments),this._tasks=Bn}else{var Bn=Array(arguments.length);Bn.push.apply(Bn,arguments),this._tasks=Bn}this.length+=arguments.length}else Dn===1?this._tasks=[this._tasks,s]:this._tasks=s,this.length++}function push_rebuild(s,$n){var Dn=this.length;if(Dn>1)if($n){var Un;(Un=this._tasks).push.apply(Un,arguments),this.length+=arguments.length}else this._tasks.push(s),this.length++;else if($n){if(Dn===1){var Bn=Array(1+arguments.length);Bn.push(Bn),Bn.push.apply(Bn,arguments),this._tasks=Bn}else{var Bn=Array(arguments.length);Bn.push.apply(Bn,arguments),this._tasks=Bn}this.length+=arguments.length}else Dn===1?this._tasks=[this._tasks,s]:this._tasks=s,this.length++;this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}function removeLast_norebuild(s){this.length!==0&&(this.length===1?this._tasks===s&&(this.length=0):((0,utils_1$1._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(s)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function removeLast_rebuild(s){if(this.length!==0){if(this.length===1)if(this._tasks===s&&(this.length=0),this.firstEmitBuildStrategy){this.call=bake_collection_1.BAKED_EMPTY_FUNC;return}else{this.rebuild();return}else(0,utils_1$1._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(s)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length;this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}}function insert_norebuild(s){for(var $n,Dn=[],Un=1;Un<arguments.length;Un++)Dn[Un-1]=arguments[Un];this.length===0?(this._tasks=Dn,this.length=1):this.length===1?(Dn.unshift(this._tasks),this._tasks=Dn,this.length=this._tasks.length):(($n=this._tasks).splice.apply($n,__spreadArray$1([s,0],Dn,!1)),this.length=this._tasks.length)}function insert_rebuild(s){for(var $n,Dn=[],Un=1;Un<arguments.length;Un++)Dn[Un-1]=arguments[Un];this.length===0?(this._tasks=Dn,this.length=1):this.length===1?(Dn.unshift(this._tasks),this._tasks=Dn,this.length=this._tasks.length):(($n=this._tasks).splice.apply($n,__spreadArray$1([s,0],Dn,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}function rebuild_noawait(){this.length===0?this.call=bake_collection_1.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,bake_collection_1.bakeCollection)(this._tasks,this.argsNum)}function rebuild_await(){this.length===0?this.call=bake_collection_1.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,bake_collection_1.bakeCollectionAwait)(this._tasks,this.argsNum)}function rebuild_on_first_call(){this.rebuild(),this.call.apply(void 0,arguments)}var TaskCollection=(function(){function s($n,Dn,Un,Bn){Dn===void 0&&(Dn=!0),Un===void 0&&(Un=null),Bn===void 0&&(Bn=!1),this.awaitTasks=Bn,this.call=bake_collection_1.BAKED_EMPTY_FUNC,this.argsNum=$n,this.firstEmitBuildStrategy=!0,Bn?this.rebuild=rebuild_await.bind(this):this.rebuild=rebuild_noawait.bind(this),this.setAutoRebuild(Dn),Un?typeof Un=="function"?(this._tasks=Un,this.length=1):(this._tasks=Un,this.length=Un.length):(this._tasks=null,this.length=0),Dn&&this.rebuild()}return s})();taskCollection.TaskCollection=TaskCollection;function fastClear(){this._tasks=null,this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC}function clear(){this._tasks=null,this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC}function growArgsNum(s){this.argsNum<s&&(this.argsNum=s,this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild())}function setAutoRebuild(s){s?(this.push=push_rebuild.bind(this),this.insert=insert_rebuild.bind(this),this.removeLast=removeLast_rebuild.bind(this)):(this.push=push_norebuild.bind(this),this.insert=insert_norebuild.bind(this),this.removeLast=removeLast_norebuild.bind(this))}function tasksAsArray(){return this.length===0?[]:this.length===1?[this._tasks]:this._tasks}function setTasks(s){s.length===0?(this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC):s.length===1?(this.length=1,this.call=s[0],this._tasks=s[0]):(this.length=s.length,this._tasks=s,this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild())}TaskCollection.prototype.fastClear=fastClear;TaskCollection.prototype.clear=clear;TaskCollection.prototype.growArgsNum=growArgsNum;TaskCollection.prototype.setAutoRebuild=setAutoRebuild;TaskCollection.prototype.tasksAsArray=tasksAsArray;TaskCollection.prototype.setTasks=setTasks;(function(s){var $n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(Un,Bn,In,qn){qn===void 0&&(qn=In);var Fn=Object.getOwnPropertyDescriptor(Bn,In);(!Fn||("get"in Fn?!Bn.__esModule:Fn.writable||Fn.configurable))&&(Fn={enumerable:!0,get:function(){return Bn[In]}}),Object.defineProperty(Un,qn,Fn)}:function(Un,Bn,In,qn){qn===void 0&&(qn=In),Un[qn]=Bn[In]}),Dn=commonjsGlobal&&commonjsGlobal.__exportStar||function(Un,Bn){for(var In in Un)In!=="default"&&!Object.prototype.hasOwnProperty.call(Bn,In)&&$n(Bn,Un,In)};Object.defineProperty(s,"__esModule",{value:!0}),Dn(taskCollection,s)})(taskCollection$1);var utils={};Object.defineProperty(utils,"__esModule",{value:!0});utils.nullObj=void 0;function nullObj(){var s={};return s.__proto__=null,s}utils.nullObj=nullObj;var __spreadArray=commonjsGlobal&&commonjsGlobal.__spreadArray||function(s,$n,Dn){if(Dn||arguments.length===2)for(var Un=0,Bn=$n.length,In;Un<Bn;Un++)(In||!(Un in $n))&&(In||(In=Array.prototype.slice.call($n,0,Un)),In[Un]=$n[Un]);return s.concat(In||Array.prototype.slice.call($n))};Object.defineProperty(ee,"__esModule",{value:!0});ee.EventEmitter=void 0;var task_collection_1=taskCollection$1,utils_1=utils$1,utils_2=utils;function emit(s,$n,Dn,Un,Bn,In){var qn=this.events[s];if(qn){if(qn.length===0)return!1;if(qn.argsNum<6)qn.call($n,Dn,Un,Bn,In);else{for(var Fn=new Array(qn.argsNum),Kn=0,jn=Fn.length;Kn<jn;++Kn)Fn[Kn]=arguments[Kn+1];qn.call.apply(void 0,Fn)}return!0}return!1}function emitHasOnce(s,$n,Dn,Un,Bn,In){var qn=this.events[s],Fn;if(qn!==void 0){if(qn.length===0)return!1;if(qn.argsNum<6)qn.call($n,Dn,Un,Bn,In);else{Fn=new Array(qn.argsNum);for(var Kn=0,jn=Fn.length;Kn<jn;++Kn)Fn[Kn]=arguments[Kn+1];qn.call.apply(void 0,Fn)}}var Yn=this.onceEvents[s];if(Yn){if(typeof Yn=="function")if(this.onceEvents[s]=void 0,arguments.length<6)Yn($n,Dn,Un,Bn,In);else{if(Fn===void 0){Fn=new Array(arguments.length-1);for(var Kn=0,jn=Fn.length;Kn<jn;++Kn)Fn[Kn]=arguments[Kn+1]}Yn.apply(void 0,Fn)}else{var Zn=Yn;if(this.onceEvents[s]=void 0,arguments.length<6)for(var Kn=0;Kn<Zn.length;++Kn)Zn[Kn]($n,Dn,Un,Bn,In);else{if(Fn===void 0){Fn=new Array(arguments.length-1);for(var Kn=0,jn=Fn.length;Kn<jn;++Kn)Fn[Kn]=arguments[Kn+1]}for(var Kn=0;Kn<Zn.length;++Kn)Zn[Kn].apply(void 0,Fn)}}return!0}return qn!==void 0}var EventEmitter=(function(){function s(){this.events=(0,utils_2.nullObj)(),this.onceEvents=(0,utils_2.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(s.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),s})();ee.EventEmitter=EventEmitter;function once(s,$n){switch(this.emit===emit&&(this.emit=emitHasOnce),typeof this.onceEvents[s]){case"undefined":this.onceEvents[s]=$n,typeof s=="symbol"&&this._symbolKeys.add(s);break;case"function":this.onceEvents[s]=[this.onceEvents[s],$n];break;case"object":this.onceEvents[s].push($n)}return this}function addListener(s,$n,Dn){if(Dn===void 0&&(Dn=$n.length),typeof $n!="function")throw new TypeError("The listener must be a function");var Un=this.events[s];return Un?(Un.push($n),Un.growArgsNum(Dn),this.maxListeners!==1/0&&this.maxListeners<=Un.length&&console.warn('Maximum event listeners for "'.concat(String(s),'" event!'))):(this.events[s]=new task_collection_1.TaskCollection(Dn,!0,$n,!1),typeof s=="symbol"&&this._symbolKeys.add(s)),this}function removeListener(s,$n){var Dn=this.events[s];Dn&&Dn.removeLast($n);var Un=this.onceEvents[s];return Un&&(typeof Un=="function"?this.onceEvents[s]=void 0:typeof Un=="object"&&(Un.length===1&&Un[0]===$n?this.onceEvents[s]=void 0:(0,utils_1._fast_remove_single)(Un,Un.lastIndexOf($n)))),this}function addListenerBound(s,$n,Dn,Un){Dn===void 0&&(Dn=this),Un===void 0&&(Un=$n.length),this.boundFuncs||(this.boundFuncs=new Map);var Bn=$n.bind(Dn);return this.boundFuncs.set($n,Bn),this.addListener(s,Bn,Un)}function removeListenerBound(s,$n){var Dn,Un,Bn=(Dn=this.boundFuncs)===null||Dn===void 0?void 0:Dn.get($n);return(Un=this.boundFuncs)===null||Un===void 0||Un.delete($n),this.removeListener(s,Bn)}function hasListeners(s){return this.events[s]&&!!this.events[s].length}function prependListener(s,$n,Dn){if(Dn===void 0&&(Dn=$n.length),typeof $n!="function")throw new TypeError("The listener must be a function");var Un=this.events[s];return!Un||!(Un instanceof task_collection_1.TaskCollection)?(Un=this.events[s]=new task_collection_1.TaskCollection(Dn,!0,$n,!1),typeof s=="symbol"&&this._symbolKeys.add(s)):(Un.insert(0,$n),Un.growArgsNum(Dn),this.maxListeners!==1/0&&this.maxListeners<=Un.length&&console.warn('Maximum event listeners for "'.concat(String(s),'" event!'))),this}function prependOnceListener(s,$n){this.emit===emit&&(this.emit=emitHasOnce);var Dn=this.onceEvents[s];return Dn?typeof Dn!="object"?(this.onceEvents[s]=[$n,Dn],typeof s=="symbol"&&this._symbolKeys.add(s)):(Dn.unshift($n),this.maxListeners!==1/0&&this.maxListeners<=Dn.length&&console.warn('Maximum event listeners for "'.concat(String(s),'" once event!'))):(this.onceEvents[s]=[$n],typeof s=="symbol"&&this._symbolKeys.add(s)),this}function removeAllListeners(s){return s===void 0?(this.events=(0,utils_2.nullObj)(),this.onceEvents=(0,utils_2.nullObj)(),this._symbolKeys=new Set):(this.events[s]=void 0,this.onceEvents[s]=void 0,typeof s=="symbol"&&this._symbolKeys.delete(s)),this}function setMaxListeners(s){return this.maxListeners=s,this}function getMaxListeners(){return this.maxListeners}function listeners(s){return this.emit===emit?this.events[s]?this.events[s].tasksAsArray().slice():[]:this.events[s]&&this.onceEvents[s]?__spreadArray(__spreadArray([],this.events[s].tasksAsArray(),!0),typeof this.onceEvents[s]=="function"?[this.onceEvents[s]]:this.onceEvents[s],!0):this.events[s]?this.events[s].tasksAsArray():this.onceEvents[s]?typeof this.onceEvents[s]=="function"?[this.onceEvents[s]]:this.onceEvents[s]:[]}function eventNames(){var s=this;if(this.emit===emit){var $n=Object.keys(this.events);return __spreadArray(__spreadArray([],$n,!0),Array.from(this._symbolKeys),!0).filter(function(Un){return Un in s.events&&s.events[Un]&&s.events[Un].length})}else{var $n=Object.keys(this.events).filter(function(Bn){return s.events[Bn]&&s.events[Bn].length}),Dn=Object.keys(this.onceEvents).filter(function(Bn){return s.onceEvents[Bn]&&s.onceEvents[Bn].length});return __spreadArray(__spreadArray(__spreadArray([],$n,!0),Dn,!0),Array.from(this._symbolKeys).filter(function(Bn){return Bn in s.events&&s.events[Bn]&&s.events[Bn].length||Bn in s.onceEvents&&s.onceEvents[Bn]&&s.onceEvents[Bn].length}),!0)}}function listenerCount(s){return this.emit===emit?this.events[s]&&this.events[s].length||0:(this.events[s]&&this.events[s].length||0)+(this.onceEvents[s]&&this.onceEvents[s].length||0)}EventEmitter.prototype.emit=emit;EventEmitter.prototype.on=addListener;EventEmitter.prototype.once=once;EventEmitter.prototype.addListener=addListener;EventEmitter.prototype.removeListener=removeListener;EventEmitter.prototype.addListenerBound=addListenerBound;EventEmitter.prototype.removeListenerBound=removeListenerBound;EventEmitter.prototype.hasListeners=hasListeners;EventEmitter.prototype.prependListener=prependListener;EventEmitter.prototype.prependOnceListener=prependOnceListener;EventEmitter.prototype.off=removeListener;EventEmitter.prototype.removeAllListeners=removeAllListeners;EventEmitter.prototype.setMaxListeners=setMaxListeners;EventEmitter.prototype.getMaxListeners=getMaxListeners;EventEmitter.prototype.listeners=listeners;EventEmitter.prototype.eventNames=eventNames;EventEmitter.prototype.listenerCount=listenerCount;(function(s){var $n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(Un,Bn,In,qn){qn===void 0&&(qn=In);var Fn=Object.getOwnPropertyDescriptor(Bn,In);(!Fn||("get"in Fn?!Bn.__esModule:Fn.writable||Fn.configurable))&&(Fn={enumerable:!0,get:function(){return Bn[In]}}),Object.defineProperty(Un,qn,Fn)}:function(Un,Bn,In,qn){qn===void 0&&(qn=In),Un[qn]=Bn[In]}),Dn=commonjsGlobal&&commonjsGlobal.__exportStar||function(Un,Bn){for(var In in Un)In!=="default"&&!Object.prototype.hasOwnProperty.call(Bn,In)&&$n(Bn,Un,In)};Object.defineProperty(s,"__esModule",{value:!0}),Dn(types,s),Dn(ee,s)})(lib$1);var browser={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var s=1e3,$n=s*60,Dn=$n*60,Un=Dn*24,Bn=Un*7,In=Un*365.25;ms=function(Yn,Zn){Zn=Zn||{};var Xn=typeof Yn;if(Xn==="string"&&Yn.length>0)return qn(Yn);if(Xn==="number"&&isFinite(Yn))return Zn.long?Kn(Yn):Fn(Yn);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Yn))};function qn(Yn){if(Yn=String(Yn),!(Yn.length>100)){var Zn=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Yn);if(Zn){var Xn=parseFloat(Zn[1]),Jn=(Zn[2]||"ms").toLowerCase();switch(Jn){case"years":case"year":case"yrs":case"yr":case"y":return Xn*In;case"weeks":case"week":case"w":return Xn*Bn;case"days":case"day":case"d":return Xn*Un;case"hours":case"hour":case"hrs":case"hr":case"h":return Xn*Dn;case"minutes":case"minute":case"mins":case"min":case"m":return Xn*$n;case"seconds":case"second":case"secs":case"sec":case"s":return Xn*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return Xn;default:return}}}}function Fn(Yn){var Zn=Math.abs(Yn);return Zn>=Un?Math.round(Yn/Un)+"d":Zn>=Dn?Math.round(Yn/Dn)+"h":Zn>=$n?Math.round(Yn/$n)+"m":Zn>=s?Math.round(Yn/s)+"s":Yn+"ms"}function Kn(Yn){var Zn=Math.abs(Yn);return Zn>=Un?jn(Yn,Zn,Un,"day"):Zn>=Dn?jn(Yn,Zn,Dn,"hour"):Zn>=$n?jn(Yn,Zn,$n,"minute"):Zn>=s?jn(Yn,Zn,s,"second"):Yn+" ms"}function jn(Yn,Zn,Xn,Jn){var Wn=Zn>=Xn*1.5;return Math.round(Yn/Xn)+" "+Jn+(Wn?"s":"")}return ms}function setup(s){Dn.debug=Dn,Dn.default=Dn,Dn.coerce=Kn,Dn.disable=qn,Dn.enable=Bn,Dn.enabled=Fn,Dn.humanize=requireMs(),Dn.destroy=jn,Object.keys(s).forEach(Yn=>{Dn[Yn]=s[Yn]}),Dn.names=[],Dn.skips=[],Dn.formatters={};function $n(Yn){let Zn=0;for(let Xn=0;Xn<Yn.length;Xn++)Zn=(Zn<<5)-Zn+Yn.charCodeAt(Xn),Zn|=0;return Dn.colors[Math.abs(Zn)%Dn.colors.length]}Dn.selectColor=$n;function Dn(Yn){let Zn,Xn=null,Jn,Wn;function tr(...ir){if(!tr.enabled)return;const sr=tr,fr=Number(new Date),ur=fr-(Zn||fr);sr.diff=ur,sr.prev=Zn,sr.curr=fr,Zn=fr,ir[0]=Dn.coerce(ir[0]),typeof ir[0]!="string"&&ir.unshift("%O");let br=0;ir[0]=ir[0].replace(/%([a-zA-Z%])/g,(Nr,Ar)=>{if(Nr==="%%")return"%";br++;const _r=Dn.formatters[Ar];if(typeof _r=="function"){const Rr=ir[br];Nr=_r.call(sr,Rr),ir.splice(br,1),br--}return Nr}),Dn.formatArgs.call(sr,ir),(sr.log||Dn.log).apply(sr,ir)}return tr.namespace=Yn,tr.useColors=Dn.useColors(),tr.color=Dn.selectColor(Yn),tr.extend=Un,tr.destroy=Dn.destroy,Object.defineProperty(tr,"enabled",{enumerable:!0,configurable:!1,get:()=>Xn!==null?Xn:(Jn!==Dn.namespaces&&(Jn=Dn.namespaces,Wn=Dn.enabled(Yn)),Wn),set:ir=>{Xn=ir}}),typeof Dn.init=="function"&&Dn.init(tr),tr}function Un(Yn,Zn){const Xn=Dn(this.namespace+(typeof Zn>"u"?":":Zn)+Yn);return Xn.log=this.log,Xn}function Bn(Yn){Dn.save(Yn),Dn.namespaces=Yn,Dn.names=[],Dn.skips=[];const Zn=(typeof Yn=="string"?Yn:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const Xn of Zn)Xn[0]==="-"?Dn.skips.push(Xn.slice(1)):Dn.names.push(Xn)}function In(Yn,Zn){let Xn=0,Jn=0,Wn=-1,tr=0;for(;Xn<Yn.length;)if(Jn<Zn.length&&(Zn[Jn]===Yn[Xn]||Zn[Jn]==="*"))Zn[Jn]==="*"?(Wn=Jn,tr=Xn,Jn++):(Xn++,Jn++);else if(Wn!==-1)Jn=Wn+1,tr++,Xn=tr;else return!1;for(;Jn<Zn.length&&Zn[Jn]==="*";)Jn++;return Jn===Zn.length}function qn(){const Yn=[...Dn.names,...Dn.skips.map(Zn=>"-"+Zn)].join(",");return Dn.enable(""),Yn}function Fn(Yn){for(const Zn of Dn.skips)if(In(Yn,Zn))return!1;for(const Zn of Dn.names)if(In(Yn,Zn))return!0;return!1}function Kn(Yn){return Yn instanceof Error?Yn.stack||Yn.message:Yn}function jn(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return Dn.enable(Dn.load()),Dn}var common=setup;(function(s,$n){var Dn={};$n.formatArgs=Bn,$n.save=In,$n.load=qn,$n.useColors=Un,$n.storage=Fn(),$n.destroy=(()=>{let jn=!1;return()=>{jn||(jn=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),$n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Un(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let jn;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(jn=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(jn[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Bn(jn){if(jn[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+jn[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!this.useColors)return;const Yn="color: "+this.color;jn.splice(1,0,Yn,"color: inherit");let Zn=0,Xn=0;jn[0].replace(/%[a-zA-Z%]/g,Jn=>{Jn!=="%%"&&(Zn++,Jn==="%c"&&(Xn=Zn))}),jn.splice(Xn,0,Yn)}$n.log=console.debug||console.log||(()=>{});function In(jn){try{jn?$n.storage.setItem("debug",jn):$n.storage.removeItem("debug")}catch{}}function qn(){let jn;try{jn=$n.storage.getItem("debug")||$n.storage.getItem("DEBUG")}catch{}return!jn&&typeof process<"u"&&"env"in process&&(jn=Dn.DEBUG),jn}function Fn(){try{return localStorage}catch{}}s.exports=common($n);const{formatters:Kn}=s.exports;Kn.j=function(jn){try{return JSON.stringify(jn)}catch(Yn){return"[UnexpectedJSONParseError]: "+Yn.message}}})(browser,browser.exports);var browserExports=browser.exports;const createDebug5=getDefaultExportFromCjs(browserExports);function number$2(s){if(!Number.isSafeInteger(s)||s<0)throw new Error(`Wrong positive integer: ${s}`)}function bytes$2(s,...$n){if(!(s instanceof Uint8Array))throw new Error("Expected Uint8Array");if($n.length>0&&!$n.includes(s.length))throw new Error(`Expected Uint8Array of length ${$n}, not of length=${s.length}`)}function hash$1(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$2(s.outputLen),number$2(s.blockLen)}function exists$2(s,$n=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if($n&&s.finished)throw new Error("Hash#digest() has already been called")}function output$2(s,$n){bytes$2(s);const Dn=$n.outputLen;if(s.length<Dn)throw new Error(`digestInto() expects output buffer of length at least ${Dn}`)}const crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const u8a$2=s=>s instanceof Uint8Array,createView$3=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),rotr$2=(s,$n)=>s<<32-$n|s>>>$n,isLE$2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$2)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$4(s){if(typeof s!="string")throw new Error(`utf8ToBytes expected string, got ${typeof s}`);return new Uint8Array(new TextEncoder().encode(s))}function toBytes$3(s){if(typeof s=="string"&&(s=utf8ToBytes$4(s)),!u8a$2(s))throw new Error(`expected Uint8Array, got ${typeof s}`);return s}function concatBytes$3(...s){const $n=new Uint8Array(s.reduce((Un,Bn)=>Un+Bn.length,0));let Dn=0;return s.forEach(Un=>{if(!u8a$2(Un))throw new Error("Uint8Array expected");$n.set(Un,Dn),Dn+=Un.length}),$n}let Hash$2=class{clone(){return this._cloneInto()}};function wrapConstructor$1(s){const $n=Un=>s().update(toBytes$3(Un)).digest(),Dn=s();return $n.outputLen=Dn.outputLen,$n.blockLen=Dn.blockLen,$n.create=()=>s(),$n}function randomBytes$2(s=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(s));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$3(s,$n,Dn,Un){if(typeof s.setBigUint64=="function")return s.setBigUint64($n,Dn,Un);const Bn=BigInt(32),In=BigInt(4294967295),qn=Number(Dn>>Bn&In),Fn=Number(Dn&In),Kn=Un?4:0,jn=Un?0:4;s.setUint32($n+Kn,qn,Un),s.setUint32($n+jn,Fn,Un)}let SHA2$1=class extends Hash$2{constructor(s,$n,Dn,Un){super(),this.blockLen=s,this.outputLen=$n,this.padOffset=Dn,this.isLE=Un,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(s),this.view=createView$3(this.buffer)}update(s){exists$2(this);const{view:$n,buffer:Dn,blockLen:Un}=this;s=toBytes$3(s);const Bn=s.length;for(let In=0;In<Bn;){const qn=Math.min(Un-this.pos,Bn-In);if(qn===Un){const Fn=createView$3(s);for(;Un<=Bn-In;In+=Un)this.process(Fn,In);continue}Dn.set(s.subarray(In,In+qn),this.pos),this.pos+=qn,In+=qn,this.pos===Un&&(this.process($n,0),this.pos=0)}return this.length+=s.length,this.roundClean(),this}digestInto(s){exists$2(this),output$2(s,this),this.finished=!0;const{buffer:$n,view:Dn,blockLen:Un,isLE:Bn}=this;let{pos:In}=this;$n[In++]=128,this.buffer.subarray(In).fill(0),this.padOffset>Un-In&&(this.process(Dn,0),In=0);for(let Yn=In;Yn<Un;Yn++)$n[Yn]=0;setBigUint64$3(Dn,Un-8,BigInt(this.length*8),Bn),this.process(Dn,0);const qn=createView$3(s),Fn=this.outputLen;if(Fn%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Kn=Fn/4,jn=this.get();if(Kn>jn.length)throw new Error("_sha2: outputLen bigger than state");for(let Yn=0;Yn<Kn;Yn++)qn.setUint32(4*Yn,jn[Yn],Bn)}digest(){const{buffer:s,outputLen:$n}=this;this.digestInto(s);const Dn=s.slice(0,$n);return this.destroy(),Dn}_cloneInto(s){s||(s=new this.constructor),s.set(...this.get());const{blockLen:$n,buffer:Dn,length:Un,finished:Bn,destroyed:In,pos:qn}=this;return s.length=Un,s.pos=qn,s.finished=Bn,s.destroyed=In,Un%$n&&s.buffer.set(Dn),s}};const Chi$2=(s,$n,Dn)=>s&$n^~s&Dn,Maj$2=(s,$n,Dn)=>s&$n^s&Dn^$n&Dn,SHA256_K$2=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$2=new Uint32Array(64);let SHA256$2=class extends SHA2$1{constructor(){super(64,32,8,!1),this.A=IV$1[0]|0,this.B=IV$1[1]|0,this.C=IV$1[2]|0,this.D=IV$1[3]|0,this.E=IV$1[4]|0,this.F=IV$1[5]|0,this.G=IV$1[6]|0,this.H=IV$1[7]|0}get(){const{A:s,B:$n,C:Dn,D:Un,E:Bn,F:In,G:qn,H:Fn}=this;return[s,$n,Dn,Un,Bn,In,qn,Fn]}set(s,$n,Dn,Un,Bn,In,qn,Fn){this.A=s|0,this.B=$n|0,this.C=Dn|0,this.D=Un|0,this.E=Bn|0,this.F=In|0,this.G=qn|0,this.H=Fn|0}process(s,$n){for(let Yn=0;Yn<16;Yn++,$n+=4)SHA256_W$2[Yn]=s.getUint32($n,!1);for(let Yn=16;Yn<64;Yn++){const Zn=SHA256_W$2[Yn-15],Xn=SHA256_W$2[Yn-2],Jn=rotr$2(Zn,7)^rotr$2(Zn,18)^Zn>>>3,Wn=rotr$2(Xn,17)^rotr$2(Xn,19)^Xn>>>10;SHA256_W$2[Yn]=Wn+SHA256_W$2[Yn-7]+Jn+SHA256_W$2[Yn-16]|0}let{A:Dn,B:Un,C:Bn,D:In,E:qn,F:Fn,G:Kn,H:jn}=this;for(let Yn=0;Yn<64;Yn++){const Zn=rotr$2(qn,6)^rotr$2(qn,11)^rotr$2(qn,25),Xn=jn+Zn+Chi$2(qn,Fn,Kn)+SHA256_K$2[Yn]+SHA256_W$2[Yn]|0,Jn=(rotr$2(Dn,2)^rotr$2(Dn,13)^rotr$2(Dn,22))+Maj$2(Dn,Un,Bn)|0;jn=Kn,Kn=Fn,Fn=qn,qn=In+Xn|0,In=Bn,Bn=Un,Un=Dn,Dn=Xn+Jn|0}Dn=Dn+this.A|0,Un=Un+this.B|0,Bn=Bn+this.C|0,In=In+this.D|0,qn=qn+this.E|0,Fn=Fn+this.F|0,Kn=Kn+this.G|0,jn=jn+this.H|0,this.set(Dn,Un,Bn,In,qn,Fn,Kn,jn)}roundClean(){SHA256_W$2.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$3=wrapConstructor$1(()=>new SHA256$2);const _0n$9=BigInt(0),_1n$9=BigInt(1),_2n$5=BigInt(2),u8a$1=s=>s instanceof Uint8Array,hexes$3=Array.from({length:256},(s,$n)=>$n.toString(16).padStart(2,"0"));function bytesToHex$3(s){if(!u8a$1(s))throw new Error("Uint8Array expected");let $n="";for(let Dn=0;Dn<s.length;Dn++)$n+=hexes$3[s[Dn]];return $n}function numberToHexUnpadded$1(s){const $n=s.toString(16);return $n.length&1?`0${$n}`:$n}function hexToNumber$1(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return BigInt(s===""?"0":`0x${s}`)}function hexToBytes$3(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);const $n=s.length;if($n%2)throw new Error("padded hex string expected, got unpadded hex of length "+$n);const Dn=new Uint8Array($n/2);for(let Un=0;Un<Dn.length;Un++){const Bn=Un*2,In=s.slice(Bn,Bn+2),qn=Number.parseInt(In,16);if(Number.isNaN(qn)||qn<0)throw new Error("Invalid byte sequence");Dn[Un]=qn}return Dn}function bytesToNumberBE$1(s){return hexToNumber$1(bytesToHex$3(s))}function bytesToNumberLE$1(s){if(!u8a$1(s))throw new Error("Uint8Array expected");return hexToNumber$1(bytesToHex$3(Uint8Array.from(s).reverse()))}function numberToBytesBE$1(s,$n){return hexToBytes$3(s.toString(16).padStart($n*2,"0"))}function numberToBytesLE$1(s,$n){return numberToBytesBE$1(s,$n).reverse()}function numberToVarBytesBE(s){return hexToBytes$3(numberToHexUnpadded$1(s))}function ensureBytes$1(s,$n,Dn){let Un;if(typeof $n=="string")try{Un=hexToBytes$3($n)}catch(In){throw new Error(`${s} must be valid hex string, got "${$n}". Cause: ${In}`)}else if(u8a$1($n))Un=Uint8Array.from($n);else throw new Error(`${s} must be hex string or Uint8Array`);const Bn=Un.length;if(typeof Dn=="number"&&Bn!==Dn)throw new Error(`${s} expected ${Dn} bytes, got ${Bn}`);return Un}function concatBytes$2(...s){const $n=new Uint8Array(s.reduce((Un,Bn)=>Un+Bn.length,0));let Dn=0;return s.forEach(Un=>{if(!u8a$1(Un))throw new Error("Uint8Array expected");$n.set(Un,Dn),Dn+=Un.length}),$n}function equalBytes$1(s,$n){if(s.length!==$n.length)return!1;for(let Dn=0;Dn<s.length;Dn++)if(s[Dn]!==$n[Dn])return!1;return!0}function utf8ToBytes$3(s){if(typeof s!="string")throw new Error(`utf8ToBytes expected string, got ${typeof s}`);return new Uint8Array(new TextEncoder().encode(s))}function bitLen$1(s){let $n;for($n=0;s>_0n$9;s>>=_1n$9,$n+=1);return $n}function bitGet(s,$n){return s>>BigInt($n)&_1n$9}const bitSet=(s,$n,Dn)=>s|(Dn?_1n$9:_0n$9)<<BigInt($n),bitMask$1=s=>(_2n$5<<BigInt(s-1))-_1n$9,u8n=s=>new Uint8Array(s),u8fr=s=>Uint8Array.from(s);function createHmacDrbg$1(s,$n,Dn){if(typeof s!="number"||s<2)throw new Error("hashLen must be a number");if(typeof $n!="number"||$n<2)throw new Error("qByteLen must be a number");if(typeof Dn!="function")throw new Error("hmacFn must be a function");let Un=u8n(s),Bn=u8n(s),In=0;const qn=()=>{Un.fill(1),Bn.fill(0),In=0},Fn=(...Yn)=>Dn(Bn,Un,...Yn),Kn=(Yn=u8n())=>{Bn=Fn(u8fr([0]),Yn),Un=Fn(),Yn.length!==0&&(Bn=Fn(u8fr([1]),Yn),Un=Fn())},jn=()=>{if(In++>=1e3)throw new Error("drbg: tried 1000 values");let Yn=0;const Zn=[];for(;Yn<$n;){Un=Fn();const Xn=Un.slice();Zn.push(Xn),Yn+=Un.length}return concatBytes$2(...Zn)};return(Yn,Zn)=>{qn(),Kn(Yn);let Xn;for(;!(Xn=Zn(jn()));)Kn();return qn(),Xn}}const validatorFns={bigint:s=>typeof s=="bigint",function:s=>typeof s=="function",boolean:s=>typeof s=="boolean",string:s=>typeof s=="string",stringOrUint8Array:s=>typeof s=="string"||s instanceof Uint8Array,isSafeInteger:s=>Number.isSafeInteger(s),array:s=>Array.isArray(s),field:(s,$n)=>$n.Fp.isValid(s),hash:s=>typeof s=="function"&&Number.isSafeInteger(s.outputLen)};function validateObject(s,$n,Dn={}){const Un=(Bn,In,qn)=>{const Fn=validatorFns[In];if(typeof Fn!="function")throw new Error(`Invalid validator "${In}", expected function`);const Kn=s[Bn];if(!(qn&&Kn===void 0)&&!Fn(Kn,s))throw new Error(`Invalid param ${String(Bn)}=${Kn} (${typeof Kn}), expected ${In}`)};for(const[Bn,In]of Object.entries($n))Un(Bn,In,!1);for(const[Bn,In]of Object.entries(Dn))Un(Bn,In,!0);return s}const ut$2=Object.freeze(Object.defineProperty({__proto__:null,bitGet,bitLen:bitLen$1,bitMask:bitMask$1,bitSet,bytesToHex:bytesToHex$3,bytesToNumberBE:bytesToNumberBE$1,bytesToNumberLE:bytesToNumberLE$1,concatBytes:concatBytes$2,createHmacDrbg:createHmacDrbg$1,ensureBytes:ensureBytes$1,equalBytes:equalBytes$1,hexToBytes:hexToBytes$3,hexToNumber:hexToNumber$1,numberToBytesBE:numberToBytesBE$1,numberToBytesLE:numberToBytesLE$1,numberToHexUnpadded:numberToHexUnpadded$1,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$3,validateObject},Symbol.toStringTag,{value:"Module"}));const _0n$8=BigInt(0),_1n$8=BigInt(1),_2n$4=BigInt(2),_3n$3=BigInt(3),_4n$2=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);BigInt(9);BigInt(16);function mod$1(s,$n){const Dn=s%$n;return Dn>=_0n$8?Dn:$n+Dn}function pow(s,$n,Dn){if(Dn<=_0n$8||$n<_0n$8)throw new Error("Expected power/modulo > 0");if(Dn===_1n$8)return _0n$8;let Un=_1n$8;for(;$n>_0n$8;)$n&_1n$8&&(Un=Un*s%Dn),s=s*s%Dn,$n>>=_1n$8;return Un}function pow2$1(s,$n,Dn){let Un=s;for(;$n-- >_0n$8;)Un*=Un,Un%=Dn;return Un}function invert$1(s,$n){if(s===_0n$8||$n<=_0n$8)throw new Error(`invert: expected positive integers, got n=${s} mod=${$n}`);let Dn=mod$1(s,$n),Un=$n,Bn=_0n$8,In=_1n$8;for(;Dn!==_0n$8;){const qn=Un/Dn,Fn=Un%Dn,Kn=Bn-In*qn;Un=Dn,Dn=Fn,Bn=In,In=Kn}if(Un!==_1n$8)throw new Error("invert: does not exist");return mod$1(Bn,$n)}function tonelliShanks$1(s){const $n=(s-_1n$8)/_2n$4;let Dn,Un,Bn;for(Dn=s-_1n$8,Un=0;Dn%_2n$4===_0n$8;Dn/=_2n$4,Un++);for(Bn=_2n$4;Bn<s&&pow(Bn,$n,s)!==s-_1n$8;Bn++);if(Un===1){const qn=(s+_1n$8)/_4n$2;return function(Fn,Kn){const jn=Fn.pow(Kn,qn);if(!Fn.eql(Fn.sqr(jn),Kn))throw new Error("Cannot find square root");return jn}}const In=(Dn+_1n$8)/_2n$4;return function(qn,Fn){if(qn.pow(Fn,$n)===qn.neg(qn.ONE))throw new Error("Cannot find square root");let Kn=Un,jn=qn.pow(qn.mul(qn.ONE,Bn),Dn),Yn=qn.pow(Fn,In),Zn=qn.pow(Fn,Dn);for(;!qn.eql(Zn,qn.ONE);){if(qn.eql(Zn,qn.ZERO))return qn.ZERO;let Xn=1;for(let Wn=qn.sqr(Zn);Xn<Kn&&!qn.eql(Wn,qn.ONE);Xn++)Wn=qn.sqr(Wn);const Jn=qn.pow(jn,_1n$8<<BigInt(Kn-Xn-1));jn=qn.sqr(Jn),Yn=qn.mul(Yn,Jn),Zn=qn.mul(Zn,jn),Kn=Xn}return Yn}}function FpSqrt$1(s){if(s%_4n$2===_3n$3){const $n=(s+_1n$8)/_4n$2;return function(Dn,Un){const Bn=Dn.pow(Un,$n);if(!Dn.eql(Dn.sqr(Bn),Un))throw new Error("Cannot find square root");return Bn}}if(s%_8n$1===_5n$1){const $n=(s-_5n$1)/_8n$1;return function(Dn,Un){const Bn=Dn.mul(Un,_2n$4),In=Dn.pow(Bn,$n),qn=Dn.mul(Un,In),Fn=Dn.mul(Dn.mul(qn,_2n$4),In),Kn=Dn.mul(qn,Dn.sub(Fn,Dn.ONE));if(!Dn.eql(Dn.sqr(Kn),Un))throw new Error("Cannot find square root");return Kn}}return tonelliShanks$1(s)}const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(s){const $n={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},Dn=FIELD_FIELDS$1.reduce((Un,Bn)=>(Un[Bn]="function",Un),$n);return validateObject(s,Dn)}function FpPow$1(s,$n,Dn){if(Dn<_0n$8)throw new Error("Expected power > 0");if(Dn===_0n$8)return s.ONE;if(Dn===_1n$8)return $n;let Un=s.ONE,Bn=$n;for(;Dn>_0n$8;)Dn&_1n$8&&(Un=s.mul(Un,Bn)),Bn=s.sqr(Bn),Dn>>=_1n$8;return Un}function FpInvertBatch$1(s,$n){const Dn=new Array($n.length),Un=$n.reduce((In,qn,Fn)=>s.is0(qn)?In:(Dn[Fn]=In,s.mul(In,qn)),s.ONE),Bn=s.inv(Un);return $n.reduceRight((In,qn,Fn)=>s.is0(qn)?In:(Dn[Fn]=s.mul(In,Dn[Fn]),s.mul(In,qn)),Bn),Dn}function nLength$1(s,$n){const Dn=$n!==void 0?$n:s.toString(2).length,Un=Math.ceil(Dn/8);return{nBitLength:Dn,nByteLength:Un}}function Field$1(s,$n,Dn=!1,Un={}){if(s<=_0n$8)throw new Error(`Expected Field ORDER > 0, got ${s}`);const{nBitLength:Bn,nByteLength:In}=nLength$1(s,$n);if(In>2048)throw new Error("Field lengths over 2048 bytes are not supported");const qn=FpSqrt$1(s),Fn=Object.freeze({ORDER:s,BITS:Bn,BYTES:In,MASK:bitMask$1(Bn),ZERO:_0n$8,ONE:_1n$8,create:Kn=>mod$1(Kn,s),isValid:Kn=>{if(typeof Kn!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof Kn}`);return _0n$8<=Kn&&Kn<s},is0:Kn=>Kn===_0n$8,isOdd:Kn=>(Kn&_1n$8)===_1n$8,neg:Kn=>mod$1(-Kn,s),eql:(Kn,jn)=>Kn===jn,sqr:Kn=>mod$1(Kn*Kn,s),add:(Kn,jn)=>mod$1(Kn+jn,s),sub:(Kn,jn)=>mod$1(Kn-jn,s),mul:(Kn,jn)=>mod$1(Kn*jn,s),pow:(Kn,jn)=>FpPow$1(Fn,Kn,jn),div:(Kn,jn)=>mod$1(Kn*invert$1(jn,s),s),sqrN:Kn=>Kn*Kn,addN:(Kn,jn)=>Kn+jn,subN:(Kn,jn)=>Kn-jn,mulN:(Kn,jn)=>Kn*jn,inv:Kn=>invert$1(Kn,s),sqrt:Un.sqrt||(Kn=>qn(Fn,Kn)),invertBatch:Kn=>FpInvertBatch$1(Fn,Kn),cmov:(Kn,jn,Yn)=>Yn?jn:Kn,toBytes:Kn=>Dn?numberToBytesLE$1(Kn,In):numberToBytesBE$1(Kn,In),fromBytes:Kn=>{if(Kn.length!==In)throw new Error(`Fp.fromBytes: expected ${In}, got ${Kn.length}`);return Dn?bytesToNumberLE$1(Kn):bytesToNumberBE$1(Kn)}});return Object.freeze(Fn)}function getFieldBytesLength$1(s){if(typeof s!="bigint")throw new Error("field order must be bigint");const $n=s.toString(2).length;return Math.ceil($n/8)}function getMinHashLength$1(s){const $n=getFieldBytesLength$1(s);return $n+Math.ceil($n/2)}function mapHashToField$1(s,$n,Dn=!1){const Un=s.length,Bn=getFieldBytesLength$1($n),In=getMinHashLength$1($n);if(Un<16||Un<In||Un>1024)throw new Error(`expected ${In}-1024 bytes of input, got ${Un}`);const qn=Dn?bytesToNumberBE$1(s):bytesToNumberLE$1(s),Fn=mod$1(qn,$n-_1n$8)+_1n$8;return Dn?numberToBytesLE$1(Fn,Bn):numberToBytesBE$1(Fn,Bn)}const _0n$7=BigInt(0),_1n$7=BigInt(1);function wNAF$1(s,$n){const Dn=(Bn,In)=>{const qn=In.negate();return Bn?qn:In},Un=Bn=>{const In=Math.ceil($n/Bn)+1,qn=2**(Bn-1);return{windows:In,windowSize:qn}};return{constTimeNegate:Dn,unsafeLadder(Bn,In){let qn=s.ZERO,Fn=Bn;for(;In>_0n$7;)In&_1n$7&&(qn=qn.add(Fn)),Fn=Fn.double(),In>>=_1n$7;return qn},precomputeWindow(Bn,In){const{windows:qn,windowSize:Fn}=Un(In),Kn=[];let jn=Bn,Yn=jn;for(let Zn=0;Zn<qn;Zn++){Yn=jn,Kn.push(Yn);for(let Xn=1;Xn<Fn;Xn++)Yn=Yn.add(jn),Kn.push(Yn);jn=Yn.double()}return Kn},wNAF(Bn,In,qn){const{windows:Fn,windowSize:Kn}=Un(Bn);let jn=s.ZERO,Yn=s.BASE;const Zn=BigInt(2**Bn-1),Xn=2**Bn,Jn=BigInt(Bn);for(let Wn=0;Wn<Fn;Wn++){const tr=Wn*Kn;let ir=Number(qn&Zn);qn>>=Jn,ir>Kn&&(ir-=Xn,qn+=_1n$7);const sr=tr,fr=tr+Math.abs(ir)-1,ur=Wn%2!==0,br=ir<0;ir===0?Yn=Yn.add(Dn(ur,In[sr])):jn=jn.add(Dn(br,In[fr]))}return{p:jn,f:Yn}},wNAFCached(Bn,In,qn,Fn){const Kn=Bn._WINDOW_SIZE||1;let jn=In.get(Bn);return jn||(jn=this.precomputeWindow(Bn,Kn),Kn!==1&&In.set(Bn,Fn(jn))),this.wNAF(Kn,jn,qn)}}}function validateBasic(s){return validateField$1(s.Fp),validateObject(s,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$1(s.n,s.nBitLength),...s,p:s.Fp.ORDER})}function validatePointOpts(s){const $n=validateBasic(s);validateObject($n,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:Dn,Fp:Un,a:Bn}=$n;if(Dn){if(!Un.eql(Bn,Un.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof Dn!="object"||typeof Dn.beta!="bigint"||typeof Dn.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...$n})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut$2,DER$1={Err:class extends Error{constructor(s=""){super(s)}},_parseInt(s){const{Err:$n}=DER$1;if(s.length<2||s[0]!==2)throw new $n("Invalid signature integer tag");const Dn=s[1],Un=s.subarray(2,Dn+2);if(!Dn||Un.length!==Dn)throw new $n("Invalid signature integer: wrong length");if(Un[0]&128)throw new $n("Invalid signature integer: negative");if(Un[0]===0&&!(Un[1]&128))throw new $n("Invalid signature integer: unnecessary leading zero");return{d:b2n(Un),l:s.subarray(Dn+2)}},toSig(s){const{Err:$n}=DER$1,Dn=typeof s=="string"?h2b(s):s;if(!(Dn instanceof Uint8Array))throw new Error("ui8a expected");let Un=Dn.length;if(Un<2||Dn[0]!=48)throw new $n("Invalid signature tag");if(Dn[1]!==Un-2)throw new $n("Invalid signature: incorrect length");const{d:Bn,l:In}=DER$1._parseInt(Dn.subarray(2)),{d:qn,l:Fn}=DER$1._parseInt(In);if(Fn.length)throw new $n("Invalid signature: left bytes after parsing");return{r:Bn,s:qn}},hexFromSig(s){const $n=jn=>Number.parseInt(jn[0],16)&8?"00"+jn:jn,Dn=jn=>{const Yn=jn.toString(16);return Yn.length&1?`0${Yn}`:Yn},Un=$n(Dn(s.s)),Bn=$n(Dn(s.r)),In=Un.length/2,qn=Bn.length/2,Fn=Dn(In),Kn=Dn(qn);return`30${Dn(qn+In+4)}02${Kn}${Bn}02${Fn}${Un}`}},_0n$6=BigInt(0),_1n$6=BigInt(1);BigInt(2);const _3n$2=BigInt(3);BigInt(4);function weierstrassPoints(s){const $n=validatePointOpts(s),{Fp:Dn}=$n,Un=$n.toBytes||((Wn,tr,ir)=>{const sr=tr.toAffine();return concatBytes$2(Uint8Array.from([4]),Dn.toBytes(sr.x),Dn.toBytes(sr.y))}),Bn=$n.fromBytes||(Wn=>{const tr=Wn.subarray(1),ir=Dn.fromBytes(tr.subarray(0,Dn.BYTES)),sr=Dn.fromBytes(tr.subarray(Dn.BYTES,2*Dn.BYTES));return{x:ir,y:sr}});function In(Wn){const{a:tr,b:ir}=$n,sr=Dn.sqr(Wn),fr=Dn.mul(sr,Wn);return Dn.add(Dn.add(fr,Dn.mul(Wn,tr)),ir)}if(!Dn.eql(Dn.sqr($n.Gy),In($n.Gx)))throw new Error("bad generator point: equation left != right");function qn(Wn){return typeof Wn=="bigint"&&_0n$6<Wn&&Wn<$n.n}function Fn(Wn){if(!qn(Wn))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function Kn(Wn){const{allowedPrivateKeyLengths:tr,nByteLength:ir,wrapPrivateKey:sr,n:fr}=$n;if(tr&&typeof Wn!="bigint"){if(Wn instanceof Uint8Array&&(Wn=bytesToHex$3(Wn)),typeof Wn!="string"||!tr.includes(Wn.length))throw new Error("Invalid key");Wn=Wn.padStart(ir*2,"0")}let ur;try{ur=typeof Wn=="bigint"?Wn:bytesToNumberBE$1(ensureBytes$1("private key",Wn,ir))}catch{throw new Error(`private key must be ${ir} bytes, hex or bigint, not ${typeof Wn}`)}return sr&&(ur=mod$1(ur,fr)),Fn(ur),ur}const jn=new Map;function Yn(Wn){if(!(Wn instanceof Zn))throw new Error("ProjectivePoint expected")}class Zn{constructor(tr,ir,sr){if(this.px=tr,this.py=ir,this.pz=sr,tr==null||!Dn.isValid(tr))throw new Error("x required");if(ir==null||!Dn.isValid(ir))throw new Error("y required");if(sr==null||!Dn.isValid(sr))throw new Error("z required")}static fromAffine(tr){const{x:ir,y:sr}=tr||{};if(!tr||!Dn.isValid(ir)||!Dn.isValid(sr))throw new Error("invalid affine point");if(tr instanceof Zn)throw new Error("projective point not allowed");const fr=ur=>Dn.eql(ur,Dn.ZERO);return fr(ir)&&fr(sr)?Zn.ZERO:new Zn(ir,sr,Dn.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(tr){const ir=Dn.invertBatch(tr.map(sr=>sr.pz));return tr.map((sr,fr)=>sr.toAffine(ir[fr])).map(Zn.fromAffine)}static fromHex(tr){const ir=Zn.fromAffine(Bn(ensureBytes$1("pointHex",tr)));return ir.assertValidity(),ir}static fromPrivateKey(tr){return Zn.BASE.multiply(Kn(tr))}_setWindowSize(tr){this._WINDOW_SIZE=tr,jn.delete(this)}assertValidity(){if(this.is0()){if($n.allowInfinityPoint&&!Dn.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:tr,y:ir}=this.toAffine();if(!Dn.isValid(tr)||!Dn.isValid(ir))throw new Error("bad point: x or y not FE");const sr=Dn.sqr(ir),fr=In(tr);if(!Dn.eql(sr,fr))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:tr}=this.toAffine();if(Dn.isOdd)return!Dn.isOdd(tr);throw new Error("Field doesn't support isOdd")}equals(tr){Yn(tr);const{px:ir,py:sr,pz:fr}=this,{px:ur,py:br,pz:Nr}=tr,Ar=Dn.eql(Dn.mul(ir,Nr),Dn.mul(ur,fr)),_r=Dn.eql(Dn.mul(sr,Nr),Dn.mul(br,fr));return Ar&&_r}negate(){return new Zn(this.px,Dn.neg(this.py),this.pz)}double(){const{a:tr,b:ir}=$n,sr=Dn.mul(ir,_3n$2),{px:fr,py:ur,pz:br}=this;let Nr=Dn.ZERO,Ar=Dn.ZERO,_r=Dn.ZERO,Rr=Dn.mul(fr,fr),Dr=Dn.mul(ur,ur),zr=Dn.mul(br,br),dr=Dn.mul(fr,ur);return dr=Dn.add(dr,dr),_r=Dn.mul(fr,br),_r=Dn.add(_r,_r),Nr=Dn.mul(tr,_r),Ar=Dn.mul(sr,zr),Ar=Dn.add(Nr,Ar),Nr=Dn.sub(Dr,Ar),Ar=Dn.add(Dr,Ar),Ar=Dn.mul(Nr,Ar),Nr=Dn.mul(dr,Nr),_r=Dn.mul(sr,_r),zr=Dn.mul(tr,zr),dr=Dn.sub(Rr,zr),dr=Dn.mul(tr,dr),dr=Dn.add(dr,_r),_r=Dn.add(Rr,Rr),Rr=Dn.add(_r,Rr),Rr=Dn.add(Rr,zr),Rr=Dn.mul(Rr,dr),Ar=Dn.add(Ar,Rr),zr=Dn.mul(ur,br),zr=Dn.add(zr,zr),Rr=Dn.mul(zr,dr),Nr=Dn.sub(Nr,Rr),_r=Dn.mul(zr,Dr),_r=Dn.add(_r,_r),_r=Dn.add(_r,_r),new Zn(Nr,Ar,_r)}add(tr){Yn(tr);const{px:ir,py:sr,pz:fr}=this,{px:ur,py:br,pz:Nr}=tr;let Ar=Dn.ZERO,_r=Dn.ZERO,Rr=Dn.ZERO;const Dr=$n.a,zr=Dn.mul($n.b,_3n$2);let dr=Dn.mul(ir,ur),pr=Dn.mul(sr,br),lr=Dn.mul(fr,Nr),mr=Dn.add(ir,sr),ar=Dn.add(ur,br);mr=Dn.mul(mr,ar),ar=Dn.add(dr,pr),mr=Dn.sub(mr,ar),ar=Dn.add(ir,fr);let er=Dn.add(ur,Nr);return ar=Dn.mul(ar,er),er=Dn.add(dr,lr),ar=Dn.sub(ar,er),er=Dn.add(sr,fr),Ar=Dn.add(br,Nr),er=Dn.mul(er,Ar),Ar=Dn.add(pr,lr),er=Dn.sub(er,Ar),Rr=Dn.mul(Dr,ar),Ar=Dn.mul(zr,lr),Rr=Dn.add(Ar,Rr),Ar=Dn.sub(pr,Rr),Rr=Dn.add(pr,Rr),_r=Dn.mul(Ar,Rr),pr=Dn.add(dr,dr),pr=Dn.add(pr,dr),lr=Dn.mul(Dr,lr),ar=Dn.mul(zr,ar),pr=Dn.add(pr,lr),lr=Dn.sub(dr,lr),lr=Dn.mul(Dr,lr),ar=Dn.add(ar,lr),dr=Dn.mul(pr,ar),_r=Dn.add(_r,dr),dr=Dn.mul(er,ar),Ar=Dn.mul(mr,Ar),Ar=Dn.sub(Ar,dr),dr=Dn.mul(mr,pr),Rr=Dn.mul(er,Rr),Rr=Dn.add(Rr,dr),new Zn(Ar,_r,Rr)}subtract(tr){return this.add(tr.negate())}is0(){return this.equals(Zn.ZERO)}wNAF(tr){return Jn.wNAFCached(this,jn,tr,ir=>{const sr=Dn.invertBatch(ir.map(fr=>fr.pz));return ir.map((fr,ur)=>fr.toAffine(sr[ur])).map(Zn.fromAffine)})}multiplyUnsafe(tr){const ir=Zn.ZERO;if(tr===_0n$6)return ir;if(Fn(tr),tr===_1n$6)return this;const{endo:sr}=$n;if(!sr)return Jn.unsafeLadder(this,tr);let{k1neg:fr,k1:ur,k2neg:br,k2:Nr}=sr.splitScalar(tr),Ar=ir,_r=ir,Rr=this;for(;ur>_0n$6||Nr>_0n$6;)ur&_1n$6&&(Ar=Ar.add(Rr)),Nr&_1n$6&&(_r=_r.add(Rr)),Rr=Rr.double(),ur>>=_1n$6,Nr>>=_1n$6;return fr&&(Ar=Ar.negate()),br&&(_r=_r.negate()),_r=new Zn(Dn.mul(_r.px,sr.beta),_r.py,_r.pz),Ar.add(_r)}multiply(tr){Fn(tr);let ir=tr,sr,fr;const{endo:ur}=$n;if(ur){const{k1neg:br,k1:Nr,k2neg:Ar,k2:_r}=ur.splitScalar(ir);let{p:Rr,f:Dr}=this.wNAF(Nr),{p:zr,f:dr}=this.wNAF(_r);Rr=Jn.constTimeNegate(br,Rr),zr=Jn.constTimeNegate(Ar,zr),zr=new Zn(Dn.mul(zr.px,ur.beta),zr.py,zr.pz),sr=Rr.add(zr),fr=Dr.add(dr)}else{const{p:br,f:Nr}=this.wNAF(ir);sr=br,fr=Nr}return Zn.normalizeZ([sr,fr])[0]}multiplyAndAddUnsafe(tr,ir,sr){const fr=Zn.BASE,ur=(Nr,Ar)=>Ar===_0n$6||Ar===_1n$6||!Nr.equals(fr)?Nr.multiplyUnsafe(Ar):Nr.multiply(Ar),br=ur(this,ir).add(ur(tr,sr));return br.is0()?void 0:br}toAffine(tr){const{px:ir,py:sr,pz:fr}=this,ur=this.is0();tr==null&&(tr=ur?Dn.ONE:Dn.inv(fr));const br=Dn.mul(ir,tr),Nr=Dn.mul(sr,tr),Ar=Dn.mul(fr,tr);if(ur)return{x:Dn.ZERO,y:Dn.ZERO};if(!Dn.eql(Ar,Dn.ONE))throw new Error("invZ was invalid");return{x:br,y:Nr}}isTorsionFree(){const{h:tr,isTorsionFree:ir}=$n;if(tr===_1n$6)return!0;if(ir)return ir(Zn,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:tr,clearCofactor:ir}=$n;return tr===_1n$6?this:ir?ir(Zn,this):this.multiplyUnsafe($n.h)}toRawBytes(tr=!0){return this.assertValidity(),Un(Zn,this,tr)}toHex(tr=!0){return bytesToHex$3(this.toRawBytes(tr))}}Zn.BASE=new Zn($n.Gx,$n.Gy,Dn.ONE),Zn.ZERO=new Zn(Dn.ZERO,Dn.ONE,Dn.ZERO);const Xn=$n.nBitLength,Jn=wNAF$1(Zn,$n.endo?Math.ceil(Xn/2):Xn);return{CURVE:$n,ProjectivePoint:Zn,normPrivateKeyToScalar:Kn,weierstrassEquation:In,isWithinCurveOrder:qn}}function validateOpts(s){const $n=validateBasic(s);return validateObject($n,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...$n})}function weierstrass$1(s){const $n=validateOpts(s),{Fp:Dn,n:Un}=$n,Bn=Dn.BYTES+1,In=2*Dn.BYTES+1;function qn(ar){return _0n$6<ar&&ar<Dn.ORDER}function Fn(ar){return mod$1(ar,Un)}function Kn(ar){return invert$1(ar,Un)}const{ProjectivePoint:jn,normPrivateKeyToScalar:Yn,weierstrassEquation:Zn,isWithinCurveOrder:Xn}=weierstrassPoints({...$n,toBytes(ar,er,or){const wr=er.toAffine(),vr=Dn.toBytes(wr.x),Sr=concatBytes$2;return or?Sr(Uint8Array.from([er.hasEvenY()?2:3]),vr):Sr(Uint8Array.from([4]),vr,Dn.toBytes(wr.y))},fromBytes(ar){const er=ar.length,or=ar[0],wr=ar.subarray(1);if(er===Bn&&(or===2||or===3)){const vr=bytesToNumberBE$1(wr);if(!qn(vr))throw new Error("Point is not on curve");const Sr=Zn(vr);let rr=Dn.sqrt(Sr);const gr=(rr&_1n$6)===_1n$6;return(or&1)===1!==gr&&(rr=Dn.neg(rr)),{x:vr,y:rr}}else if(er===In&&or===4){const vr=Dn.fromBytes(wr.subarray(0,Dn.BYTES)),Sr=Dn.fromBytes(wr.subarray(Dn.BYTES,2*Dn.BYTES));return{x:vr,y:Sr}}else throw new Error(`Point of length ${er} was invalid. Expected ${Bn} compressed bytes or ${In} uncompressed bytes`)}}),Jn=ar=>bytesToHex$3(numberToBytesBE$1(ar,$n.nByteLength));function Wn(ar){const er=Un>>_1n$6;return ar>er}function tr(ar){return Wn(ar)?Fn(-ar):ar}const ir=(ar,er,or)=>bytesToNumberBE$1(ar.slice(er,or));class sr{constructor(er,or,wr){this.r=er,this.s=or,this.recovery=wr,this.assertValidity()}static fromCompact(er){const or=$n.nByteLength;return er=ensureBytes$1("compactSignature",er,or*2),new sr(ir(er,0,or),ir(er,or,2*or))}static fromDER(er){const{r:or,s:wr}=DER$1.toSig(ensureBytes$1("DER",er));return new sr(or,wr)}assertValidity(){if(!Xn(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!Xn(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(er){return new sr(this.r,this.s,er)}recoverPublicKey(er){const{r:or,s:wr,recovery:vr}=this,Sr=_r(ensureBytes$1("msgHash",er));if(vr==null||![0,1,2,3].includes(vr))throw new Error("recovery id invalid");const rr=vr===2||vr===3?or+$n.n:or;if(rr>=Dn.ORDER)throw new Error("recovery id 2 or 3 invalid");const gr=vr&1?"03":"02",Tr=jn.fromHex(gr+Jn(rr)),Br=Kn(rr),Ur=Fn(-Sr*Br),qr=Fn(wr*Br),Hr=jn.BASE.multiplyAndAddUnsafe(Tr,Ur,qr);if(!Hr)throw new Error("point at infinify");return Hr.assertValidity(),Hr}hasHighS(){return Wn(this.s)}normalizeS(){return this.hasHighS()?new sr(this.r,Fn(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$3(this.toDERHex())}toDERHex(){return DER$1.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$3(this.toCompactHex())}toCompactHex(){return Jn(this.r)+Jn(this.s)}}const fr={isValidPrivateKey(ar){try{return Yn(ar),!0}catch{return!1}},normPrivateKeyToScalar:Yn,randomPrivateKey:()=>{const ar=getMinHashLength$1($n.n);return mapHashToField$1($n.randomBytes(ar),$n.n)},precompute(ar=8,er=jn.BASE){return er._setWindowSize(ar),er.multiply(BigInt(3)),er}};function ur(ar,er=!0){return jn.fromPrivateKey(ar).toRawBytes(er)}function br(ar){const er=ar instanceof Uint8Array,or=typeof ar=="string",wr=(er||or)&&ar.length;return er?wr===Bn||wr===In:or?wr===2*Bn||wr===2*In:ar instanceof jn}function Nr(ar,er,or=!0){if(br(ar))throw new Error("first arg must be private key");if(!br(er))throw new Error("second arg must be public key");return jn.fromHex(er).multiply(Yn(ar)).toRawBytes(or)}const Ar=$n.bits2int||function(ar){const er=bytesToNumberBE$1(ar),or=ar.length*8-$n.nBitLength;return or>0?er>>BigInt(or):er},_r=$n.bits2int_modN||function(ar){return Fn(Ar(ar))},Rr=bitMask$1($n.nBitLength);function Dr(ar){if(typeof ar!="bigint")throw new Error("bigint expected");if(!(_0n$6<=ar&&ar<Rr))throw new Error(`bigint expected < 2^${$n.nBitLength}`);return numberToBytesBE$1(ar,$n.nByteLength)}function zr(ar,er,or=dr){if(["recovered","canonical"].some(Kr=>Kr in or))throw new Error("sign() legacy options not supported");const{hash:wr,randomBytes:vr}=$n;let{lowS:Sr,prehash:rr,extraEntropy:gr}=or;Sr==null&&(Sr=!0),ar=ensureBytes$1("msgHash",ar),rr&&(ar=ensureBytes$1("prehashed msgHash",wr(ar)));const Tr=_r(ar),Br=Yn(er),Ur=[Dr(Br),Dr(Tr)];if(gr!=null){const Kr=gr===!0?vr(Dn.BYTES):gr;Ur.push(ensureBytes$1("extraEntropy",Kr))}const qr=concatBytes$2(...Ur),Hr=Tr;function Yr(Kr){const si=Ar(Kr);if(!Xn(si))return;const zi=Kn(si),Ai=jn.BASE.multiply(si).toAffine(),Li=Fn(Ai.x);if(Li===_0n$6)return;const Ii=Fn(zi*Fn(Hr+Li*Br));if(Ii===_0n$6)return;let ji=(Ai.x===Li?0:2)|Number(Ai.y&_1n$6),Ts=Ii;return Sr&&Wn(Ii)&&(Ts=tr(Ii),ji^=1),new sr(Li,Ts,ji)}return{seed:qr,k2sig:Yr}}const dr={lowS:$n.lowS,prehash:!1},pr={lowS:$n.lowS,prehash:!1};function lr(ar,er,or=dr){const{seed:wr,k2sig:vr}=zr(ar,er,or),Sr=$n;return createHmacDrbg$1(Sr.hash.outputLen,Sr.nByteLength,Sr.hmac)(wr,vr)}jn.BASE._setWindowSize(8);function mr(ar,er,or,wr=pr){var vr;const Sr=ar;if(er=ensureBytes$1("msgHash",er),or=ensureBytes$1("publicKey",or),"strict"in wr)throw new Error("options.strict was renamed to lowS");const{lowS:rr,prehash:gr}=wr;let Tr,Br;try{if(typeof Sr=="string"||Sr instanceof Uint8Array)try{Tr=sr.fromDER(Sr)}catch(Ai){if(!(Ai instanceof DER$1.Err))throw Ai;Tr=sr.fromCompact(Sr)}else if(typeof Sr=="object"&&typeof Sr.r=="bigint"&&typeof Sr.s=="bigint"){const{r:Ai,s:Li}=Sr;Tr=new sr(Ai,Li)}else throw new Error("PARSE");Br=jn.fromHex(or)}catch(Ai){if(Ai.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(rr&&Tr.hasHighS())return!1;gr&&(er=$n.hash(er));const{r:Ur,s:qr}=Tr,Hr=_r(er),Yr=Kn(qr),Kr=Fn(Hr*Yr),si=Fn(Ur*Yr),zi=(vr=jn.BASE.multiplyAndAddUnsafe(Br,Kr,si))==null?void 0:vr.toAffine();return zi?Fn(zi.x)===Ur:!1}return{CURVE:$n,getPublicKey:ur,getSharedSecret:Nr,sign:lr,verify:mr,ProjectivePoint:jn,Signature:sr,utils:fr}}let HMAC$2=class extends Hash$2{constructor(s,$n){super(),this.finished=!1,this.destroyed=!1,hash$1(s);const Dn=toBytes$3($n);if(this.iHash=s.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const Un=this.blockLen,Bn=new Uint8Array(Un);Bn.set(Dn.length>Un?s.create().update(Dn).digest():Dn);for(let In=0;In<Bn.length;In++)Bn[In]^=54;this.iHash.update(Bn),this.oHash=s.create();for(let In=0;In<Bn.length;In++)Bn[In]^=106;this.oHash.update(Bn),Bn.fill(0)}update(s){return exists$2(this),this.iHash.update(s),this}digestInto(s){exists$2(this),bytes$2(s,this.outputLen),this.finished=!0,this.iHash.digestInto(s),this.oHash.update(s),this.oHash.digestInto(s),this.destroy()}digest(){const s=new Uint8Array(this.oHash.outputLen);return this.digestInto(s),s}_cloneInto(s){s||(s=Object.create(Object.getPrototypeOf(this),{}));const{oHash:$n,iHash:Dn,finished:Un,destroyed:Bn,blockLen:In,outputLen:qn}=this;return s=s,s.finished=Un,s.destroyed=Bn,s.blockLen=In,s.outputLen=qn,s.oHash=$n._cloneInto(s.oHash),s.iHash=Dn._cloneInto(s.iHash),s}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$2=(s,$n,Dn)=>new HMAC$2(s,$n).update(Dn).digest();hmac$2.create=(s,$n)=>new HMAC$2(s,$n);function getHash(s){return{hash:s,hmac:($n,...Dn)=>hmac$2(s,$n,concatBytes$3(...Dn)),randomBytes:randomBytes$2}}function createCurve$1(s,$n){const Dn=Un=>weierstrass$1({...s,...getHash(Un)});return Object.freeze({...Dn($n),create:Dn})}const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$5=BigInt(1),_2n$3=BigInt(2),divNearest$1=(s,$n)=>(s+$n/_2n$3)/$n;function sqrtMod$1(s){const $n=secp256k1P,Dn=BigInt(3),Un=BigInt(6),Bn=BigInt(11),In=BigInt(22),qn=BigInt(23),Fn=BigInt(44),Kn=BigInt(88),jn=s*s*s%$n,Yn=jn*jn*s%$n,Zn=pow2$1(Yn,Dn,$n)*Yn%$n,Xn=pow2$1(Zn,Dn,$n)*Yn%$n,Jn=pow2$1(Xn,_2n$3,$n)*jn%$n,Wn=pow2$1(Jn,Bn,$n)*Jn%$n,tr=pow2$1(Wn,In,$n)*Wn%$n,ir=pow2$1(tr,Fn,$n)*tr%$n,sr=pow2$1(ir,Kn,$n)*ir%$n,fr=pow2$1(sr,Fn,$n)*tr%$n,ur=pow2$1(fr,Dn,$n)*Yn%$n,br=pow2$1(ur,qn,$n)*Wn%$n,Nr=pow2$1(br,Un,$n)*jn%$n,Ar=pow2$1(Nr,_2n$3,$n);if(!Fp.eql(Fp.sqr(Ar),s))throw new Error("Cannot find square root");return Ar}const Fp=Field$1(secp256k1P,void 0,void 0,{sqrt:sqrtMod$1}),secp256k1$1=createCurve$1({a:BigInt(0),b:BigInt(7),Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:s=>{const $n=secp256k1N,Dn=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),Un=-_1n$5*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),Bn=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),In=Dn,qn=BigInt("0x100000000000000000000000000000000"),Fn=divNearest$1(In*s,$n),Kn=divNearest$1(-Un*s,$n);let jn=mod$1(s-Fn*Dn-Kn*Bn,$n),Yn=mod$1(-Fn*Un-Kn*In,$n);const Zn=jn>qn,Xn=Yn>qn;if(Zn&&(jn=$n-jn),Xn&&(Yn=$n-Yn),jn>qn||Yn>qn)throw new Error("splitScalar: Endomorphism failed, k="+s);return{k1neg:Zn,k1:jn,k2neg:Xn,k2:Yn}}}},sha256$3),_0n$5=BigInt(0),fe$2=s=>typeof s=="bigint"&&_0n$5<s&&s<secp256k1P,ge$2=s=>typeof s=="bigint"&&_0n$5<s&&s<secp256k1N,TAGGED_HASH_PREFIXES$1={};function taggedHash$1(s,...$n){let Dn=TAGGED_HASH_PREFIXES$1[s];if(Dn===void 0){const Un=sha256$3(Uint8Array.from(s,Bn=>Bn.charCodeAt(0)));Dn=concatBytes$2(Un,Un),TAGGED_HASH_PREFIXES$1[s]=Dn}return sha256$3(concatBytes$2(Dn,...$n))}const pointToBytes$1=s=>s.toRawBytes(!0).slice(1),numTo32b=s=>numberToBytesBE$1(s,32),modP=s=>mod$1(s,secp256k1P),modN=s=>mod$1(s,secp256k1N),Point=secp256k1$1.ProjectivePoint,GmulAdd=(s,$n,Dn)=>Point.BASE.multiplyAndAddUnsafe(s,$n,Dn);function schnorrGetExtPubKey$1(s){let $n=secp256k1$1.utils.normPrivateKeyToScalar(s),Dn=Point.fromPrivateKey($n);return{scalar:Dn.hasEvenY()?$n:modN(-$n),bytes:pointToBytes$1(Dn)}}function lift_x$1(s){if(!fe$2(s))throw new Error("bad x: need 0 < x < p");const $n=modP(s*s),Dn=modP($n*s+BigInt(7));let Un=sqrtMod$1(Dn);Un%_2n$3!==_0n$5&&(Un=modP(-Un));const Bn=new Point(s,Un,_1n$5);return Bn.assertValidity(),Bn}function challenge$1(...s){return modN(bytesToNumberBE$1(taggedHash$1("BIP0340/challenge",...s)))}function schnorrGetPublicKey$1(s){return schnorrGetExtPubKey$1(s).bytes}function schnorrSign$1(s,$n,Dn=randomBytes$2(32)){const Un=ensureBytes$1("message",s),{bytes:Bn,scalar:In}=schnorrGetExtPubKey$1($n),qn=ensureBytes$1("auxRand",Dn,32),Fn=numTo32b(In^bytesToNumberBE$1(taggedHash$1("BIP0340/aux",qn))),Kn=taggedHash$1("BIP0340/nonce",Fn,Bn,Un),jn=modN(bytesToNumberBE$1(Kn));if(jn===_0n$5)throw new Error("sign failed: k is zero");const{bytes:Yn,scalar:Zn}=schnorrGetExtPubKey$1(jn),Xn=challenge$1(Yn,Bn,Un),Jn=new Uint8Array(64);if(Jn.set(Yn,0),Jn.set(numTo32b(modN(Zn+Xn*In)),32),!schnorrVerify$1(Jn,Un,Bn))throw new Error("sign: Invalid signature produced");return Jn}function schnorrVerify$1(s,$n,Dn){const Un=ensureBytes$1("signature",s,64),Bn=ensureBytes$1("message",$n),In=ensureBytes$1("publicKey",Dn,32);try{const qn=lift_x$1(bytesToNumberBE$1(In)),Fn=bytesToNumberBE$1(Un.subarray(0,32));if(!fe$2(Fn))return!1;const Kn=bytesToNumberBE$1(Un.subarray(32,64));if(!ge$2(Kn))return!1;const jn=challenge$1(numTo32b(Fn),pointToBytes$1(qn),Bn),Yn=GmulAdd(qn,Kn,modN(-jn));return!(!Yn||!Yn.hasEvenY()||Yn.toAffine().x!==Fn)}catch{return!1}}const schnorr$1={getPublicKey:schnorrGetPublicKey$1,sign:schnorrSign$1,verify:schnorrVerify$1,utils:{randomPrivateKey:secp256k1$1.utils.randomPrivateKey,lift_x:lift_x$1,pointToBytes:pointToBytes$1,numberToBytesBE:numberToBytesBE$1,bytesToNumberBE:bytesToNumberBE$1,taggedHash:taggedHash$1,mod:mod$1}},crypto$1=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const u8a=s=>s instanceof Uint8Array,u32$1=s=>new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)),createView$2=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),rotr$1=(s,$n)=>s<<32-$n|s>>>$n,isLE$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$1)throw new Error("Non little-endian hardware is not supported");const hexes$2=Array.from({length:256},(s,$n)=>$n.toString(16).padStart(2,"0"));function bytesToHex$2(s){if(!u8a(s))throw new Error("Uint8Array expected");let $n="";for(let Dn=0;Dn<s.length;Dn++)$n+=hexes$2[s[Dn]];return $n}function hexToBytes$2(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);const $n=s.length;if($n%2)throw new Error("padded hex string expected, got unpadded hex of length "+$n);const Dn=new Uint8Array($n/2);for(let Un=0;Un<Dn.length;Un++){const Bn=Un*2,In=s.slice(Bn,Bn+2),qn=Number.parseInt(In,16);if(Number.isNaN(qn)||qn<0)throw new Error("Invalid byte sequence");Dn[Un]=qn}return Dn}function utf8ToBytes$2(s){if(typeof s!="string")throw new Error(`utf8ToBytes expected string, got ${typeof s}`);return new Uint8Array(new TextEncoder().encode(s))}function toBytes$2(s){if(typeof s=="string"&&(s=utf8ToBytes$2(s)),!u8a(s))throw new Error(`expected Uint8Array, got ${typeof s}`);return s}function concatBytes$1(...s){const $n=new Uint8Array(s.reduce((Un,Bn)=>Un+Bn.length,0));let Dn=0;return s.forEach(Un=>{if(!u8a(Un))throw new Error("Uint8Array expected");$n.set(Un,Dn),Dn+=Un.length}),$n}let Hash$1=class{clone(){return this._cloneInto()}};const isPlainObject=s=>Object.prototype.toString.call(s)==="[object Object]"&&s.constructor===Object;function checkOpts$1(s,$n){if($n!==void 0&&(typeof $n!="object"||!isPlainObject($n)))throw new Error("Options should be object or undefined");return Object.assign(s,$n)}function wrapConstructor(s){const $n=Un=>s().update(toBytes$2(Un)).digest(),Dn=s();return $n.outputLen=Dn.outputLen,$n.blockLen=Dn.blockLen,$n.create=()=>s(),$n}function randomBytes$1(s=32){if(crypto$1&&typeof crypto$1.getRandomValues=="function")return crypto$1.getRandomValues(new Uint8Array(s));throw new Error("crypto.getRandomValues must be defined")}function number$1(s){if(!Number.isSafeInteger(s)||s<0)throw new Error(`Wrong positive integer: ${s}`)}function bool$1(s){if(typeof s!="boolean")throw new Error(`Expected boolean, not ${s}`)}function bytes$1(s,...$n){if(!(s instanceof Uint8Array))throw new Error("Expected Uint8Array");if($n.length>0&&!$n.includes(s.length))throw new Error(`Expected Uint8Array of length ${$n}, not of length=${s.length}`)}function hash(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$1(s.outputLen),number$1(s.blockLen)}function exists$1(s,$n=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if($n&&s.finished)throw new Error("Hash#digest() has already been called")}function output$1(s,$n){bytes$1(s);const Dn=$n.outputLen;if(s.length<Dn)throw new Error(`digestInto() expects output buffer of length at least ${Dn}`)}const assert={number:number$1,bool:bool$1,bytes:bytes$1,hash,exists:exists$1,output:output$1};function setBigUint64$2(s,$n,Dn,Un){if(typeof s.setBigUint64=="function")return s.setBigUint64($n,Dn,Un);const Bn=BigInt(32),In=BigInt(4294967295),qn=Number(Dn>>Bn&In),Fn=Number(Dn&In),Kn=Un?4:0,jn=Un?0:4;s.setUint32($n+Kn,qn,Un),s.setUint32($n+jn,Fn,Un)}class SHA2 extends Hash$1{constructor($n,Dn,Un,Bn){super(),this.blockLen=$n,this.outputLen=Dn,this.padOffset=Un,this.isLE=Bn,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array($n),this.view=createView$2(this.buffer)}update($n){assert.exists(this);const{view:Dn,buffer:Un,blockLen:Bn}=this;$n=toBytes$2($n);const In=$n.length;for(let qn=0;qn<In;){const Fn=Math.min(Bn-this.pos,In-qn);if(Fn===Bn){const Kn=createView$2($n);for(;Bn<=In-qn;qn+=Bn)this.process(Kn,qn);continue}Un.set($n.subarray(qn,qn+Fn),this.pos),this.pos+=Fn,qn+=Fn,this.pos===Bn&&(this.process(Dn,0),this.pos=0)}return this.length+=$n.length,this.roundClean(),this}digestInto($n){assert.exists(this),assert.output($n,this),this.finished=!0;const{buffer:Dn,view:Un,blockLen:Bn,isLE:In}=this;let{pos:qn}=this;Dn[qn++]=128,this.buffer.subarray(qn).fill(0),this.padOffset>Bn-qn&&(this.process(Un,0),qn=0);for(let Zn=qn;Zn<Bn;Zn++)Dn[Zn]=0;setBigUint64$2(Un,Bn-8,BigInt(this.length*8),In),this.process(Un,0);const Fn=createView$2($n),Kn=this.outputLen;if(Kn%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const jn=Kn/4,Yn=this.get();if(jn>Yn.length)throw new Error("_sha2: outputLen bigger than state");for(let Zn=0;Zn<jn;Zn++)Fn.setUint32(4*Zn,Yn[Zn],In)}digest(){const{buffer:$n,outputLen:Dn}=this;this.digestInto($n);const Un=$n.slice(0,Dn);return this.destroy(),Un}_cloneInto($n){$n||($n=new this.constructor),$n.set(...this.get());const{blockLen:Dn,buffer:Un,length:Bn,finished:In,destroyed:qn,pos:Fn}=this;return $n.length=Bn,$n.pos=Fn,$n.finished=In,$n.destroyed=qn,Bn%Dn&&$n.buffer.set(Un),$n}}const Chi$1=(s,$n,Dn)=>s&$n^~s&Dn,Maj$1=(s,$n,Dn)=>s&$n^s&Dn^$n&Dn,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends SHA2{constructor(){super(64,32,8,!1),this.A=IV[0]|0,this.B=IV[1]|0,this.C=IV[2]|0,this.D=IV[3]|0,this.E=IV[4]|0,this.F=IV[5]|0,this.G=IV[6]|0,this.H=IV[7]|0}get(){const{A:s,B:$n,C:Dn,D:Un,E:Bn,F:In,G:qn,H:Fn}=this;return[s,$n,Dn,Un,Bn,In,qn,Fn]}set(s,$n,Dn,Un,Bn,In,qn,Fn){this.A=s|0,this.B=$n|0,this.C=Dn|0,this.D=Un|0,this.E=Bn|0,this.F=In|0,this.G=qn|0,this.H=Fn|0}process(s,$n){for(let Yn=0;Yn<16;Yn++,$n+=4)SHA256_W$1[Yn]=s.getUint32($n,!1);for(let Yn=16;Yn<64;Yn++){const Zn=SHA256_W$1[Yn-15],Xn=SHA256_W$1[Yn-2],Jn=rotr$1(Zn,7)^rotr$1(Zn,18)^Zn>>>3,Wn=rotr$1(Xn,17)^rotr$1(Xn,19)^Xn>>>10;SHA256_W$1[Yn]=Wn+SHA256_W$1[Yn-7]+Jn+SHA256_W$1[Yn-16]|0}let{A:Dn,B:Un,C:Bn,D:In,E:qn,F:Fn,G:Kn,H:jn}=this;for(let Yn=0;Yn<64;Yn++){const Zn=rotr$1(qn,6)^rotr$1(qn,11)^rotr$1(qn,25),Xn=jn+Zn+Chi$1(qn,Fn,Kn)+SHA256_K$1[Yn]+SHA256_W$1[Yn]|0,Jn=(rotr$1(Dn,2)^rotr$1(Dn,13)^rotr$1(Dn,22))+Maj$1(Dn,Un,Bn)|0;jn=Kn,Kn=Fn,Fn=qn,qn=In+Xn|0,In=Bn,Bn=Un,Un=Dn,Dn=Xn+Jn|0}Dn=Dn+this.A|0,Un=Un+this.B|0,Bn=Bn+this.C|0,In=In+this.D|0,qn=qn+this.E|0,Fn=Fn+this.F|0,Kn=Kn+this.G|0,jn=jn+this.H|0,this.set(Dn,Un,Bn,In,qn,Fn,Kn,jn)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class SHA224 extends SHA256$1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const sha256$2=wrapConstructor(()=>new SHA256$1);wrapConstructor(()=>new SHA224);function assertNumber(s){if(!Number.isSafeInteger(s))throw new Error(`Wrong integer: ${s}`)}function chain(...s){const $n=(Bn,In)=>qn=>Bn(In(qn)),Dn=Array.from(s).reverse().reduce((Bn,In)=>Bn?$n(Bn,In.encode):In.encode,void 0),Un=s.reduce((Bn,In)=>Bn?$n(Bn,In.decode):In.decode,void 0);return{encode:Dn,decode:Un}}function alphabet(s){return{encode:$n=>{if(!Array.isArray($n)||$n.length&&typeof $n[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return $n.map(Dn=>{if(assertNumber(Dn),Dn<0||Dn>=s.length)throw new Error(`Digit index outside alphabet: ${Dn} (alphabet: ${s.length})`);return s[Dn]})},decode:$n=>{if(!Array.isArray($n)||$n.length&&typeof $n[0]!="string")throw new Error("alphabet.decode input should be array of strings");return $n.map(Dn=>{if(typeof Dn!="string")throw new Error(`alphabet.decode: not string element=${Dn}`);const Un=s.indexOf(Dn);if(Un===-1)throw new Error(`Unknown letter: "${Dn}". Allowed: ${s}`);return Un})}}}function join(s=""){if(typeof s!="string")throw new Error("join separator should be string");return{encode:$n=>{if(!Array.isArray($n)||$n.length&&typeof $n[0]!="string")throw new Error("join.encode input should be array of strings");for(let Dn of $n)if(typeof Dn!="string")throw new Error(`join.encode: non-string input=${Dn}`);return $n.join(s)},decode:$n=>{if(typeof $n!="string")throw new Error("join.decode input should be string");return $n.split(s)}}}function padding(s,$n="="){if(assertNumber(s),typeof $n!="string")throw new Error("padding chr should be string");return{encode(Dn){if(!Array.isArray(Dn)||Dn.length&&typeof Dn[0]!="string")throw new Error("padding.encode input should be array of strings");for(let Un of Dn)if(typeof Un!="string")throw new Error(`padding.encode: non-string input=${Un}`);for(;Dn.length*s%8;)Dn.push($n);return Dn},decode(Dn){if(!Array.isArray(Dn)||Dn.length&&typeof Dn[0]!="string")throw new Error("padding.encode input should be array of strings");for(let Bn of Dn)if(typeof Bn!="string")throw new Error(`padding.decode: non-string input=${Bn}`);let Un=Dn.length;if(Un*s%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;Un>0&&Dn[Un-1]===$n;Un--)if(!((Un-1)*s%8))throw new Error("Invalid padding: string has too much padding");return Dn.slice(0,Un)}}}function normalize$1(s){if(typeof s!="function")throw new Error("normalize fn should be function");return{encode:$n=>$n,decode:$n=>s($n)}}function convertRadix(s,$n,Dn){if($n<2)throw new Error(`convertRadix: wrong from=${$n}, base cannot be less than 2`);if(Dn<2)throw new Error(`convertRadix: wrong to=${Dn}, base cannot be less than 2`);if(!Array.isArray(s))throw new Error("convertRadix: data should be array");if(!s.length)return[];let Un=0;const Bn=[],In=Array.from(s);for(In.forEach(qn=>{if(assertNumber(qn),qn<0||qn>=$n)throw new Error(`Wrong integer: ${qn}`)});;){let qn=0,Fn=!0;for(let Kn=Un;Kn<In.length;Kn++){const jn=In[Kn],Yn=$n*qn+jn;if(!Number.isSafeInteger(Yn)||$n*qn/$n!==qn||Yn-jn!==$n*qn)throw new Error("convertRadix: carry overflow");if(qn=Yn%Dn,In[Kn]=Math.floor(Yn/Dn),!Number.isSafeInteger(In[Kn])||In[Kn]*Dn+qn!==Yn)throw new Error("convertRadix: carry overflow");if(Fn)In[Kn]?Fn=!1:Un=Kn;else continue}if(Bn.push(qn),Fn)break}for(let qn=0;qn<s.length-1&&s[qn]===0;qn++)Bn.push(0);return Bn.reverse()}const gcd=(s,$n)=>$n?gcd($n,s%$n):s,radix2carry=(s,$n)=>s+($n-gcd(s,$n));function convertRadix2(s,$n,Dn,Un){if(!Array.isArray(s))throw new Error("convertRadix2: data should be array");if($n<=0||$n>32)throw new Error(`convertRadix2: wrong from=${$n}`);if(Dn<=0||Dn>32)throw new Error(`convertRadix2: wrong to=${Dn}`);if(radix2carry($n,Dn)>32)throw new Error(`convertRadix2: carry overflow from=${$n} to=${Dn} carryBits=${radix2carry($n,Dn)}`);let Bn=0,In=0;const qn=2**Dn-1,Fn=[];for(const Kn of s){if(assertNumber(Kn),Kn>=2**$n)throw new Error(`convertRadix2: invalid data word=${Kn} from=${$n}`);if(Bn=Bn<<$n|Kn,In+$n>32)throw new Error(`convertRadix2: carry overflow pos=${In} from=${$n}`);for(In+=$n;In>=Dn;In-=Dn)Fn.push((Bn>>In-Dn&qn)>>>0);Bn&=2**In-1}if(Bn=Bn<<Dn-In&qn,!Un&&In>=$n)throw new Error("Excess padding");if(!Un&&Bn)throw new Error(`Non-zero padding: ${Bn}`);return Un&&In>0&&Fn.push(Bn>>>0),Fn}function radix(s){return assertNumber(s),{encode:$n=>{if(!($n instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from($n),2**8,s)},decode:$n=>{if(!Array.isArray($n)||$n.length&&typeof $n[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(convertRadix($n,s,2**8))}}}function radix2(s,$n=!1){if(assertNumber(s),s<=0||s>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,s)>32||radix2carry(s,8)>32)throw new Error("radix2: carry overflow");return{encode:Dn=>{if(!(Dn instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(Dn),8,s,!$n)},decode:Dn=>{if(!Array.isArray(Dn)||Dn.length&&typeof Dn[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(convertRadix2(Dn,s,8,$n))}}}function unsafeWrapper(s){if(typeof s!="function")throw new Error("unsafeWrapper fn should be function");return function(...$n){try{return s.apply(null,$n)}catch{}}}const base16=chain(radix2(4),alphabet("0123456789ABCDEF"),join("")),base32=chain(radix2(5),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHIJKLMNOPQRSTUV"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),join(""),normalize$1(s=>s.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const base64=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),padding(6),join("")),base64url=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),padding(6),join("")),genBase58=s=>chain(radix(58),alphabet(s),join("")),base58=genBase58("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");genBase58("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");genBase58("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const XMR_BLOCK_LEN=[0,2,3,5,6,7,9,10,11],base58xmr={encode(s){let $n="";for(let Dn=0;Dn<s.length;Dn+=8){const Un=s.subarray(Dn,Dn+8);$n+=base58.encode(Un).padStart(XMR_BLOCK_LEN[Un.length],"1")}return $n},decode(s){let $n=[];for(let Dn=0;Dn<s.length;Dn+=11){const Un=s.slice(Dn,Dn+11),Bn=XMR_BLOCK_LEN.indexOf(Un.length),In=base58.decode(Un);for(let qn=0;qn<In.length-Bn;qn++)if(In[qn]!==0)throw new Error("base58xmr: wrong padding");$n=$n.concat(Array.from(In.slice(In.length-Bn)))}return Uint8Array.from($n)}},BECH_ALPHABET=chain(alphabet("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join("")),POLYMOD_GENERATORS=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod(s){const $n=s>>25;let Dn=(s&33554431)<<5;for(let Un=0;Un<POLYMOD_GENERATORS.length;Un++)($n>>Un&1)===1&&(Dn^=POLYMOD_GENERATORS[Un]);return Dn}function bechChecksum(s,$n,Dn=1){const Un=s.length;let Bn=1;for(let In=0;In<Un;In++){const qn=s.charCodeAt(In);if(qn<33||qn>126)throw new Error(`Invalid prefix (${s})`);Bn=bech32Polymod(Bn)^qn>>5}Bn=bech32Polymod(Bn);for(let In=0;In<Un;In++)Bn=bech32Polymod(Bn)^s.charCodeAt(In)&31;for(let In of $n)Bn=bech32Polymod(Bn)^In;for(let In=0;In<6;In++)Bn=bech32Polymod(Bn);return Bn^=Dn,BECH_ALPHABET.encode(convertRadix2([Bn%2**30],30,5,!1))}function genBech32(s){const $n=s==="bech32"?1:734539939,Dn=radix2(5),Un=Dn.decode,Bn=Dn.encode,In=unsafeWrapper(Un);function qn(Yn,Zn,Xn=90){if(typeof Yn!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof Yn}`);if(!Array.isArray(Zn)||Zn.length&&typeof Zn[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof Zn}`);const Jn=Yn.length+7+Zn.length;if(Xn!==!1&&Jn>Xn)throw new TypeError(`Length ${Jn} exceeds limit ${Xn}`);return Yn=Yn.toLowerCase(),`${Yn}1${BECH_ALPHABET.encode(Zn)}${bechChecksum(Yn,Zn,$n)}`}function Fn(Yn,Zn=90){if(typeof Yn!="string")throw new Error(`bech32.decode input should be string, not ${typeof Yn}`);if(Yn.length<8||Zn!==!1&&Yn.length>Zn)throw new TypeError(`Wrong string length: ${Yn.length} (${Yn}). Expected (8..${Zn})`);const Xn=Yn.toLowerCase();if(Yn!==Xn&&Yn!==Yn.toUpperCase())throw new Error("String must be lowercase or uppercase");Yn=Xn;const Jn=Yn.lastIndexOf("1");if(Jn===0||Jn===-1)throw new Error('Letter "1" must be present between prefix and data only');const Wn=Yn.slice(0,Jn),tr=Yn.slice(Jn+1);if(tr.length<6)throw new Error("Data must be at least 6 characters long");const ir=BECH_ALPHABET.decode(tr).slice(0,-6),sr=bechChecksum(Wn,ir,$n);if(!tr.endsWith(sr))throw new Error(`Invalid checksum in ${Yn}: expected "${sr}"`);return{prefix:Wn,words:ir}}const Kn=unsafeWrapper(Fn);function jn(Yn){const{prefix:Zn,words:Xn}=Fn(Yn,!1);return{prefix:Zn,words:Xn,bytes:Un(Xn)}}return{encode:qn,decode:Fn,decodeToBytes:jn,decodeUnsafe:Kn,fromWords:Un,fromWordsUnsafe:In,toWords:Bn}}const bech32$1=genBech32("bech32");genBech32("bech32m");const utf8$1={encode:s=>new TextDecoder().decode(s),decode:s=>new TextEncoder().encode(s)},hex$1=chain(radix2(4),alphabet("0123456789abcdef"),join(""),normalize$1(s=>{if(typeof s!="string"||s.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);return s.toLowerCase()})),CODERS={utf8:utf8$1,hex:hex$1,base16,base32,base64,base64url,base58,base58xmr};`${Object.keys(CODERS).join(", ")}`;function number(s){if(!Number.isSafeInteger(s)||s<0)throw new Error(`positive integer expected, not ${s}`)}function bool(s){if(typeof s!="boolean")throw new Error(`boolean expected, not ${s}`)}function isBytes$1(s){return s instanceof Uint8Array||s!=null&&typeof s=="object"&&s.constructor.name==="Uint8Array"}function bytes(s,...$n){if(!isBytes$1(s))throw new Error("Uint8Array expected");if($n.length>0&&!$n.includes(s.length))throw new Error(`Uint8Array expected of length ${$n}, not of length=${s.length}`)}function exists(s,$n=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if($n&&s.finished)throw new Error("Hash#digest() has already been called")}function output(s,$n){bytes(s);const Dn=$n.outputLen;if(s.length<Dn)throw new Error(`digestInto() expects output buffer of length at least ${Dn}`)}const u32=s=>new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)),createView$1=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");const hexes$1=Array.from({length:256},(s,$n)=>$n.toString(16).padStart(2,"0"));function bytesToHex$1(s){bytes(s);let $n="";for(let Dn=0;Dn<s.length;Dn++)$n+=hexes$1[s[Dn]];return $n}const asciis$1={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16$1(s){if(s>=asciis$1._0&&s<=asciis$1._9)return s-asciis$1._0;if(s>=asciis$1._A&&s<=asciis$1._F)return s-(asciis$1._A-10);if(s>=asciis$1._a&&s<=asciis$1._f)return s-(asciis$1._a-10)}function hexToBytes$1(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);const $n=s.length,Dn=$n/2;if($n%2)throw new Error("padded hex string expected, got unpadded hex of length "+$n);const Un=new Uint8Array(Dn);for(let Bn=0,In=0;Bn<Dn;Bn++,In+=2){const qn=asciiToBase16$1(s.charCodeAt(In)),Fn=asciiToBase16$1(s.charCodeAt(In+1));if(qn===void 0||Fn===void 0){const Kn=s[In]+s[In+1];throw new Error('hex string expected, got non-hex character "'+Kn+'" at index '+In)}Un[Bn]=qn*16+Fn}return Un}function utf8ToBytes$1(s){if(typeof s!="string")throw new Error(`string expected, got ${typeof s}`);return new Uint8Array(new TextEncoder().encode(s))}function toBytes$1(s){if(typeof s=="string")s=utf8ToBytes$1(s);else if(isBytes$1(s))s=s.slice();else throw new Error(`Uint8Array expected, got ${typeof s}`);return s}function checkOpts(s,$n){if($n==null||typeof $n!="object")throw new Error("options must be defined");return Object.assign(s,$n)}function equalBytes(s,$n){if(s.length!==$n.length)return!1;let Dn=0;for(let Un=0;Un<s.length;Un++)Dn|=s[Un]^$n[Un];return Dn===0}const wrapCipher=(s,$n)=>(Object.assign($n,s),$n);function setBigUint64$1(s,$n,Dn,Un){if(typeof s.setBigUint64=="function")return s.setBigUint64($n,Dn,Un);const Bn=BigInt(32),In=BigInt(4294967295),qn=Number(Dn>>Bn&In),Fn=Number(Dn&In);s.setUint32($n+4,qn,Un),s.setUint32($n+0,Fn,Un)}const BLOCK_SIZE=16,POLY=283;function mul2(s){return s<<1^POLY&-(s>>7)}function mul(s,$n){let Dn=0;for(;$n>0;$n>>=1)Dn^=s&-($n&1),s=mul2(s);return Dn}const sbox=(()=>{let s=new Uint8Array(256);for(let Dn=0,Un=1;Dn<256;Dn++,Un^=mul2(Un))s[Dn]=Un;const $n=new Uint8Array(256);$n[0]=99;for(let Dn=0;Dn<255;Dn++){let Un=s[255-Dn];Un|=Un<<8,$n[s[Dn]]=(Un^Un>>4^Un>>5^Un>>6^Un>>7^99)&255}return $n})(),invSbox=sbox.map((s,$n)=>sbox.indexOf($n)),rotr32_8=s=>s<<24|s>>>8,rotl32_8=s=>s<<8|s>>>24;function genTtable(s,$n){if(s.length!==256)throw new Error("Wrong sbox length");const Dn=new Uint32Array(256).map((jn,Yn)=>$n(s[Yn])),Un=Dn.map(rotl32_8),Bn=Un.map(rotl32_8),In=Bn.map(rotl32_8),qn=new Uint32Array(256*256),Fn=new Uint32Array(256*256),Kn=new Uint16Array(256*256);for(let jn=0;jn<256;jn++)for(let Yn=0;Yn<256;Yn++){const Zn=jn*256+Yn;qn[Zn]=Dn[jn]^Un[Yn],Fn[Zn]=Bn[jn]^In[Yn],Kn[Zn]=s[jn]<<8|s[Yn]}return{sbox:s,sbox2:Kn,T0:Dn,T1:Un,T2:Bn,T3:In,T01:qn,T23:Fn}}const tableEncoding=genTtable(sbox,s=>mul(s,3)<<24|s<<16|s<<8|mul(s,2)),tableDecoding=genTtable(invSbox,s=>mul(s,11)<<24|mul(s,13)<<16|mul(s,9)<<8|mul(s,14)),xPowers=(()=>{const s=new Uint8Array(16);for(let $n=0,Dn=1;$n<16;$n++,Dn=mul2(Dn))s[$n]=Dn;return s})();function expandKeyLE(s){bytes(s);const $n=s.length;if(![16,24,32].includes($n))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${$n}`);const{sbox2:Dn}=tableEncoding,Un=u32(s),Bn=Un.length,In=Fn=>applySbox(Dn,Fn,Fn,Fn,Fn),qn=new Uint32Array($n+28);qn.set(Un);for(let Fn=Bn;Fn<qn.length;Fn++){let Kn=qn[Fn-1];Fn%Bn===0?Kn=In(rotr32_8(Kn))^xPowers[Fn/Bn-1]:Bn>6&&Fn%Bn===4&&(Kn=In(Kn)),qn[Fn]=qn[Fn-Bn]^Kn}return qn}function expandKeyDecLE(s){const $n=expandKeyLE(s),Dn=$n.slice(),Un=$n.length,{sbox2:Bn}=tableEncoding,{T0:In,T1:qn,T2:Fn,T3:Kn}=tableDecoding;for(let jn=0;jn<Un;jn+=4)for(let Yn=0;Yn<4;Yn++)Dn[jn+Yn]=$n[Un-jn-4+Yn];$n.fill(0);for(let jn=4;jn<Un-4;jn++){const Yn=Dn[jn],Zn=applySbox(Bn,Yn,Yn,Yn,Yn);Dn[jn]=In[Zn&255]^qn[Zn>>>8&255]^Fn[Zn>>>16&255]^Kn[Zn>>>24]}return Dn}function apply0123(s,$n,Dn,Un,Bn,In){return s[Dn<<8&65280|Un>>>8&255]^$n[Bn>>>8&65280|In>>>24&255]}function applySbox(s,$n,Dn,Un,Bn){return s[$n&255|Dn&65280]|s[Un>>>16&255|Bn>>>16&65280]<<16}function encrypt$3(s,$n,Dn,Un,Bn){const{sbox2:In,T01:qn,T23:Fn}=tableEncoding;let Kn=0;$n^=s[Kn++],Dn^=s[Kn++],Un^=s[Kn++],Bn^=s[Kn++];const jn=s.length/4-2;for(let Wn=0;Wn<jn;Wn++){const tr=s[Kn++]^apply0123(qn,Fn,$n,Dn,Un,Bn),ir=s[Kn++]^apply0123(qn,Fn,Dn,Un,Bn,$n),sr=s[Kn++]^apply0123(qn,Fn,Un,Bn,$n,Dn),fr=s[Kn++]^apply0123(qn,Fn,Bn,$n,Dn,Un);$n=tr,Dn=ir,Un=sr,Bn=fr}const Yn=s[Kn++]^applySbox(In,$n,Dn,Un,Bn),Zn=s[Kn++]^applySbox(In,Dn,Un,Bn,$n),Xn=s[Kn++]^applySbox(In,Un,Bn,$n,Dn),Jn=s[Kn++]^applySbox(In,Bn,$n,Dn,Un);return{s0:Yn,s1:Zn,s2:Xn,s3:Jn}}function decrypt$3(s,$n,Dn,Un,Bn){const{sbox2:In,T01:qn,T23:Fn}=tableDecoding;let Kn=0;$n^=s[Kn++],Dn^=s[Kn++],Un^=s[Kn++],Bn^=s[Kn++];const jn=s.length/4-2;for(let Wn=0;Wn<jn;Wn++){const tr=s[Kn++]^apply0123(qn,Fn,$n,Bn,Un,Dn),ir=s[Kn++]^apply0123(qn,Fn,Dn,$n,Bn,Un),sr=s[Kn++]^apply0123(qn,Fn,Un,Dn,$n,Bn),fr=s[Kn++]^apply0123(qn,Fn,Bn,Un,Dn,$n);$n=tr,Dn=ir,Un=sr,Bn=fr}const Yn=s[Kn++]^applySbox(In,$n,Bn,Un,Dn),Zn=s[Kn++]^applySbox(In,Dn,$n,Bn,Un),Xn=s[Kn++]^applySbox(In,Un,Dn,$n,Bn),Jn=s[Kn++]^applySbox(In,Bn,Un,Dn,$n);return{s0:Yn,s1:Zn,s2:Xn,s3:Jn}}function getDst(s,$n){if(!$n)return new Uint8Array(s);if(bytes($n),$n.length<s)throw new Error(`aes: wrong destination length, expected at least ${s}, got: ${$n.length}`);return $n}function validateBlockDecrypt(s){if(bytes(s),s.length%BLOCK_SIZE!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${BLOCK_SIZE}`)}function validateBlockEncrypt(s,$n,Dn){let Un=s.length;const Bn=Un%BLOCK_SIZE;if(!$n&&Bn!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const In=u32(s);if($n){let Kn=BLOCK_SIZE-Bn;Kn||(Kn=BLOCK_SIZE),Un=Un+Kn}const qn=getDst(Un,Dn),Fn=u32(qn);return{b:In,o:Fn,out:qn}}function validatePCKS(s,$n){if(!$n)return s;const Dn=s.length;if(!Dn)throw new Error("aes/pcks5: empty ciphertext not allowed");const Un=s[Dn-1];if(Un<=0||Un>16)throw new Error(`aes/pcks5: wrong padding byte: ${Un}`);const Bn=s.subarray(0,-Un);for(let In=0;In<Un;In++)if(s[Dn-In-1]!==Un)throw new Error("aes/pcks5: wrong padding");return Bn}function padPCKS(s){const $n=new Uint8Array(16),Dn=u32($n);$n.set(s);const Un=BLOCK_SIZE-s.length;for(let Bn=BLOCK_SIZE-Un;Bn<BLOCK_SIZE;Bn++)$n[Bn]=Un;return Dn}const cbc=wrapCipher({blockSize:16,nonceLength:16},function s($n,Dn,Un={}){bytes($n),bytes(Dn,16);const Bn=!Un.disablePadding;return{encrypt:(In,qn)=>{const Fn=expandKeyLE($n),{b:Kn,o:jn,out:Yn}=validateBlockEncrypt(In,Bn,qn),Zn=u32(Dn);let Xn=Zn[0],Jn=Zn[1],Wn=Zn[2],tr=Zn[3],ir=0;for(;ir+4<=Kn.length;)Xn^=Kn[ir+0],Jn^=Kn[ir+1],Wn^=Kn[ir+2],tr^=Kn[ir+3],{s0:Xn,s1:Jn,s2:Wn,s3:tr}=encrypt$3(Fn,Xn,Jn,Wn,tr),jn[ir++]=Xn,jn[ir++]=Jn,jn[ir++]=Wn,jn[ir++]=tr;if(Bn){const sr=padPCKS(In.subarray(ir*4));Xn^=sr[0],Jn^=sr[1],Wn^=sr[2],tr^=sr[3],{s0:Xn,s1:Jn,s2:Wn,s3:tr}=encrypt$3(Fn,Xn,Jn,Wn,tr),jn[ir++]=Xn,jn[ir++]=Jn,jn[ir++]=Wn,jn[ir++]=tr}return Fn.fill(0),Yn},decrypt:(In,qn)=>{validateBlockDecrypt(In);const Fn=expandKeyDecLE($n),Kn=u32(Dn),jn=getDst(In.length,qn),Yn=u32(In),Zn=u32(jn);let Xn=Kn[0],Jn=Kn[1],Wn=Kn[2],tr=Kn[3];for(let ir=0;ir+4<=Yn.length;){const sr=Xn,fr=Jn,ur=Wn,br=tr;Xn=Yn[ir+0],Jn=Yn[ir+1],Wn=Yn[ir+2],tr=Yn[ir+3];const{s0:Nr,s1:Ar,s2:_r,s3:Rr}=decrypt$3(Fn,Xn,Jn,Wn,tr);Zn[ir++]=Nr^sr,Zn[ir++]=Ar^fr,Zn[ir++]=_r^ur,Zn[ir++]=Rr^br}return Fn.fill(0),validatePCKS(jn,Bn)}}}),u8to16=(s,$n)=>s[$n++]&255|(s[$n++]&255)<<8;class Poly1305{constructor($n){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,$n=toBytes$1($n),bytes($n,32);const Dn=u8to16($n,0),Un=u8to16($n,2),Bn=u8to16($n,4),In=u8to16($n,6),qn=u8to16($n,8),Fn=u8to16($n,10),Kn=u8to16($n,12),jn=u8to16($n,14);this.r[0]=Dn&8191,this.r[1]=(Dn>>>13|Un<<3)&8191,this.r[2]=(Un>>>10|Bn<<6)&7939,this.r[3]=(Bn>>>7|In<<9)&8191,this.r[4]=(In>>>4|qn<<12)&255,this.r[5]=qn>>>1&8190,this.r[6]=(qn>>>14|Fn<<2)&8191,this.r[7]=(Fn>>>11|Kn<<5)&8065,this.r[8]=(Kn>>>8|jn<<8)&8191,this.r[9]=jn>>>5&127;for(let Yn=0;Yn<8;Yn++)this.pad[Yn]=u8to16($n,16+2*Yn)}process($n,Dn,Un=!1){const Bn=Un?0:2048,{h:In,r:qn}=this,Fn=qn[0],Kn=qn[1],jn=qn[2],Yn=qn[3],Zn=qn[4],Xn=qn[5],Jn=qn[6],Wn=qn[7],tr=qn[8],ir=qn[9],sr=u8to16($n,Dn+0),fr=u8to16($n,Dn+2),ur=u8to16($n,Dn+4),br=u8to16($n,Dn+6),Nr=u8to16($n,Dn+8),Ar=u8to16($n,Dn+10),_r=u8to16($n,Dn+12),Rr=u8to16($n,Dn+14);let Dr=In[0]+(sr&8191),zr=In[1]+((sr>>>13|fr<<3)&8191),dr=In[2]+((fr>>>10|ur<<6)&8191),pr=In[3]+((ur>>>7|br<<9)&8191),lr=In[4]+((br>>>4|Nr<<12)&8191),mr=In[5]+(Nr>>>1&8191),ar=In[6]+((Nr>>>14|Ar<<2)&8191),er=In[7]+((Ar>>>11|_r<<5)&8191),or=In[8]+((_r>>>8|Rr<<8)&8191),wr=In[9]+(Rr>>>5|Bn),vr=0,Sr=vr+Dr*Fn+zr*(5*ir)+dr*(5*tr)+pr*(5*Wn)+lr*(5*Jn);vr=Sr>>>13,Sr&=8191,Sr+=mr*(5*Xn)+ar*(5*Zn)+er*(5*Yn)+or*(5*jn)+wr*(5*Kn),vr+=Sr>>>13,Sr&=8191;let rr=vr+Dr*Kn+zr*Fn+dr*(5*ir)+pr*(5*tr)+lr*(5*Wn);vr=rr>>>13,rr&=8191,rr+=mr*(5*Jn)+ar*(5*Xn)+er*(5*Zn)+or*(5*Yn)+wr*(5*jn),vr+=rr>>>13,rr&=8191;let gr=vr+Dr*jn+zr*Kn+dr*Fn+pr*(5*ir)+lr*(5*tr);vr=gr>>>13,gr&=8191,gr+=mr*(5*Wn)+ar*(5*Jn)+er*(5*Xn)+or*(5*Zn)+wr*(5*Yn),vr+=gr>>>13,gr&=8191;let Tr=vr+Dr*Yn+zr*jn+dr*Kn+pr*Fn+lr*(5*ir);vr=Tr>>>13,Tr&=8191,Tr+=mr*(5*tr)+ar*(5*Wn)+er*(5*Jn)+or*(5*Xn)+wr*(5*Zn),vr+=Tr>>>13,Tr&=8191;let Br=vr+Dr*Zn+zr*Yn+dr*jn+pr*Kn+lr*Fn;vr=Br>>>13,Br&=8191,Br+=mr*(5*ir)+ar*(5*tr)+er*(5*Wn)+or*(5*Jn)+wr*(5*Xn),vr+=Br>>>13,Br&=8191;let Ur=vr+Dr*Xn+zr*Zn+dr*Yn+pr*jn+lr*Kn;vr=Ur>>>13,Ur&=8191,Ur+=mr*Fn+ar*(5*ir)+er*(5*tr)+or*(5*Wn)+wr*(5*Jn),vr+=Ur>>>13,Ur&=8191;let qr=vr+Dr*Jn+zr*Xn+dr*Zn+pr*Yn+lr*jn;vr=qr>>>13,qr&=8191,qr+=mr*Kn+ar*Fn+er*(5*ir)+or*(5*tr)+wr*(5*Wn),vr+=qr>>>13,qr&=8191;let Hr=vr+Dr*Wn+zr*Jn+dr*Xn+pr*Zn+lr*Yn;vr=Hr>>>13,Hr&=8191,Hr+=mr*jn+ar*Kn+er*Fn+or*(5*ir)+wr*(5*tr),vr+=Hr>>>13,Hr&=8191;let Yr=vr+Dr*tr+zr*Wn+dr*Jn+pr*Xn+lr*Zn;vr=Yr>>>13,Yr&=8191,Yr+=mr*Yn+ar*jn+er*Kn+or*Fn+wr*(5*ir),vr+=Yr>>>13,Yr&=8191;let Kr=vr+Dr*ir+zr*tr+dr*Wn+pr*Jn+lr*Xn;vr=Kr>>>13,Kr&=8191,Kr+=mr*Zn+ar*Yn+er*jn+or*Kn+wr*Fn,vr+=Kr>>>13,Kr&=8191,vr=(vr<<2)+vr|0,vr=vr+Sr|0,Sr=vr&8191,vr=vr>>>13,rr+=vr,In[0]=Sr,In[1]=rr,In[2]=gr,In[3]=Tr,In[4]=Br,In[5]=Ur,In[6]=qr,In[7]=Hr,In[8]=Yr,In[9]=Kr}finalize(){const{h:$n,pad:Dn}=this,Un=new Uint16Array(10);let Bn=$n[1]>>>13;$n[1]&=8191;for(let Fn=2;Fn<10;Fn++)$n[Fn]+=Bn,Bn=$n[Fn]>>>13,$n[Fn]&=8191;$n[0]+=Bn*5,Bn=$n[0]>>>13,$n[0]&=8191,$n[1]+=Bn,Bn=$n[1]>>>13,$n[1]&=8191,$n[2]+=Bn,Un[0]=$n[0]+5,Bn=Un[0]>>>13,Un[0]&=8191;for(let Fn=1;Fn<10;Fn++)Un[Fn]=$n[Fn]+Bn,Bn=Un[Fn]>>>13,Un[Fn]&=8191;Un[9]-=8192;let In=(Bn^1)-1;for(let Fn=0;Fn<10;Fn++)Un[Fn]&=In;In=~In;for(let Fn=0;Fn<10;Fn++)$n[Fn]=$n[Fn]&In|Un[Fn];$n[0]=($n[0]|$n[1]<<13)&65535,$n[1]=($n[1]>>>3|$n[2]<<10)&65535,$n[2]=($n[2]>>>6|$n[3]<<7)&65535,$n[3]=($n[3]>>>9|$n[4]<<4)&65535,$n[4]=($n[4]>>>12|$n[5]<<1|$n[6]<<14)&65535,$n[5]=($n[6]>>>2|$n[7]<<11)&65535,$n[6]=($n[7]>>>5|$n[8]<<8)&65535,$n[7]=($n[8]>>>8|$n[9]<<5)&65535;let qn=$n[0]+Dn[0];$n[0]=qn&65535;for(let Fn=1;Fn<8;Fn++)qn=($n[Fn]+Dn[Fn]|0)+(qn>>>16)|0,$n[Fn]=qn&65535}update($n){exists(this);const{buffer:Dn,blockLen:Un}=this;$n=toBytes$1($n);const Bn=$n.length;for(let In=0;In<Bn;){const qn=Math.min(Un-this.pos,Bn-In);if(qn===Un){for(;Un<=Bn-In;In+=Un)this.process($n,In);continue}Dn.set($n.subarray(In,In+qn),this.pos),this.pos+=qn,In+=qn,this.pos===Un&&(this.process(Dn,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto($n){exists(this),output($n,this),this.finished=!0;const{buffer:Dn,h:Un}=this;let{pos:Bn}=this;if(Bn){for(Dn[Bn++]=1;Bn<16;Bn++)Dn[Bn]=0;this.process(Dn,0,!0)}this.finalize();let In=0;for(let qn=0;qn<8;qn++)$n[In++]=Un[qn]>>>0,$n[In++]=Un[qn]>>>8;return $n}digest(){const{buffer:$n,outputLen:Dn}=this;this.digestInto($n);const Un=$n.slice(0,Dn);return this.destroy(),Un}}function wrapConstructorWithKey(s){const $n=(Un,Bn)=>s(Bn).update(toBytes$1(Un)).digest(),Dn=s(new Uint8Array(32));return $n.outputLen=Dn.outputLen,$n.blockLen=Dn.blockLen,$n.create=Un=>s(Un),$n}const poly1305=wrapConstructorWithKey(s=>new Poly1305(s)),_utf8ToBytes=s=>Uint8Array.from(s.split("").map($n=>$n.charCodeAt(0))),sigma16=_utf8ToBytes("expand 16-byte k"),sigma32=_utf8ToBytes("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32);sigma32_32.slice();function rotl$1(s,$n){return s<<$n|s>>>32-$n}function isAligned32(s){return s.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(s,$n,Dn,Un,Bn,In,qn,Fn){const Kn=Bn.length,jn=new Uint8Array(BLOCK_LEN),Yn=u32(jn),Zn=isAligned32(Bn)&&isAligned32(In),Xn=Zn?u32(Bn):U32_EMPTY,Jn=Zn?u32(In):U32_EMPTY;for(let Wn=0;Wn<Kn;qn++){if(s($n,Dn,Un,Yn,qn,Fn),qn>=MAX_COUNTER)throw new Error("arx: counter overflow");const tr=Math.min(BLOCK_LEN,Kn-Wn);if(Zn&&tr===BLOCK_LEN){const ir=Wn/4;if(Wn%4!==0)throw new Error("arx: invalid block position");for(let sr=0,fr;sr<BLOCK_LEN32;sr++)fr=ir+sr,Jn[fr]=Xn[fr]^Yn[sr];Wn+=BLOCK_LEN;continue}for(let ir=0,sr;ir<tr;ir++)sr=Wn+ir,In[sr]=Bn[sr]^jn[ir];Wn+=tr}}function createCipher(s,$n){const{allowShortKeys:Dn,extendNonceFn:Un,counterLength:Bn,counterRight:In,rounds:qn}=checkOpts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},$n);if(typeof s!="function")throw new Error("core must be a function");return number(Bn),number(qn),bool(In),bool(Dn),(Fn,Kn,jn,Yn,Zn=0)=>{bytes(Fn),bytes(Kn),bytes(jn);const Xn=jn.length;if(Yn||(Yn=new Uint8Array(Xn)),bytes(Yn),number(Zn),Zn<0||Zn>=MAX_COUNTER)throw new Error("arx: counter overflow");if(Yn.length<Xn)throw new Error(`arx: output (${Yn.length}) is shorter than data (${Xn})`);const Jn=[];let Wn=Fn.length,tr,ir;if(Wn===32)tr=Fn.slice(),Jn.push(tr),ir=sigma32_32;else if(Wn===16&&Dn)tr=new Uint8Array(32),tr.set(Fn),tr.set(Fn,16),ir=sigma16_32,Jn.push(tr);else throw new Error(`arx: invalid 32-byte key, got length=${Wn}`);isAligned32(Kn)||(Kn=Kn.slice(),Jn.push(Kn));const sr=u32(tr);if(Un){if(Kn.length!==24)throw new Error("arx: extended nonce must be 24 bytes");Un(ir,sr,u32(Kn.subarray(0,16)),sr),Kn=Kn.subarray(16)}const fr=16-Bn;if(fr!==Kn.length)throw new Error(`arx: nonce must be ${fr} or 16 bytes`);if(fr!==12){const br=new Uint8Array(12);br.set(Kn,In?0:12-Kn.length),Kn=br,Jn.push(Kn)}const ur=u32(Kn);for(runCipher(s,ir,sr,ur,jn,Yn,Zn,qn);Jn.length>0;)Jn.pop().fill(0);return Yn}}function chachaCore(s,$n,Dn,Un,Bn,In=20){let qn=s[0],Fn=s[1],Kn=s[2],jn=s[3],Yn=$n[0],Zn=$n[1],Xn=$n[2],Jn=$n[3],Wn=$n[4],tr=$n[5],ir=$n[6],sr=$n[7],fr=Bn,ur=Dn[0],br=Dn[1],Nr=Dn[2],Ar=qn,_r=Fn,Rr=Kn,Dr=jn,zr=Yn,dr=Zn,pr=Xn,lr=Jn,mr=Wn,ar=tr,er=ir,or=sr,wr=fr,vr=ur,Sr=br,rr=Nr;for(let Tr=0;Tr<In;Tr+=2)Ar=Ar+zr|0,wr=rotl$1(wr^Ar,16),mr=mr+wr|0,zr=rotl$1(zr^mr,12),Ar=Ar+zr|0,wr=rotl$1(wr^Ar,8),mr=mr+wr|0,zr=rotl$1(zr^mr,7),_r=_r+dr|0,vr=rotl$1(vr^_r,16),ar=ar+vr|0,dr=rotl$1(dr^ar,12),_r=_r+dr|0,vr=rotl$1(vr^_r,8),ar=ar+vr|0,dr=rotl$1(dr^ar,7),Rr=Rr+pr|0,Sr=rotl$1(Sr^Rr,16),er=er+Sr|0,pr=rotl$1(pr^er,12),Rr=Rr+pr|0,Sr=rotl$1(Sr^Rr,8),er=er+Sr|0,pr=rotl$1(pr^er,7),Dr=Dr+lr|0,rr=rotl$1(rr^Dr,16),or=or+rr|0,lr=rotl$1(lr^or,12),Dr=Dr+lr|0,rr=rotl$1(rr^Dr,8),or=or+rr|0,lr=rotl$1(lr^or,7),Ar=Ar+dr|0,rr=rotl$1(rr^Ar,16),er=er+rr|0,dr=rotl$1(dr^er,12),Ar=Ar+dr|0,rr=rotl$1(rr^Ar,8),er=er+rr|0,dr=rotl$1(dr^er,7),_r=_r+pr|0,wr=rotl$1(wr^_r,16),or=or+wr|0,pr=rotl$1(pr^or,12),_r=_r+pr|0,wr=rotl$1(wr^_r,8),or=or+wr|0,pr=rotl$1(pr^or,7),Rr=Rr+lr|0,vr=rotl$1(vr^Rr,16),mr=mr+vr|0,lr=rotl$1(lr^mr,12),Rr=Rr+lr|0,vr=rotl$1(vr^Rr,8),mr=mr+vr|0,lr=rotl$1(lr^mr,7),Dr=Dr+zr|0,Sr=rotl$1(Sr^Dr,16),ar=ar+Sr|0,zr=rotl$1(zr^ar,12),Dr=Dr+zr|0,Sr=rotl$1(Sr^Dr,8),ar=ar+Sr|0,zr=rotl$1(zr^ar,7);let gr=0;Un[gr++]=qn+Ar|0,Un[gr++]=Fn+_r|0,Un[gr++]=Kn+Rr|0,Un[gr++]=jn+Dr|0,Un[gr++]=Yn+zr|0,Un[gr++]=Zn+dr|0,Un[gr++]=Xn+pr|0,Un[gr++]=Jn+lr|0,Un[gr++]=Wn+mr|0,Un[gr++]=tr+ar|0,Un[gr++]=ir+er|0,Un[gr++]=sr+or|0,Un[gr++]=fr+wr|0,Un[gr++]=ur+vr|0,Un[gr++]=br+Sr|0,Un[gr++]=Nr+rr|0}function hchacha(s,$n,Dn,Un){let Bn=s[0],In=s[1],qn=s[2],Fn=s[3],Kn=$n[0],jn=$n[1],Yn=$n[2],Zn=$n[3],Xn=$n[4],Jn=$n[5],Wn=$n[6],tr=$n[7],ir=Dn[0],sr=Dn[1],fr=Dn[2],ur=Dn[3];for(let Nr=0;Nr<20;Nr+=2)Bn=Bn+Kn|0,ir=rotl$1(ir^Bn,16),Xn=Xn+ir|0,Kn=rotl$1(Kn^Xn,12),Bn=Bn+Kn|0,ir=rotl$1(ir^Bn,8),Xn=Xn+ir|0,Kn=rotl$1(Kn^Xn,7),In=In+jn|0,sr=rotl$1(sr^In,16),Jn=Jn+sr|0,jn=rotl$1(jn^Jn,12),In=In+jn|0,sr=rotl$1(sr^In,8),Jn=Jn+sr|0,jn=rotl$1(jn^Jn,7),qn=qn+Yn|0,fr=rotl$1(fr^qn,16),Wn=Wn+fr|0,Yn=rotl$1(Yn^Wn,12),qn=qn+Yn|0,fr=rotl$1(fr^qn,8),Wn=Wn+fr|0,Yn=rotl$1(Yn^Wn,7),Fn=Fn+Zn|0,ur=rotl$1(ur^Fn,16),tr=tr+ur|0,Zn=rotl$1(Zn^tr,12),Fn=Fn+Zn|0,ur=rotl$1(ur^Fn,8),tr=tr+ur|0,Zn=rotl$1(Zn^tr,7),Bn=Bn+jn|0,ur=rotl$1(ur^Bn,16),Wn=Wn+ur|0,jn=rotl$1(jn^Wn,12),Bn=Bn+jn|0,ur=rotl$1(ur^Bn,8),Wn=Wn+ur|0,jn=rotl$1(jn^Wn,7),In=In+Yn|0,ir=rotl$1(ir^In,16),tr=tr+ir|0,Yn=rotl$1(Yn^tr,12),In=In+Yn|0,ir=rotl$1(ir^In,8),tr=tr+ir|0,Yn=rotl$1(Yn^tr,7),qn=qn+Zn|0,sr=rotl$1(sr^qn,16),Xn=Xn+sr|0,Zn=rotl$1(Zn^Xn,12),qn=qn+Zn|0,sr=rotl$1(sr^qn,8),Xn=Xn+sr|0,Zn=rotl$1(Zn^Xn,7),Fn=Fn+Kn|0,fr=rotl$1(fr^Fn,16),Jn=Jn+fr|0,Kn=rotl$1(Kn^Jn,12),Fn=Fn+Kn|0,fr=rotl$1(fr^Fn,8),Jn=Jn+fr|0,Kn=rotl$1(Kn^Jn,7);let br=0;Un[br++]=Bn,Un[br++]=In,Un[br++]=qn,Un[br++]=Fn,Un[br++]=ir,Un[br++]=sr,Un[br++]=fr,Un[br++]=ur}const chacha20=createCipher(chachaCore,{counterRight:!1,counterLength:4,allowShortKeys:!1}),xchacha20=createCipher(chachaCore,{counterRight:!1,counterLength:8,extendNonceFn:hchacha,allowShortKeys:!1}),ZEROS16=new Uint8Array(16),updatePadded=(s,$n)=>{s.update($n);const Dn=$n.length%16;Dn&&s.update(ZEROS16.subarray(Dn))},ZEROS32=new Uint8Array(32);function computeTag(s,$n,Dn,Un,Bn){const In=s($n,Dn,ZEROS32),qn=poly1305.create(In);Bn&&updatePadded(qn,Bn),updatePadded(qn,Un);const Fn=new Uint8Array(16),Kn=createView$1(Fn);setBigUint64$1(Kn,0,BigInt(Bn?Bn.length:0),!0),setBigUint64$1(Kn,8,BigInt(Un.length),!0),qn.update(Fn);const jn=qn.digest();return In.fill(0),jn}const _poly1305_aead=s=>($n,Dn,Un)=>(bytes($n,32),bytes(Dn),{encrypt:(Bn,In)=>{const qn=Bn.length,Fn=qn+16;In?bytes(In,Fn):In=new Uint8Array(Fn),s($n,Dn,Bn,In,1);const Kn=computeTag(s,$n,Dn,In.subarray(0,-16),Un);return In.set(Kn,qn),In},decrypt:(Bn,In)=>{const qn=Bn.length,Fn=qn-16;if(qn<16)throw new Error("encrypted data must be at least 16 bytes");In?bytes(In,Fn):In=new Uint8Array(Fn);const Kn=Bn.subarray(0,-16),jn=Bn.subarray(-16),Yn=computeTag(s,$n,Dn,Kn,Un);if(!equalBytes(jn,Yn))throw new Error("invalid tag");return s($n,Dn,Kn,In,1),In}}),xchacha20poly1305=wrapCipher({blockSize:64,nonceLength:24,tagLength:16},_poly1305_aead(xchacha20));let HMAC$1=class extends Hash$1{constructor(s,$n){super(),this.finished=!1,this.destroyed=!1,assert.hash(s);const Dn=toBytes$2($n);if(this.iHash=s.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const Un=this.blockLen,Bn=new Uint8Array(Un);Bn.set(Dn.length>Un?s.create().update(Dn).digest():Dn);for(let In=0;In<Bn.length;In++)Bn[In]^=54;this.iHash.update(Bn),this.oHash=s.create();for(let In=0;In<Bn.length;In++)Bn[In]^=106;this.oHash.update(Bn),Bn.fill(0)}update(s){return assert.exists(this),this.iHash.update(s),this}digestInto(s){assert.exists(this),assert.bytes(s,this.outputLen),this.finished=!0,this.iHash.digestInto(s),this.oHash.update(s),this.oHash.digestInto(s),this.destroy()}digest(){const s=new Uint8Array(this.oHash.outputLen);return this.digestInto(s),s}_cloneInto(s){s||(s=Object.create(Object.getPrototypeOf(this),{}));const{oHash:$n,iHash:Dn,finished:Un,destroyed:Bn,blockLen:In,outputLen:qn}=this;return s=s,s.finished=Un,s.destroyed=Bn,s.blockLen=In,s.outputLen=qn,s.oHash=$n._cloneInto(s.oHash),s.iHash=Dn._cloneInto(s.iHash),s}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$1=(s,$n,Dn)=>new HMAC$1(s,$n).update(Dn).digest();hmac$1.create=(s,$n)=>new HMAC$1(s,$n);function extract(s,$n,Dn){return assert.hash(s),hmac$1(s,toBytes$2(Dn),toBytes$2($n))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER=new Uint8Array;function expand(s,$n,Dn,Un=32){if(assert.hash(s),assert.number(Un),Un>255*s.outputLen)throw new Error("Length should be <= 255*HashLen");const Bn=Math.ceil(Un/s.outputLen);Dn===void 0&&(Dn=EMPTY_BUFFER);const In=new Uint8Array(Bn*s.outputLen),qn=hmac$1.create(s,$n),Fn=qn._cloneInto(),Kn=new Uint8Array(qn.outputLen);for(let jn=0;jn<Bn;jn++)HKDF_COUNTER[0]=jn+1,Fn.update(jn===0?EMPTY_BUFFER:Kn).update(Dn).update(HKDF_COUNTER).digestInto(Kn),In.set(Kn,s.outputLen*jn),qn._cloneInto(Fn);return qn.destroy(),Fn.destroy(),Kn.fill(0),HKDF_COUNTER.fill(0),In.slice(0,Un)}var __defProp$1=Object.defineProperty,__export=(s,$n)=>{for(var Dn in $n)__defProp$1(s,Dn,{get:$n[Dn],enumerable:!0})},verifiedSymbol=Symbol("verified"),isRecord=s=>s instanceof Object;function validateEvent(s){if(!isRecord(s)||typeof s.kind!="number"||typeof s.content!="string"||typeof s.created_at!="number"||typeof s.pubkey!="string"||!s.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(s.tags))return!1;for(let $n=0;$n<s.tags.length;$n++){let Dn=s.tags[$n];if(!Array.isArray(Dn))return!1;for(let Un=0;Un<Dn.length;Un++)if(typeof Dn[Un]!="string")return!1}return!0}var utils_exports={};__export(utils_exports,{Queue:()=>Queue$1,QueueNode:()=>QueueNode,binarySearch:()=>binarySearch,bytesToHex:()=>bytesToHex$2,hexToBytes:()=>hexToBytes$2,insertEventIntoAscendingList:()=>insertEventIntoAscendingList,insertEventIntoDescendingList:()=>insertEventIntoDescendingList,normalizeURL:()=>normalizeURL,utf8Decoder:()=>utf8Decoder$1,utf8Encoder:()=>utf8Encoder$1});var utf8Decoder$1=new TextDecoder("utf-8"),utf8Encoder$1=new TextEncoder;function normalizeURL(s){try{s.indexOf("://")===-1&&(s="wss://"+s);let $n=new URL(s);return $n.protocol==="http:"?$n.protocol="ws:":$n.protocol==="https:"&&($n.protocol="wss:"),$n.pathname=$n.pathname.replace(/\/+/g,"/"),$n.pathname.endsWith("/")&&($n.pathname=$n.pathname.slice(0,-1)),($n.port==="80"&&$n.protocol==="ws:"||$n.port==="443"&&$n.protocol==="wss:")&&($n.port=""),$n.searchParams.sort(),$n.hash="",$n.toString()}catch{throw new Error(`Invalid URL: ${s}`)}}function insertEventIntoDescendingList(s,$n){const[Dn,Un]=binarySearch(s,Bn=>$n.id===Bn.id?0:$n.created_at===Bn.created_at?-1:Bn.created_at-$n.created_at);return Un||s.splice(Dn,0,$n),s}function insertEventIntoAscendingList(s,$n){const[Dn,Un]=binarySearch(s,Bn=>$n.id===Bn.id?0:$n.created_at===Bn.created_at?-1:$n.created_at-Bn.created_at);return Un||s.splice(Dn,0,$n),s}function binarySearch(s,$n){let Dn=0,Un=s.length-1;for(;Dn<=Un;){const Bn=Math.floor((Dn+Un)/2),In=$n(s[Bn]);if(In===0)return[Bn,!0];In<0?Un=Bn-1:Dn=Bn+1}return[Dn,!1]}var QueueNode=class{constructor(s){g$3(this,"value"),g$3(this,"next",null),g$3(this,"prev",null),this.value=s}},Queue$1=class{constructor(){g$3(this,"first"),g$3(this,"last"),this.first=null,this.last=null}enqueue(s){const $n=new QueueNode(s);return this.last?this.last===this.first?(this.last=$n,this.last.prev=this.first,this.first.next=$n):($n.prev=this.last,this.last.next=$n,this.last=$n):(this.first=$n,this.last=$n),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const $n=this.first;return this.first=null,this.last=null,$n.value}const s=this.first;return this.first=s.next,this.first&&(this.first.prev=null),s.value}},JS=class{generateSecretKey(){return schnorr$1.utils.randomPrivateKey()}getPublicKey(s){return bytesToHex$2(schnorr$1.getPublicKey(s))}finalizeEvent(s,$n){const Dn=s;return Dn.pubkey=bytesToHex$2(schnorr$1.getPublicKey($n)),Dn.id=getEventHash$1(Dn),Dn.sig=bytesToHex$2(schnorr$1.sign(getEventHash$1(Dn),$n)),Dn[verifiedSymbol]=!0,Dn}verifyEvent(s){if(typeof s[verifiedSymbol]=="boolean")return s[verifiedSymbol];const $n=getEventHash$1(s);if($n!==s.id)return s[verifiedSymbol]=!1,!1;try{const Dn=schnorr$1.verify(s.sig,$n,s.pubkey);return s[verifiedSymbol]=Dn,Dn}catch{return s[verifiedSymbol]=!1,!1}}};function serializeEvent(s){if(!validateEvent(s))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,s.pubkey,s.created_at,s.kind,s.tags,s.content])}function getEventHash$1(s){let $n=sha256$2(utf8Encoder$1.encode(serializeEvent(s)));return bytesToHex$2($n)}var i$3=new JS,generateSecretKey=i$3.generateSecretKey,getPublicKey=i$3.getPublicKey,finalizeEvent=i$3.finalizeEvent,verifyEvent=i$3.verifyEvent,kinds_exports={};__export(kinds_exports,{Application:()=>Application,BadgeAward:()=>BadgeAward,BadgeDefinition:()=>BadgeDefinition,BlockedRelaysList:()=>BlockedRelaysList,BlossomServerList:()=>BlossomServerList,BookmarkList:()=>BookmarkList,Bookmarksets:()=>Bookmarksets,Calendar:()=>Calendar,CalendarEventRSVP:()=>CalendarEventRSVP,ChannelCreation:()=>ChannelCreation,ChannelHideMessage:()=>ChannelHideMessage,ChannelMessage:()=>ChannelMessage,ChannelMetadata:()=>ChannelMetadata,ChannelMuteUser:()=>ChannelMuteUser,ChatMessage:()=>ChatMessage,ClassifiedListing:()=>ClassifiedListing,ClientAuth:()=>ClientAuth,Comment:()=>Comment,CommunitiesList:()=>CommunitiesList,CommunityDefinition:()=>CommunityDefinition,CommunityPostApproval:()=>CommunityPostApproval,Contacts:()=>Contacts,CreateOrUpdateProduct:()=>CreateOrUpdateProduct,CreateOrUpdateStall:()=>CreateOrUpdateStall,Curationsets:()=>Curationsets,Date:()=>Date2,DirectMessageRelaysList:()=>DirectMessageRelaysList,DraftClassifiedListing:()=>DraftClassifiedListing,DraftLong:()=>DraftLong,Emojisets:()=>Emojisets,EncryptedDirectMessage:()=>EncryptedDirectMessage,EventDeletion:()=>EventDeletion,FavoriteRelays:()=>FavoriteRelays,FileMessage:()=>FileMessage,FileMetadata:()=>FileMetadata,FileServerPreference:()=>FileServerPreference,Followsets:()=>Followsets,ForumThread:()=>ForumThread,GenericRepost:()=>GenericRepost,Genericlists:()=>Genericlists,GiftWrap:()=>GiftWrap,GroupMetadata:()=>GroupMetadata,HTTPAuth:()=>HTTPAuth,Handlerinformation:()=>Handlerinformation,Handlerrecommendation:()=>Handlerrecommendation,Highlights:()=>Highlights,InterestsList:()=>InterestsList,Interestsets:()=>Interestsets,JobFeedback:()=>JobFeedback,JobRequest:()=>JobRequest,JobResult:()=>JobResult,Label:()=>Label,LightningPubRPC:()=>LightningPubRPC,LiveChatMessage:()=>LiveChatMessage,LiveEvent:()=>LiveEvent,LongFormArticle:()=>LongFormArticle,Metadata:()=>Metadata,Mutelist:()=>Mutelist,NWCWalletInfo:()=>NWCWalletInfo,NWCWalletRequest:()=>NWCWalletRequest,NWCWalletResponse:()=>NWCWalletResponse,NormalVideo:()=>NormalVideo,NostrConnect:()=>NostrConnect,OpenTimestamps:()=>OpenTimestamps,Photo:()=>Photo,Pinlist:()=>Pinlist,Poll:()=>Poll,PollResponse:()=>PollResponse,PrivateDirectMessage:()=>PrivateDirectMessage,ProblemTracker:()=>ProblemTracker,ProfileBadges:()=>ProfileBadges,PublicChatsList:()=>PublicChatsList,Reaction:()=>Reaction,RecommendRelay:()=>RecommendRelay,RelayList:()=>RelayList,RelayReview:()=>RelayReview,Relaysets:()=>Relaysets,Report:()=>Report,Reporting:()=>Reporting,Repost:()=>Repost,Seal:()=>Seal,SearchRelaysList:()=>SearchRelaysList,ShortTextNote:()=>ShortTextNote,ShortVideo:()=>ShortVideo,Time:()=>Time,UserEmojiList:()=>UserEmojiList,UserStatuses:()=>UserStatuses,Voice:()=>Voice,VoiceComment:()=>VoiceComment,Zap:()=>Zap,ZapGoal:()=>ZapGoal,ZapRequest:()=>ZapRequest,classifyKind:()=>classifyKind,isAddressableKind:()=>isAddressableKind,isEphemeralKind:()=>isEphemeralKind,isKind:()=>isKind,isRegularKind:()=>isRegularKind,isReplaceableKind:()=>isReplaceableKind});function isRegularKind(s){return s<1e4&&s!==0&&s!==3}function isReplaceableKind(s){return s===0||s===3||1e4<=s&&s<2e4}function isEphemeralKind(s){return 2e4<=s&&s<3e4}function isAddressableKind(s){return 3e4<=s&&s<4e4}function classifyKind(s){return isRegularKind(s)?"regular":isReplaceableKind(s)?"replaceable":isEphemeralKind(s)?"ephemeral":isAddressableKind(s)?"parameterized":"unknown"}function isKind(s,$n){const Dn=$n instanceof Array?$n:[$n];return validateEvent(s)&&Dn.includes(s.kind)||!1}var Metadata=0,ShortTextNote=1,RecommendRelay=2,Contacts=3,EncryptedDirectMessage=4,EventDeletion=5,Repost=6,Reaction=7,BadgeAward=8,ChatMessage=9,ForumThread=11,Seal=13,PrivateDirectMessage=14,FileMessage=15,GenericRepost=16,Photo=20,NormalVideo=21,ShortVideo=22,ChannelCreation=40,ChannelMetadata=41,ChannelMessage=42,ChannelHideMessage=43,ChannelMuteUser=44,OpenTimestamps=1040,GiftWrap=1059,Poll=1068,FileMetadata=1063,Comment=1111,LiveChatMessage=1311,Voice=1222,VoiceComment=1244,ProblemTracker=1971,Report=1984,Reporting=1984,Label=1985,CommunityPostApproval=4550,JobRequest=5999,JobResult=6999,JobFeedback=7e3,ZapGoal=9041,ZapRequest=9734,Zap=9735,Highlights=9802,PollResponse=1018,Mutelist=1e4,Pinlist=10001,RelayList=10002,BookmarkList=10003,CommunitiesList=10004,PublicChatsList=10005,BlockedRelaysList=10006,SearchRelaysList=10007,FavoriteRelays=10012,InterestsList=10015,UserEmojiList=10030,DirectMessageRelaysList=10050,FileServerPreference=10096,BlossomServerList=10063,NWCWalletInfo=13194,LightningPubRPC=21e3,ClientAuth=22242,NWCWalletRequest=23194,NWCWalletResponse=23195,NostrConnect=24133,HTTPAuth=27235,Followsets=3e4,Genericlists=30001,Relaysets=30002,Bookmarksets=30003,Curationsets=30004,ProfileBadges=30008,BadgeDefinition=30009,Interestsets=30015,CreateOrUpdateStall=30017,CreateOrUpdateProduct=30018,LongFormArticle=30023,DraftLong=30024,Emojisets=30030,Application=30078,LiveEvent=30311,UserStatuses=30315,ClassifiedListing=30402,DraftClassifiedListing=30403,Date2=31922,Time=31923,Calendar=31924,CalendarEventRSVP=31925,RelayReview=31987,Handlerrecommendation=31989,Handlerinformation=31990,CommunityDefinition=34550,GroupMetadata=39e3;function matchFilter(s,$n){if(s.ids&&s.ids.indexOf($n.id)===-1||s.kinds&&s.kinds.indexOf($n.kind)===-1||s.authors&&s.authors.indexOf($n.pubkey)===-1)return!1;for(let Dn in s)if(Dn[0]==="#"){let Un=Dn.slice(1),Bn=s[`#${Un}`];if(Bn&&!$n.tags.find(([In,qn])=>In===Dn.slice(1)&&Bn.indexOf(qn)!==-1))return!1}return!(s.since&&$n.created_at<s.since||s.until&&$n.created_at>s.until)}function matchFilters(s,$n){for(let Dn=0;Dn<s.length;Dn++)if(matchFilter(s[Dn],$n))return!0;return!1}var fakejson_exports={};__export(fakejson_exports,{getHex64:()=>getHex64,getInt:()=>getInt,getSubscriptionId:()=>getSubscriptionId,matchEventId:()=>matchEventId,matchEventKind:()=>matchEventKind,matchEventPubkey:()=>matchEventPubkey});function getHex64(s,$n){let Dn=$n.length+3,Un=s.indexOf(`"${$n}":`)+Dn,Bn=s.slice(Un).indexOf('"')+Un+1;return s.slice(Bn,Bn+64)}function getInt(s,$n){let Dn=$n.length,Un=s.indexOf(`"${$n}":`)+Dn+3,Bn=s.slice(Un),In=Math.min(Bn.indexOf(","),Bn.indexOf("}"));return parseInt(Bn.slice(0,In),10)}function getSubscriptionId(s){let $n=s.slice(0,22).indexOf('"EVENT"');if($n===-1)return null;let Dn=s.slice($n+7+1).indexOf('"');if(Dn===-1)return null;let Un=$n+7+1+Dn,Bn=s.slice(Un+1,80).indexOf('"');if(Bn===-1)return null;let In=Un+1+Bn;return s.slice(Un+1,In)}function matchEventId(s,$n){return $n===getHex64(s,"id")}function matchEventPubkey(s,$n){return $n===getHex64(s,"pubkey")}function matchEventKind(s,$n){return $n===getInt(s,"kind")}var nip42_exports={};__export(nip42_exports,{makeAuthEvent:()=>makeAuthEvent});function makeAuthEvent(s,$n){return{kind:ClientAuth,created_at:Math.floor(Date.now()/1e3),tags:[["relay",s],["challenge",$n]],content:""}}async function yieldThread(){return new Promise((s,$n)=>{try{if(typeof MessageChannel<"u"){const Dn=new MessageChannel,Un=()=>{Dn.port1.removeEventListener("message",Un),s()};Dn.port1.addEventListener("message",Un),Dn.port2.postMessage(0),Dn.port1.start()}else typeof setImmediate<"u"?setImmediate(s):typeof setTimeout<"u"?setTimeout(s,0):s()}catch(Dn){console.error("during yield: ",Dn),$n(Dn)}})}var alwaysTrue=s=>(s[verifiedSymbol]=!0,!0),SendingOnClosedConnection=class extends Error{constructor(s,$n){super(`Tried to send message '${s} on a closed connection to ${$n}.`),this.name="SendingOnClosedConnection"}},AbstractRelay=class{constructor(s,$n){g$3(this,"url"),g$3(this,"_connected",!1),g$3(this,"onclose",null),g$3(this,"onnotice",Dn=>console.debug(`NOTICE from ${this.url}: ${Dn}`)),g$3(this,"onauth"),g$3(this,"baseEoseTimeout",4400),g$3(this,"connectionTimeout",4400),g$3(this,"publishTimeout",4400),g$3(this,"pingFrequency",29e3),g$3(this,"pingTimeout",2e4),g$3(this,"resubscribeBackoff",[1e4,1e4,1e4,2e4,2e4,3e4,6e4]),g$3(this,"openSubs",new Map),g$3(this,"enablePing"),g$3(this,"enableReconnect"),g$3(this,"connectionTimeoutHandle"),g$3(this,"reconnectTimeoutHandle"),g$3(this,"pingIntervalHandle"),g$3(this,"reconnectAttempts",0),g$3(this,"closedIntentionally",!1),g$3(this,"connectionPromise"),g$3(this,"openCountRequests",new Map),g$3(this,"openEventPublishes",new Map),g$3(this,"ws"),g$3(this,"incomingMessageQueue",new Queue$1),g$3(this,"queueRunning",!1),g$3(this,"challenge"),g$3(this,"authPromise"),g$3(this,"serial",0),g$3(this,"verifyEvent"),g$3(this,"_WebSocket"),this.url=normalizeURL(s),this.verifyEvent=$n.verifyEvent,this._WebSocket=$n.websocketImplementation||WebSocket,this.enablePing=$n.enablePing,this.enableReconnect=$n.enableReconnect||!1}static async connect(s,$n){const Dn=new AbstractRelay(s,$n);return await Dn.connect(),Dn}closeAllSubscriptions(s){for(let[$n,Dn]of this.openSubs)Dn.close(s);this.openSubs.clear();for(let[$n,Dn]of this.openEventPublishes)Dn.reject(new Error(s));this.openEventPublishes.clear();for(let[$n,Dn]of this.openCountRequests)Dn.reject(new Error(s));this.openCountRequests.clear()}get connected(){return this._connected}async reconnect(){const s=this.resubscribeBackoff[Math.min(this.reconnectAttempts,this.resubscribeBackoff.length-1)];this.reconnectAttempts++,this.reconnectTimeoutHandle=setTimeout(async()=>{try{await this.connect()}catch{}},s)}handleHardClose(s){var $n;this.pingIntervalHandle&&(clearInterval(this.pingIntervalHandle),this.pingIntervalHandle=void 0),this._connected=!1,this.connectionPromise=void 0;const Dn=this.closedIntentionally;this.closedIntentionally=!1,($n=this.onclose)==null||$n.call(this),this.enableReconnect&&!Dn?this.reconnect():this.closeAllSubscriptions(s)}async connect(){return this.connectionPromise?this.connectionPromise:(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((s,$n)=>{this.connectionTimeoutHandle=setTimeout(()=>{var Dn;$n("connection timed out"),this.connectionPromise=void 0,(Dn=this.onclose)==null||Dn.call(this),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(Dn){clearTimeout(this.connectionTimeoutHandle),$n(Dn);return}this.ws.onopen=()=>{this.reconnectTimeoutHandle&&(clearTimeout(this.reconnectTimeoutHandle),this.reconnectTimeoutHandle=void 0),clearTimeout(this.connectionTimeoutHandle),this._connected=!0;const Dn=this.reconnectAttempts>0;this.reconnectAttempts=0;for(const Un of this.openSubs.values()){if(Un.eosed=!1,Dn)for(let Bn=0;Bn<Un.filters.length;Bn++)Un.lastEmitted&&(Un.filters[Bn].since=Un.lastEmitted+1);Un.fire()}this.enablePing&&(this.pingIntervalHandle=setInterval(()=>this.pingpong(),this.pingFrequency)),s()},this.ws.onerror=Dn=>{clearTimeout(this.connectionTimeoutHandle),$n(Dn.message||"websocket error"),this.handleHardClose("relay connection errored")},this.ws.onclose=Dn=>{clearTimeout(this.connectionTimeoutHandle),$n(Dn.message||"websocket closed"),this.handleHardClose("relay connection closed")},this.ws.onmessage=this._onmessage.bind(this)}),this.connectionPromise)}waitForPingPong(){return new Promise(s=>{this.ws.once("pong",()=>s(!0)),this.ws.ping()})}waitForDummyReq(){return new Promise((s,$n)=>{if(!this.connectionPromise)return $n(new Error(`no connection to ${this.url}, can't ping`));try{const Dn=this.subscribe([{ids:["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"],limit:0}],{label:"forced-ping",oneose:()=>{s(!0),Dn.close()},onclose(){s(!0)},eoseTimeout:this.pingTimeout+1e3})}catch(Dn){$n(Dn)}})}async pingpong(){var s,$n,Dn;((s=this.ws)==null?void 0:s.readyState)===1&&(await Promise.any([this.ws&&this.ws.ping&&this.ws.once?this.waitForPingPong():this.waitForDummyReq(),new Promise(Un=>setTimeout(()=>Un(!1),this.pingTimeout))])||(($n=this.ws)==null?void 0:$n.readyState)===this._WebSocket.OPEN&&((Dn=this.ws)==null||Dn.close()))}async runQueue(){for(this.queueRunning=!0;this.handleNext()!==!1;)await yieldThread();this.queueRunning=!1}handleNext(){var s,$n,Dn;const Un=this.incomingMessageQueue.dequeue();if(!Un)return!1;const Bn=getSubscriptionId(Un);if(Bn){const In=this.openSubs.get(Bn);if(!In)return;const qn=getHex64(Un,"id"),Fn=(s=In.alreadyHaveEvent)==null?void 0:s.call(In,qn);if(($n=In.receivedEvent)==null||$n.call(In,this,qn),Fn)return}try{let In=JSON.parse(Un);switch(In[0]){case"EVENT":{const qn=this.openSubs.get(In[1]),Fn=In[2];this.verifyEvent(Fn)&&matchFilters(qn.filters,Fn)&&qn.onevent(Fn),(!qn.lastEmitted||qn.lastEmitted<Fn.created_at)&&(qn.lastEmitted=Fn.created_at);return}case"COUNT":{const qn=In[1],Fn=In[2],Kn=this.openCountRequests.get(qn);Kn&&(Kn.resolve(Fn.count),this.openCountRequests.delete(qn));return}case"EOSE":{const qn=this.openSubs.get(In[1]);if(!qn)return;qn.receivedEose();return}case"OK":{const qn=In[1],Fn=In[2],Kn=In[3],jn=this.openEventPublishes.get(qn);jn&&(clearTimeout(jn.timeout),Fn?jn.resolve(Kn):jn.reject(new Error(Kn)),this.openEventPublishes.delete(qn));return}case"CLOSED":{const qn=In[1],Fn=this.openSubs.get(qn);if(!Fn)return;Fn.closed=!0,Fn.close(In[2]);return}case"NOTICE":{this.onnotice(In[1]);return}case"AUTH":{this.challenge=In[1],this.onauth&&this.auth(this.onauth);return}default:{const qn=this.openSubs.get(In[1]);(Dn=qn?.oncustom)==null||Dn.call(qn,In);return}}}catch{return}}async send(s){if(!this.connectionPromise)throw new SendingOnClosedConnection(s,this.url);this.connectionPromise.then(()=>{var $n;($n=this.ws)==null||$n.send(s)})}async auth(s){const $n=this.challenge;if(!$n)throw new Error("can't perform auth, no challenge was received");return this.authPromise?this.authPromise:(this.authPromise=new Promise(async(Dn,Un)=>{try{let Bn=await s(makeAuthEvent(this.url,$n)),In=setTimeout(()=>{let qn=this.openEventPublishes.get(Bn.id);qn&&(qn.reject(new Error("auth timed out")),this.openEventPublishes.delete(Bn.id))},this.publishTimeout);this.openEventPublishes.set(Bn.id,{resolve:Dn,reject:Un,timeout:In}),this.send('["AUTH",'+JSON.stringify(Bn)+"]")}catch(Bn){console.warn("subscribe auth function failed:",Bn)}}),this.authPromise)}async publish(s){const $n=new Promise((Dn,Un)=>{const Bn=setTimeout(()=>{const In=this.openEventPublishes.get(s.id);In&&(In.reject(new Error("publish timed out")),this.openEventPublishes.delete(s.id))},this.publishTimeout);this.openEventPublishes.set(s.id,{resolve:Dn,reject:Un,timeout:Bn})});return this.send('["EVENT",'+JSON.stringify(s)+"]"),$n}async count(s,$n){this.serial++;const Dn=$n?.id||"count:"+this.serial,Un=new Promise((Bn,In)=>{this.openCountRequests.set(Dn,{resolve:Bn,reject:In})});return this.send('["COUNT","'+Dn+'",'+JSON.stringify(s).substring(1)),Un}subscribe(s,$n){const Dn=this.prepareSubscription(s,$n);return Dn.fire(),Dn}prepareSubscription(s,$n){this.serial++;const Dn=$n.id||($n.label?$n.label+":":"sub:")+this.serial,Un=new Subscription(this,Dn,s,$n);return this.openSubs.set(Dn,Un),Un}close(){var s,$n,Dn;this.closedIntentionally=!0,this.reconnectTimeoutHandle&&(clearTimeout(this.reconnectTimeoutHandle),this.reconnectTimeoutHandle=void 0),this.pingIntervalHandle&&(clearInterval(this.pingIntervalHandle),this.pingIntervalHandle=void 0),this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,(s=this.onclose)==null||s.call(this),(($n=this.ws)==null?void 0:$n.readyState)===this._WebSocket.OPEN&&((Dn=this.ws)==null||Dn.close())}_onmessage(s){this.incomingMessageQueue.enqueue(s.data),this.queueRunning||this.runQueue()}},Subscription=class{constructor(s,$n,Dn,Un){if(g$3(this,"relay"),g$3(this,"id"),g$3(this,"lastEmitted"),g$3(this,"closed",!1),g$3(this,"eosed",!1),g$3(this,"filters"),g$3(this,"alreadyHaveEvent"),g$3(this,"receivedEvent"),g$3(this,"onevent"),g$3(this,"oneose"),g$3(this,"onclose"),g$3(this,"oncustom"),g$3(this,"eoseTimeout"),g$3(this,"eoseTimeoutHandle"),Dn.length===0)throw new Error("subscription can't be created with zero filters");this.relay=s,this.filters=Dn,this.id=$n,this.alreadyHaveEvent=Un.alreadyHaveEvent,this.receivedEvent=Un.receivedEvent,this.eoseTimeout=Un.eoseTimeout||s.baseEoseTimeout,this.oneose=Un.oneose,this.onclose=Un.onclose,this.onevent=Un.onevent||(Bn=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,Bn)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){var s;this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,(s=this.oneose)==null||s.call(this))}close(s="closed by caller"){var $n;if(!this.closed&&this.relay.connected){try{this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]")}catch(Dn){if(!(Dn instanceof SendingOnClosedConnection))throw Dn}this.closed=!0}this.relay.openSubs.delete(this.id),($n=this.onclose)==null||$n.call(this,s)}},_WebSocket;try{_WebSocket=WebSocket}catch{}var AbstractSimplePool=class{constructor(s){g$3(this,"relays",new Map),g$3(this,"seenOn",new Map),g$3(this,"trackRelays",!1),g$3(this,"verifyEvent"),g$3(this,"enablePing"),g$3(this,"enableReconnect"),g$3(this,"automaticallyAuth"),g$3(this,"trustedRelayURLs",new Set),g$3(this,"_WebSocket"),this.verifyEvent=s.verifyEvent,this._WebSocket=s.websocketImplementation,this.enablePing=s.enablePing,this.enableReconnect=s.enableReconnect||!1,this.automaticallyAuth=s.automaticallyAuth}async ensureRelay(s,$n){s=normalizeURL(s);let Dn=this.relays.get(s);if(Dn||(Dn=new AbstractRelay(s,{verifyEvent:this.trustedRelayURLs.has(s)?alwaysTrue:this.verifyEvent,websocketImplementation:this._WebSocket,enablePing:this.enablePing,enableReconnect:this.enableReconnect}),Dn.onclose=()=>{Dn&&!Dn.enableReconnect&&this.relays.delete(s)},$n!=null&&$n.connectionTimeout&&(Dn.connectionTimeout=$n.connectionTimeout),this.relays.set(s,Dn)),this.automaticallyAuth){const Un=this.automaticallyAuth(s);Un&&(Dn.onauth=Un)}return await Dn.connect(),Dn}close(s){s.map(normalizeURL).forEach($n=>{var Dn;(Dn=this.relays.get($n))==null||Dn.close(),this.relays.delete($n)})}subscribe(s,$n,Dn){const Un=[];for(let Bn=0;Bn<s.length;Bn++){const In=normalizeURL(s[Bn]);Un.find(qn=>qn.url===In)||Un.push({url:In,filter:$n})}return this.subscribeMap(Un,Dn)}subscribeMany(s,$n,Dn){const Un=[],Bn=[];for(let In=0;In<s.length;In++){const qn=normalizeURL(s[In]);Bn.indexOf(qn)===-1&&(Bn.push(qn),Un.push({url:qn,filter:$n}))}return this.subscribeMap(Un,Dn)}subscribeMap(s,$n){const Dn=new Map;for(const Xn of s){const{url:Jn,filter:Wn}=Xn;Dn.has(Jn)||Dn.set(Jn,[]),Dn.get(Jn).push(Wn)}const Un=Array.from(Dn.entries()).map(([Xn,Jn])=>({url:Xn,filters:Jn}));this.trackRelays&&($n.receivedEvent=(Xn,Jn)=>{let Wn=this.seenOn.get(Jn);Wn||(Wn=new Set,this.seenOn.set(Jn,Wn)),Wn.add(Xn)});const Bn=new Set,In=[],qn=[];let Fn=Xn=>{var Jn;qn[Xn]||(qn[Xn]=!0,qn.filter(Wn=>Wn).length===Un.length&&((Jn=$n.oneose)==null||Jn.call($n),Fn=()=>{}))};const Kn=[];let jn=(Xn,Jn)=>{var Wn;Kn[Xn]||(Fn(Xn),Kn[Xn]=Jn,Kn.filter(tr=>tr).length===Un.length&&((Wn=$n.onclose)==null||Wn.call($n,Kn),jn=()=>{}))};const Yn=Xn=>{var Jn;if((Jn=$n.alreadyHaveEvent)!=null&&Jn.call($n,Xn))return!0;const Wn=Bn.has(Xn);return Bn.add(Xn),Wn},Zn=Promise.all(Un.map(async({url:Xn,filters:Jn},Wn)=>{let tr;try{tr=await this.ensureRelay(Xn,{connectionTimeout:$n.maxWait?Math.max($n.maxWait*.8,$n.maxWait-1e3):void 0})}catch(sr){jn(Wn,sr?.message||String(sr));return}let ir=tr.subscribe(Jn,{...$n,oneose:()=>Fn(Wn),onclose:sr=>{sr.startsWith("auth-required: ")&&$n.onauth?tr.auth($n.onauth).then(()=>{tr.subscribe(Jn,{...$n,oneose:()=>Fn(Wn),onclose:fr=>{jn(Wn,fr)},alreadyHaveEvent:Yn,eoseTimeout:$n.maxWait})}).catch(fr=>{jn(Wn,`auth was required and attempted, but failed with: ${fr}`)}):jn(Wn,sr)},alreadyHaveEvent:Yn,eoseTimeout:$n.maxWait});In.push(ir)}));return{async close(Xn){await Zn,In.forEach(Jn=>{Jn.close(Xn)})}}}subscribeEose(s,$n,Dn){const Un=this.subscribe(s,$n,{...Dn,oneose(){Un.close("closed automatically on eose")}});return Un}subscribeManyEose(s,$n,Dn){const Un=this.subscribeMany(s,$n,{...Dn,oneose(){Un.close("closed automatically on eose")}});return Un}async querySync(s,$n,Dn){return new Promise(async Un=>{const Bn=[];this.subscribeEose(s,$n,{...Dn,onevent(In){Bn.push(In)},onclose(In){Un(Bn)}})})}async get(s,$n,Dn){$n.limit=1;const Un=await this.querySync(s,$n,Dn);return Un.sort((Bn,In)=>In.created_at-Bn.created_at),Un[0]||null}publish(s,$n,Dn){return s.map(normalizeURL).map(async(Un,Bn,In)=>{if(In.indexOf(Un)!==Bn)return Promise.reject("duplicate url");let qn=await this.ensureRelay(Un);return qn.publish($n).catch(async Fn=>{if(Fn instanceof Error&&Fn.message.startsWith("auth-required: ")&&Dn!=null&&Dn.onauth)return await qn.auth(Dn.onauth),qn.publish($n);throw Fn}).then(Fn=>{if(this.trackRelays){let Kn=this.seenOn.get($n.id);Kn||(Kn=new Set,this.seenOn.set($n.id,Kn)),Kn.add(qn)}return Fn})})}listConnectionStatus(){const s=new Map;return this.relays.forEach(($n,Dn)=>s.set(Dn,$n.connected)),s}destroy(){this.relays.forEach(s=>s.close()),this.relays=new Map}},_WebSocket2;try{_WebSocket2=WebSocket}catch{}var SimplePool=class extends AbstractSimplePool{constructor(s){super({verifyEvent,websocketImplementation:_WebSocket2,...s})}},nip19_exports$1={};__export(nip19_exports$1,{BECH32_REGEX:()=>BECH32_REGEX$2,Bech32MaxSize:()=>Bech32MaxSize$2,NostrTypeGuard:()=>NostrTypeGuard$1,decode:()=>decode$1,decodeNostrURI:()=>decodeNostrURI$1,encodeBytes:()=>encodeBytes$2,naddrEncode:()=>naddrEncode$1,neventEncode:()=>neventEncode$1,noteEncode:()=>noteEncode$1,nprofileEncode:()=>nprofileEncode$1,npubEncode:()=>npubEncode$1,nsecEncode:()=>nsecEncode$1});var NostrTypeGuard$1={isNProfile:s=>/^nprofile1[a-z\d]+$/.test(s||""),isNEvent:s=>/^nevent1[a-z\d]+$/.test(s||""),isNAddr:s=>/^naddr1[a-z\d]+$/.test(s||""),isNSec:s=>/^nsec1[a-z\d]{58}$/.test(s||""),isNPub:s=>/^npub1[a-z\d]{58}$/.test(s||""),isNote:s=>/^note1[a-z\d]+$/.test(s||""),isNcryptsec:s=>/^ncryptsec1[a-z\d]+$/.test(s||"")},Bech32MaxSize$2=5e3,BECH32_REGEX$2=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array$1(s){const $n=new Uint8Array(4);return $n[0]=s>>24&255,$n[1]=s>>16&255,$n[2]=s>>8&255,$n[3]=s&255,$n}function decodeNostrURI$1(s){try{return s.startsWith("nostr:")&&(s=s.substring(6)),decode$1(s)}catch{return{type:"invalid",data:null}}}function decode$1(s){var $n,Dn,Un,Bn,In,qn,Fn;let{prefix:Kn,words:jn}=bech32$1.decode(s,Bech32MaxSize$2),Yn=new Uint8Array(bech32$1.fromWords(jn));switch(Kn){case"nprofile":{let Zn=parseTLV$1(Yn);if(!(($n=Zn[0])!=null&&$n[0]))throw new Error("missing TLV 0 for nprofile");if(Zn[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$2(Zn[0][0]),relays:Zn[1]?Zn[1].map(Xn=>utf8Decoder$1.decode(Xn)):[]}}}case"nevent":{let Zn=parseTLV$1(Yn);if(!((Dn=Zn[0])!=null&&Dn[0]))throw new Error("missing TLV 0 for nevent");if(Zn[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(Zn[2]&&Zn[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(Zn[3]&&Zn[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$2(Zn[0][0]),relays:Zn[1]?Zn[1].map(Xn=>utf8Decoder$1.decode(Xn)):[],author:(Un=Zn[2])!=null&&Un[0]?bytesToHex$2(Zn[2][0]):void 0,kind:(Bn=Zn[3])!=null&&Bn[0]?parseInt(bytesToHex$2(Zn[3][0]),16):void 0}}}case"naddr":{let Zn=parseTLV$1(Yn);if(!((In=Zn[0])!=null&&In[0]))throw new Error("missing TLV 0 for naddr");if(!((qn=Zn[2])!=null&&qn[0]))throw new Error("missing TLV 2 for naddr");if(Zn[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((Fn=Zn[3])!=null&&Fn[0]))throw new Error("missing TLV 3 for naddr");if(Zn[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder$1.decode(Zn[0][0]),pubkey:bytesToHex$2(Zn[2][0]),kind:parseInt(bytesToHex$2(Zn[3][0]),16),relays:Zn[1]?Zn[1].map(Xn=>utf8Decoder$1.decode(Xn)):[]}}}case"nsec":return{type:Kn,data:Yn};case"npub":case"note":return{type:Kn,data:bytesToHex$2(Yn)};default:throw new Error(`unknown prefix ${Kn}`)}}function parseTLV$1(s){let $n={},Dn=s;for(;Dn.length>0;){let Un=Dn[0],Bn=Dn[1],In=Dn.slice(2,2+Bn);if(Dn=Dn.slice(2+Bn),In.length<Bn)throw new Error(`not enough data to read on TLV ${Un}`);$n[Un]=$n[Un]||[],$n[Un].push(In)}return $n}function nsecEncode$1(s){return encodeBytes$2("nsec",s)}function npubEncode$1(s){return encodeBytes$2("npub",hexToBytes$2(s))}function noteEncode$1(s){return encodeBytes$2("note",hexToBytes$2(s))}function encodeBech32$2(s,$n){let Dn=bech32$1.toWords($n);return bech32$1.encode(s,Dn,Bech32MaxSize$2)}function encodeBytes$2(s,$n){return encodeBech32$2(s,$n)}function nprofileEncode$1(s){let $n=encodeTLV$1({0:[hexToBytes$2(s.pubkey)],1:(s.relays||[]).map(Dn=>utf8Encoder$1.encode(Dn))});return encodeBech32$2("nprofile",$n)}function neventEncode$1(s){let $n;s.kind!==void 0&&($n=integerToUint8Array$1(s.kind));let Dn=encodeTLV$1({0:[hexToBytes$2(s.id)],1:(s.relays||[]).map(Un=>utf8Encoder$1.encode(Un)),2:s.author?[hexToBytes$2(s.author)]:[],3:$n?[new Uint8Array($n)]:[]});return encodeBech32$2("nevent",Dn)}function naddrEncode$1(s){let $n=new ArrayBuffer(4);new DataView($n).setUint32(0,s.kind,!1);let Dn=encodeTLV$1({0:[utf8Encoder$1.encode(s.identifier)],1:(s.relays||[]).map(Un=>utf8Encoder$1.encode(Un)),2:[hexToBytes$2(s.pubkey)],3:[new Uint8Array($n)]});return encodeBech32$2("naddr",Dn)}function encodeTLV$1(s){let $n=[];return Object.entries(s).reverse().forEach(([Dn,Un])=>{Un.forEach(Bn=>{let In=new Uint8Array(Bn.length+2);In.set([parseInt(Dn)],0),In.set([Bn.length],1),In.set(Bn,2),$n.push(In)})}),concatBytes$1(...$n)}var nip04_exports={};__export(nip04_exports,{decrypt:()=>decrypt$2,encrypt:()=>encrypt$2});function encrypt$2(s,$n,Dn){const Un=s instanceof Uint8Array?bytesToHex$2(s):s,Bn=secp256k1$1.getSharedSecret(Un,"02"+$n),In=getNormalizedX(Bn);let qn=Uint8Array.from(randomBytes$1(16)),Fn=utf8Encoder$1.encode(Dn),Kn=cbc(In,qn).encrypt(Fn),jn=base64.encode(new Uint8Array(Kn)),Yn=base64.encode(new Uint8Array(qn.buffer));return`${jn}?iv=${Yn}`}function decrypt$2(s,$n,Dn){const Un=s instanceof Uint8Array?bytesToHex$2(s):s;let[Bn,In]=Dn.split("?iv="),qn=secp256k1$1.getSharedSecret(Un,"02"+$n),Fn=getNormalizedX(qn),Kn=base64.decode(In),jn=base64.decode(Bn),Yn=cbc(Fn,Kn).decrypt(jn);return utf8Decoder$1.decode(Yn)}function getNormalizedX(s){return s.slice(1,33)}var nip05_exports={};__export(nip05_exports,{NIP05_REGEX:()=>NIP05_REGEX$1,isNip05:()=>isNip05,isValid:()=>isValid,queryProfile:()=>queryProfile,searchDomain:()=>searchDomain,useFetchImplementation:()=>useFetchImplementation});var NIP05_REGEX$1=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,isNip05=s=>NIP05_REGEX$1.test(s||""),_fetch;try{_fetch=fetch}catch(s){}function useFetchImplementation(s){_fetch=s}async function searchDomain(s,$n=""){try{const Dn=`https://${s}/.well-known/nostr.json?name=${$n}`,Un=await _fetch(Dn,{redirect:"manual"});if(Un.status!==200)throw Error("Wrong response code");return(await Un.json()).names}catch{return{}}}async function queryProfile(s){var $n;const Dn=s.match(NIP05_REGEX$1);if(!Dn)return null;const[,Un="_",Bn]=Dn;try{const In=`https://${Bn}/.well-known/nostr.json?name=${Un}`,qn=await _fetch(In,{redirect:"manual"});if(qn.status!==200)throw Error("Wrong response code");const Fn=await qn.json(),Kn=Fn.names[Un];return Kn?{pubkey:Kn,relays:($n=Fn.relays)==null?void 0:$n[Kn]}:null}catch{return null}}async function isValid(s,$n){const Dn=await queryProfile($n);return Dn?Dn.pubkey===s:!1}var nip10_exports={};__export(nip10_exports,{parse:()=>parse});function parse(s){const $n={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let Dn,Un;for(let Bn=s.tags.length-1;Bn>=0;Bn--){const In=s.tags[Bn];if(In[0]==="e"&&In[1]){const[qn,Fn,Kn,jn,Yn]=In,Zn={id:Fn,relays:Kn?[Kn]:[],author:Yn};if(jn==="root"){$n.root=Zn;continue}if(jn==="reply"){$n.reply=Zn;continue}if(jn==="mention"){$n.mentions.push(Zn);continue}Dn?Un=Zn:Dn=Zn,$n.mentions.push(Zn);continue}if(In[0]==="q"&&In[1]){const[qn,Fn,Kn]=In;$n.quotes.push({id:Fn,relays:Kn?[Kn]:[]})}if(In[0]==="p"&&In[1]){$n.profiles.push({pubkey:In[1],relays:In[2]?[In[2]]:[]});continue}}return $n.root||($n.root=Un||Dn||$n.reply),$n.reply||($n.reply=Dn||$n.root),[$n.reply,$n.root].forEach(Bn=>{if(!Bn)return;let In=$n.mentions.indexOf(Bn);if(In!==-1&&$n.mentions.splice(In,1),Bn.author){let qn=$n.profiles.find(Fn=>Fn.pubkey===Bn.author);qn&&qn.relays&&(Bn.relays||(Bn.relays=[]),qn.relays.forEach(Fn=>{var Kn;((Kn=Bn.relays)==null?void 0:Kn.indexOf(Fn))===-1&&Bn.relays.push(Fn)}),qn.relays=Bn.relays)}}),$n.mentions.forEach(Bn=>{if(Bn.author){let In=$n.profiles.find(qn=>qn.pubkey===Bn.author);In&&In.relays&&(Bn.relays||(Bn.relays=[]),In.relays.forEach(qn=>{Bn.relays.indexOf(qn)===-1&&Bn.relays.push(qn)}),In.relays=Bn.relays)}}),$n}var nip11_exports={};__export(nip11_exports,{fetchRelayInformation:()=>fetchRelayInformation$1,useFetchImplementation:()=>useFetchImplementation2});var _fetch2;try{_fetch2=fetch}catch{}function useFetchImplementation2(s){_fetch2=s}async function fetchRelayInformation$1(s){return await(await fetch(s.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var nip13_exports={};__export(nip13_exports,{fastEventHash:()=>fastEventHash,getPow:()=>getPow,minePow:()=>minePow});function getPow(s){let $n=0;for(let Dn=0;Dn<64;Dn+=8){const Un=parseInt(s.substring(Dn,Dn+8),16);if(Un===0)$n+=32;else{$n+=Math.clz32(Un);break}}return $n}function minePow(s,$n){let Dn=0;const Un=s,Bn=["nonce",Dn.toString(),$n.toString()];for(Un.tags.push(Bn);;){const In=Math.floor(new Date().getTime()/1e3);if(In!==Un.created_at&&(Dn=0,Un.created_at=In),Bn[1]=(++Dn).toString(),Un.id=fastEventHash(Un),getPow(Un.id)>=$n)break}return Un}function fastEventHash(s){return bytesToHex$2(sha256$2(utf8Encoder$1.encode(JSON.stringify([0,s.pubkey,s.created_at,s.kind,s.tags,s.content]))))}var nip17_exports={};__export(nip17_exports,{unwrapEvent:()=>unwrapEvent2,unwrapManyEvents:()=>unwrapManyEvents2,wrapEvent:()=>wrapEvent2,wrapManyEvents:()=>wrapManyEvents2});var nip59_exports={};__export(nip59_exports,{createRumor:()=>createRumor,createSeal:()=>createSeal,createWrap:()=>createWrap,unwrapEvent:()=>unwrapEvent,unwrapManyEvents:()=>unwrapManyEvents,wrapEvent:()=>wrapEvent$1,wrapManyEvents:()=>wrapManyEvents});var nip44_exports={};__export(nip44_exports,{decrypt:()=>decrypt2,encrypt:()=>encrypt2,getConversationKey:()=>getConversationKey,v2:()=>v2});var minPlaintextSize=1,maxPlaintextSize=65535;function getConversationKey(s,$n){const Dn=secp256k1$1.getSharedSecret(s,"02"+$n).subarray(1,33);return extract(sha256$2,Dn,"nip44-v2")}function getMessageKeys(s,$n){const Dn=expand(sha256$2,s,$n,76);return{chacha_key:Dn.subarray(0,32),chacha_nonce:Dn.subarray(32,44),hmac_key:Dn.subarray(44,76)}}function calcPaddedLen(s){if(!Number.isSafeInteger(s)||s<1)throw new Error("expected positive integer");if(s<=32)return 32;const $n=1<<Math.floor(Math.log2(s-1))+1,Dn=$n<=256?32:$n/8;return Dn*(Math.floor((s-1)/Dn)+1)}function writeU16BE(s){if(!Number.isSafeInteger(s)||s<minPlaintextSize||s>maxPlaintextSize)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const $n=new Uint8Array(2);return new DataView($n.buffer).setUint16(0,s,!1),$n}function pad(s){const $n=utf8Encoder$1.encode(s),Dn=$n.length,Un=writeU16BE(Dn),Bn=new Uint8Array(calcPaddedLen(Dn)-Dn);return concatBytes$1(Un,$n,Bn)}function unpad(s){const $n=new DataView(s.buffer).getUint16(0),Dn=s.subarray(2,2+$n);if($n<minPlaintextSize||$n>maxPlaintextSize||Dn.length!==$n||s.length!==2+calcPaddedLen($n))throw new Error("invalid padding");return utf8Decoder$1.decode(Dn)}function hmacAad(s,$n,Dn){if(Dn.length!==32)throw new Error("AAD associated data must be 32 bytes");const Un=concatBytes$1(Dn,$n);return hmac$1(sha256$2,s,Un)}function decodePayload(s){if(typeof s!="string")throw new Error("payload must be a valid string");const $n=s.length;if($n<132||$n>87472)throw new Error("invalid payload length: "+$n);if(s[0]==="#")throw new Error("unknown encryption version");let Dn;try{Dn=base64.decode(s)}catch(In){throw new Error("invalid base64: "+In.message)}const Un=Dn.length;if(Un<99||Un>65603)throw new Error("invalid data length: "+Un);const Bn=Dn[0];if(Bn!==2)throw new Error("unknown encryption version "+Bn);return{nonce:Dn.subarray(1,33),ciphertext:Dn.subarray(33,-32),mac:Dn.subarray(-32)}}function encrypt2(s,$n,Dn=randomBytes$1(32)){const{chacha_key:Un,chacha_nonce:Bn,hmac_key:In}=getMessageKeys($n,Dn),qn=pad(s),Fn=chacha20(Un,Bn,qn),Kn=hmacAad(In,Fn,Dn);return base64.encode(concatBytes$1(new Uint8Array([2]),Dn,Fn,Kn))}function decrypt2(s,$n){const{nonce:Dn,ciphertext:Un,mac:Bn}=decodePayload(s),{chacha_key:In,chacha_nonce:qn,hmac_key:Fn}=getMessageKeys($n,Dn),Kn=hmacAad(Fn,Un,Dn);if(!equalBytes(Kn,Bn))throw new Error("invalid MAC");const jn=chacha20(In,qn,Un);return unpad(jn)}var v2={utils:{getConversationKey,calcPaddedLen},encrypt:encrypt2,decrypt:decrypt2},TWO_DAYS=2880*60,now=()=>Math.round(Date.now()/1e3),randomNow=()=>Math.round(now()-Math.random()*TWO_DAYS),nip44ConversationKey=(s,$n)=>getConversationKey(s,$n),nip44Encrypt=(s,$n,Dn)=>encrypt2(JSON.stringify(s),nip44ConversationKey($n,Dn)),nip44Decrypt=(s,$n)=>JSON.parse(decrypt2(s.content,nip44ConversationKey($n,s.pubkey)));function createRumor(s,$n){const Dn={created_at:now(),content:"",tags:[],...s,pubkey:getPublicKey($n)};return Dn.id=getEventHash$1(Dn),Dn}function createSeal(s,$n,Dn){return finalizeEvent({kind:Seal,content:nip44Encrypt(s,$n,Dn),created_at:randomNow(),tags:[]},$n)}function createWrap(s,$n){const Dn=generateSecretKey();return finalizeEvent({kind:GiftWrap,content:nip44Encrypt(s,Dn,$n),created_at:randomNow(),tags:[["p",$n]]},Dn)}function wrapEvent$1(s,$n,Dn){const Un=createRumor(s,$n),Bn=createSeal(Un,$n,Dn);return createWrap(Bn,Dn)}function wrapManyEvents(s,$n,Dn){if(!Dn||Dn.length===0)throw new Error("At least one recipient is required.");const Un=getPublicKey($n),Bn=[wrapEvent$1(s,$n,Un)];return Dn.forEach(In=>{Bn.push(wrapEvent$1(s,$n,In))}),Bn}function unwrapEvent(s,$n){const Dn=nip44Decrypt(s,$n);return nip44Decrypt(Dn,$n)}function unwrapManyEvents(s,$n){let Dn=[];return s.forEach(Un=>{Dn.push(unwrapEvent(Un,$n))}),Dn.sort((Un,Bn)=>Un.created_at-Bn.created_at),Dn}function createEvent(s,$n,Dn,Un){const Bn={created_at:Math.ceil(Date.now()/1e3),kind:PrivateDirectMessage,tags:[],content:$n};return(Array.isArray(s)?s:[s]).forEach(({publicKey:In,relayUrl:qn})=>{Bn.tags.push(qn?["p",In,qn]:["p",In])}),Un&&Bn.tags.push(["e",Un.eventId,Un.relayUrl||"","reply"]),Dn&&Bn.tags.push(["subject",Dn]),Bn}function wrapEvent2(s,$n,Dn,Un,Bn){const In=createEvent($n,Dn,Un,Bn);return wrapEvent$1(In,s,$n.publicKey)}function wrapManyEvents2(s,$n,Dn,Un,Bn){if(!$n||$n.length===0)throw new Error("At least one recipient is required.");return[{publicKey:getPublicKey(s)},...$n].map(In=>wrapEvent2(s,In,Dn,Un,Bn))}var unwrapEvent2=unwrapEvent,unwrapManyEvents2=unwrapManyEvents,nip18_exports={};__export(nip18_exports,{finishRepostEvent:()=>finishRepostEvent,getRepostedEvent:()=>getRepostedEvent,getRepostedEventPointer:()=>getRepostedEventPointer});function finishRepostEvent(s,$n,Dn,Un){var Bn;let In;const qn=[...s.tags??[],["e",$n.id,Dn],["p",$n.pubkey]];return $n.kind===ShortTextNote?In=Repost:(In=GenericRepost,qn.push(["k",String($n.kind)])),finalizeEvent({kind:In,tags:qn,content:s.content===""||(Bn=$n.tags)!=null&&Bn.find(Fn=>Fn[0]==="-")?"":JSON.stringify($n),created_at:s.created_at},Un)}function getRepostedEventPointer(s){if(![Repost,GenericRepost].includes(s.kind))return;let $n,Dn;for(let Un=s.tags.length-1;Un>=0&&($n===void 0||Dn===void 0);Un--){const Bn=s.tags[Un];Bn.length>=2&&(Bn[0]==="e"&&$n===void 0?$n=Bn:Bn[0]==="p"&&Dn===void 0&&(Dn=Bn))}if($n!==void 0)return{id:$n[1],relays:[$n[2],Dn?.[2]].filter(Un=>typeof Un=="string"),author:Dn?.[1]}}function getRepostedEvent(s,{skipVerification:$n}={}){const Dn=getRepostedEventPointer(s);if(Dn===void 0||s.content==="")return;let Un;try{Un=JSON.parse(s.content)}catch{return}if(Un.id===Dn.id&&!(!$n&&!verifyEvent(Un)))return Un}var nip21_exports={};__export(nip21_exports,{NOSTR_URI_REGEX:()=>NOSTR_URI_REGEX,parse:()=>parse2,test:()=>test});var NOSTR_URI_REGEX=new RegExp(`nostr:(${BECH32_REGEX$2.source})`);function test(s){return typeof s=="string"&&new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(s)}function parse2(s){const $n=s.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));if(!$n)throw new Error(`Invalid Nostr URI: ${s}`);return{uri:$n[0],value:$n[1],decoded:decode$1($n[1])}}var nip25_exports={};__export(nip25_exports,{finishReactionEvent:()=>finishReactionEvent,getReactedEventPointer:()=>getReactedEventPointer});function finishReactionEvent(s,$n,Dn){const Un=$n.tags.filter(Bn=>Bn.length>=2&&(Bn[0]==="e"||Bn[0]==="p"));return finalizeEvent({...s,kind:Reaction,tags:[...s.tags??[],...Un,["e",$n.id],["p",$n.pubkey]],content:s.content??"+"},Dn)}function getReactedEventPointer(s){if(s.kind!==Reaction)return;let $n,Dn;for(let Un=s.tags.length-1;Un>=0&&($n===void 0||Dn===void 0);Un--){const Bn=s.tags[Un];Bn.length>=2&&(Bn[0]==="e"&&$n===void 0?$n=Bn:Bn[0]==="p"&&Dn===void 0&&(Dn=Bn))}if(!($n===void 0||Dn===void 0))return{id:$n[1],relays:[$n[2],Dn[2]].filter(Un=>Un!==void 0),author:Dn[1]}}var nip27_exports={};__export(nip27_exports,{parse:()=>parse3});var noCharacter=/\W/m,noURLCharacter=/[^\w\/] |[^\w\/]$|$|,| /m,MAX_HASHTAG_LENGTH=42;function*parse3(s){let $n=[];if(typeof s!="string"){for(let In=0;In<s.tags.length;In++){const qn=s.tags[In];qn[0]==="emoji"&&qn.length>=3&&$n.push({type:"emoji",shortcode:qn[1],url:qn[2]})}s=s.content}const Dn=s.length;let Un=0,Bn=0;t:for(;Bn<Dn;){const In=s.indexOf(":",Bn),qn=s.indexOf("#",Bn);if(In===-1&&qn===-1)break t;if(In===-1||qn>=0&&qn<In){if(qn===0||s[qn-1]===" "){const Fn=s.slice(qn+1,qn+MAX_HASHTAG_LENGTH).match(noCharacter),Kn=Fn?qn+1+Fn.index:Dn;yield{type:"text",text:s.slice(Un,qn)},yield{type:"hashtag",value:s.slice(qn+1,Kn)},Bn=Kn,Un=Bn;continue t}Bn=qn+1;continue t}if(s.slice(In-5,In)==="nostr"){const Fn=s.slice(In+60).match(noCharacter),Kn=Fn?In+60+Fn.index:Dn;try{let jn,{data:Yn,type:Zn}=decode$1(s.slice(In+1,Kn));switch(Zn){case"npub":jn={pubkey:Yn};break;case"note":jn={id:Yn};break;case"nsec":Bn=Kn+1;continue;default:jn=Yn}Un!==In-5&&(yield{type:"text",text:s.slice(Un,In-5)}),yield{type:"reference",pointer:jn},Bn=Kn,Un=Bn;continue t}catch{Bn=In+1;continue t}}else if(s.slice(In-5,In)==="https"||s.slice(In-4,In)==="http"){const Fn=s.slice(In+4).match(noURLCharacter),Kn=Fn?In+4+Fn.index:Dn,jn=s[In-1]==="s"?5:4;try{let Yn=new URL(s.slice(In-jn,Kn));if(Yn.hostname.indexOf(".")===-1)throw new Error("invalid url");if(Un!==In-jn&&(yield{type:"text",text:s.slice(Un,In-jn)}),/\.(png|jpe?g|gif|webp|heic|svg)$/i.test(Yn.pathname)){yield{type:"image",url:Yn.toString()},Bn=Kn,Un=Bn;continue t}if(/\.(mp4|avi|webm|mkv|mov)$/i.test(Yn.pathname)){yield{type:"video",url:Yn.toString()},Bn=Kn,Un=Bn;continue t}if(/\.(mp3|aac|ogg|opus|wav|flac)$/i.test(Yn.pathname)){yield{type:"audio",url:Yn.toString()},Bn=Kn,Un=Bn;continue t}yield{type:"url",url:Yn.toString()},Bn=Kn,Un=Bn;continue t}catch{Bn=Kn+1;continue t}}else if(s.slice(In-3,In)==="wss"||s.slice(In-2,In)==="ws"){const Fn=s.slice(In+4).match(noURLCharacter),Kn=Fn?In+4+Fn.index:Dn,jn=s[In-1]==="s"?3:2;try{let Yn=new URL(s.slice(In-jn,Kn));if(Yn.hostname.indexOf(".")===-1)throw new Error("invalid ws url");Un!==In-jn&&(yield{type:"text",text:s.slice(Un,In-jn)}),yield{type:"relay",url:Yn.toString()},Bn=Kn,Un=Bn;continue t}catch{Bn=Kn+1;continue t}}else{for(let Fn=0;Fn<$n.length;Fn++){const Kn=$n[Fn];if(s[In+Kn.shortcode.length+1]===":"&&s.slice(In+1,In+Kn.shortcode.length+1)===Kn.shortcode){Un!==In&&(yield{type:"text",text:s.slice(Un,In)}),yield Kn,Bn=In+Kn.shortcode.length+2,Un=Bn;continue t}}Bn=In+1;continue t}}Un!==Dn&&(yield{type:"text",text:s.slice(Un)})}var nip28_exports={};__export(nip28_exports,{channelCreateEvent:()=>channelCreateEvent,channelHideMessageEvent:()=>channelHideMessageEvent,channelMessageEvent:()=>channelMessageEvent,channelMetadataEvent:()=>channelMetadataEvent,channelMuteUserEvent:()=>channelMuteUserEvent});var channelCreateEvent=(s,$n)=>{let Dn;if(typeof s.content=="object")Dn=JSON.stringify(s.content);else if(typeof s.content=="string")Dn=s.content;else return;return finalizeEvent({kind:ChannelCreation,tags:[...s.tags??[]],content:Dn,created_at:s.created_at},$n)},channelMetadataEvent=(s,$n)=>{let Dn;if(typeof s.content=="object")Dn=JSON.stringify(s.content);else if(typeof s.content=="string")Dn=s.content;else return;return finalizeEvent({kind:ChannelMetadata,tags:[["e",s.channel_create_event_id],...s.tags??[]],content:Dn,created_at:s.created_at},$n)},channelMessageEvent=(s,$n)=>{const Dn=[["e",s.channel_create_event_id,s.relay_url,"root"]];return s.reply_to_channel_message_event_id&&Dn.push(["e",s.reply_to_channel_message_event_id,s.relay_url,"reply"]),finalizeEvent({kind:ChannelMessage,tags:[...Dn,...s.tags??[]],content:s.content,created_at:s.created_at},$n)},channelHideMessageEvent=(s,$n)=>{let Dn;if(typeof s.content=="object")Dn=JSON.stringify(s.content);else if(typeof s.content=="string")Dn=s.content;else return;return finalizeEvent({kind:ChannelHideMessage,tags:[["e",s.channel_message_event_id],...s.tags??[]],content:Dn,created_at:s.created_at},$n)},channelMuteUserEvent=(s,$n)=>{let Dn;if(typeof s.content=="object")Dn=JSON.stringify(s.content);else if(typeof s.content=="string")Dn=s.content;else return;return finalizeEvent({kind:ChannelMuteUser,tags:[["p",s.pubkey_to_mute],...s.tags??[]],content:Dn,created_at:s.created_at},$n)},nip30_exports={};__export(nip30_exports,{EMOJI_SHORTCODE_REGEX:()=>EMOJI_SHORTCODE_REGEX,matchAll:()=>matchAll,regex:()=>regex,replaceAll:()=>replaceAll});var EMOJI_SHORTCODE_REGEX=/:(\w+):/,regex=()=>new RegExp(`\\B${EMOJI_SHORTCODE_REGEX.source}\\B`,"g");function*matchAll(s){const $n=s.matchAll(regex());for(const Dn of $n)try{const[Un,Bn]=Dn;yield{shortcode:Un,name:Bn,start:Dn.index,end:Dn.index+Un.length}}catch{}}function replaceAll(s,$n){return s.replaceAll(regex(),(Dn,Un)=>$n({shortcode:Dn,name:Un}))}var nip39_exports={};__export(nip39_exports,{useFetchImplementation:()=>useFetchImplementation3,validateGithub:()=>validateGithub});var _fetch3;try{_fetch3=fetch}catch{}function useFetchImplementation3(s){_fetch3=s}async function validateGithub(s,$n,Dn){try{return await(await _fetch3(`https://gist.github.com/${$n}/${Dn}/raw`)).text()===`Verifying that I control the following Nostr public key: ${s}`}catch{return!1}}var nip47_exports={};__export(nip47_exports,{makeNwcRequestEvent:()=>makeNwcRequestEvent,parseConnectionString:()=>parseConnectionString});function parseConnectionString(s){const{host:$n,pathname:Dn,searchParams:Un}=new URL(s),Bn=Dn||$n,In=Un.get("relay"),qn=Un.get("secret");if(!Bn||!In||!qn)throw new Error("invalid connection string");return{pubkey:Bn,relay:In,secret:qn}}async function makeNwcRequestEvent(s,$n,Dn){const Un=encrypt$2($n,s,JSON.stringify({method:"pay_invoice",params:{invoice:Dn}})),Bn={kind:NWCWalletRequest,created_at:Math.round(Date.now()/1e3),content:Un,tags:[["p",s]]};return finalizeEvent(Bn,$n)}var nip54_exports={};__export(nip54_exports,{normalizeIdentifier:()=>normalizeIdentifier});function normalizeIdentifier(s){return s=s.trim().toLowerCase(),s=s.normalize("NFKC"),Array.from(s).map($n=>new RegExp("\\p{Letter}","u").test($n)||new RegExp("\\p{Number}","u").test($n)?$n:"-").join("")}var nip57_exports={};__export(nip57_exports,{getSatoshisAmountFromBolt11:()=>getSatoshisAmountFromBolt11,getZapEndpoint:()=>getZapEndpoint,makeZapReceipt:()=>makeZapReceipt,makeZapRequest:()=>makeZapRequest,useFetchImplementation:()=>useFetchImplementation4,validateZapRequest:()=>validateZapRequest});var _fetch4;try{_fetch4=fetch}catch{}function useFetchImplementation4(s){_fetch4=s}async function getZapEndpoint(s){try{let $n="",{lud06:Dn,lud16:Un}=JSON.parse(s.content);if(Un){let[In,qn]=Un.split("@");$n=new URL(`/.well-known/lnurlp/${In}`,`https://${qn}`).toString()}else if(Dn){let{words:In}=bech32$1.decode(Dn,1e3),qn=bech32$1.fromWords(In);$n=utf8Decoder$1.decode(qn)}else return null;let Bn=await(await _fetch4($n)).json();if(Bn.allowsNostr&&Bn.nostrPubkey)return Bn.callback}catch{}return null}function makeZapRequest(s){let $n={kind:9734,created_at:Math.round(Date.now()/1e3),content:s.comment||"",tags:[["p","pubkey"in s?s.pubkey:s.event.pubkey],["amount",s.amount.toString()],["relays",...s.relays]]};if("event"in s){if($n.tags.push(["e",s.event.id]),isReplaceableKind(s.event.kind)){const Dn=["a",`${s.event.kind}:${s.event.pubkey}:`];$n.tags.push(Dn)}else if(isAddressableKind(s.event.kind)){let Dn=s.event.tags.find(([Bn,In])=>Bn==="d"&&In);if(!Dn)throw new Error("d tag not found or is empty");const Un=["a",`${s.event.kind}:${s.event.pubkey}:${Dn[1]}`];$n.tags.push(Un)}$n.tags.push(["k",s.event.kind.toString()])}return $n}function validateZapRequest(s){let $n;try{$n=JSON.parse(s)}catch{return"Invalid zap request JSON."}if(!validateEvent($n))return"Zap request is not a valid Nostr event.";if(!verifyEvent($n))return"Invalid signature on zap request.";let Dn=$n.tags.find(([Bn,In])=>Bn==="p"&&In);if(!Dn)return"Zap request doesn't have a 'p' tag.";if(!Dn[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let Un=$n.tags.find(([Bn,In])=>Bn==="e"&&In);return Un&&!Un[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":$n.tags.find(([Bn,In])=>Bn==="relays"&&In)?null:"Zap request doesn't have a 'relays' tag."}function makeZapReceipt({zapRequest:s,preimage:$n,bolt11:Dn,paidAt:Un}){let Bn=JSON.parse(s),In=Bn.tags.filter(([Fn])=>Fn==="e"||Fn==="p"||Fn==="a"),qn={kind:9735,created_at:Math.round(Un.getTime()/1e3),content:"",tags:[...In,["P",Bn.pubkey],["bolt11",Dn],["description",s]]};return $n&&qn.tags.push(["preimage",$n]),qn}function getSatoshisAmountFromBolt11(s){if(s.length<50)return 0;s=s.substring(0,50);const $n=s.lastIndexOf("1");if($n===-1)return 0;const Dn=s.substring(0,$n);if(!Dn.startsWith("lnbc"))return 0;const Un=Dn.substring(4);if(Un.length<1)return 0;const Bn=Un[Un.length-1],In=Bn.charCodeAt(0)-48,qn=In>=0&&In<=9;let Fn=Un.length-1;if(qn&&Fn++,Fn<1)return 0;const Kn=parseInt(Un.substring(0,Fn));switch(Bn){case"m":return Kn*1e5;case"u":return Kn*100;case"n":return Kn/10;case"p":return Kn/1e4;default:return Kn*1e8}}var nip77_exports={};__export(nip77_exports,{Negentropy:()=>Negentropy,NegentropyStorageVector:()=>NegentropyStorageVector,NegentropySync:()=>NegentropySync});var PROTOCOL_VERSION=97,ID_SIZE=32,FINGERPRINT_SIZE=16,Mode={Skip:0,Fingerprint:1,IdList:2},WrappedBuffer=class{constructor(s){g$3(this,"_raw"),g$3(this,"length"),typeof s=="number"?(this._raw=new Uint8Array(s),this.length=0):s instanceof Uint8Array?(this._raw=new Uint8Array(s),this.length=s.length):(this._raw=new Uint8Array(512),this.length=0)}unwrap(){return this._raw.subarray(0,this.length)}get capacity(){return this._raw.byteLength}extend(s){if(s instanceof WrappedBuffer&&(s=s.unwrap()),typeof s.length!="number")throw Error("bad length");const $n=s.length+this.length;if(this.capacity<$n){const Dn=this._raw,Un=Math.max(this.capacity*2,$n);this._raw=new Uint8Array(Un),this._raw.set(Dn)}this._raw.set(s,this.length),this.length+=s.length}shift(){const s=this._raw[0];return this._raw=this._raw.subarray(1),this.length--,s}shiftN(s=1){const $n=this._raw.subarray(0,s);return this._raw=this._raw.subarray(s),this.length-=s,$n}};function decodeVarInt(s){let $n=0;for(;;){if(s.length===0)throw Error("parse ends prematurely");let Dn=s.shift();if($n=$n<<7|Dn&127,!(Dn&128))break}return $n}function encodeVarInt(s){if(s===0)return new WrappedBuffer(new Uint8Array([0]));let $n=[];for(;s!==0;)$n.push(s&127),s>>>=7;$n.reverse();for(let Dn=0;Dn<$n.length-1;Dn++)$n[Dn]|=128;return new WrappedBuffer(new Uint8Array($n))}function getByte(s){return getBytes(s,1)[0]}function getBytes(s,$n){if(s.length<$n)throw Error("parse ends prematurely");return s.shiftN($n)}var Accumulator=class{constructor(){g$3(this,"buf"),this.setToZero()}setToZero(){this.buf=new Uint8Array(ID_SIZE)}add(s){let $n=0,Dn=0,Un=new DataView(this.buf.buffer),Bn=new DataView(s.buffer);for(let In=0;In<8;In++){let qn=In*4,Fn=Un.getUint32(qn,!0),Kn=Bn.getUint32(qn,!0),jn=Fn;jn+=$n,jn+=Kn,jn>4294967295&&(Dn=1),Un.setUint32(qn,jn&4294967295,!0),$n=Dn,Dn=0}}negate(){let s=new DataView(this.buf.buffer);for(let Dn=0;Dn<8;Dn++){let Un=Dn*4;s.setUint32(Un,~s.getUint32(Un,!0))}let $n=new Uint8Array(ID_SIZE);$n[0]=1,this.add($n)}getFingerprint(s){let $n=new WrappedBuffer;return $n.extend(this.buf),$n.extend(encodeVarInt(s)),sha256$2($n.unwrap()).subarray(0,FINGERPRINT_SIZE)}},NegentropyStorageVector=class{constructor(){g$3(this,"items"),g$3(this,"sealed"),this.items=[],this.sealed=!1}insert(s,$n){if(this.sealed)throw Error("already sealed");const Dn=hexToBytes$1($n);if(Dn.byteLength!==ID_SIZE)throw Error("bad id size for added item");this.items.push({timestamp:s,id:Dn})}seal(){if(this.sealed)throw Error("already sealed");this.sealed=!0,this.items.sort(itemCompare);for(let s=1;s<this.items.length;s++)if(itemCompare(this.items[s-1],this.items[s])===0)throw Error("duplicate item inserted")}unseal(){this.sealed=!1}size(){return this._checkSealed(),this.items.length}getItem(s){if(this._checkSealed(),s>=this.items.length)throw Error("out of range");return this.items[s]}iterate(s,$n,Dn){this._checkSealed(),this._checkBounds(s,$n);for(let Un=s;Un<$n&&Dn(this.items[Un],Un);++Un);}findLowerBound(s,$n,Dn){return this._checkSealed(),this._checkBounds(s,$n),this._binarySearch(this.items,s,$n,Un=>itemCompare(Un,Dn)<0)}fingerprint(s,$n){let Dn=new Accumulator;return Dn.setToZero(),this.iterate(s,$n,Un=>(Dn.add(Un.id),!0)),Dn.getFingerprint($n-s)}_checkSealed(){if(!this.sealed)throw Error("not sealed")}_checkBounds(s,$n){if(s>$n||$n>this.items.length)throw Error("bad range")}_binarySearch(s,$n,Dn,Un){let Bn=Dn-$n;for(;Bn>0;){let In=$n,qn=Math.floor(Bn/2);In+=qn,Un(s[In])?($n=++In,Bn-=qn+1):Bn=qn}return $n}},Negentropy=class{constructor(s,$n=6e4){if(g$3(this,"storage"),g$3(this,"frameSizeLimit"),g$3(this,"lastTimestampIn"),g$3(this,"lastTimestampOut"),$n<4096)throw Error("frameSizeLimit too small");this.storage=s,this.frameSizeLimit=$n,this.lastTimestampIn=0,this.lastTimestampOut=0}_bound(s,$n){return{timestamp:s,id:$n||new Uint8Array(0)}}initiate(){let s=new WrappedBuffer;return s.extend(new Uint8Array([PROTOCOL_VERSION])),this.splitRange(0,this.storage.size(),this._bound(Number.MAX_VALUE),s),bytesToHex$1(s.unwrap())}reconcile(s,$n,Dn){const Un=new WrappedBuffer(hexToBytes$1(s));this.lastTimestampIn=this.lastTimestampOut=0;let Bn=new WrappedBuffer;Bn.extend(new Uint8Array([PROTOCOL_VERSION]));let In=getByte(Un);if(In<96||In>111)throw Error("invalid negentropy protocol version byte");if(In!==PROTOCOL_VERSION)throw Error("unsupported negentropy protocol version requested: "+(In-96));let qn=this.storage.size(),Fn=this._bound(0),Kn=0,jn=!1;for(;Un.length!==0;){let Yn=new WrappedBuffer,Zn=()=>{jn&&(jn=!1,Yn.extend(this.encodeBound(Fn)),Yn.extend(encodeVarInt(Mode.Skip)))},Xn=this.decodeBound(Un),Jn=decodeVarInt(Un),Wn=Kn,tr=this.storage.findLowerBound(Kn,qn,Xn);if(Jn===Mode.Skip)jn=!0;else if(Jn===Mode.Fingerprint){let ir=getBytes(Un,FINGERPRINT_SIZE),sr=this.storage.fingerprint(Wn,tr);compareUint8Array(ir,sr)!==0?(Zn(),this.splitRange(Wn,tr,Xn,Yn)):jn=!0}else if(Jn===Mode.IdList){let ir=decodeVarInt(Un),sr={};for(let fr=0;fr<ir;fr++){let ur=getBytes(Un,ID_SIZE);sr[bytesToHex$1(ur)]=ur}if(jn=!0,this.storage.iterate(Wn,tr,fr=>{let ur=fr.id;const br=bytesToHex$1(ur);return sr[br]?delete sr[bytesToHex$1(ur)]:$n?.(br),!0}),Dn)for(let fr of Object.values(sr))Dn(bytesToHex$1(fr))}else throw Error("unexpected mode");if(this.exceededFrameSizeLimit(Bn.length+Yn.length)){let ir=this.storage.fingerprint(tr,qn);Bn.extend(this.encodeBound(this._bound(Number.MAX_VALUE))),Bn.extend(encodeVarInt(Mode.Fingerprint)),Bn.extend(ir);break}else Bn.extend(Yn);Kn=tr,Fn=Xn}return Bn.length===1?null:bytesToHex$1(Bn.unwrap())}splitRange(s,$n,Dn,Un){let Bn=$n-s,In=16;if(Bn<In*2)Un.extend(this.encodeBound(Dn)),Un.extend(encodeVarInt(Mode.IdList)),Un.extend(encodeVarInt(Bn)),this.storage.iterate(s,$n,qn=>(Un.extend(qn.id),!0));else{let qn=Math.floor(Bn/In),Fn=Bn%In,Kn=s;for(let jn=0;jn<In;jn++){let Yn=qn+(jn<Fn?1:0),Zn=this.storage.fingerprint(Kn,Kn+Yn);Kn+=Yn;let Xn;if(Kn===$n)Xn=Dn;else{let Jn,Wn;this.storage.iterate(Kn-1,Kn+1,(tr,ir)=>(ir===Kn-1?Jn=tr:Wn=tr,!0)),Xn=this.getMinimalBound(Jn,Wn)}Un.extend(this.encodeBound(Xn)),Un.extend(encodeVarInt(Mode.Fingerprint)),Un.extend(Zn)}}}exceededFrameSizeLimit(s){return s>this.frameSizeLimit-200}decodeTimestampIn(s){let $n=decodeVarInt(s);return $n=$n===0?Number.MAX_VALUE:$n-1,this.lastTimestampIn===Number.MAX_VALUE||$n===Number.MAX_VALUE?(this.lastTimestampIn=Number.MAX_VALUE,Number.MAX_VALUE):($n+=this.lastTimestampIn,this.lastTimestampIn=$n,$n)}decodeBound(s){let $n=this.decodeTimestampIn(s),Dn=decodeVarInt(s);if(Dn>ID_SIZE)throw Error("bound key too long");let Un=getBytes(s,Dn);return{timestamp:$n,id:Un}}encodeTimestampOut(s){if(s===Number.MAX_VALUE)return this.lastTimestampOut=Number.MAX_VALUE,encodeVarInt(0);let $n=s;return s-=this.lastTimestampOut,this.lastTimestampOut=$n,encodeVarInt(s+1)}encodeBound(s){let $n=new WrappedBuffer;return $n.extend(this.encodeTimestampOut(s.timestamp)),$n.extend(encodeVarInt(s.id.length)),$n.extend(s.id),$n}getMinimalBound(s,$n){if($n.timestamp!==s.timestamp)return this._bound($n.timestamp);{let Dn=0,Un=$n.id,Bn=s.id;for(let In=0;In<ID_SIZE&&Un[In]===Bn[In];In++)Dn++;return this._bound($n.timestamp,$n.id.subarray(0,Dn+1))}}};function compareUint8Array(s,$n){for(let Dn=0;Dn<s.byteLength;Dn++){if(s[Dn]<$n[Dn])return-1;if(s[Dn]>$n[Dn])return 1}return s.byteLength>$n.byteLength?1:s.byteLength<$n.byteLength?-1:0}function itemCompare(s,$n){return s.timestamp===$n.timestamp?compareUint8Array(s.id,$n.id):s.timestamp-$n.timestamp}var NegentropySync=class{constructor(s,$n,Dn,Un={}){g$3(this,"relay"),g$3(this,"storage"),g$3(this,"neg"),g$3(this,"filter"),g$3(this,"subscription"),g$3(this,"onhave"),g$3(this,"onneed"),this.relay=s,this.storage=$n,this.neg=new Negentropy($n),this.onhave=Un.onhave,this.onneed=Un.onneed,this.filter=Dn,this.subscription=this.relay.prepareSubscription([{}],{label:Un.label||"negentropy"}),this.subscription.oncustom=Bn=>{var In,qn,Fn,Kn;switch(Bn[0]){case"NEG-MSG":{Bn.length<3&&console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${Bn}`);try{const jn=this.neg.reconcile(Bn[2],this.onhave,this.onneed);jn?this.relay.send(`["NEG-MSG", "${this.subscription.id}", "${jn}"]`):(this.close(),(In=Un.onclose)==null||In.call(Un))}catch(jn){console.error("negentropy reconcile error:",jn),(qn=Un?.onclose)==null||qn.call(Un,`reconcile error: ${jn}`)}break}case"NEG-CLOSE":{const jn=Bn[2];console.warn("negentropy error:",jn),(Fn=Un.onclose)==null||Fn.call(Un,jn);break}case"NEG-ERR":(Kn=Un.onclose)==null||Kn.call(Un)}}}async start(){const s=this.neg.initiate();this.relay.send(`["NEG-OPEN","${this.subscription.id}",${JSON.stringify(this.filter)},"${s}"]`)}close(){this.relay.send(`["NEG-CLOSE","${this.subscription.id}"]`),this.subscription.close()}},nip98_exports={};__export(nip98_exports,{getToken:()=>getToken,hashPayload:()=>hashPayload,unpackEventFromToken:()=>unpackEventFromToken,validateEvent:()=>validateEvent2,validateEventKind:()=>validateEventKind,validateEventMethodTag:()=>validateEventMethodTag,validateEventPayloadTag:()=>validateEventPayloadTag,validateEventTimestamp:()=>validateEventTimestamp,validateEventUrlTag:()=>validateEventUrlTag,validateToken:()=>validateToken});var _authorizationScheme="Nostr ";async function getToken(s,$n,Dn,Un=!1,Bn){const In={kind:HTTPAuth,tags:[["u",s],["method",$n]],created_at:Math.round(new Date().getTime()/1e3),content:""};Bn&&In.tags.push(["payload",hashPayload(Bn)]);const qn=await Dn(In);return(Un?_authorizationScheme:"")+base64.encode(utf8Encoder$1.encode(JSON.stringify(qn)))}async function validateToken(s,$n,Dn){const Un=await unpackEventFromToken(s).catch(Bn=>{throw Bn});return await validateEvent2(Un,$n,Dn).catch(Bn=>{throw Bn})}async function unpackEventFromToken(s){if(!s)throw new Error("Missing token");s=s.replace(_authorizationScheme,"");const $n=utf8Decoder$1.decode(base64.decode(s));if(!$n||$n.length===0||!$n.startsWith("{"))throw new Error("Invalid token");return JSON.parse($n)}function validateEventTimestamp(s){return s.created_at?Math.round(new Date().getTime()/1e3)-s.created_at<60:!1}function validateEventKind(s){return s.kind===HTTPAuth}function validateEventUrlTag(s,$n){const Dn=s.tags.find(Un=>Un[0]==="u");return Dn?Dn.length>0&&Dn[1]===$n:!1}function validateEventMethodTag(s,$n){const Dn=s.tags.find(Un=>Un[0]==="method");return Dn?Dn.length>0&&Dn[1].toLowerCase()===$n.toLowerCase():!1}function hashPayload(s){const $n=sha256$2(utf8Encoder$1.encode(JSON.stringify(s)));return bytesToHex$2($n)}function validateEventPayloadTag(s,$n){const Dn=s.tags.find(Bn=>Bn[0]==="payload");if(!Dn)return!1;const Un=hashPayload($n);return Dn.length>0&&Dn[1]===Un}async function validateEvent2(s,$n,Dn,Un){if(!verifyEvent(s))throw new Error("Invalid nostr event, signature invalid");if(!validateEventKind(s))throw new Error("Invalid nostr event, kind invalid");if(!validateEventTimestamp(s))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!validateEventUrlTag(s,$n))throw new Error("Invalid nostr event, url tag invalid");if(!validateEventMethodTag(s,Dn))throw new Error("Invalid nostr event, method tag invalid");if(Un&&typeof Un=="object"&&Object.keys(Un).length>0&&!validateEventPayloadTag(s,Un))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}const index$1=Object.freeze(Object.defineProperty({__proto__:null,SimplePool,finalizeEvent,fj:fakejson_exports,generateSecretKey,getEventHash:getEventHash$1,getPublicKey,kinds:kinds_exports,matchFilter,matchFilters,nip04:nip04_exports,nip05:nip05_exports,nip10:nip10_exports,nip11:nip11_exports,nip13:nip13_exports,nip17:nip17_exports,nip18:nip18_exports,nip19:nip19_exports$1,nip21:nip21_exports,nip25:nip25_exports,nip27:nip27_exports,nip28:nip28_exports,nip30:nip30_exports,nip39:nip39_exports,nip42:nip42_exports,nip44:nip44_exports,nip47:nip47_exports,nip54:nip54_exports,nip57:nip57_exports,nip59:nip59_exports,nip77:nip77_exports,nip98:nip98_exports,serializeEvent,utils:utils_exports,validateEvent,verifiedSymbol,verifyEvent},Symbol.toStringTag,{value:"Module"})),crypto$3=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function isBytes(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function anumber(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function abytes(s,...$n){if(!isBytes(s))throw new Error("Uint8Array expected");if($n.length>0&&!$n.includes(s.length))throw new Error("Uint8Array expected of length "+$n+", got length="+s.length)}function ahash(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");anumber(s.outputLen),anumber(s.blockLen)}function aexists(s,$n=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if($n&&s.finished)throw new Error("Hash#digest() has already been called")}function aoutput(s,$n){abytes(s);const Dn=$n.outputLen;if(s.length<Dn)throw new Error("digestInto() expects output buffer of length at least "+Dn)}function clean(...s){for(let $n=0;$n<s.length;$n++)s[$n].fill(0)}function createView(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function rotr(s,$n){return s<<32-$n|s>>>$n}const hasHexBuiltin=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes=Array.from({length:256},(s,$n)=>$n.toString(16).padStart(2,"0"));function bytesToHex(s){if(abytes(s),hasHexBuiltin)return s.toHex();let $n="";for(let Dn=0;Dn<s.length;Dn++)$n+=hexes[s[Dn]];return $n}const asciis={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(s){if(s>=asciis._0&&s<=asciis._9)return s-asciis._0;if(s>=asciis.A&&s<=asciis.F)return s-(asciis.A-10);if(s>=asciis.a&&s<=asciis.f)return s-(asciis.a-10)}function hexToBytes(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);if(hasHexBuiltin)return Uint8Array.fromHex(s);const $n=s.length,Dn=$n/2;if($n%2)throw new Error("hex string expected, got unpadded hex of length "+$n);const Un=new Uint8Array(Dn);for(let Bn=0,In=0;Bn<Dn;Bn++,In+=2){const qn=asciiToBase16(s.charCodeAt(In)),Fn=asciiToBase16(s.charCodeAt(In+1));if(qn===void 0||Fn===void 0){const Kn=s[In]+s[In+1];throw new Error('hex string expected, got non-hex character "'+Kn+'" at index '+In)}Un[Bn]=qn*16+Fn}return Un}function utf8ToBytes(s){if(typeof s!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(s))}function toBytes(s){return typeof s=="string"&&(s=utf8ToBytes(s)),abytes(s),s}function concatBytes(...s){let $n=0;for(let Un=0;Un<s.length;Un++){const Bn=s[Un];abytes(Bn),$n+=Bn.length}const Dn=new Uint8Array($n);for(let Un=0,Bn=0;Un<s.length;Un++){const In=s[Un];Dn.set(In,Bn),Bn+=In.length}return Dn}class Hash{}function createHasher(s){const $n=Un=>s().update(toBytes(Un)).digest(),Dn=s();return $n.outputLen=Dn.outputLen,$n.blockLen=Dn.blockLen,$n.create=()=>s(),$n}function randomBytes(s=32){if(crypto$3&&typeof crypto$3.getRandomValues=="function")return crypto$3.getRandomValues(new Uint8Array(s));if(crypto$3&&typeof crypto$3.randomBytes=="function")return Uint8Array.from(crypto$3.randomBytes(s));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(s,$n,Dn,Un){if(typeof s.setBigUint64=="function")return s.setBigUint64($n,Dn,Un);const Bn=BigInt(32),In=BigInt(4294967295),qn=Number(Dn>>Bn&In),Fn=Number(Dn&In),Kn=Un?4:0,jn=Un?0:4;s.setUint32($n+Kn,qn,Un),s.setUint32($n+jn,Fn,Un)}function Chi(s,$n,Dn){return s&$n^~s&Dn}function Maj(s,$n,Dn){return s&$n^s&Dn^$n&Dn}class HashMD extends Hash{constructor($n,Dn,Un,Bn){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=$n,this.outputLen=Dn,this.padOffset=Un,this.isLE=Bn,this.buffer=new Uint8Array($n),this.view=createView(this.buffer)}update($n){aexists(this),$n=toBytes($n),abytes($n);const{view:Dn,buffer:Un,blockLen:Bn}=this,In=$n.length;for(let qn=0;qn<In;){const Fn=Math.min(Bn-this.pos,In-qn);if(Fn===Bn){const Kn=createView($n);for(;Bn<=In-qn;qn+=Bn)this.process(Kn,qn);continue}Un.set($n.subarray(qn,qn+Fn),this.pos),this.pos+=Fn,qn+=Fn,this.pos===Bn&&(this.process(Dn,0),this.pos=0)}return this.length+=$n.length,this.roundClean(),this}digestInto($n){aexists(this),aoutput($n,this),this.finished=!0;const{buffer:Dn,view:Un,blockLen:Bn,isLE:In}=this;let{pos:qn}=this;Dn[qn++]=128,clean(this.buffer.subarray(qn)),this.padOffset>Bn-qn&&(this.process(Un,0),qn=0);for(let Zn=qn;Zn<Bn;Zn++)Dn[Zn]=0;setBigUint64(Un,Bn-8,BigInt(this.length*8),In),this.process(Un,0);const Fn=createView($n),Kn=this.outputLen;if(Kn%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const jn=Kn/4,Yn=this.get();if(jn>Yn.length)throw new Error("_sha2: outputLen bigger than state");for(let Zn=0;Zn<jn;Zn++)Fn.setUint32(4*Zn,Yn[Zn],In)}digest(){const{buffer:$n,outputLen:Dn}=this;this.digestInto($n);const Un=$n.slice(0,Dn);return this.destroy(),Un}_cloneInto($n){$n||($n=new this.constructor),$n.set(...this.get());const{blockLen:Dn,buffer:Un,length:Bn,finished:In,destroyed:qn,pos:Fn}=this;return $n.destroyed=qn,$n.finished=In,$n.length=Bn,$n.pos=Fn,Bn%Dn&&$n.buffer.set(Un),$n}clone(){return this._cloneInto()}}const SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_K=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor($n=32){super(64,$n,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:$n,B:Dn,C:Un,D:Bn,E:In,F:qn,G:Fn,H:Kn}=this;return[$n,Dn,Un,Bn,In,qn,Fn,Kn]}set($n,Dn,Un,Bn,In,qn,Fn,Kn){this.A=$n|0,this.B=Dn|0,this.C=Un|0,this.D=Bn|0,this.E=In|0,this.F=qn|0,this.G=Fn|0,this.H=Kn|0}process($n,Dn){for(let Zn=0;Zn<16;Zn++,Dn+=4)SHA256_W[Zn]=$n.getUint32(Dn,!1);for(let Zn=16;Zn<64;Zn++){const Xn=SHA256_W[Zn-15],Jn=SHA256_W[Zn-2],Wn=rotr(Xn,7)^rotr(Xn,18)^Xn>>>3,tr=rotr(Jn,17)^rotr(Jn,19)^Jn>>>10;SHA256_W[Zn]=tr+SHA256_W[Zn-7]+Wn+SHA256_W[Zn-16]|0}let{A:Un,B:Bn,C:In,D:qn,E:Fn,F:Kn,G:jn,H:Yn}=this;for(let Zn=0;Zn<64;Zn++){const Xn=rotr(Fn,6)^rotr(Fn,11)^rotr(Fn,25),Jn=Yn+Xn+Chi(Fn,Kn,jn)+SHA256_K[Zn]+SHA256_W[Zn]|0,Wn=(rotr(Un,2)^rotr(Un,13)^rotr(Un,22))+Maj(Un,Bn,In)|0;Yn=jn,jn=Kn,Kn=Fn,Fn=qn+Jn|0,qn=In,In=Bn,Bn=Un,Un=Jn+Wn|0}Un=Un+this.A|0,Bn=Bn+this.B|0,In=In+this.C|0,qn=qn+this.D|0,Fn=Fn+this.E|0,Kn=Kn+this.F|0,jn=jn+this.G|0,Yn=Yn+this.H|0,this.set(Un,Bn,In,qn,Fn,Kn,jn,Yn)}roundClean(){clean(SHA256_W)}destroy(){this.set(0,0,0,0,0,0,0,0),clean(this.buffer)}}const sha256$1=createHasher(()=>new SHA256);class HMAC extends Hash{constructor($n,Dn){super(),this.finished=!1,this.destroyed=!1,ahash($n);const Un=toBytes(Dn);if(this.iHash=$n.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const Bn=this.blockLen,In=new Uint8Array(Bn);In.set(Un.length>Bn?$n.create().update(Un).digest():Un);for(let qn=0;qn<In.length;qn++)In[qn]^=54;this.iHash.update(In),this.oHash=$n.create();for(let qn=0;qn<In.length;qn++)In[qn]^=106;this.oHash.update(In),clean(In)}update($n){return aexists(this),this.iHash.update($n),this}digestInto($n){aexists(this),abytes($n,this.outputLen),this.finished=!0,this.iHash.digestInto($n),this.oHash.update($n),this.oHash.digestInto($n),this.destroy()}digest(){const $n=new Uint8Array(this.oHash.outputLen);return this.digestInto($n),$n}_cloneInto($n){$n||($n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:Dn,iHash:Un,finished:Bn,destroyed:In,blockLen:qn,outputLen:Fn}=this;return $n=$n,$n.finished=Bn,$n.destroyed=In,$n.blockLen=qn,$n.outputLen=Fn,$n.oHash=Dn._cloneInto($n.oHash),$n.iHash=Un._cloneInto($n.iHash),$n}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(s,$n,Dn)=>new HMAC(s,$n).update(Dn).digest();hmac.create=(s,$n)=>new HMAC(s,$n);const _0n$4=BigInt(0),_1n$4=BigInt(1);function _abool2(s,$n=""){if(typeof s!="boolean"){const Dn=$n&&`"${$n}"`;throw new Error(Dn+"expected boolean, got type="+typeof s)}return s}function _abytes2(s,$n,Dn=""){const Un=isBytes(s),Bn=s?.length,In=$n!==void 0;if(!Un||In&&Bn!==$n){const qn=Dn&&`"${Dn}" `,Fn=In?` of length ${$n}`:"",Kn=Un?`length=${Bn}`:`type=${typeof s}`;throw new Error(qn+"expected Uint8Array"+Fn+", got "+Kn)}return s}function numberToHexUnpadded(s){const $n=s.toString(16);return $n.length&1?"0"+$n:$n}function hexToNumber(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return s===""?_0n$4:BigInt("0x"+s)}function bytesToNumberBE(s){return hexToNumber(bytesToHex(s))}function bytesToNumberLE(s){return abytes(s),hexToNumber(bytesToHex(Uint8Array.from(s).reverse()))}function numberToBytesBE(s,$n){return hexToBytes(s.toString(16).padStart($n*2,"0"))}function numberToBytesLE(s,$n){return numberToBytesBE(s,$n).reverse()}function ensureBytes(s,$n,Dn){let Un;if(typeof $n=="string")try{Un=hexToBytes($n)}catch(In){throw new Error(s+" must be hex string or Uint8Array, cause: "+In)}else if(isBytes($n))Un=Uint8Array.from($n);else throw new Error(s+" must be hex string or Uint8Array");const Bn=Un.length;if(typeof Dn=="number"&&Bn!==Dn)throw new Error(s+" of length "+Dn+" expected, got "+Bn);return Un}const isPosBig=s=>typeof s=="bigint"&&_0n$4<=s;function inRange(s,$n,Dn){return isPosBig(s)&&isPosBig($n)&&isPosBig(Dn)&&$n<=s&&s<Dn}function aInRange(s,$n,Dn,Un){if(!inRange($n,Dn,Un))throw new Error("expected valid "+s+": "+Dn+" <= n < "+Un+", got "+$n)}function bitLen(s){let $n;for($n=0;s>_0n$4;s>>=_1n$4,$n+=1);return $n}const bitMask=s=>(_1n$4<<BigInt(s))-_1n$4;function createHmacDrbg(s,$n,Dn){if(typeof s!="number"||s<2)throw new Error("hashLen must be a number");if(typeof $n!="number"||$n<2)throw new Error("qByteLen must be a number");if(typeof Dn!="function")throw new Error("hmacFn must be a function");const Un=Xn=>new Uint8Array(Xn),Bn=Xn=>Uint8Array.of(Xn);let In=Un(s),qn=Un(s),Fn=0;const Kn=()=>{In.fill(1),qn.fill(0),Fn=0},jn=(...Xn)=>Dn(qn,In,...Xn),Yn=(Xn=Un(0))=>{qn=jn(Bn(0),Xn),In=jn(),Xn.length!==0&&(qn=jn(Bn(1),Xn),In=jn())},Zn=()=>{if(Fn++>=1e3)throw new Error("drbg: tried 1000 values");let Xn=0;const Jn=[];for(;Xn<$n;){In=jn();const Wn=In.slice();Jn.push(Wn),Xn+=In.length}return concatBytes(...Jn)};return(Xn,Jn)=>{Kn(),Yn(Xn);let Wn;for(;!(Wn=Jn(Zn()));)Yn();return Kn(),Wn}}function _validateObject(s,$n,Dn={}){if(!s||typeof s!="object")throw new Error("expected valid options object");function Un(Bn,In,qn){const Fn=s[Bn];if(qn&&Fn===void 0)return;const Kn=typeof Fn;if(Kn!==In||Fn===null)throw new Error(`param "${Bn}" is invalid: expected ${In}, got ${Kn}`)}Object.entries($n).forEach(([Bn,In])=>Un(Bn,In,!1)),Object.entries(Dn).forEach(([Bn,In])=>Un(Bn,In,!0))}function memoized(s){const $n=new WeakMap;return(Dn,...Un)=>{const Bn=$n.get(Dn);if(Bn!==void 0)return Bn;const In=s(Dn,...Un);return $n.set(Dn,In),In}}const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$2=BigInt(2),_3n$1=BigInt(3),_4n$1=BigInt(4),_5n=BigInt(5),_7n=BigInt(7),_8n=BigInt(8),_9n=BigInt(9),_16n=BigInt(16);function mod(s,$n){const Dn=s%$n;return Dn>=_0n$3?Dn:$n+Dn}function pow2(s,$n,Dn){let Un=s;for(;$n-- >_0n$3;)Un*=Un,Un%=Dn;return Un}function invert(s,$n){if(s===_0n$3)throw new Error("invert: expected non-zero number");if($n<=_0n$3)throw new Error("invert: expected positive modulus, got "+$n);let Dn=mod(s,$n),Un=$n,Bn=_0n$3,In=_1n$3;for(;Dn!==_0n$3;){const qn=Un/Dn,Fn=Un%Dn,Kn=Bn-In*qn;Un=Dn,Dn=Fn,Bn=In,In=Kn}if(Un!==_1n$3)throw new Error("invert: does not exist");return mod(Bn,$n)}function assertIsSquare(s,$n,Dn){if(!s.eql(s.sqr($n),Dn))throw new Error("Cannot find square root")}function sqrt3mod4(s,$n){const Dn=(s.ORDER+_1n$3)/_4n$1,Un=s.pow($n,Dn);return assertIsSquare(s,Un,$n),Un}function sqrt5mod8(s,$n){const Dn=(s.ORDER-_5n)/_8n,Un=s.mul($n,_2n$2),Bn=s.pow(Un,Dn),In=s.mul($n,Bn),qn=s.mul(s.mul(In,_2n$2),Bn),Fn=s.mul(In,s.sub(qn,s.ONE));return assertIsSquare(s,Fn,$n),Fn}function sqrt9mod16(s){const $n=Field(s),Dn=tonelliShanks(s),Un=Dn($n,$n.neg($n.ONE)),Bn=Dn($n,Un),In=Dn($n,$n.neg(Un)),qn=(s+_7n)/_16n;return(Fn,Kn)=>{let jn=Fn.pow(Kn,qn),Yn=Fn.mul(jn,Un);const Zn=Fn.mul(jn,Bn),Xn=Fn.mul(jn,In),Jn=Fn.eql(Fn.sqr(Yn),Kn),Wn=Fn.eql(Fn.sqr(Zn),Kn);jn=Fn.cmov(jn,Yn,Jn),Yn=Fn.cmov(Xn,Zn,Wn);const tr=Fn.eql(Fn.sqr(Yn),Kn),ir=Fn.cmov(jn,Yn,tr);return assertIsSquare(Fn,ir,Kn),ir}}function tonelliShanks(s){if(s<_3n$1)throw new Error("sqrt is not defined for small field");let $n=s-_1n$3,Dn=0;for(;$n%_2n$2===_0n$3;)$n/=_2n$2,Dn++;let Un=_2n$2;const Bn=Field(s);for(;FpLegendre(Bn,Un)===1;)if(Un++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(Dn===1)return sqrt3mod4;let In=Bn.pow(Un,$n);const qn=($n+_1n$3)/_2n$2;return function(Fn,Kn){if(Fn.is0(Kn))return Kn;if(FpLegendre(Fn,Kn)!==1)throw new Error("Cannot find square root");let jn=Dn,Yn=Fn.mul(Fn.ONE,In),Zn=Fn.pow(Kn,$n),Xn=Fn.pow(Kn,qn);for(;!Fn.eql(Zn,Fn.ONE);){if(Fn.is0(Zn))return Fn.ZERO;let Jn=1,Wn=Fn.sqr(Zn);for(;!Fn.eql(Wn,Fn.ONE);)if(Jn++,Wn=Fn.sqr(Wn),Jn===jn)throw new Error("Cannot find square root");const tr=_1n$3<<BigInt(jn-Jn-1),ir=Fn.pow(Yn,tr);jn=Jn,Yn=Fn.sqr(ir),Zn=Fn.mul(Zn,Yn),Xn=Fn.mul(Xn,ir)}return Xn}}function FpSqrt(s){return s%_4n$1===_3n$1?sqrt3mod4:s%_8n===_5n?sqrt5mod8:s%_16n===_9n?sqrt9mod16(s):tonelliShanks(s)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(s){const $n={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},Dn=FIELD_FIELDS.reduce((Un,Bn)=>(Un[Bn]="function",Un),$n);return _validateObject(s,Dn),s}function FpPow(s,$n,Dn){if(Dn<_0n$3)throw new Error("invalid exponent, negatives unsupported");if(Dn===_0n$3)return s.ONE;if(Dn===_1n$3)return $n;let Un=s.ONE,Bn=$n;for(;Dn>_0n$3;)Dn&_1n$3&&(Un=s.mul(Un,Bn)),Bn=s.sqr(Bn),Dn>>=_1n$3;return Un}function FpInvertBatch(s,$n,Dn=!1){const Un=new Array($n.length).fill(Dn?s.ZERO:void 0),Bn=$n.reduce((qn,Fn,Kn)=>s.is0(Fn)?qn:(Un[Kn]=qn,s.mul(qn,Fn)),s.ONE),In=s.inv(Bn);return $n.reduceRight((qn,Fn,Kn)=>s.is0(Fn)?qn:(Un[Kn]=s.mul(qn,Un[Kn]),s.mul(qn,Fn)),In),Un}function FpLegendre(s,$n){const Dn=(s.ORDER-_1n$3)/_2n$2,Un=s.pow($n,Dn),Bn=s.eql(Un,s.ONE),In=s.eql(Un,s.ZERO),qn=s.eql(Un,s.neg(s.ONE));if(!Bn&&!In&&!qn)throw new Error("invalid Legendre symbol result");return Bn?1:In?0:-1}function nLength(s,$n){$n!==void 0&&anumber($n);const Dn=$n!==void 0?$n:s.toString(2).length,Un=Math.ceil(Dn/8);return{nBitLength:Dn,nByteLength:Un}}function Field(s,$n,Dn=!1,Un={}){if(s<=_0n$3)throw new Error("invalid field: expected ORDER > 0, got "+s);let Bn,In,qn=!1,Fn;if(typeof $n=="object"&&$n!=null){if(Un.sqrt||Dn)throw new Error("cannot specify opts in two arguments");const Xn=$n;Xn.BITS&&(Bn=Xn.BITS),Xn.sqrt&&(In=Xn.sqrt),typeof Xn.isLE=="boolean"&&(Dn=Xn.isLE),typeof Xn.modFromBytes=="boolean"&&(qn=Xn.modFromBytes),Fn=Xn.allowedLengths}else typeof $n=="number"&&(Bn=$n),Un.sqrt&&(In=Un.sqrt);const{nBitLength:Kn,nByteLength:jn}=nLength(s,Bn);if(jn>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let Yn;const Zn=Object.freeze({ORDER:s,isLE:Dn,BITS:Kn,BYTES:jn,MASK:bitMask(Kn),ZERO:_0n$3,ONE:_1n$3,allowedLengths:Fn,create:Xn=>mod(Xn,s),isValid:Xn=>{if(typeof Xn!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof Xn);return _0n$3<=Xn&&Xn<s},is0:Xn=>Xn===_0n$3,isValidNot0:Xn=>!Zn.is0(Xn)&&Zn.isValid(Xn),isOdd:Xn=>(Xn&_1n$3)===_1n$3,neg:Xn=>mod(-Xn,s),eql:(Xn,Jn)=>Xn===Jn,sqr:Xn=>mod(Xn*Xn,s),add:(Xn,Jn)=>mod(Xn+Jn,s),sub:(Xn,Jn)=>mod(Xn-Jn,s),mul:(Xn,Jn)=>mod(Xn*Jn,s),pow:(Xn,Jn)=>FpPow(Zn,Xn,Jn),div:(Xn,Jn)=>mod(Xn*invert(Jn,s),s),sqrN:Xn=>Xn*Xn,addN:(Xn,Jn)=>Xn+Jn,subN:(Xn,Jn)=>Xn-Jn,mulN:(Xn,Jn)=>Xn*Jn,inv:Xn=>invert(Xn,s),sqrt:In||(Xn=>(Yn||(Yn=FpSqrt(s)),Yn(Zn,Xn))),toBytes:Xn=>Dn?numberToBytesLE(Xn,jn):numberToBytesBE(Xn,jn),fromBytes:(Xn,Jn=!0)=>{if(Fn){if(!Fn.includes(Xn.length)||Xn.length>jn)throw new Error("Field.fromBytes: expected "+Fn+" bytes, got "+Xn.length);const tr=new Uint8Array(jn);tr.set(Xn,Dn?0:tr.length-Xn.length),Xn=tr}if(Xn.length!==jn)throw new Error("Field.fromBytes: expected "+jn+" bytes, got "+Xn.length);let Wn=Dn?bytesToNumberLE(Xn):bytesToNumberBE(Xn);if(qn&&(Wn=mod(Wn,s)),!Jn&&!Zn.isValid(Wn))throw new Error("invalid field element: outside of range 0..ORDER");return Wn},invertBatch:Xn=>FpInvertBatch(Zn,Xn),cmov:(Xn,Jn,Wn)=>Wn?Jn:Xn});return Object.freeze(Zn)}function getFieldBytesLength(s){if(typeof s!="bigint")throw new Error("field order must be bigint");const $n=s.toString(2).length;return Math.ceil($n/8)}function getMinHashLength(s){const $n=getFieldBytesLength(s);return $n+Math.ceil($n/2)}function mapHashToField(s,$n,Dn=!1){const Un=s.length,Bn=getFieldBytesLength($n),In=getMinHashLength($n);if(Un<16||Un<In||Un>1024)throw new Error("expected "+In+"-1024 bytes of input, got "+Un);const qn=Dn?bytesToNumberLE(s):bytesToNumberBE(s),Fn=mod(qn,$n-_1n$3)+_1n$3;return Dn?numberToBytesLE(Fn,Bn):numberToBytesBE(Fn,Bn)}const _0n$2=BigInt(0),_1n$2=BigInt(1);function negateCt(s,$n){const Dn=$n.negate();return s?Dn:$n}function normalizeZ(s,$n){const Dn=FpInvertBatch(s.Fp,$n.map(Un=>Un.Z));return $n.map((Un,Bn)=>s.fromAffine(Un.toAffine(Dn[Bn])))}function validateW(s,$n){if(!Number.isSafeInteger(s)||s<=0||s>$n)throw new Error("invalid window size, expected [1.."+$n+"], got W="+s)}function calcWOpts(s,$n){validateW(s,$n);const Dn=Math.ceil($n/s)+1,Un=2**(s-1),Bn=2**s,In=bitMask(s),qn=BigInt(s);return{windows:Dn,windowSize:Un,mask:In,maxNumber:Bn,shiftBy:qn}}function calcOffsets(s,$n,Dn){const{windowSize:Un,mask:Bn,maxNumber:In,shiftBy:qn}=Dn;let Fn=Number(s&Bn),Kn=s>>qn;Fn>Un&&(Fn-=In,Kn+=_1n$2);const jn=$n*Un,Yn=jn+Math.abs(Fn)-1,Zn=Fn===0,Xn=Fn<0,Jn=$n%2!==0;return{nextN:Kn,offset:Yn,isZero:Zn,isNeg:Xn,isNegF:Jn,offsetF:jn}}function validateMSMPoints(s,$n){if(!Array.isArray(s))throw new Error("array expected");s.forEach((Dn,Un)=>{if(!(Dn instanceof $n))throw new Error("invalid point at index "+Un)})}function validateMSMScalars(s,$n){if(!Array.isArray(s))throw new Error("array of scalars expected");s.forEach((Dn,Un)=>{if(!$n.isValid(Dn))throw new Error("invalid scalar at index "+Un)})}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(s){return pointWindowSizes.get(s)||1}function assert0(s){if(s!==_0n$2)throw new Error("invalid wNAF")}class wNAF{constructor($n,Dn){this.BASE=$n.BASE,this.ZERO=$n.ZERO,this.Fn=$n.Fn,this.bits=Dn}_unsafeLadder($n,Dn,Un=this.ZERO){let Bn=$n;for(;Dn>_0n$2;)Dn&_1n$2&&(Un=Un.add(Bn)),Bn=Bn.double(),Dn>>=_1n$2;return Un}precomputeWindow($n,Dn){const{windows:Un,windowSize:Bn}=calcWOpts(Dn,this.bits),In=[];let qn=$n,Fn=qn;for(let Kn=0;Kn<Un;Kn++){Fn=qn,In.push(Fn);for(let jn=1;jn<Bn;jn++)Fn=Fn.add(qn),In.push(Fn);qn=Fn.double()}return In}wNAF($n,Dn,Un){if(!this.Fn.isValid(Un))throw new Error("invalid scalar");let Bn=this.ZERO,In=this.BASE;const qn=calcWOpts($n,this.bits);for(let Fn=0;Fn<qn.windows;Fn++){const{nextN:Kn,offset:jn,isZero:Yn,isNeg:Zn,isNegF:Xn,offsetF:Jn}=calcOffsets(Un,Fn,qn);Un=Kn,Yn?In=In.add(negateCt(Xn,Dn[Jn])):Bn=Bn.add(negateCt(Zn,Dn[jn]))}return assert0(Un),{p:Bn,f:In}}wNAFUnsafe($n,Dn,Un,Bn=this.ZERO){const In=calcWOpts($n,this.bits);for(let qn=0;qn<In.windows&&Un!==_0n$2;qn++){const{nextN:Fn,offset:Kn,isZero:jn,isNeg:Yn}=calcOffsets(Un,qn,In);if(Un=Fn,!jn){const Zn=Dn[Kn];Bn=Bn.add(Yn?Zn.negate():Zn)}}return assert0(Un),Bn}getPrecomputes($n,Dn,Un){let Bn=pointPrecomputes.get(Dn);return Bn||(Bn=this.precomputeWindow(Dn,$n),$n!==1&&(typeof Un=="function"&&(Bn=Un(Bn)),pointPrecomputes.set(Dn,Bn))),Bn}cached($n,Dn,Un){const Bn=getW($n);return this.wNAF(Bn,this.getPrecomputes(Bn,$n,Un),Dn)}unsafe($n,Dn,Un,Bn){const In=getW($n);return In===1?this._unsafeLadder($n,Dn,Bn):this.wNAFUnsafe(In,this.getPrecomputes(In,$n,Un),Dn,Bn)}createCache($n,Dn){validateW(Dn,this.bits),pointWindowSizes.set($n,Dn),pointPrecomputes.delete($n)}hasCache($n){return getW($n)!==1}}function mulEndoUnsafe(s,$n,Dn,Un){let Bn=$n,In=s.ZERO,qn=s.ZERO;for(;Dn>_0n$2||Un>_0n$2;)Dn&_1n$2&&(In=In.add(Bn)),Un&_1n$2&&(qn=qn.add(Bn)),Bn=Bn.double(),Dn>>=_1n$2,Un>>=_1n$2;return{p1:In,p2:qn}}function pippenger(s,$n,Dn,Un){validateMSMPoints(Dn,s),validateMSMScalars(Un,$n);const Bn=Dn.length,In=Un.length;if(Bn!==In)throw new Error("arrays of points and scalars must have equal length");const qn=s.ZERO,Fn=bitLen(BigInt(Bn));let Kn=1;Fn>12?Kn=Fn-3:Fn>4?Kn=Fn-2:Fn>0&&(Kn=2);const jn=bitMask(Kn),Yn=new Array(Number(jn)+1).fill(qn),Zn=Math.floor(($n.BITS-1)/Kn)*Kn;let Xn=qn;for(let Jn=Zn;Jn>=0;Jn-=Kn){Yn.fill(qn);for(let tr=0;tr<In;tr++){const ir=Un[tr],sr=Number(ir>>BigInt(Jn)&jn);Yn[sr]=Yn[sr].add(Dn[tr])}let Wn=qn;for(let tr=Yn.length-1,ir=qn;tr>0;tr--)ir=ir.add(Yn[tr]),Wn=Wn.add(ir);if(Xn=Xn.add(Wn),Jn!==0)for(let tr=0;tr<Kn;tr++)Xn=Xn.double()}return Xn}function createField(s,$n,Dn){if($n){if($n.ORDER!==s)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField($n),$n}else return Field(s,{isLE:Dn})}function _createCurveFields(s,$n,Dn={},Un){if(Un===void 0&&(Un=s==="edwards"),!$n||typeof $n!="object")throw new Error(`expected valid ${s} CURVE object`);for(const Fn of["p","n","h"]){const Kn=$n[Fn];if(!(typeof Kn=="bigint"&&Kn>_0n$2))throw new Error(`CURVE.${Fn} must be positive bigint`)}const Bn=createField($n.p,Dn.Fp,Un),In=createField($n.n,Dn.Fn,Un),qn=["Gx","Gy","a","b"];for(const Fn of qn)if(!Bn.isValid($n[Fn]))throw new Error(`CURVE.${Fn} must be valid field element of CURVE.Fp`);return $n=Object.freeze(Object.assign({},$n)),{CURVE:$n,Fp:Bn,Fn:In}}const divNearest=(s,$n)=>(s+(s>=0?$n:-$n)/_2n$1)/$n;function _splitEndoScalar(s,$n,Dn){const[[Un,Bn],[In,qn]]=$n,Fn=divNearest(qn*s,Dn),Kn=divNearest(-Bn*s,Dn);let jn=s-Fn*Un-Kn*In,Yn=-Fn*Bn-Kn*qn;const Zn=jn<_0n$1,Xn=Yn<_0n$1;Zn&&(jn=-jn),Xn&&(Yn=-Yn);const Jn=bitMask(Math.ceil(bitLen(Dn)/2))+_1n$1;if(jn<_0n$1||jn>=Jn||Yn<_0n$1||Yn>=Jn)throw new Error("splitScalar (endomorphism): failed, k="+s);return{k1neg:Zn,k1:jn,k2neg:Xn,k2:Yn}}function validateSigFormat(s){if(!["compact","recovered","der"].includes(s))throw new Error('Signature format must be "compact", "recovered", or "der"');return s}function validateSigOpts(s,$n){const Dn={};for(let Un of Object.keys($n))Dn[Un]=s[Un]===void 0?$n[Un]:s[Un];return _abool2(Dn.lowS,"lowS"),_abool2(Dn.prehash,"prehash"),Dn.format!==void 0&&validateSigFormat(Dn.format),Dn}class DERErr extends Error{constructor($n=""){super($n)}}const DER={Err:DERErr,_tlv:{encode:(s,$n)=>{const{Err:Dn}=DER;if(s<0||s>256)throw new Dn("tlv.encode: wrong tag");if($n.length&1)throw new Dn("tlv.encode: unpadded data");const Un=$n.length/2,Bn=numberToHexUnpadded(Un);if(Bn.length/2&128)throw new Dn("tlv.encode: long form length too big");const In=Un>127?numberToHexUnpadded(Bn.length/2|128):"";return numberToHexUnpadded(s)+In+Bn+$n},decode(s,$n){const{Err:Dn}=DER;let Un=0;if(s<0||s>256)throw new Dn("tlv.encode: wrong tag");if($n.length<2||$n[Un++]!==s)throw new Dn("tlv.decode: wrong tlv");const Bn=$n[Un++],In=!!(Bn&128);let qn=0;if(!In)qn=Bn;else{const Kn=Bn&127;if(!Kn)throw new Dn("tlv.decode(long): indefinite length not supported");if(Kn>4)throw new Dn("tlv.decode(long): byte length is too big");const jn=$n.subarray(Un,Un+Kn);if(jn.length!==Kn)throw new Dn("tlv.decode: length bytes not complete");if(jn[0]===0)throw new Dn("tlv.decode(long): zero leftmost byte");for(const Yn of jn)qn=qn<<8|Yn;if(Un+=Kn,qn<128)throw new Dn("tlv.decode(long): not minimal encoding")}const Fn=$n.subarray(Un,Un+qn);if(Fn.length!==qn)throw new Dn("tlv.decode: wrong value length");return{v:Fn,l:$n.subarray(Un+qn)}}},_int:{encode(s){const{Err:$n}=DER;if(s<_0n$1)throw new $n("integer: negative integers are not allowed");let Dn=numberToHexUnpadded(s);if(Number.parseInt(Dn[0],16)&8&&(Dn="00"+Dn),Dn.length&1)throw new $n("unexpected DER parsing assertion: unpadded hex");return Dn},decode(s){const{Err:$n}=DER;if(s[0]&128)throw new $n("invalid signature integer: negative");if(s[0]===0&&!(s[1]&128))throw new $n("invalid signature integer: unnecessary leading zero");return bytesToNumberBE(s)}},toSig(s){const{Err:$n,_int:Dn,_tlv:Un}=DER,Bn=ensureBytes("signature",s),{v:In,l:qn}=Un.decode(48,Bn);if(qn.length)throw new $n("invalid signature: left bytes after parsing");const{v:Fn,l:Kn}=Un.decode(2,In),{v:jn,l:Yn}=Un.decode(2,Kn);if(Yn.length)throw new $n("invalid signature: left bytes after parsing");return{r:Dn.decode(Fn),s:Dn.decode(jn)}},hexFromSig(s){const{_tlv:$n,_int:Dn}=DER,Un=$n.encode(2,Dn.encode(s.r)),Bn=$n.encode(2,Dn.encode(s.s)),In=Un+Bn;return $n.encode(48,In)}},_0n$1=BigInt(0),_1n$1=BigInt(1),_2n$1=BigInt(2),_3n=BigInt(3),_4n=BigInt(4);function _normFnElement(s,$n){const{BYTES:Dn}=s;let Un;if(typeof $n=="bigint")Un=$n;else{let Bn=ensureBytes("private key",$n);try{Un=s.fromBytes(Bn)}catch{throw new Error(`invalid private key: expected ui8a of size ${Dn}, got ${typeof $n}`)}}if(!s.isValidNot0(Un))throw new Error("invalid private key: out of range [1..N-1]");return Un}function weierstrassN(s,$n={}){const Dn=_createCurveFields("weierstrass",s,$n),{Fp:Un,Fn:Bn}=Dn;let In=Dn.CURVE;const{h:qn,n:Fn}=In;_validateObject($n,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:Kn}=$n;if(Kn&&(!Un.is0(In.a)||typeof Kn.beta!="bigint"||!Array.isArray(Kn.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const jn=getWLengths(Un,Bn);function Yn(){if(!Un.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function Zn(pr,lr,mr){const{x:ar,y:er}=lr.toAffine(),or=Un.toBytes(ar);if(_abool2(mr,"isCompressed"),mr){Yn();const wr=!Un.isOdd(er);return concatBytes(pprefix(wr),or)}else return concatBytes(Uint8Array.of(4),or,Un.toBytes(er))}function Xn(pr){_abytes2(pr,void 0,"Point");const{publicKey:lr,publicKeyUncompressed:mr}=jn,ar=pr.length,er=pr[0],or=pr.subarray(1);if(ar===lr&&(er===2||er===3)){const wr=Un.fromBytes(or);if(!Un.isValid(wr))throw new Error("bad point: is not on curve, wrong x");const vr=tr(wr);let Sr;try{Sr=Un.sqrt(vr)}catch(gr){const Tr=gr instanceof Error?": "+gr.message:"";throw new Error("bad point: is not on curve, sqrt error"+Tr)}Yn();const rr=Un.isOdd(Sr);return(er&1)===1!==rr&&(Sr=Un.neg(Sr)),{x:wr,y:Sr}}else if(ar===mr&&er===4){const wr=Un.BYTES,vr=Un.fromBytes(or.subarray(0,wr)),Sr=Un.fromBytes(or.subarray(wr,wr*2));if(!ir(vr,Sr))throw new Error("bad point: is not on curve");return{x:vr,y:Sr}}else throw new Error(`bad point: got length ${ar}, expected compressed=${lr} or uncompressed=${mr}`)}const Jn=$n.toBytes||Zn,Wn=$n.fromBytes||Xn;function tr(pr){const lr=Un.sqr(pr),mr=Un.mul(lr,pr);return Un.add(Un.add(mr,Un.mul(pr,In.a)),In.b)}function ir(pr,lr){const mr=Un.sqr(lr),ar=tr(pr);return Un.eql(mr,ar)}if(!ir(In.Gx,In.Gy))throw new Error("bad curve params: generator point");const sr=Un.mul(Un.pow(In.a,_3n),_4n),fr=Un.mul(Un.sqr(In.b),BigInt(27));if(Un.is0(Un.add(sr,fr)))throw new Error("bad curve params: a or b");function ur(pr,lr,mr=!1){if(!Un.isValid(lr)||mr&&Un.is0(lr))throw new Error(`bad point coordinate ${pr}`);return lr}function br(pr){if(!(pr instanceof Dr))throw new Error("ProjectivePoint expected")}function Nr(pr){if(!Kn||!Kn.basises)throw new Error("no endo");return _splitEndoScalar(pr,Kn.basises,Bn.ORDER)}const Ar=memoized((pr,lr)=>{const{X:mr,Y:ar,Z:er}=pr;if(Un.eql(er,Un.ONE))return{x:mr,y:ar};const or=pr.is0();lr==null&&(lr=or?Un.ONE:Un.inv(er));const wr=Un.mul(mr,lr),vr=Un.mul(ar,lr),Sr=Un.mul(er,lr);if(or)return{x:Un.ZERO,y:Un.ZERO};if(!Un.eql(Sr,Un.ONE))throw new Error("invZ was invalid");return{x:wr,y:vr}}),_r=memoized(pr=>{if(pr.is0()){if($n.allowInfinityPoint&&!Un.is0(pr.Y))return;throw new Error("bad point: ZERO")}const{x:lr,y:mr}=pr.toAffine();if(!Un.isValid(lr)||!Un.isValid(mr))throw new Error("bad point: x or y not field elements");if(!ir(lr,mr))throw new Error("bad point: equation left != right");if(!pr.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function Rr(pr,lr,mr,ar,er){return mr=new Dr(Un.mul(mr.X,pr),mr.Y,mr.Z),lr=negateCt(ar,lr),mr=negateCt(er,mr),lr.add(mr)}class Dr{constructor(lr,mr,ar){this.X=ur("x",lr),this.Y=ur("y",mr,!0),this.Z=ur("z",ar),Object.freeze(this)}static CURVE(){return In}static fromAffine(lr){const{x:mr,y:ar}=lr||{};if(!lr||!Un.isValid(mr)||!Un.isValid(ar))throw new Error("invalid affine point");if(lr instanceof Dr)throw new Error("projective point not allowed");return Un.is0(mr)&&Un.is0(ar)?Dr.ZERO:new Dr(mr,ar,Un.ONE)}static fromBytes(lr){const mr=Dr.fromAffine(Wn(_abytes2(lr,void 0,"point")));return mr.assertValidity(),mr}static fromHex(lr){return Dr.fromBytes(ensureBytes("pointHex",lr))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(lr=8,mr=!0){return dr.createCache(this,lr),mr||this.multiply(_3n),this}assertValidity(){_r(this)}hasEvenY(){const{y:lr}=this.toAffine();if(!Un.isOdd)throw new Error("Field doesn't support isOdd");return!Un.isOdd(lr)}equals(lr){br(lr);const{X:mr,Y:ar,Z:er}=this,{X:or,Y:wr,Z:vr}=lr,Sr=Un.eql(Un.mul(mr,vr),Un.mul(or,er)),rr=Un.eql(Un.mul(ar,vr),Un.mul(wr,er));return Sr&&rr}negate(){return new Dr(this.X,Un.neg(this.Y),this.Z)}double(){const{a:lr,b:mr}=In,ar=Un.mul(mr,_3n),{X:er,Y:or,Z:wr}=this;let vr=Un.ZERO,Sr=Un.ZERO,rr=Un.ZERO,gr=Un.mul(er,er),Tr=Un.mul(or,or),Br=Un.mul(wr,wr),Ur=Un.mul(er,or);return Ur=Un.add(Ur,Ur),rr=Un.mul(er,wr),rr=Un.add(rr,rr),vr=Un.mul(lr,rr),Sr=Un.mul(ar,Br),Sr=Un.add(vr,Sr),vr=Un.sub(Tr,Sr),Sr=Un.add(Tr,Sr),Sr=Un.mul(vr,Sr),vr=Un.mul(Ur,vr),rr=Un.mul(ar,rr),Br=Un.mul(lr,Br),Ur=Un.sub(gr,Br),Ur=Un.mul(lr,Ur),Ur=Un.add(Ur,rr),rr=Un.add(gr,gr),gr=Un.add(rr,gr),gr=Un.add(gr,Br),gr=Un.mul(gr,Ur),Sr=Un.add(Sr,gr),Br=Un.mul(or,wr),Br=Un.add(Br,Br),gr=Un.mul(Br,Ur),vr=Un.sub(vr,gr),rr=Un.mul(Br,Tr),rr=Un.add(rr,rr),rr=Un.add(rr,rr),new Dr(vr,Sr,rr)}add(lr){br(lr);const{X:mr,Y:ar,Z:er}=this,{X:or,Y:wr,Z:vr}=lr;let Sr=Un.ZERO,rr=Un.ZERO,gr=Un.ZERO;const Tr=In.a,Br=Un.mul(In.b,_3n);let Ur=Un.mul(mr,or),qr=Un.mul(ar,wr),Hr=Un.mul(er,vr),Yr=Un.add(mr,ar),Kr=Un.add(or,wr);Yr=Un.mul(Yr,Kr),Kr=Un.add(Ur,qr),Yr=Un.sub(Yr,Kr),Kr=Un.add(mr,er);let si=Un.add(or,vr);return Kr=Un.mul(Kr,si),si=Un.add(Ur,Hr),Kr=Un.sub(Kr,si),si=Un.add(ar,er),Sr=Un.add(wr,vr),si=Un.mul(si,Sr),Sr=Un.add(qr,Hr),si=Un.sub(si,Sr),gr=Un.mul(Tr,Kr),Sr=Un.mul(Br,Hr),gr=Un.add(Sr,gr),Sr=Un.sub(qr,gr),gr=Un.add(qr,gr),rr=Un.mul(Sr,gr),qr=Un.add(Ur,Ur),qr=Un.add(qr,Ur),Hr=Un.mul(Tr,Hr),Kr=Un.mul(Br,Kr),qr=Un.add(qr,Hr),Hr=Un.sub(Ur,Hr),Hr=Un.mul(Tr,Hr),Kr=Un.add(Kr,Hr),Ur=Un.mul(qr,Kr),rr=Un.add(rr,Ur),Ur=Un.mul(si,Kr),Sr=Un.mul(Yr,Sr),Sr=Un.sub(Sr,Ur),Ur=Un.mul(Yr,qr),gr=Un.mul(si,gr),gr=Un.add(gr,Ur),new Dr(Sr,rr,gr)}subtract(lr){return this.add(lr.negate())}is0(){return this.equals(Dr.ZERO)}multiply(lr){const{endo:mr}=$n;if(!Bn.isValidNot0(lr))throw new Error("invalid scalar: out of range");let ar,er;const or=wr=>dr.cached(this,wr,vr=>normalizeZ(Dr,vr));if(mr){const{k1neg:wr,k1:vr,k2neg:Sr,k2:rr}=Nr(lr),{p:gr,f:Tr}=or(vr),{p:Br,f:Ur}=or(rr);er=Tr.add(Ur),ar=Rr(mr.beta,gr,Br,wr,Sr)}else{const{p:wr,f:vr}=or(lr);ar=wr,er=vr}return normalizeZ(Dr,[ar,er])[0]}multiplyUnsafe(lr){const{endo:mr}=$n,ar=this;if(!Bn.isValid(lr))throw new Error("invalid scalar: out of range");if(lr===_0n$1||ar.is0())return Dr.ZERO;if(lr===_1n$1)return ar;if(dr.hasCache(this))return this.multiply(lr);if(mr){const{k1neg:er,k1:or,k2neg:wr,k2:vr}=Nr(lr),{p1:Sr,p2:rr}=mulEndoUnsafe(Dr,ar,or,vr);return Rr(mr.beta,Sr,rr,er,wr)}else return dr.unsafe(ar,lr)}multiplyAndAddUnsafe(lr,mr,ar){const er=this.multiplyUnsafe(mr).add(lr.multiplyUnsafe(ar));return er.is0()?void 0:er}toAffine(lr){return Ar(this,lr)}isTorsionFree(){const{isTorsionFree:lr}=$n;return qn===_1n$1?!0:lr?lr(Dr,this):dr.unsafe(this,Fn).is0()}clearCofactor(){const{clearCofactor:lr}=$n;return qn===_1n$1?this:lr?lr(Dr,this):this.multiplyUnsafe(qn)}isSmallOrder(){return this.multiplyUnsafe(qn).is0()}toBytes(lr=!0){return _abool2(lr,"isCompressed"),this.assertValidity(),Jn(Dr,this,lr)}toHex(lr=!0){return bytesToHex(this.toBytes(lr))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(lr=!0){return this.toBytes(lr)}_setWindowSize(lr){this.precompute(lr)}static normalizeZ(lr){return normalizeZ(Dr,lr)}static msm(lr,mr){return pippenger(Dr,Bn,lr,mr)}static fromPrivateKey(lr){return Dr.BASE.multiply(_normFnElement(Bn,lr))}}Dr.BASE=new Dr(In.Gx,In.Gy,Un.ONE),Dr.ZERO=new Dr(Un.ZERO,Un.ONE,Un.ZERO),Dr.Fp=Un,Dr.Fn=Bn;const zr=Bn.BITS,dr=new wNAF(Dr,$n.endo?Math.ceil(zr/2):zr);return Dr.BASE.precompute(8),Dr}function pprefix(s){return Uint8Array.of(s?2:3)}function getWLengths(s,$n){return{secretKey:$n.BYTES,publicKey:1+s.BYTES,publicKeyUncompressed:1+2*s.BYTES,publicKeyHasPrefix:!0,signature:2*$n.BYTES}}function ecdh(s,$n={}){const{Fn:Dn}=s,Un=$n.randomBytes||randomBytes,Bn=Object.assign(getWLengths(s.Fp,Dn),{seed:getMinHashLength(Dn.ORDER)});function In(Xn){try{return!!_normFnElement(Dn,Xn)}catch{return!1}}function qn(Xn,Jn){const{publicKey:Wn,publicKeyUncompressed:tr}=Bn;try{const ir=Xn.length;return Jn===!0&&ir!==Wn||Jn===!1&&ir!==tr?!1:!!s.fromBytes(Xn)}catch{return!1}}function Fn(Xn=Un(Bn.seed)){return mapHashToField(_abytes2(Xn,Bn.seed,"seed"),Dn.ORDER)}function Kn(Xn,Jn=!0){return s.BASE.multiply(_normFnElement(Dn,Xn)).toBytes(Jn)}function jn(Xn){const Jn=Fn(Xn);return{secretKey:Jn,publicKey:Kn(Jn)}}function Yn(Xn){if(typeof Xn=="bigint")return!1;if(Xn instanceof s)return!0;const{secretKey:Jn,publicKey:Wn,publicKeyUncompressed:tr}=Bn;if(Dn.allowedLengths||Jn===Wn)return;const ir=ensureBytes("key",Xn).length;return ir===Wn||ir===tr}function Zn(Xn,Jn,Wn=!0){if(Yn(Xn)===!0)throw new Error("first arg must be private key");if(Yn(Jn)===!1)throw new Error("second arg must be public key");const tr=_normFnElement(Dn,Xn);return s.fromHex(Jn).multiply(tr).toBytes(Wn)}return Object.freeze({getPublicKey:Kn,getSharedSecret:Zn,keygen:jn,Point:s,utils:{isValidSecretKey:In,isValidPublicKey:qn,randomSecretKey:Fn,isValidPrivateKey:In,randomPrivateKey:Fn,normPrivateKeyToScalar:Xn=>_normFnElement(Dn,Xn),precompute(Xn=8,Jn=s.BASE){return Jn.precompute(Xn,!1)}},lengths:Bn})}function ecdsa(s,$n,Dn={}){ahash($n),_validateObject(Dn,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const Un=Dn.randomBytes||randomBytes,Bn=Dn.hmac||((mr,...ar)=>hmac($n,mr,concatBytes(...ar))),{Fp:In,Fn:qn}=s,{ORDER:Fn,BITS:Kn}=qn,{keygen:jn,getPublicKey:Yn,getSharedSecret:Zn,utils:Xn,lengths:Jn}=ecdh(s,Dn),Wn={prehash:!1,lowS:typeof Dn.lowS=="boolean"?Dn.lowS:!1,format:void 0,extraEntropy:!1},tr="compact";function ir(mr){const ar=Fn>>_1n$1;return mr>ar}function sr(mr,ar){if(!qn.isValidNot0(ar))throw new Error(`invalid signature ${mr}: out of range 1..Point.Fn.ORDER`);return ar}function fr(mr,ar){validateSigFormat(ar);const er=Jn.signature,or=ar==="compact"?er:ar==="recovered"?er+1:void 0;return _abytes2(mr,or,`${ar} signature`)}class ur{constructor(ar,er,or){this.r=sr("r",ar),this.s=sr("s",er),or!=null&&(this.recovery=or),Object.freeze(this)}static fromBytes(ar,er=tr){fr(ar,er);let or;if(er==="der"){const{r:rr,s:gr}=DER.toSig(_abytes2(ar));return new ur(rr,gr)}er==="recovered"&&(or=ar[0],er="compact",ar=ar.subarray(1));const wr=qn.BYTES,vr=ar.subarray(0,wr),Sr=ar.subarray(wr,wr*2);return new ur(qn.fromBytes(vr),qn.fromBytes(Sr),or)}static fromHex(ar,er){return this.fromBytes(hexToBytes(ar),er)}addRecoveryBit(ar){return new ur(this.r,this.s,ar)}recoverPublicKey(ar){const er=In.ORDER,{r:or,s:wr,recovery:vr}=this;if(vr==null||![0,1,2,3].includes(vr))throw new Error("recovery id invalid");if(Fn*_2n$1<er&&vr>1)throw new Error("recovery id is ambiguous for h>1 curve");const Sr=vr===2||vr===3?or+Fn:or;if(!In.isValid(Sr))throw new Error("recovery id 2 or 3 invalid");const rr=In.toBytes(Sr),gr=s.fromBytes(concatBytes(pprefix((vr&1)===0),rr)),Tr=qn.inv(Sr),Br=Nr(ensureBytes("msgHash",ar)),Ur=qn.create(-Br*Tr),qr=qn.create(wr*Tr),Hr=s.BASE.multiplyUnsafe(Ur).add(gr.multiplyUnsafe(qr));if(Hr.is0())throw new Error("point at infinify");return Hr.assertValidity(),Hr}hasHighS(){return ir(this.s)}toBytes(ar=tr){if(validateSigFormat(ar),ar==="der")return hexToBytes(DER.hexFromSig(this));const er=qn.toBytes(this.r),or=qn.toBytes(this.s);if(ar==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return concatBytes(Uint8Array.of(this.recovery),er,or)}return concatBytes(er,or)}toHex(ar){return bytesToHex(this.toBytes(ar))}assertValidity(){}static fromCompact(ar){return ur.fromBytes(ensureBytes("sig",ar),"compact")}static fromDER(ar){return ur.fromBytes(ensureBytes("sig",ar),"der")}normalizeS(){return this.hasHighS()?new ur(this.r,qn.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return bytesToHex(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return bytesToHex(this.toBytes("compact"))}}const br=Dn.bits2int||function(mr){if(mr.length>8192)throw new Error("input is too large");const ar=bytesToNumberBE(mr),er=mr.length*8-Kn;return er>0?ar>>BigInt(er):ar},Nr=Dn.bits2int_modN||function(mr){return qn.create(br(mr))},Ar=bitMask(Kn);function _r(mr){return aInRange("num < 2^"+Kn,mr,_0n$1,Ar),qn.toBytes(mr)}function Rr(mr,ar){return _abytes2(mr,void 0,"message"),ar?_abytes2($n(mr),void 0,"prehashed message"):mr}function Dr(mr,ar,er){if(["recovered","canonical"].some(qr=>qr in er))throw new Error("sign() legacy options not supported");const{lowS:or,prehash:wr,extraEntropy:vr}=validateSigOpts(er,Wn);mr=Rr(mr,wr);const Sr=Nr(mr),rr=_normFnElement(qn,ar),gr=[_r(rr),_r(Sr)];if(vr!=null&&vr!==!1){const qr=vr===!0?Un(Jn.secretKey):vr;gr.push(ensureBytes("extraEntropy",qr))}const Tr=concatBytes(...gr),Br=Sr;function Ur(qr){const Hr=br(qr);if(!qn.isValidNot0(Hr))return;const Yr=qn.inv(Hr),Kr=s.BASE.multiply(Hr).toAffine(),si=qn.create(Kr.x);if(si===_0n$1)return;const zi=qn.create(Yr*qn.create(Br+si*rr));if(zi===_0n$1)return;let Ai=(Kr.x===si?0:2)|Number(Kr.y&_1n$1),Li=zi;return or&&ir(zi)&&(Li=qn.neg(zi),Ai^=1),new ur(si,Li,Ai)}return{seed:Tr,k2sig:Ur}}function zr(mr,ar,er={}){mr=ensureBytes("message",mr);const{seed:or,k2sig:wr}=Dr(mr,ar,er);return createHmacDrbg($n.outputLen,qn.BYTES,Bn)(or,wr)}function dr(mr){let ar;const er=typeof mr=="string"||isBytes(mr),or=!er&&mr!==null&&typeof mr=="object"&&typeof mr.r=="bigint"&&typeof mr.s=="bigint";if(!er&&!or)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(or)ar=new ur(mr.r,mr.s);else if(er){try{ar=ur.fromBytes(ensureBytes("sig",mr),"der")}catch(wr){if(!(wr instanceof DER.Err))throw wr}if(!ar)try{ar=ur.fromBytes(ensureBytes("sig",mr),"compact")}catch{return!1}}return ar||!1}function pr(mr,ar,er,or={}){const{lowS:wr,prehash:vr,format:Sr}=validateSigOpts(or,Wn);if(er=ensureBytes("publicKey",er),ar=Rr(ensureBytes("message",ar),vr),"strict"in or)throw new Error("options.strict was renamed to lowS");const rr=Sr===void 0?dr(mr):ur.fromBytes(ensureBytes("sig",mr),Sr);if(rr===!1)return!1;try{const gr=s.fromBytes(er);if(wr&&rr.hasHighS())return!1;const{r:Tr,s:Br}=rr,Ur=Nr(ar),qr=qn.inv(Br),Hr=qn.create(Ur*qr),Yr=qn.create(Tr*qr),Kr=s.BASE.multiplyUnsafe(Hr).add(gr.multiplyUnsafe(Yr));return Kr.is0()?!1:qn.create(Kr.x)===Tr}catch{return!1}}function lr(mr,ar,er={}){const{prehash:or}=validateSigOpts(er,Wn);return ar=Rr(ar,or),ur.fromBytes(mr,"recovered").recoverPublicKey(ar).toBytes()}return Object.freeze({keygen:jn,getPublicKey:Yn,getSharedSecret:Zn,utils:Xn,lengths:Jn,Point:s,sign:zr,verify:pr,recoverPublicKey:lr,Signature:ur,hash:$n})}function _weierstrass_legacy_opts_to_new(s){const $n={a:s.a,b:s.b,p:s.Fp.ORDER,n:s.n,h:s.h,Gx:s.Gx,Gy:s.Gy},Dn=s.Fp;let Un=s.allowedPrivateKeyLengths?Array.from(new Set(s.allowedPrivateKeyLengths.map(qn=>Math.ceil(qn/2)))):void 0;const Bn=Field($n.n,{BITS:s.nBitLength,allowedLengths:Un,modFromBytes:s.wrapPrivateKey}),In={Fp:Dn,Fn:Bn,allowInfinityPoint:s.allowInfinityPoint,endo:s.endo,isTorsionFree:s.isTorsionFree,clearCofactor:s.clearCofactor,fromBytes:s.fromBytes,toBytes:s.toBytes};return{CURVE:$n,curveOpts:In}}function _ecdsa_legacy_opts_to_new(s){const{CURVE:$n,curveOpts:Dn}=_weierstrass_legacy_opts_to_new(s),Un={hmac:s.hmac,randomBytes:s.randomBytes,lowS:s.lowS,bits2int:s.bits2int,bits2int_modN:s.bits2int_modN};return{CURVE:$n,curveOpts:Dn,hash:s.hash,ecdsaOpts:Un}}function _ecdsa_new_output_to_legacy(s,$n){const Dn=$n.Point;return Object.assign({},$n,{ProjectivePoint:Dn,CURVE:Object.assign({},s,nLength(Dn.Fn.ORDER,Dn.Fn.BITS))})}function weierstrass(s){const{CURVE:$n,curveOpts:Dn,hash:Un,ecdsaOpts:Bn}=_ecdsa_legacy_opts_to_new(s),In=weierstrassN($n,Dn),qn=ecdsa(In,Un,Bn);return _ecdsa_new_output_to_legacy(s,qn)}function createCurve(s,$n){const Dn=Un=>weierstrass({...s,hash:Un});return{...Dn($n),create:Dn}}const secp256k1_CURVE={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2);function sqrtMod(s){const $n=secp256k1_CURVE.p,Dn=BigInt(3),Un=BigInt(6),Bn=BigInt(11),In=BigInt(22),qn=BigInt(23),Fn=BigInt(44),Kn=BigInt(88),jn=s*s*s%$n,Yn=jn*jn*s%$n,Zn=pow2(Yn,Dn,$n)*Yn%$n,Xn=pow2(Zn,Dn,$n)*Yn%$n,Jn=pow2(Xn,_2n,$n)*jn%$n,Wn=pow2(Jn,Bn,$n)*Jn%$n,tr=pow2(Wn,In,$n)*Wn%$n,ir=pow2(tr,Fn,$n)*tr%$n,sr=pow2(ir,Kn,$n)*ir%$n,fr=pow2(sr,Fn,$n)*tr%$n,ur=pow2(fr,Dn,$n)*Yn%$n,br=pow2(ur,qn,$n)*Wn%$n,Nr=pow2(br,Un,$n)*jn%$n,Ar=pow2(Nr,_2n,$n);if(!Fpk1.eql(Fpk1.sqr(Ar),s))throw new Error("Cannot find square root");return Ar}const Fpk1=Field(secp256k1_CURVE.p,{sqrt:sqrtMod}),secp256k1=createCurve({...secp256k1_CURVE,Fp:Fpk1,lowS:!0,endo:secp256k1_ENDO},sha256$1),TAGGED_HASH_PREFIXES={};function taggedHash(s,...$n){let Dn=TAGGED_HASH_PREFIXES[s];if(Dn===void 0){const Un=sha256$1(utf8ToBytes(s));Dn=concatBytes(Un,Un),TAGGED_HASH_PREFIXES[s]=Dn}return sha256$1(concatBytes(Dn,...$n))}const pointToBytes=s=>s.toBytes(!0).slice(1),Pointk1=secp256k1.Point,hasEven=s=>s%_2n===_0n;function schnorrGetExtPubKey(s){const{Fn:$n,BASE:Dn}=Pointk1,Un=_normFnElement($n,s),Bn=Dn.multiply(Un);return{scalar:hasEven(Bn.y)?Un:$n.neg(Un),bytes:pointToBytes(Bn)}}function lift_x(s){const $n=Fpk1;if(!$n.isValidNot0(s))throw new Error("invalid x: Fail if x  p");const Dn=$n.create(s*s),Un=$n.create(Dn*s+BigInt(7));let Bn=$n.sqrt(Un);hasEven(Bn)||(Bn=$n.neg(Bn));const In=Pointk1.fromAffine({x:s,y:Bn});return In.assertValidity(),In}const num=bytesToNumberBE;function challenge(...s){return Pointk1.Fn.create(num(taggedHash("BIP0340/challenge",...s)))}function schnorrGetPublicKey(s){return schnorrGetExtPubKey(s).bytes}function schnorrSign(s,$n,Dn=randomBytes(32)){const{Fn:Un}=Pointk1,Bn=ensureBytes("message",s),{bytes:In,scalar:qn}=schnorrGetExtPubKey($n),Fn=ensureBytes("auxRand",Dn,32),Kn=Un.toBytes(qn^num(taggedHash("BIP0340/aux",Fn))),jn=taggedHash("BIP0340/nonce",Kn,In,Bn),{bytes:Yn,scalar:Zn}=schnorrGetExtPubKey(jn),Xn=challenge(Yn,In,Bn),Jn=new Uint8Array(64);if(Jn.set(Yn,0),Jn.set(Un.toBytes(Un.create(Zn+Xn*qn)),32),!schnorrVerify(Jn,Bn,In))throw new Error("sign: Invalid signature produced");return Jn}function schnorrVerify(s,$n,Dn){const{Fn:Un,BASE:Bn}=Pointk1,In=ensureBytes("signature",s,64),qn=ensureBytes("message",$n),Fn=ensureBytes("publicKey",Dn,32);try{const Kn=lift_x(num(Fn)),jn=num(In.subarray(0,32));if(!inRange(jn,_1n,secp256k1_CURVE.p))return!1;const Yn=num(In.subarray(32,64));if(!inRange(Yn,_1n,secp256k1_CURVE.n))return!1;const Zn=challenge(Un.toBytes(jn),pointToBytes(Kn),qn),Xn=Bn.multiplyUnsafe(Yn).add(Kn.multiplyUnsafe(Un.neg(Zn))),{x:Jn,y:Wn}=Xn.toAffine();return!(Xn.is0()||!hasEven(Wn)||Jn!==jn)}catch{return!1}}const schnorr=(()=>{const s=(Dn=randomBytes(48))=>mapHashToField(Dn,secp256k1_CURVE.n);secp256k1.utils.randomSecretKey;function $n(Dn){const Un=s(Dn);return{secretKey:Un,publicKey:schnorrGetPublicKey(Un)}}return{keygen:$n,getPublicKey:schnorrGetPublicKey,sign:schnorrSign,verify:schnorrVerify,Point:Pointk1,utils:{randomSecretKey:s,randomPrivateKey:s,taggedHash,lift_x,pointToBytes,numberToBytesBE,bytesToNumberBE,mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})(),sha256=sha256$1;var dist={},LRUCache$1={},LRUCacheNode$1={};Object.defineProperty(LRUCacheNode$1,"__esModule",{value:!0});LRUCacheNode$1.LRUCacheNode=void 0;class LRUCacheNode{constructor($n,Dn,Un){const{entryExpirationTimeInMS:Bn=null,next:In=null,prev:qn=null,onEntryEvicted:Fn,onEntryMarkedAsMostRecentlyUsed:Kn,clone:jn,cloneFn:Yn}=Un??{};if(typeof Bn=="number"&&(Bn<=0||Number.isNaN(Bn)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.clone=jn??!1,this.cloneFn=Yn??this.defaultClone,this.key=$n,this.internalValue=this.clone?this.cloneFn(Dn):Dn,this.created=Date.now(),this.entryExpirationTimeInMS=Bn,this.next=In,this.prev=qn,this.onEntryEvicted=Fn,this.onEntryMarkedAsMostRecentlyUsed=Kn}get value(){return this.clone?this.cloneFn(this.internalValue):this.internalValue}get isExpired(){return typeof this.entryExpirationTimeInMS=="number"&&Date.now()-this.created>this.entryExpirationTimeInMS}invokeOnEvicted(){if(this.onEntryEvicted){const{key:$n,value:Dn,isExpired:Un}=this;this.onEntryEvicted({key:$n,value:Dn,isExpired:Un})}}invokeOnEntryMarkedAsMostRecentlyUsed(){if(this.onEntryMarkedAsMostRecentlyUsed){const{key:$n,value:Dn}=this;this.onEntryMarkedAsMostRecentlyUsed({key:$n,value:Dn})}}defaultClone($n){return typeof $n=="boolean"||typeof $n=="string"||typeof $n=="number"?$n:JSON.parse(JSON.stringify($n))}}LRUCacheNode$1.LRUCacheNode=LRUCacheNode;Object.defineProperty(LRUCache$1,"__esModule",{value:!0});LRUCache$1.LRUCache=void 0;const LRUCacheNode_1=LRUCacheNode$1;class LRUCache{constructor($n){this.lookupTable=new Map,this.head=null,this.tail=null;const{maxSize:Dn=25,entryExpirationTimeInMS:Un=null,onEntryEvicted:Bn,onEntryMarkedAsMostRecentlyUsed:In,cloneFn:qn,clone:Fn}=$n??{};if(Number.isNaN(Dn)||Dn<=0)throw new Error("maxSize must be greater than 0.");if(typeof Un=="number"&&(Un<=0||Number.isNaN(Un)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.maxSizeInternal=Dn,this.entryExpirationTimeInMS=Un,this.onEntryEvicted=Bn,this.onEntryMarkedAsMostRecentlyUsed=In,this.clone=Fn,this.cloneFn=qn}get size(){return this.cleanCache(),this.lookupTable.size}get remainingSize(){return this.maxSizeInternal-this.size}get newest(){return this.head?this.head.isExpired?(this.removeNodeFromListAndLookupTable(this.head),this.newest):this.mapNodeToEntry(this.head):null}get oldest(){return this.tail?this.tail.isExpired?(this.removeNodeFromListAndLookupTable(this.tail),this.oldest):this.mapNodeToEntry(this.tail):null}get maxSize(){return this.maxSizeInternal}set maxSize($n){if(Number.isNaN($n)||$n<=0)throw new Error("maxSize must be greater than 0.");this.maxSizeInternal=$n,this.enforceSizeLimit()}set($n,Dn,Un){const Bn=this.lookupTable.get($n);Bn&&this.removeNodeFromListAndLookupTable(Bn);const In=new LRUCacheNode_1.LRUCacheNode($n,Dn,{entryExpirationTimeInMS:this.entryExpirationTimeInMS,onEntryEvicted:this.onEntryEvicted,onEntryMarkedAsMostRecentlyUsed:this.onEntryMarkedAsMostRecentlyUsed,clone:this.clone,cloneFn:this.cloneFn,...Un});return this.setNodeAsHead(In),this.lookupTable.set($n,In),this.enforceSizeLimit(),this}get($n){const Dn=this.lookupTable.get($n);return Dn?Dn.isExpired?(this.removeNodeFromListAndLookupTable(Dn),null):(this.setNodeAsHead(Dn),Dn.value):null}peek($n){const Dn=this.lookupTable.get($n);return Dn?Dn.isExpired?(this.removeNodeFromListAndLookupTable(Dn),null):Dn.value:null}delete($n){const Dn=this.lookupTable.get($n);return Dn?this.removeNodeFromListAndLookupTable(Dn):!1}has($n){const Dn=this.lookupTable.get($n);return Dn?Dn.isExpired?(this.removeNodeFromListAndLookupTable(Dn),!1):!0:!1}clear(){this.head=null,this.tail=null,this.lookupTable.clear()}find($n){let Dn=this.head;for(;Dn;){if(Dn.isExpired){const Bn=Dn.next;this.removeNodeFromListAndLookupTable(Dn),Dn=Bn;continue}const Un=this.mapNodeToEntry(Dn);if($n(Un))return this.setNodeAsHead(Dn),Un;Dn=Dn.next}return null}forEach($n){let Dn=this.head,Un=0;for(;Dn;){if(Dn.isExpired){const Bn=Dn.next;this.removeNodeFromListAndLookupTable(Dn),Dn=Bn;continue}$n(Dn.value,Dn.key,Un),Dn=Dn.next,Un++}}*values(){let $n=this.head;for(;$n;){if($n.isExpired){const Dn=$n.next;this.removeNodeFromListAndLookupTable($n),$n=Dn;continue}yield $n.value,$n=$n.next}}*keys(){let $n=this.head;for(;$n;){if($n.isExpired){const Dn=$n.next;this.removeNodeFromListAndLookupTable($n),$n=Dn;continue}yield $n.key,$n=$n.next}}*entries(){let $n=this.head;for(;$n;){if($n.isExpired){const Dn=$n.next;this.removeNodeFromListAndLookupTable($n),$n=Dn;continue}yield this.mapNodeToEntry($n),$n=$n.next}}*[Symbol.iterator](){let $n=this.head;for(;$n;){if($n.isExpired){const Dn=$n.next;this.removeNodeFromListAndLookupTable($n),$n=Dn;continue}yield this.mapNodeToEntry($n),$n=$n.next}}enforceSizeLimit(){let $n=this.tail;for(;$n!==null&&this.size>this.maxSizeInternal;){const Dn=$n.prev;this.removeNodeFromListAndLookupTable($n),$n=Dn}}mapNodeToEntry({key:$n,value:Dn}){return{key:$n,value:Dn}}setNodeAsHead($n){this.removeNodeFromList($n),this.head?($n.next=this.head,this.head.prev=$n,this.head=$n):(this.head=$n,this.tail=$n),$n.invokeOnEntryMarkedAsMostRecentlyUsed()}removeNodeFromList($n){$n.prev!==null&&($n.prev.next=$n.next),$n.next!==null&&($n.next.prev=$n.prev),this.head===$n&&(this.head=$n.next),this.tail===$n&&(this.tail=$n.prev),$n.next=null,$n.prev=null}removeNodeFromListAndLookupTable($n){return $n.invokeOnEvicted(),this.removeNodeFromList($n),this.lookupTable.delete($n.key)}cleanCache(){if(!this.entryExpirationTimeInMS)return;const $n=[];for(const Dn of this.lookupTable.values())Dn.isExpired&&$n.push(Dn);$n.forEach(Dn=>this.removeNodeFromListAndLookupTable(Dn))}}LRUCache$1.LRUCache=LRUCache;(function(s){var $n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(Un,Bn,In,qn){qn===void 0&&(qn=In);var Fn=Object.getOwnPropertyDescriptor(Bn,In);(!Fn||("get"in Fn?!Bn.__esModule:Fn.writable||Fn.configurable))&&(Fn={enumerable:!0,get:function(){return Bn[In]}}),Object.defineProperty(Un,qn,Fn)}:function(Un,Bn,In,qn){qn===void 0&&(qn=In),Un[qn]=Bn[In]}),Dn=commonjsGlobal&&commonjsGlobal.__exportStar||function(Un,Bn){for(var In in Un)In!=="default"&&!Object.prototype.hasOwnProperty.call(Bn,In)&&$n(Bn,Un,In)};Object.defineProperty(s,"__esModule",{value:!0}),Dn(LRUCache$1,s)})(dist);function pbkdf2Init(s,$n,Dn,Un){assert.hash(s);const Bn=checkOpts$1({dkLen:32,asyncTick:10},Un),{c:In,dkLen:qn,asyncTick:Fn}=Bn;if(assert.number(In),assert.number(qn),assert.number(Fn),In<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const Kn=toBytes$2($n),jn=toBytes$2(Dn),Yn=new Uint8Array(qn),Zn=hmac$1.create(s,Kn),Xn=Zn._cloneInto().update(jn);return{c:In,dkLen:qn,asyncTick:Fn,DK:Yn,PRF:Zn,PRFSalt:Xn}}function pbkdf2Output(s,$n,Dn,Un,Bn){return s.destroy(),$n.destroy(),Un&&Un.destroy(),Bn.fill(0),Dn}function pbkdf2(s,$n,Dn,Un){const{c:Bn,dkLen:In,DK:qn,PRF:Fn,PRFSalt:Kn}=pbkdf2Init(s,$n,Dn,Un);let jn;const Yn=new Uint8Array(4),Zn=createView$2(Yn),Xn=new Uint8Array(Fn.outputLen);for(let Jn=1,Wn=0;Wn<In;Jn++,Wn+=Fn.outputLen){const tr=qn.subarray(Wn,Wn+Fn.outputLen);Zn.setInt32(0,Jn,!1),(jn=Kn._cloneInto(jn)).update(Yn).digestInto(Xn),tr.set(Xn.subarray(0,tr.length));for(let ir=1;ir<Bn;ir++){Fn._cloneInto(jn).update(Xn).digestInto(Xn);for(let sr=0;sr<tr.length;sr++)tr[sr]^=Xn[sr]}}return pbkdf2Output(Fn,Kn,qn,jn,Xn)}const rotl=(s,$n)=>s<<$n|s>>>32-$n;function XorAndSalsa(s,$n,Dn,Un,Bn,In){let qn=s[$n++]^Dn[Un++],Fn=s[$n++]^Dn[Un++],Kn=s[$n++]^Dn[Un++],jn=s[$n++]^Dn[Un++],Yn=s[$n++]^Dn[Un++],Zn=s[$n++]^Dn[Un++],Xn=s[$n++]^Dn[Un++],Jn=s[$n++]^Dn[Un++],Wn=s[$n++]^Dn[Un++],tr=s[$n++]^Dn[Un++],ir=s[$n++]^Dn[Un++],sr=s[$n++]^Dn[Un++],fr=s[$n++]^Dn[Un++],ur=s[$n++]^Dn[Un++],br=s[$n++]^Dn[Un++],Nr=s[$n++]^Dn[Un++],Ar=qn,_r=Fn,Rr=Kn,Dr=jn,zr=Yn,dr=Zn,pr=Xn,lr=Jn,mr=Wn,ar=tr,er=ir,or=sr,wr=fr,vr=ur,Sr=br,rr=Nr;for(let gr=0;gr<8;gr+=2)zr^=rotl(Ar+wr|0,7),mr^=rotl(zr+Ar|0,9),wr^=rotl(mr+zr|0,13),Ar^=rotl(wr+mr|0,18),ar^=rotl(dr+_r|0,7),vr^=rotl(ar+dr|0,9),_r^=rotl(vr+ar|0,13),dr^=rotl(_r+vr|0,18),Sr^=rotl(er+pr|0,7),Rr^=rotl(Sr+er|0,9),pr^=rotl(Rr+Sr|0,13),er^=rotl(pr+Rr|0,18),Dr^=rotl(rr+or|0,7),lr^=rotl(Dr+rr|0,9),or^=rotl(lr+Dr|0,13),rr^=rotl(or+lr|0,18),_r^=rotl(Ar+Dr|0,7),Rr^=rotl(_r+Ar|0,9),Dr^=rotl(Rr+_r|0,13),Ar^=rotl(Dr+Rr|0,18),pr^=rotl(dr+zr|0,7),lr^=rotl(pr+dr|0,9),zr^=rotl(lr+pr|0,13),dr^=rotl(zr+lr|0,18),or^=rotl(er+ar|0,7),mr^=rotl(or+er|0,9),ar^=rotl(mr+or|0,13),er^=rotl(ar+mr|0,18),wr^=rotl(rr+Sr|0,7),vr^=rotl(wr+rr|0,9),Sr^=rotl(vr+wr|0,13),rr^=rotl(Sr+vr|0,18);Bn[In++]=qn+Ar|0,Bn[In++]=Fn+_r|0,Bn[In++]=Kn+Rr|0,Bn[In++]=jn+Dr|0,Bn[In++]=Yn+zr|0,Bn[In++]=Zn+dr|0,Bn[In++]=Xn+pr|0,Bn[In++]=Jn+lr|0,Bn[In++]=Wn+mr|0,Bn[In++]=tr+ar|0,Bn[In++]=ir+er|0,Bn[In++]=sr+or|0,Bn[In++]=fr+wr|0,Bn[In++]=ur+vr|0,Bn[In++]=br+Sr|0,Bn[In++]=Nr+rr|0}function BlockMix(s,$n,Dn,Un,Bn){let In=Un+0,qn=Un+16*Bn;for(let Fn=0;Fn<16;Fn++)Dn[qn+Fn]=s[$n+(2*Bn-1)*16+Fn];for(let Fn=0;Fn<Bn;Fn++,In+=16,$n+=16)XorAndSalsa(Dn,qn,s,$n,Dn,In),Fn>0&&(qn+=16),XorAndSalsa(Dn,In,s,$n+=16,Dn,qn)}function scryptInit(s,$n,Dn){const Un=checkOpts$1({dkLen:32,asyncTick:10,maxmem:1073742848},Dn),{N:Bn,r:In,p:qn,dkLen:Fn,asyncTick:Kn,maxmem:jn,onProgress:Yn}=Un;if(assert.number(Bn),assert.number(In),assert.number(qn),assert.number(Fn),assert.number(Kn),assert.number(jn),Yn!==void 0&&typeof Yn!="function")throw new Error("progressCb should be function");const Zn=128*In,Xn=Zn/4;if(Bn<=1||Bn&Bn-1||Bn>=2**(Zn/8)||Bn>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(qn<0||qn>(2**32-1)*32/Zn)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(Fn<0||Fn>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const Jn=Zn*(Bn+qn);if(Jn>jn)throw new Error(`Scrypt: parameters too large, ${Jn} (128 * r * (N + p)) > ${jn} (maxmem)`);const Wn=pbkdf2(sha256$2,s,$n,{c:1,dkLen:Zn*qn}),tr=u32$1(Wn),ir=u32$1(new Uint8Array(Zn*Bn)),sr=u32$1(new Uint8Array(Zn));let fr=()=>{};if(Yn){const ur=2*Bn*qn,br=Math.max(Math.floor(ur/1e4),1);let Nr=0;fr=()=>{Nr++,Yn&&(!(Nr%br)||Nr===ur)&&Yn(Nr/ur)}}return{N:Bn,r:In,p:qn,dkLen:Fn,blockSize32:Xn,V:ir,B32:tr,B:Wn,tmp:sr,blockMixCb:fr,asyncTick:Kn}}function scryptOutput(s,$n,Dn,Un,Bn){const In=pbkdf2(sha256$2,s,Dn,{c:1,dkLen:$n});return Dn.fill(0),Un.fill(0),Bn.fill(0),In}function scrypt(s,$n,Dn){const{N:Un,r:Bn,p:In,dkLen:qn,blockSize32:Fn,V:Kn,B32:jn,B:Yn,tmp:Zn,blockMixCb:Xn}=scryptInit(s,$n,Dn);for(let Jn=0;Jn<In;Jn++){const Wn=Fn*Jn;for(let tr=0;tr<Fn;tr++)Kn[tr]=jn[Wn+tr];for(let tr=0,ir=0;tr<Un-1;tr++)BlockMix(Kn,ir,Kn,ir+=Fn,Bn),Xn();BlockMix(Kn,(Un-1)*Fn,jn,Wn,Bn),Xn();for(let tr=0;tr<Un;tr++){const ir=jn[Wn+Fn-16]%Un;for(let sr=0;sr<Fn;sr++)Zn[sr]=jn[Wn+sr]^Kn[ir*Fn+sr];BlockMix(Zn,0,jn,Wn,Bn),Xn()}}return scryptOutput(s,qn,Yn,Kn,Zn)}var Bech32MaxSize$1=5e3;function encodeBech32$1(s,$n){let Dn=bech32$1.toWords($n);return bech32$1.encode(s,Dn,Bech32MaxSize$1)}function encodeBytes$1(s,$n){return encodeBech32$1(s,$n)}function encrypt$1(s,$n,Dn=16,Un=2){let Bn=randomBytes$1(16),In=2**Dn,qn=scrypt($n.normalize("NFKC"),Bn,{N:In,r:8,p:1,dkLen:32}),Fn=randomBytes$1(24),Kn=Uint8Array.from([Un]),jn=xchacha20poly1305(qn,Fn,Kn).encrypt(s),Yn=concatBytes$1(Uint8Array.from([2]),Uint8Array.from([Dn]),Bn,Fn,Kn,jn);return encodeBytes$1("ncryptsec",Yn)}function decrypt$1(s,$n){let{prefix:Dn,words:Un}=bech32$1.decode(s,Bech32MaxSize$1);if(Dn!=="ncryptsec")throw new Error(`invalid prefix ${Dn}, expected 'ncryptsec'`);let Bn=new Uint8Array(bech32$1.fromWords(Un)),In=Bn[0];if(In!==2)throw new Error(`invalid version ${In}, expected 0x02`);let qn=2**Bn[1],Fn=Bn.slice(2,18),Kn=Bn.slice(18,42),jn=Bn[42],Yn=Uint8Array.from([jn]),Zn=Bn.slice(43),Xn=scrypt($n.normalize("NFKC"),Fn,{N:qn,r:8,p:1,dkLen:32});return xchacha20poly1305(Xn,Kn,Yn).decrypt(Zn)}const nip49_star=Object.freeze(Object.defineProperty({__proto__:null,decrypt:decrypt$1,encrypt:encrypt$1},Symbol.toStringTag,{value:"Module"}));var utf8Decoder=new TextDecoder("utf-8"),utf8Encoder=new TextEncoder,NostrTypeGuard={isNProfile:s=>/^nprofile1[a-z\d]+$/.test(s||""),isNEvent:s=>/^nevent1[a-z\d]+$/.test(s||""),isNAddr:s=>/^naddr1[a-z\d]+$/.test(s||""),isNSec:s=>/^nsec1[a-z\d]{58}$/.test(s||""),isNPub:s=>/^npub1[a-z\d]{58}$/.test(s||""),isNote:s=>/^note1[a-z\d]+$/.test(s||""),isNcryptsec:s=>/^ncryptsec1[a-z\d]+$/.test(s||"")},Bech32MaxSize=5e3,BECH32_REGEX$1=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array(s){const $n=new Uint8Array(4);return $n[0]=s>>24&255,$n[1]=s>>16&255,$n[2]=s>>8&255,$n[3]=s&255,$n}function decodeNostrURI(s){try{return s.startsWith("nostr:")&&(s=s.substring(6)),decode(s)}catch{return{type:"invalid",data:null}}}function decode(s){var $n,Dn,Un,Bn,In,qn,Fn;let{prefix:Kn,words:jn}=bech32$1.decode(s,Bech32MaxSize),Yn=new Uint8Array(bech32$1.fromWords(jn));switch(Kn){case"nprofile":{let Zn=parseTLV(Yn);if(!(($n=Zn[0])!=null&&$n[0]))throw new Error("missing TLV 0 for nprofile");if(Zn[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$2(Zn[0][0]),relays:Zn[1]?Zn[1].map(Xn=>utf8Decoder.decode(Xn)):[]}}}case"nevent":{let Zn=parseTLV(Yn);if(!((Dn=Zn[0])!=null&&Dn[0]))throw new Error("missing TLV 0 for nevent");if(Zn[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(Zn[2]&&Zn[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(Zn[3]&&Zn[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$2(Zn[0][0]),relays:Zn[1]?Zn[1].map(Xn=>utf8Decoder.decode(Xn)):[],author:(Un=Zn[2])!=null&&Un[0]?bytesToHex$2(Zn[2][0]):void 0,kind:(Bn=Zn[3])!=null&&Bn[0]?parseInt(bytesToHex$2(Zn[3][0]),16):void 0}}}case"naddr":{let Zn=parseTLV(Yn);if(!((In=Zn[0])!=null&&In[0]))throw new Error("missing TLV 0 for naddr");if(!((qn=Zn[2])!=null&&qn[0]))throw new Error("missing TLV 2 for naddr");if(Zn[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((Fn=Zn[3])!=null&&Fn[0]))throw new Error("missing TLV 3 for naddr");if(Zn[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder.decode(Zn[0][0]),pubkey:bytesToHex$2(Zn[2][0]),kind:parseInt(bytesToHex$2(Zn[3][0]),16),relays:Zn[1]?Zn[1].map(Xn=>utf8Decoder.decode(Xn)):[]}}}case"nsec":return{type:Kn,data:Yn};case"npub":case"note":return{type:Kn,data:bytesToHex$2(Yn)};default:throw new Error(`unknown prefix ${Kn}`)}}function parseTLV(s){let $n={},Dn=s;for(;Dn.length>0;){let Un=Dn[0],Bn=Dn[1],In=Dn.slice(2,2+Bn);if(Dn=Dn.slice(2+Bn),In.length<Bn)throw new Error(`not enough data to read on TLV ${Un}`);$n[Un]=$n[Un]||[],$n[Un].push(In)}return $n}function nsecEncode(s){return encodeBytes("nsec",s)}function npubEncode(s){return encodeBytes("npub",hexToBytes$2(s))}function noteEncode(s){return encodeBytes("note",hexToBytes$2(s))}function encodeBech32(s,$n){let Dn=bech32$1.toWords($n);return bech32$1.encode(s,Dn,Bech32MaxSize)}function encodeBytes(s,$n){return encodeBech32(s,$n)}function nprofileEncode(s){let $n=encodeTLV({0:[hexToBytes$2(s.pubkey)],1:(s.relays||[]).map(Dn=>utf8Encoder.encode(Dn))});return encodeBech32("nprofile",$n)}function neventEncode(s){let $n;s.kind!==void 0&&($n=integerToUint8Array(s.kind));let Dn=encodeTLV({0:[hexToBytes$2(s.id)],1:(s.relays||[]).map(Un=>utf8Encoder.encode(Un)),2:s.author?[hexToBytes$2(s.author)]:[],3:$n?[new Uint8Array($n)]:[]});return encodeBech32("nevent",Dn)}function naddrEncode(s){let $n=new ArrayBuffer(4);new DataView($n).setUint32(0,s.kind,!1);let Dn=encodeTLV({0:[utf8Encoder.encode(s.identifier)],1:(s.relays||[]).map(Un=>utf8Encoder.encode(Un)),2:[hexToBytes$2(s.pubkey)],3:[new Uint8Array($n)]});return encodeBech32("naddr",Dn)}function encodeTLV(s){let $n=[];return Object.entries(s).reverse().forEach(([Dn,Un])=>{Un.forEach(Bn=>{let In=new Uint8Array(Bn.length+2);In.set([parseInt(Dn)],0),In.set([Bn.length],1),In.set(Bn,2),$n.push(In)})}),concatBytes$1(...$n)}const nip19_star=Object.freeze(Object.defineProperty({__proto__:null,BECH32_REGEX:BECH32_REGEX$1,Bech32MaxSize,NostrTypeGuard,decode,decodeNostrURI,encodeBytes,naddrEncode,neventEncode,noteEncode,nprofileEncode,npubEncode,nsecEncode},Symbol.toStringTag,{value:"Module"}));var lib={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.bytes=s.stringToBytes=s.str=s.bytesToString=s.hex=s.utf8=s.bech32m=s.bech32=s.base58check=s.base58xmr=s.base58xrp=s.base58flickr=s.base58=s.base64url=s.base64=s.base32crockford=s.base32hex=s.base32=s.base16=s.utils=s.assertNumber=void 0;function $n(dr){if(!Number.isSafeInteger(dr))throw new Error(`Wrong integer: ${dr}`)}s.assertNumber=$n;function Dn(...dr){const pr=(ar,er)=>or=>ar(er(or)),lr=Array.from(dr).reverse().reduce((ar,er)=>ar?pr(ar,er.encode):er.encode,void 0),mr=dr.reduce((ar,er)=>ar?pr(ar,er.decode):er.decode,void 0);return{encode:lr,decode:mr}}function Un(dr){return{encode:pr=>{if(!Array.isArray(pr)||pr.length&&typeof pr[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return pr.map(lr=>{if($n(lr),lr<0||lr>=dr.length)throw new Error(`Digit index outside alphabet: ${lr} (alphabet: ${dr.length})`);return dr[lr]})},decode:pr=>{if(!Array.isArray(pr)||pr.length&&typeof pr[0]!="string")throw new Error("alphabet.decode input should be array of strings");return pr.map(lr=>{if(typeof lr!="string")throw new Error(`alphabet.decode: not string element=${lr}`);const mr=dr.indexOf(lr);if(mr===-1)throw new Error(`Unknown letter: "${lr}". Allowed: ${dr}`);return mr})}}}function Bn(dr=""){if(typeof dr!="string")throw new Error("join separator should be string");return{encode:pr=>{if(!Array.isArray(pr)||pr.length&&typeof pr[0]!="string")throw new Error("join.encode input should be array of strings");for(let lr of pr)if(typeof lr!="string")throw new Error(`join.encode: non-string input=${lr}`);return pr.join(dr)},decode:pr=>{if(typeof pr!="string")throw new Error("join.decode input should be string");return pr.split(dr)}}}function In(dr,pr="="){if($n(dr),typeof pr!="string")throw new Error("padding chr should be string");return{encode(lr){if(!Array.isArray(lr)||lr.length&&typeof lr[0]!="string")throw new Error("padding.encode input should be array of strings");for(let mr of lr)if(typeof mr!="string")throw new Error(`padding.encode: non-string input=${mr}`);for(;lr.length*dr%8;)lr.push(pr);return lr},decode(lr){if(!Array.isArray(lr)||lr.length&&typeof lr[0]!="string")throw new Error("padding.encode input should be array of strings");for(let ar of lr)if(typeof ar!="string")throw new Error(`padding.decode: non-string input=${ar}`);let mr=lr.length;if(mr*dr%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;mr>0&&lr[mr-1]===pr;mr--)if(!((mr-1)*dr%8))throw new Error("Invalid padding: string has too much padding");return lr.slice(0,mr)}}}function qn(dr){if(typeof dr!="function")throw new Error("normalize fn should be function");return{encode:pr=>pr,decode:pr=>dr(pr)}}function Fn(dr,pr,lr){if(pr<2)throw new Error(`convertRadix: wrong from=${pr}, base cannot be less than 2`);if(lr<2)throw new Error(`convertRadix: wrong to=${lr}, base cannot be less than 2`);if(!Array.isArray(dr))throw new Error("convertRadix: data should be array");if(!dr.length)return[];let mr=0;const ar=[],er=Array.from(dr);for(er.forEach(or=>{if($n(or),or<0||or>=pr)throw new Error(`Wrong integer: ${or}`)});;){let or=0,wr=!0;for(let vr=mr;vr<er.length;vr++){const Sr=er[vr],rr=pr*or+Sr;if(!Number.isSafeInteger(rr)||pr*or/pr!==or||rr-Sr!==pr*or)throw new Error("convertRadix: carry overflow");if(or=rr%lr,er[vr]=Math.floor(rr/lr),!Number.isSafeInteger(er[vr])||er[vr]*lr+or!==rr)throw new Error("convertRadix: carry overflow");if(wr)er[vr]?wr=!1:mr=vr;else continue}if(ar.push(or),wr)break}for(let or=0;or<dr.length-1&&dr[or]===0;or++)ar.push(0);return ar.reverse()}const Kn=(dr,pr)=>pr?Kn(pr,dr%pr):dr,jn=(dr,pr)=>dr+(pr-Kn(dr,pr));function Yn(dr,pr,lr,mr){if(!Array.isArray(dr))throw new Error("convertRadix2: data should be array");if(pr<=0||pr>32)throw new Error(`convertRadix2: wrong from=${pr}`);if(lr<=0||lr>32)throw new Error(`convertRadix2: wrong to=${lr}`);if(jn(pr,lr)>32)throw new Error(`convertRadix2: carry overflow from=${pr} to=${lr} carryBits=${jn(pr,lr)}`);let ar=0,er=0;const or=2**lr-1,wr=[];for(const vr of dr){if($n(vr),vr>=2**pr)throw new Error(`convertRadix2: invalid data word=${vr} from=${pr}`);if(ar=ar<<pr|vr,er+pr>32)throw new Error(`convertRadix2: carry overflow pos=${er} from=${pr}`);for(er+=pr;er>=lr;er-=lr)wr.push((ar>>er-lr&or)>>>0);ar&=2**er-1}if(ar=ar<<lr-er&or,!mr&&er>=pr)throw new Error("Excess padding");if(!mr&&ar)throw new Error(`Non-zero padding: ${ar}`);return mr&&er>0&&wr.push(ar>>>0),wr}function Zn(dr){return $n(dr),{encode:pr=>{if(!(pr instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Fn(Array.from(pr),2**8,dr)},decode:pr=>{if(!Array.isArray(pr)||pr.length&&typeof pr[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Fn(pr,dr,2**8))}}}function Xn(dr,pr=!1){if($n(dr),dr<=0||dr>32)throw new Error("radix2: bits should be in (0..32]");if(jn(8,dr)>32||jn(dr,8)>32)throw new Error("radix2: carry overflow");return{encode:lr=>{if(!(lr instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Yn(Array.from(lr),8,dr,!pr)},decode:lr=>{if(!Array.isArray(lr)||lr.length&&typeof lr[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Yn(lr,dr,8,pr))}}}function Jn(dr){if(typeof dr!="function")throw new Error("unsafeWrapper fn should be function");return function(...pr){try{return dr.apply(null,pr)}catch{}}}function Wn(dr,pr){if($n(dr),typeof pr!="function")throw new Error("checksum fn should be function");return{encode(lr){if(!(lr instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const mr=pr(lr).slice(0,dr),ar=new Uint8Array(lr.length+dr);return ar.set(lr),ar.set(mr,lr.length),ar},decode(lr){if(!(lr instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const mr=lr.slice(0,-dr),ar=pr(mr).slice(0,dr),er=lr.slice(-dr);for(let or=0;or<dr;or++)if(ar[or]!==er[or])throw new Error("Invalid checksum");return mr}}}s.utils={alphabet:Un,chain:Dn,checksum:Wn,radix:Zn,radix2:Xn,join:Bn,padding:In},s.base16=Dn(Xn(4),Un("0123456789ABCDEF"),Bn("")),s.base32=Dn(Xn(5),Un("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),In(5),Bn("")),s.base32hex=Dn(Xn(5),Un("0123456789ABCDEFGHIJKLMNOPQRSTUV"),In(5),Bn("")),s.base32crockford=Dn(Xn(5),Un("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Bn(""),qn(dr=>dr.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),s.base64=Dn(Xn(6),Un("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),In(6),Bn("")),s.base64url=Dn(Xn(6),Un("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),In(6),Bn(""));const tr=dr=>Dn(Zn(58),Un(dr),Bn(""));s.base58=tr("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),s.base58flickr=tr("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),s.base58xrp=tr("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const ir=[0,2,3,5,6,7,9,10,11];s.base58xmr={encode(dr){let pr="";for(let lr=0;lr<dr.length;lr+=8){const mr=dr.subarray(lr,lr+8);pr+=s.base58.encode(mr).padStart(ir[mr.length],"1")}return pr},decode(dr){let pr=[];for(let lr=0;lr<dr.length;lr+=11){const mr=dr.slice(lr,lr+11),ar=ir.indexOf(mr.length),er=s.base58.decode(mr);for(let or=0;or<er.length-ar;or++)if(er[or]!==0)throw new Error("base58xmr: wrong padding");pr=pr.concat(Array.from(er.slice(er.length-ar)))}return Uint8Array.from(pr)}};const sr=dr=>Dn(Wn(4,pr=>dr(dr(pr))),s.base58);s.base58check=sr;const fr=Dn(Un("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Bn("")),ur=[996825010,642813549,513874426,1027748829,705979059];function br(dr){const pr=dr>>25;let lr=(dr&33554431)<<5;for(let mr=0;mr<ur.length;mr++)(pr>>mr&1)===1&&(lr^=ur[mr]);return lr}function Nr(dr,pr,lr=1){const mr=dr.length;let ar=1;for(let er=0;er<mr;er++){const or=dr.charCodeAt(er);if(or<33||or>126)throw new Error(`Invalid prefix (${dr})`);ar=br(ar)^or>>5}ar=br(ar);for(let er=0;er<mr;er++)ar=br(ar)^dr.charCodeAt(er)&31;for(let er of pr)ar=br(ar)^er;for(let er=0;er<6;er++)ar=br(ar);return ar^=lr,fr.encode(Yn([ar%2**30],30,5,!1))}function Ar(dr){const pr=dr==="bech32"?1:734539939,lr=Xn(5),mr=lr.decode,ar=lr.encode,er=Jn(mr);function or(rr,gr,Tr=90){if(typeof rr!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof rr}`);if(!Array.isArray(gr)||gr.length&&typeof gr[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof gr}`);const Br=rr.length+7+gr.length;if(Tr!==!1&&Br>Tr)throw new TypeError(`Length ${Br} exceeds limit ${Tr}`);return rr=rr.toLowerCase(),`${rr}1${fr.encode(gr)}${Nr(rr,gr,pr)}`}function wr(rr,gr=90){if(typeof rr!="string")throw new Error(`bech32.decode input should be string, not ${typeof rr}`);if(rr.length<8||gr!==!1&&rr.length>gr)throw new TypeError(`Wrong string length: ${rr.length} (${rr}). Expected (8..${gr})`);const Tr=rr.toLowerCase();if(rr!==Tr&&rr!==rr.toUpperCase())throw new Error("String must be lowercase or uppercase");rr=Tr;const Br=rr.lastIndexOf("1");if(Br===0||Br===-1)throw new Error('Letter "1" must be present between prefix and data only');const Ur=rr.slice(0,Br),qr=rr.slice(Br+1);if(qr.length<6)throw new Error("Data must be at least 6 characters long");const Hr=fr.decode(qr).slice(0,-6),Yr=Nr(Ur,Hr,pr);if(!qr.endsWith(Yr))throw new Error(`Invalid checksum in ${rr}: expected "${Yr}"`);return{prefix:Ur,words:Hr}}const vr=Jn(wr);function Sr(rr){const{prefix:gr,words:Tr}=wr(rr,!1);return{prefix:gr,words:Tr,bytes:mr(Tr)}}return{encode:or,decode:wr,decodeToBytes:Sr,decodeUnsafe:vr,fromWords:mr,fromWordsUnsafe:er,toWords:ar}}s.bech32=Ar("bech32"),s.bech32m=Ar("bech32m"),s.utf8={encode:dr=>new TextDecoder().decode(dr),decode:dr=>new TextEncoder().encode(dr)},s.hex=Dn(Xn(4),Un("0123456789abcdef"),Bn(""),qn(dr=>{if(typeof dr!="string"||dr.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof dr} with length ${dr.length}`);return dr.toLowerCase()}));const _r={utf8:s.utf8,hex:s.hex,base16:s.base16,base32:s.base32,base64:s.base64,base64url:s.base64url,base58:s.base58,base58xmr:s.base58xmr},Rr=`Invalid encoding type. Available types: ${Object.keys(_r).join(", ")}`,Dr=(dr,pr)=>{if(typeof dr!="string"||!_r.hasOwnProperty(dr))throw new TypeError(Rr);if(!(pr instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return _r[dr].encode(pr)};s.bytesToString=Dr,s.str=s.bytesToString;const zr=(dr,pr)=>{if(!_r.hasOwnProperty(dr))throw new TypeError(Rr);if(typeof pr!="string")throw new TypeError("stringToBytes() expects string");return _r[dr].decode(pr)};s.stringToBytes=zr,s.bytes=s.stringToBytes})(lib);const{bech32,hex,utf8}=lib;BigInt(1e3),BigInt(1e6),BigInt(1e9),BigInt(1e12);BigInt("2100000000000000000");BigInt(1e11);const TAGCODES={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27};for(let s=0,$n=Object.keys(TAGCODES);s<$n.length;s++)$n[s],TAGCODES[$n[s]].toString();var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__copyProps=(s,$n,Dn,Un)=>{if($n&&typeof $n=="object"||typeof $n=="function")for(let Bn of __getOwnPropNames($n))!__hasOwnProp.call(s,Bn)&&Bn!==Dn&&__defProp(s,Bn,{get:()=>$n[Bn],enumerable:!(Un=__getOwnPropDesc($n,Bn))||Un.enumerable});return s},__reExport=(s,$n,Dn)=>(__copyProps(s,$n,"default"),Dn),NDKKind=(s=>(s[s.Metadata=0]="Metadata",s[s.Text=1]="Text",s[s.RecommendRelay=2]="RecommendRelay",s[s.Contacts=3]="Contacts",s[s.EncryptedDirectMessage=4]="EncryptedDirectMessage",s[s.EventDeletion=5]="EventDeletion",s[s.Repost=6]="Repost",s[s.Reaction=7]="Reaction",s[s.BadgeAward=8]="BadgeAward",s[s.GroupChat=9]="GroupChat",s[s.Thread=11]="Thread",s[s.GroupReply=12]="GroupReply",s[s.GiftWrapSeal=13]="GiftWrapSeal",s[s.PrivateDirectMessage=14]="PrivateDirectMessage",s[s.Image=20]="Image",s[s.Video=21]="Video",s[s.ShortVideo=22]="ShortVideo",s[s.Story=23]="Story",s[s.Vanish=62]="Vanish",s[s.CashuWalletBackup=375]="CashuWalletBackup",s[s.GiftWrap=1059]="GiftWrap",s[s.GenericRepost=16]="GenericRepost",s[s.ChannelCreation=40]="ChannelCreation",s[s.ChannelMetadata=41]="ChannelMetadata",s[s.ChannelMessage=42]="ChannelMessage",s[s.ChannelHideMessage=43]="ChannelHideMessage",s[s.ChannelMuteUser=44]="ChannelMuteUser",s[s.WikiMergeRequest=818]="WikiMergeRequest",s[s.GenericReply=1111]="GenericReply",s[s.Media=1063]="Media",s[s.DraftCheckpoint=1234]="DraftCheckpoint",s[s.Task=1934]="Task",s[s.Report=1984]="Report",s[s.Label=1985]="Label",s[s.DVMReqTextExtraction=5e3]="DVMReqTextExtraction",s[s.DVMReqTextSummarization=5001]="DVMReqTextSummarization",s[s.DVMReqTextTranslation=5002]="DVMReqTextTranslation",s[s.DVMReqTextGeneration=5050]="DVMReqTextGeneration",s[s.DVMReqImageGeneration=5100]="DVMReqImageGeneration",s[s.DVMReqTextToSpeech=5250]="DVMReqTextToSpeech",s[s.DVMReqDiscoveryNostrContent=5300]="DVMReqDiscoveryNostrContent",s[s.DVMReqDiscoveryNostrPeople=5301]="DVMReqDiscoveryNostrPeople",s[s.DVMReqTimestamping=5900]="DVMReqTimestamping",s[s.DVMEventSchedule=5905]="DVMEventSchedule",s[s.DVMJobFeedback=7e3]="DVMJobFeedback",s[s.Subscribe=7001]="Subscribe",s[s.Unsubscribe=7002]="Unsubscribe",s[s.SubscriptionReceipt=7003]="SubscriptionReceipt",s[s.CashuReserve=7373]="CashuReserve",s[s.CashuQuote=7374]="CashuQuote",s[s.CashuToken=7375]="CashuToken",s[s.CashuWalletTx=7376]="CashuWalletTx",s[s.GroupAdminAddUser=9e3]="GroupAdminAddUser",s[s.GroupAdminRemoveUser=9001]="GroupAdminRemoveUser",s[s.GroupAdminEditMetadata=9002]="GroupAdminEditMetadata",s[s.GroupAdminEditStatus=9006]="GroupAdminEditStatus",s[s.GroupAdminCreateGroup=9007]="GroupAdminCreateGroup",s[s.GroupAdminRequestJoin=9021]="GroupAdminRequestJoin",s[s.MuteList=1e4]="MuteList",s[s.PinList=10001]="PinList",s[s.RelayList=10002]="RelayList",s[s.BookmarkList=10003]="BookmarkList",s[s.CommunityList=10004]="CommunityList",s[s.PublicChatList=10005]="PublicChatList",s[s.BlockRelayList=10006]="BlockRelayList",s[s.SearchRelayList=10007]="SearchRelayList",s[s.SimpleGroupList=10009]="SimpleGroupList",s[s.InterestList=10015]="InterestList",s[s.CashuMintList=10019]="CashuMintList",s[s.EmojiList=10030]="EmojiList",s[s.DirectMessageReceiveRelayList=10050]="DirectMessageReceiveRelayList",s[s.BlossomList=10063]="BlossomList",s[s.NostrWaletConnectInfo=13194]="NostrWaletConnectInfo",s[s.TierList=17e3]="TierList",s[s.CashuWallet=17375]="CashuWallet",s[s.FollowSet=3e4]="FollowSet",s[s.CategorizedPeopleList=3e4]="CategorizedPeopleList",s[s.CategorizedBookmarkList=30001]="CategorizedBookmarkList",s[s.RelaySet=30002]="RelaySet",s[s.CategorizedRelayList=30002]="CategorizedRelayList",s[s.BookmarkSet=30003]="BookmarkSet",s[s.CurationSet=30004]="CurationSet",s[s.ArticleCurationSet=30004]="ArticleCurationSet",s[s.VideoCurationSet=30005]="VideoCurationSet",s[s.ImageCurationSet=30006]="ImageCurationSet",s[s.InterestSet=30015]="InterestSet",s[s.InterestsList=30015]="InterestsList",s[s.ProjectTemplate=30717]="ProjectTemplate",s[s.EmojiSet=30030]="EmojiSet",s[s.ModularArticle=30040]="ModularArticle",s[s.ModularArticleItem=30041]="ModularArticleItem",s[s.Wiki=30818]="Wiki",s[s.Draft=31234]="Draft",s[s.Project=31933]="Project",s[s.SubscriptionTier=37001]="SubscriptionTier",s[s.EcashMintRecommendation=38e3]="EcashMintRecommendation",s[s.CashuMintAnnouncement=38172]="CashuMintAnnouncement",s[s.FedimintMintAnnouncement=38173]="FedimintMintAnnouncement",s[s.HighlightSet=39802]="HighlightSet",s[s.CategorizedHighlightList=39802]="CategorizedHighlightList",s[s.Nutzap=9321]="Nutzap",s[s.ZapRequest=9734]="ZapRequest",s[s.Zap=9735]="Zap",s[s.Highlight=9802]="Highlight",s[s.ClientAuth=22242]="ClientAuth",s[s.NostrWalletConnectReq=23194]="NostrWalletConnectReq",s[s.NostrWalletConnectRes=23195]="NostrWalletConnectRes",s[s.NostrConnect=24133]="NostrConnect",s[s.BlossomUpload=24242]="BlossomUpload",s[s.HttpAuth=27235]="HttpAuth",s[s.ProfileBadge=30008]="ProfileBadge",s[s.BadgeDefinition=30009]="BadgeDefinition",s[s.MarketStall=30017]="MarketStall",s[s.MarketProduct=30018]="MarketProduct",s[s.Article=30023]="Article",s[s.AppSpecificData=30078]="AppSpecificData",s[s.Classified=30402]="Classified",s[s.HorizontalVideo=34235]="HorizontalVideo",s[s.VerticalVideo=34236]="VerticalVideo",s[s.GroupMetadata=39e3]="GroupMetadata",s[s.GroupAdmins=39001]="GroupAdmins",s[s.GroupMembers=39002]="GroupMembers",s[s.FollowPack=39089]="FollowPack",s[s.MediaFollowPack=39092]="MediaFollowPack",s[s.AppRecommendation=31989]="AppRecommendation",s[s.AppHandler=31990]="AppHandler",s))(NDKKind||{});function getRelaysForSync(s,$n,Dn="write"){if(!s.outboxTracker)return;const Un=s.outboxTracker.data.get($n);if(Un)return Dn==="write"?Un.writeRelays:Un.readRelays}async function getWriteRelaysFor(s,$n,Dn="write"){if(s.outboxTracker)return s.outboxTracker.data.has($n)||await s.outboxTracker.trackUsers([$n]),getRelaysForSync(s,$n,Dn)}function getTopRelaysForAuthors(s,$n){const Dn=new Map;return $n.forEach(Un=>{const Bn=getRelaysForSync(s,Un);Bn&&Bn.forEach(In=>{const qn=Dn.get(In)||0;Dn.set(In,qn+1)})}),Array.from(Dn.entries()).sort((Un,Bn)=>Bn[1]-Un[1]).map(Un=>Un[0])}function getAllRelaysForAllPubkeys(s,$n,Dn="read"){const Un=new Map,Bn=new Set;return $n.forEach(In=>{const qn=getRelaysForSync(s,In,Dn);qn&&qn.size>0?(qn.forEach(Fn=>{(Un.get(Fn)||new Set).add(In)}),Un.set(In,qn)):Bn.add(In)}),{pubkeysToRelays:Un,authorsMissingRelays:Bn}}function chooseRelayCombinationForPubkeys(s,$n,Dn,{count:Un,preferredRelays:Bn}={}){Un??(Un=2),Bn??(Bn=new Set);const In=s.pool,qn=In.connectedRelays();qn.forEach(Xn=>{Bn?.add(Xn.url)});const Fn=new Map,{pubkeysToRelays:Kn,authorsMissingRelays:jn}=getAllRelaysForAllPubkeys(s,$n,Dn),Yn=getTopRelaysForAuthors(s,$n),Zn=(Xn,Jn)=>{const Wn=Fn.get(Jn)||[];Wn.push(Xn),Fn.set(Jn,Wn)};for(const[Xn,Jn]of Kn.entries()){let Wn=Un;const tr=new Set;for(const ir of qn)Jn.has(ir.url)&&(Zn(Xn,ir.url),tr.add(ir.url),Wn--);for(const ir of Jn)tr.has(ir)||Fn.has(ir)&&(Zn(Xn,ir),tr.add(ir),Wn--);if(!(Wn<=0))for(const ir of Yn){if(Wn<=0)break;tr.has(ir)||Jn.has(ir)&&(Zn(Xn,ir),tr.add(ir),Wn--)}}for(const Xn of jn)In.permanentAndConnectedRelays().forEach(Jn=>{const Wn=Fn.get(Jn.url)||[];Wn.push(Xn),Fn.set(Jn.url,Wn)});return Fn}function getRelaysForFilterWithAuthors(s,$n,Dn=2){return chooseRelayCombinationForPubkeys(s,$n,"write",{count:Dn})}function tryNormalizeRelayUrl(s){try{return normalizeRelayUrl(s)}catch{return}}function normalizeRelayUrl(s){let $n=normalizeUrl(s,{stripAuthentication:!1,stripWWW:!1,stripHash:!0});return $n.endsWith("/")||($n+="/"),$n}function normalize(s){const $n=new Set;for(const Dn of s)try{$n.add(normalizeRelayUrl(Dn))}catch{}return Array.from($n)}var DATA_URL_DEFAULT_MIME_TYPE="text/plain",DATA_URL_DEFAULT_CHARSET="us-ascii",testParameter=(s,$n)=>$n.some(Dn=>Dn instanceof RegExp?Dn.test(s):Dn===s),supportedProtocols=new Set(["https:","http:","file:"]),hasCustomProtocol=s=>{try{const{protocol:$n}=new URL(s);return $n.endsWith(":")&&!$n.includes(".")&&!supportedProtocols.has($n)}catch{return!1}},normalizeDataURL=(s,{stripHash:$n})=>{var Dn,Un,Bn,In;const qn=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(s);if(!qn)throw new Error(`Invalid URL: ${s}`);const Fn=((Dn=qn.groups)==null?void 0:Dn.type)??"",Kn=((Un=qn.groups)==null?void 0:Un.data)??"";let jn=((Bn=qn.groups)==null?void 0:Bn.hash)??"";const Yn=Fn.split(";");jn=$n?"":jn;let Zn=!1;Yn[Yn.length-1]==="base64"&&(Yn.pop(),Zn=!0);const Xn=((In=Yn.shift())==null?void 0:In.toLowerCase())??"",Jn=[...Yn.map(Wn=>{let[tr,ir=""]=Wn.split("=").map(sr=>sr.trim());return tr==="charset"&&(ir=ir.toLowerCase(),ir===DATA_URL_DEFAULT_CHARSET)?"":`${tr}${ir?`=${ir}`:""}`}).filter(Boolean)];return Zn&&Jn.push("base64"),(Jn.length>0||Xn&&Xn!==DATA_URL_DEFAULT_MIME_TYPE)&&Jn.unshift(Xn),`data:${Jn.join(";")},${Zn?Kn.trim():Kn}${jn?`#${jn}`:""}`};function normalizeUrl(s,$n={}){if($n={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...$n},typeof $n.defaultProtocol=="string"&&!$n.defaultProtocol.endsWith(":")&&($n.defaultProtocol=`${$n.defaultProtocol}:`),s=s.trim(),/^data:/i.test(s))return normalizeDataURL(s,$n);if(hasCustomProtocol(s))return s;const Dn=s.startsWith("//");!Dn&&/^\.*\//.test(s)||(s=s.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,$n.defaultProtocol));const Un=new URL(s);if(Un.hostname=Un.hostname.toLowerCase(),$n.forceHttp&&$n.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if($n.forceHttp&&Un.protocol==="https:"&&(Un.protocol="http:"),$n.forceHttps&&Un.protocol==="http:"&&(Un.protocol="https:"),$n.stripAuthentication&&(Un.username="",Un.password=""),$n.stripHash?Un.hash="":$n.stripTextFragment&&(Un.hash=Un.hash.replace(/#?:~:text.*?$/i,"")),Un.pathname){const In=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let qn=0,Fn="";for(;;){const jn=In.exec(Un.pathname);if(!jn)break;const Yn=jn[0],Zn=jn.index,Xn=Un.pathname.slice(qn,Zn);Fn+=Xn.replace(/\/{2,}/g,"/"),Fn+=Yn,qn=Zn+Yn.length}const Kn=Un.pathname.slice(qn,Un.pathname.length);Fn+=Kn.replace(/\/{2,}/g,"/"),Un.pathname=Fn}if(Un.pathname)try{Un.pathname=decodeURI(Un.pathname)}catch{}if($n.removeDirectoryIndex===!0&&($n.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray($n.removeDirectoryIndex)&&$n.removeDirectoryIndex.length>0){let In=Un.pathname.split("/");const qn=In[In.length-1];testParameter(qn,$n.removeDirectoryIndex)&&(In=In.slice(0,-1),Un.pathname=`${In.slice(1).join("/")}/`)}if(Un.hostname&&(Un.hostname=Un.hostname.replace(/\.$/,""),$n.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(Un.hostname)&&(Un.hostname=Un.hostname.replace(/^www\./,""))),Array.isArray($n.removeQueryParameters))for(const In of[...Un.searchParams.keys()])testParameter(In,$n.removeQueryParameters)&&Un.searchParams.delete(In);if(!Array.isArray($n.keepQueryParameters)&&$n.removeQueryParameters===!0&&(Un.search=""),Array.isArray($n.keepQueryParameters)&&$n.keepQueryParameters.length>0)for(const In of[...Un.searchParams.keys()])testParameter(In,$n.keepQueryParameters)||Un.searchParams.delete(In);if($n.sortQueryParameters){Un.searchParams.sort();try{Un.search=decodeURIComponent(Un.search)}catch{}}$n.removeTrailingSlash&&(Un.pathname=Un.pathname.replace(/\/$/,"")),$n.removeExplicitPort&&Un.port&&(Un.port="");const Bn=s;return s=Un.toString(),!$n.removeSingleSlash&&Un.pathname==="/"&&!Bn.endsWith("/")&&Un.hash===""&&(s=s.replace(/\/$/,"")),($n.removeTrailingSlash||Un.pathname==="/")&&Un.hash===""&&$n.removeSingleSlash&&(s=s.replace(/\/$/,"")),Dn&&!$n.normalizeProtocol&&(s=s.replace(/^http:\/\//,"//")),$n.stripProtocol&&(s=s.replace(/^(?:https?:)?\/\//,"")),s}var NDKRelayKeepalive=class{constructor(s=3e4,$n){g$3(this,"lastActivity",Date.now()),g$3(this,"timer"),g$3(this,"timeout"),g$3(this,"isRunning",!1),this.onSilenceDetected=$n,this.timeout=s}recordActivity(){this.lastActivity=Date.now(),this.isRunning&&this.resetTimer()}start(){this.isRunning||(this.isRunning=!0,this.lastActivity=Date.now(),this.resetTimer())}stop(){this.isRunning=!1,this.timer&&(clearTimeout(this.timer),this.timer=void 0)}resetTimer(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{const s=Date.now()-this.lastActivity;if(s>=this.timeout)this.onSilenceDetected();else{const $n=this.timeout-s;this.timer=setTimeout(()=>{this.onSilenceDetected()},$n)}},this.timeout)}};async function probeRelayConnection(s){const $n=`probe-${Math.random().toString(36).substring(7)}`;return new Promise(Dn=>{let Un=!1;const Bn=setTimeout(()=>{Un||(Un=!0,s.send(["CLOSE",$n]),Dn(!1))},5e3),In=()=>{Un||(Un=!0,clearTimeout(Bn),s.send(["CLOSE",$n]),Dn(!0))};s.once("message",In),s.send(["REQ",$n,{kinds:[99999],limit:0}])})}var MAX_RECONNECT_ATTEMPTS=5,FLAPPING_THRESHOLD_MS=1e3,NDKRelayConnectivity=class{constructor(s,$n){g$3(this,"ndkRelay"),g$3(this,"ws"),g$3(this,"_status"),g$3(this,"timeoutMs"),g$3(this,"connectedAt"),g$3(this,"_connectionStats",{attempts:0,success:0,durations:[]}),g$3(this,"debug"),g$3(this,"netDebug"),g$3(this,"connectTimeout"),g$3(this,"reconnectTimeout"),g$3(this,"ndk"),g$3(this,"openSubs",new Map),g$3(this,"openCountRequests",new Map),g$3(this,"openEventPublishes",new Map),g$3(this,"pendingAuthPublishes",new Map),g$3(this,"serial",0),g$3(this,"baseEoseTimeout",4400),g$3(this,"keepalive"),g$3(this,"wsStateMonitor"),g$3(this,"sleepDetector"),g$3(this,"lastSleepCheck",Date.now()),g$3(this,"lastMessageSent",Date.now()),g$3(this,"wasIdle",!1),g$3(this,"updateConnectionStats",{connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++,this._connectionStats.connectedAt=Date.now()}}),this.ndkRelay=s,this._status=1;const Dn=Math.floor(Math.random()*1e3);this.debug=this.ndkRelay.debug.extend(`connectivity${Dn}`),this.ndk=$n,this.setupMonitoring()}setupMonitoring(){this.keepalive=new NDKRelayKeepalive(12e4,async()=>{this.debug("Relay silence detected, probing connection"),await probeRelayConnection({send:s=>this.send(JSON.stringify(s)),once:(s,$n)=>{var Dn;const Un=Bn=>{var In;try{const qn=JSON.parse(Bn.data);(qn[0]==="EOSE"||qn[0]==="EVENT"||qn[0]==="NOTICE")&&($n(),(In=this.ws)==null||In.removeEventListener("message",Un))}catch{}};(Dn=this.ws)==null||Dn.addEventListener("message",Un)}})||(this.debug("Probe failed, connection is stale"),this.handleStaleConnection())}),this.wsStateMonitor=setInterval(()=>{this._status===5&&(!this.ws||this.ws.readyState!==WebSocket.OPEN)&&(this.debug("WebSocket died silently, reconnecting"),this.handleStaleConnection())},5e3),this.sleepDetector=setInterval(()=>{const s=Date.now(),$n=s-this.lastSleepCheck;$n>15e3&&(this.debug(`Detected possible sleep/wake (${$n}ms gap)`),this.handlePossibleWake()),this.lastSleepCheck=s},1e4)}handleStaleConnection(){this._status=1,this.wasIdle=!0,this.onDisconnect()}handlePossibleWake(){this.debug("System wake detected, checking all connections"),this.wasIdle=!0,this._status>=5&&(!this.ws||this.ws.readyState!==WebSocket.OPEN?this.handleStaleConnection():probeRelayConnection({send:s=>this.send(JSON.stringify(s)),once:(s,$n)=>{var Dn;const Un=Bn=>{var In;try{const qn=JSON.parse(Bn.data);(qn[0]==="EOSE"||qn[0]==="EVENT"||qn[0]==="NOTICE")&&($n(),(In=this.ws)==null||In.removeEventListener("message",Un))}catch{}};(Dn=this.ws)==null||Dn.addEventListener("message",Un)}}).then(s=>{s||this.handleStaleConnection()}))}resetReconnectionState(){this.wasIdle=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}async connect(s,$n=!0){if(this.ws&&this.ws.readyState!==WebSocket.OPEN&&this.ws.readyState!==WebSocket.CONNECTING){this.debug("Cleaning up stale WebSocket connection");try{this.ws.close()}catch{}this.ws=void 0,this._status=1}if(this._status!==2&&this._status!==1||this.reconnectTimeout){this.debug("Relay requested to be connected but was in state %s or it had a reconnect timeout",this._status);return}this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),s??(s=this.timeoutMs),!this.timeoutMs&&s&&(this.timeoutMs=s),this.timeoutMs&&(this.connectTimeout=setTimeout(()=>this.onConnectionError($n),this.timeoutMs));try{this.updateConnectionStats.attempt(),this._status===1?this._status=4:this._status=2,this.ws=new WebSocket(this.ndkRelay.url),this.ws.onopen=this.onConnect.bind(this),this.ws.onclose=this.onDisconnect.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onerror=this.onError.bind(this)}catch(Dn){throw this.debug(`Failed to connect to ${this.ndkRelay.url}`,Dn),this._status=1,$n?this.handleReconnection():this.ndkRelay.emit("delayed-connect",2880*60*1e3),Dn}}disconnect(){var s,$n;this._status=0,(s=this.keepalive)==null||s.stop(),this.wsStateMonitor&&(clearInterval(this.wsStateMonitor),this.wsStateMonitor=void 0),this.sleepDetector&&(clearInterval(this.sleepDetector),this.sleepDetector=void 0);try{($n=this.ws)==null||$n.close()}catch(Dn){this.debug("Failed to disconnect",Dn),this._status=1}}onConnectionError(s){this.debug(`Error connecting to ${this.ndkRelay.url}`,this.timeoutMs),s&&!this.reconnectTimeout&&this.handleReconnection()}onConnect(){var s,$n;(s=this.netDebug)==null||s.call(this,"connected",this.ndkRelay),this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.updateConnectionStats.connected(),this._status=5,($n=this.keepalive)==null||$n.start(),this.wasIdle=!1,this.ndkRelay.emit("connect"),this.ndkRelay.emit("ready")}onDisconnect(){var s,$n;(s=this.netDebug)==null||s.call(this,"disconnected",this.ndkRelay),this.updateConnectionStats.disconnected(),($n=this.keepalive)==null||$n.stop(),this.clearPendingPublishes(new Error(`Relay ${this.ndkRelay.url} disconnected`)),this._status===5&&this.handleReconnection(),this._status=1,this.ndkRelay.emit("disconnect")}onMessage(s){var $n,Dn;($n=this.netDebug)==null||$n.call(this,s.data,this.ndkRelay,"recv"),(Dn=this.keepalive)==null||Dn.recordActivity();try{const Un=JSON.parse(s.data),[Bn,In,...qn]=Un,Fn=this.ndkRelay.getProtocolHandler(Bn);if(Fn){Fn(this.ndkRelay,Un);return}switch(Bn){case"EVENT":{const Kn=this.openSubs.get(In),jn=Un[2];if(!Kn){this.debug(`Received event for unknown subscription ${In}`);return}Kn.onevent(jn);return}case"COUNT":{const Kn=Un[2],jn=this.openCountRequests.get(In);jn&&(jn.resolve(Kn.count),this.openCountRequests.delete(In));return}case"EOSE":{const Kn=this.openSubs.get(In);if(!Kn)return;Kn.oneose(In);return}case"OK":{const Kn=Un[2],jn=Un[3],Yn=this.openEventPublishes.get(In),Zn=Yn?.pop();if(!Yn||!Zn){this.debug("Received OK for unknown event publish",In);return}Kn?(Zn.resolve(jn),this.pendingAuthPublishes.delete(In)):jn&&(jn.toLowerCase().includes("auth-required")||jn.toLowerCase().includes("not authorized")||jn.toLowerCase().includes("blocked: not authorized"))?this.pendingAuthPublishes.get(In)?(this.debug("Publish failed due to auth-required, will retry after auth",In),Yn.push(Zn),this.openEventPublishes.set(In,Yn)):Zn.reject(new Error(jn)):(Zn.reject(new Error(jn)),this.pendingAuthPublishes.delete(In)),Yn.length===0?this.openEventPublishes.delete(In):!Kn&&!(jn!=null&&jn.toLowerCase().includes("auth-required")||jn!=null&&jn.toLowerCase().includes("not authorized")||jn!=null&&jn.toLowerCase().includes("blocked: not authorized"))&&this.openEventPublishes.set(In,Yn);return}case"CLOSED":{const Kn=this.openSubs.get(In);if(!Kn)return;Kn.onclosed(Un[2]);return}case"NOTICE":this.onNotice(Un[1]);return;case"AUTH":{this.onAuthRequested(Un[1]);return}}}catch(Un){this.debug(`Error parsing message from ${this.ndkRelay.url}: ${Un.message}`,Un?.stack);return}}async onAuthRequested(s){var $n,Dn,Un;const Bn=this.ndkRelay.authPolicy??(($n=this.ndk)==null?void 0:$n.relayAuthDefaultPolicy);if(this.debug("Relay requested authentication",{havePolicy:!!Bn}),this._status===7){this.debug("Already authenticating, ignoring");return}if(this._status=6,Bn){if(this._status>=5){this._status=7;let In;try{In=await Bn(this.ndkRelay,s)}catch(qn){this.debug("Authentication policy threw an error",qn),In=!1}if(this.debug("Authentication policy returned",!!In),In instanceof NDKEvent||In===!0){In instanceof NDKEvent&&await this.auth(In);const qn=async()=>{if(this._status>=5&&this._status<8){const Fn=new NDKEvent(this.ndk);Fn.kind=22242,Fn.tags=[["relay",this.ndkRelay.url],["challenge",s]],await Fn.sign(),this.auth(Fn).then(()=>{this._status=8,this.ndkRelay.emit("authed"),this.debug("Authentication successful"),this.retryPendingAuthPublishes()}).catch(Kn=>{this._status=6,this.ndkRelay.emit("auth:failed",Kn),this.debug("Authentication failed",Kn),this.rejectPendingAuthPublishes(Kn)})}else this.debug("Authentication failed, it changed status, status is %d",this._status)};In===!0&&((Dn=this.ndk)!=null&&Dn.signer?qn().catch(Fn=>{console.error("Error authenticating",Fn)}):(this.debug("No signer available for authentication localhost"),(Un=this.ndk)==null||Un.once("signer:ready",qn))),this._status=5,this.ndkRelay.emit("authed")}}}else this.ndkRelay.emit("auth",s)}onError(s){this.debug(`WebSocket error on ${this.ndkRelay.url}:`,s)}get status(){return this._status}isAvailable(){return this._status===5}isFlapping(){const s=this._connectionStats.durations;if(s.length%3!==0)return!1;const $n=s.reduce((Un,Bn)=>Un+Bn,0)/s.length,Dn=s.map(Un=>(Un-$n)**2).reduce((Un,Bn)=>Un+Bn,0)/s.length;return Math.sqrt(Dn)<FLAPPING_THRESHOLD_MS}async onNotice(s){this.ndkRelay.emit("notice",s)}handleReconnection(s=0){if(this.reconnectTimeout)return;if(this.isFlapping()){this.ndkRelay.emit("flapping",this._connectionStats),this._status=3;return}let $n;if(this.wasIdle){const Dn=[0,1e3,2e3,5e3,1e4,3e4];$n=Dn[Math.min(s,Dn.length-1)],this.debug(`Using aggressive reconnect after idle, attempt ${s}, delay ${$n}ms`)}else this.connectedAt?$n=Math.max(0,6e4-(Date.now()-this.connectedAt)):($n=Math.min(1e3*2**s,3e4),this.debug(`Using standard backoff, attempt ${s}, delay ${$n}ms`));this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=void 0,this._status=2,this.connect().catch(Dn=>{s<MAX_RECONNECT_ATTEMPTS?this.handleReconnection(s+1):(this.debug("Max reconnect attempts reached"),this.wasIdle=!1)})},$n),this.ndkRelay.emit("delayed-connect",$n),this.debug("Reconnecting in",$n),this._connectionStats.nextReconnectAt=Date.now()+$n}async send(s){var $n,Dn,Un,Bn,In;Date.now()-this.lastMessageSent>12e4&&(this.wasIdle=!0),this._status>=5&&(($n=this.ws)==null?void 0:$n.readyState)===WebSocket.OPEN?((Dn=this.ws)==null||Dn.send(s),(Un=this.netDebug)==null||Un.call(this,s,this.ndkRelay,"send"),this.lastMessageSent=Date.now()):(this.debug(`Not connected to ${this.ndkRelay.url} (%d), not sending message ${s}`,this._status),this._status>=5&&((Bn=this.ws)==null?void 0:Bn.readyState)!==WebSocket.OPEN&&(this.debug(`Stale connection detected, WebSocket state: ${(In=this.ws)==null?void 0:In.readyState}`),this.handleStaleConnection()))}async auth(s){const $n=new Promise((Dn,Un)=>{const Bn=this.openEventPublishes.get(s.id)??[];Bn.push({resolve:Dn,reject:Un}),this.openEventPublishes.set(s.id,Bn)});return this.send(`["AUTH",${JSON.stringify(s.rawEvent())}]`),$n}clearPendingPublishes(s){this.rejectPendingAuthPublishes(s);for(const[$n,Dn]of this.openEventPublishes.entries()){for(;Dn.length>0;){const Un=Dn.shift();Un&&Un.reject(s)}this.openEventPublishes.delete($n)}}retryPendingAuthPublishes(){if(this.pendingAuthPublishes.size!==0){this.debug(`Retrying ${this.pendingAuthPublishes.size} pending publishes after auth`);for(const[s,$n]of this.pendingAuthPublishes.entries())this.debug(`Retrying publish for event ${s}`),this.send(`["EVENT",${JSON.stringify($n)}]`);this.pendingAuthPublishes.clear()}}rejectPendingAuthPublishes(s){if(this.pendingAuthPublishes.size!==0){this.debug(`Rejecting ${this.pendingAuthPublishes.size} pending publishes due to auth failure`);for(const[$n]of this.pendingAuthPublishes.entries()){const Dn=this.openEventPublishes.get($n);if(Dn&&Dn.length>0){const Un=Dn.pop();Un&&Un.reject(new Error(`Authentication failed: ${s.message}`)),Dn.length===0&&this.openEventPublishes.delete($n)}}this.pendingAuthPublishes.clear()}}async publish(s){const $n=new Promise((Dn,Un)=>{const Bn=this.openEventPublishes.get(s.id)??[];Bn.length>0&&console.warn(`Duplicate event publishing detected, you are publishing event ${s.id} twice`),Bn.push({resolve:Dn,reject:Un}),this.openEventPublishes.set(s.id,Bn)});return this.pendingAuthPublishes.set(s.id,s),this.send(`["EVENT",${JSON.stringify(s)}]`),$n}async count(s,$n){this.serial++;const Dn=$n?.id||`count:${this.serial}`,Un=new Promise((Bn,In)=>{this.openCountRequests.set(Dn,{resolve:Bn,reject:In})});return this.send(`["COUNT","${Dn}",${JSON.stringify(s).substring(1)}`),Un}close(s,$n){this.send(`["CLOSE","${s}"]`);const Dn=this.openSubs.get(s);this.openSubs.delete(s),Dn&&Dn.onclose($n)}req(s){`${this.send(`["REQ","${s.subId}",${JSON.stringify(s.executeFilters).substring(1)}`)}`,this.openSubs.set(s.subId,s)}get connectionStats(){return this._connectionStats}get url(){return this.ndkRelay.url}get connected(){var s;return this._status>=5&&((s=this.ws)==null?void 0:s.readyState)===WebSocket.OPEN}};async function fetchRelayInformation(s){const $n=s.replace(/^wss:\/\//,"https://").replace(/^ws:\/\//,"http://"),Dn=await fetch($n,{headers:{Accept:"application/nostr+json"}});if(!Dn.ok)throw new Error(`Failed to fetch relay information: ${Dn.status} ${Dn.statusText}`);return await Dn.json()}var NDKRelayPublisher=class{constructor(s){g$3(this,"ndkRelay"),g$3(this,"debug"),this.ndkRelay=s,this.debug=s.debug.extend("publisher")}async publish(s,$n=2500){let Dn;const Un=()=>new Promise((Yn,Zn)=>{try{this.publishEvent(s).then(Xn=>{this.ndkRelay.emit("published",s),s.emit("relay:published",this.ndkRelay),Yn(!0)}).catch(Zn)}catch(Xn){Zn(Xn)}}),Bn=new Promise((Yn,Zn)=>{Dn=setTimeout(()=>{Dn=void 0,Zn(new Error(`Timeout: ${$n}ms`))},$n)}),In=()=>{Un().then(Yn=>qn(Yn)).catch(Yn=>Fn(Yn))};let qn,Fn;const Kn=Yn=>{throw this.ndkRelay.debug("Publish failed",Yn,s.id),this.ndkRelay.emit("publish:failed",s,Yn),s.emit("relay:publish:failed",this.ndkRelay,Yn),Yn},jn=()=>{Dn&&clearTimeout(Dn),this.ndkRelay.removeListener("connect",In)};return this.ndkRelay.status>=5?Promise.race([Un(),Bn]).catch(Kn).finally(jn):(this.ndkRelay.status<=1?(console.warn("Relay is disconnected, trying to connect to publish an event",this.ndkRelay.url),this.ndkRelay.connect()):console.warn("Relay not connected, waiting for connection to publish an event",this.ndkRelay.url),Promise.race([new Promise((Yn,Zn)=>{qn=Yn,Fn=Zn,this.ndkRelay.on("connect",In)}),Bn]).catch(Kn).finally(jn))}async publishEvent(s){return this.ndkRelay.connectivity.publish(s.rawEvent())}};function filterFingerprint(s,$n){const Dn=[];for(const Bn of s){const In=Object.entries(Bn||{}).map(([qn,Fn])=>["since","until"].includes(qn)?`${qn}:${Fn}`:qn).sort().join("-");Dn.push(In)}let Un=$n?"+":"";return Un+=Dn.join("|"),Un}function mergeFilters(s){const $n=[],Dn={};return s.filter(Un=>!!Un.limit).forEach(Un=>$n.push(Un)),s=s.filter(Un=>!Un.limit),s.length===0?$n:(s.forEach(Un=>{Object.entries(Un).forEach(([Bn,In])=>{Array.isArray(In)?Dn[Bn]===void 0?Dn[Bn]=[...In]:Dn[Bn]=Array.from(new Set([...Dn[Bn],...In])):Dn[Bn]=In})}),[...$n,Dn])}var MAX_ITEMS=3;function formatArray(s,$n){const Dn=($n?s.slice(0,MAX_ITEMS).map($n):s.slice(0,MAX_ITEMS)).join(",");return s.length>MAX_ITEMS?`${Dn}+${s.length-MAX_ITEMS}`:Dn}function formatFilters(s){return s.map($n=>{var Dn,Un,Bn;const In=[];(Dn=$n.ids)!=null&&Dn.length&&In.push(`ids:[${formatArray($n.ids,qn=>String(qn).slice(0,8))}]`),(Un=$n.kinds)!=null&&Un.length&&In.push(`kinds:[${formatArray($n.kinds)}]`),(Bn=$n.authors)!=null&&Bn.length&&In.push(`authors:[${formatArray($n.authors,qn=>String(qn).slice(0,8))}]`),$n.since&&In.push(`since:${$n.since}`),$n.until&&In.push(`until:${$n.until}`),$n.limit&&In.push(`limit:${$n.limit}`),$n.search&&In.push(`search:"${String($n.search).slice(0,20)}"`);for(const[qn,Fn]of Object.entries($n))qn.startsWith("#")&&Array.isArray(Fn)&&Fn.length>0&&In.push(`${qn}:[${formatArray(Fn,Kn=>String(Kn).slice(0,8))}]`);return`{${In.join(" ")}}`}).join(", ")}var NDKRelaySubscription=class{constructor(s,$n,Dn){g$3(this,"fingerprint"),g$3(this,"items",new Map),g$3(this,"topSubManager"),g$3(this,"debug"),g$3(this,"status",0),g$3(this,"onClose"),g$3(this,"relay"),g$3(this,"eosed",!1),g$3(this,"executionTimer"),g$3(this,"fireTime"),g$3(this,"delayType"),g$3(this,"executeFilters"),g$3(this,"id",Math.random().toString(36).substring(7)),g$3(this,"_subId"),g$3(this,"subIdParts",new Set),g$3(this,"executeOnRelayReady",()=>{if(this.status===2){if(this.items.size===0){this.debug("No items to execute; this relay was probably too slow to respond and the caller gave up",{status:this.status,fingerprint:this.fingerprint,id:this.id,subId:this.subId}),this.cleanup();return}this.debug("Executing on relay ready",{status:this.status,fingerprint:this.fingerprint,itemsSize:this.items.size,filters:formatFilters(this.compileFilters())}),this.status=1,this.execute()}}),g$3(this,"reExecuteAfterAuth",(()=>{const Un=this.subId;this.debug("Re-executing after auth",this.items.size),this.eosed?this.relay.close(this.subId):this.debug("We are abandoning an opened subscription, once it EOSE's, the handler will close it",{oldSubId:Un}),this._subId=void 0,this.status=1,this.execute(),this.debug("Re-executed after auth %s  %s",Un,this.subId)}).bind(this)),this.relay=s,this.topSubManager=Dn,this.debug=s.debug.extend(`sub[${this.id}]`),this.fingerprint=$n||Math.random().toString(36).substring(7)}get subId(){return this._subId?this._subId:(this._subId=this.fingerprint.slice(0,15),this._subId)}addSubIdPart(s){this.subIdParts.add(s)}addItem(s,$n){if(this.debug("Adding item",{filters:formatFilters($n),internalId:s.internalId,status:this.status,fingerprint:this.fingerprint,id:this.subId,itemsSize:this.items.size}),!this.items.has(s.internalId))switch(s.on("close",this.removeItem.bind(this,s)),this.items.set(s.internalId,{subscription:s,filters:$n}),this.status!==3&&s.subId&&(!this._subId||this._subId.length<25)&&(this.status===0||this.status===1)&&this.addSubIdPart(s.subId),this.status){case 0:this.evaluateExecutionPlan(s);break;case 3:break;case 1:this.evaluateExecutionPlan(s);break;case 4:throw this.debug("Subscription is closed, cannot add new items",{filters:formatFilters($n),subId:s.subId,internalId:s.internalId}),new Error("Cannot add new items to a closed subscription")}}removeItem(s){if(this.items.delete(s.internalId),this.items.size===0){if(!this.eosed)return;this.close(),this.cleanup()}}close(){if(this.status===4)return;const s=this.status;if(this.status=4,s===3)try{this.relay.close(this.subId)}catch($n){this.debug("Error closing subscription",$n,this)}else this.debug("Subscription wanted to close but it wasn't running, this is probably ok",{subId:this.subId,prevStatus:s,sub:this});this.cleanup()}cleanup(){this.executionTimer&&clearTimeout(this.executionTimer),this.relay.off("ready",this.executeOnRelayReady),this.relay.off("authed",this.reExecuteAfterAuth),this.onClose&&this.onClose(this)}evaluateExecutionPlan(s){if(!s.isGroupable()){this.status=1,this.execute();return}if(s.filters.find(Un=>!!Un.limit)&&(this.executeFilters=this.compileFilters(),this.executeFilters.length>=10)){this.status=1,this.execute();return}const $n=s.groupableDelay,Dn=s.groupableDelayType;if(!$n)throw new Error("Cannot group a subscription without a delay");if(this.status===0)this.schedule($n,Dn);else{const Un=this.delayType,Bn=this.fireTime-Date.now();if(Un==="at-least"&&Dn==="at-least")Bn<$n&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule($n,Dn));else if(Un==="at-least"&&Dn==="at-most")Bn>$n&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule($n,Dn));else if(Un==="at-most"&&Dn==="at-most")Bn>$n&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule($n,Dn));else if(Un==="at-most"&&Dn==="at-least")Bn>$n&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule($n,Dn));else throw new Error(`Unknown delay type combination ${Un} ${Dn}`)}}schedule(s,$n){this.status=1;const Dn=Date.now();this.fireTime=Dn+s,this.delayType=$n;const Un=setTimeout(this.execute.bind(this),s);$n==="at-least"&&(this.executionTimer=Un)}finalizeSubId(){if(this.subIdParts.size>0){let s=Array.from(this.subIdParts).map($n=>$n.substring(0,10)).join("-");s.length>20&&(s=s.substring(0,20)),this._subId=s}else this._subId=this.fingerprint.slice(0,15);this._subId+=`-${Math.random().toString(36).substring(2,7)}`}execute(){if(this.status===1){if(!this.relay.connected){this.status=2,this.debug("Waiting for relay to be ready",{status:this.status,id:this.subId,fingerprint:this.fingerprint,itemsSize:this.items.size}),this.relay.once("ready",this.executeOnRelayReady);return}this.relay.status<8&&this.relay.once("authed",this.reExecuteAfterAuth),this.status=3,this.finalizeSubId(),this.executeFilters=this.compileFilters(),this.relay.req(this)}}onstart(){}onevent(s){this.topSubManager.dispatchEvent(s,this.relay)}oneose(s){if(this.eosed=!0,s!==this.subId){this.debug("Received EOSE for an abandoned subscription",s,this.subId),this.relay.close(s);return}this.items.size===0&&this.close();for(const{subscription:$n}of this.items.values())$n.eoseReceived(this.relay),$n.closeOnEose&&(this.debug("Removing item because of EOSE",{filters:formatFilters($n.filters),internalId:$n.internalId,status:this.status,fingerprint:this.fingerprint,itemsSize:this.items.size}),this.removeItem($n))}onclose(s){this.status=4}onclosed(s){if(s)for(const{subscription:$n}of this.items.values())$n.closedReceived(this.relay,s)}compileFilters(){const s=[],$n=Array.from(this.items.values()).map(Un=>Un.filters);if(!$n[0])return this.debug(" No filters to merge",{itemsSize:this.items.size}),[];const Dn=$n[0].length;for(let Un=0;Un<Dn;Un++){const Bn=$n.map(qn=>qn[Un]),In=mergeFilters(Bn);s.push(...In)}return s}},NDKRelaySubscriptionManager=class{constructor(s,$n){g$3(this,"relay"),g$3(this,"subscriptions"),g$3(this,"generalSubManager"),this.relay=s,this.subscriptions=new Map,this.generalSubManager=$n}addSubscription(s,$n){let Dn;if(!s.isGroupable())Dn=this.createSubscription(s,$n);else{const Un=filterFingerprint($n,s.closeOnEose);Un&&(Dn=(this.subscriptions.get(Un)||[]).find(Bn=>Bn.status<3)),Dn??(Dn=this.createSubscription(s,$n,Un))}Dn.addItem(s,$n)}createSubscription(s,$n,Dn){const Un=new NDKRelaySubscription(this.relay,Dn||null,this.generalSubManager);Un.onClose=this.onRelaySubscriptionClose.bind(this);const Bn=this.subscriptions.get(Un.fingerprint)??[];return this.subscriptions.set(Un.fingerprint,[...Bn,Un]),Un}onRelaySubscriptionClose(s){let $n=this.subscriptions.get(s.fingerprint)??[];$n?$n.length===1?this.subscriptions.delete(s.fingerprint):($n=$n.filter(Dn=>Dn.id!==s.id),this.subscriptions.set(s.fingerprint,$n)):console.warn("Unexpectedly did not find a subscription with fingerprint",s.fingerprint)}},$e$3,NDKRelay=($e$3=class extends lib$1.EventEmitter{constructor(s,$n,Dn){super(),g$3(this,"url"),g$3(this,"scores"),g$3(this,"connectivity"),g$3(this,"subs"),g$3(this,"publisher"),g$3(this,"authPolicy"),g$3(this,"protocolHandlers",new Map),g$3(this,"_relayInfo"),g$3(this,"lowestValidationRatio"),g$3(this,"targetValidationRatio"),g$3(this,"validationRatioFn"),g$3(this,"validatedEventCount",0),g$3(this,"nonValidatedEventCount",0),g$3(this,"trusted",!1),g$3(this,"complaining",!1),g$3(this,"debug"),g$3(this,"req"),g$3(this,"close"),this.url=normalizeRelayUrl(s),this.scores=new Map,this.debug=createDebug5(`ndk:relay:${s}`),this.connectivity=new NDKRelayConnectivity(this,Dn),this.connectivity.netDebug=Dn?.netDebug,this.req=this.connectivity.req.bind(this.connectivity),this.close=this.connectivity.close.bind(this.connectivity),this.subs=new NDKRelaySubscriptionManager(this,Dn.subManager),this.publisher=new NDKRelayPublisher(this),this.authPolicy=$n,this.targetValidationRatio=Dn?.initialValidationRatio,this.lowestValidationRatio=Dn?.lowestValidationRatio,this.validationRatioFn=(Dn?.validationRatioFn??$e$3.defaultValidationRatioUpdateFn).bind(this),this.updateValidationRatio(),Dn||console.trace("relay created without ndk")}updateValidationRatio(){if(this.validationRatioFn&&this.validatedEventCount>0){const s=this.validationRatioFn(this,this.validatedEventCount,this.nonValidatedEventCount);this.targetValidationRatio=s}setTimeout(()=>{this.updateValidationRatio()},3e4)}get status(){return this.connectivity.status}get connectionStats(){return this.connectivity.connectionStats}async connect(s,$n=!0){return this.connectivity.connect(s,$n)}disconnect(){this.status!==1&&this.connectivity.disconnect()}subscribe(s,$n){this.subs.addSubscription(s,$n)}async publish(s,$n=2500){return this.publisher.publish(s,$n)}referenceTags(){return[["r",this.url]]}addValidatedEvent(){this.validatedEventCount++}addNonValidatedEvent(){this.nonValidatedEventCount++}get validationRatio(){return this.nonValidatedEventCount===0?1:this.validatedEventCount/(this.validatedEventCount+this.nonValidatedEventCount)}shouldValidateEvent(){return this.trusted?!1:this.targetValidationRatio===void 0||this.targetValidationRatio>=1?!0:Math.random()<this.targetValidationRatio}get connected(){return this.connectivity.connected}registerProtocolHandler(s,$n){this.protocolHandlers.set(s,$n)}unregisterProtocolHandler(s){this.protocolHandlers.delete(s)}getProtocolHandler(s){return this.protocolHandlers.get(s)}async fetchInfo(s=!1){var $n,Dn;const Un=this.connectivity.ndk;if(!s&&($n=Un?.cacheAdapter)!=null&&$n.getRelayStatus){const Bn=await Un.cacheAdapter.getRelayStatus(this.url);if(Bn!=null&&Bn.nip11&&Date.now()-Bn.nip11.fetchedAt<864e5)return this._relayInfo=Bn.nip11.data,Bn.nip11.data}return!s&&this._relayInfo?this._relayInfo:(this._relayInfo=await fetchRelayInformation(this.url),(Dn=Un?.cacheAdapter)!=null&&Dn.updateRelayStatus&&await Un.cacheAdapter.updateRelayStatus(this.url,{nip11:{data:this._relayInfo,fetchedAt:Date.now()}}),this._relayInfo)}get info(){return this._relayInfo}},g$3($e$3,"defaultValidationRatioUpdateFn",(s,$n,Dn)=>{if(s.lowestValidationRatio===void 0||s.targetValidationRatio===void 0)return 1;let Un=s.validationRatio;if(s.validationRatio>s.targetValidationRatio){const Bn=$n/100;Un=Math.max(s.lowestValidationRatio,s.validationRatio-Bn)}return Un<s.validationRatio?Un:s.validationRatio}),$e$3),NDKPublishError=class extends Error{constructor(s,$n,Dn,Un){super(s),g$3(this,"errors"),g$3(this,"publishedToRelays"),g$3(this,"intendedRelaySet"),this.errors=$n,this.publishedToRelays=Dn,this.intendedRelaySet=Un}get relayErrors(){const s=[];for(const[$n,Dn]of this.errors)s.push(`${$n.url}: ${Dn}`);return s.join(`
`)}},NDKRelaySet=class Gm{constructor($n,Dn,Un){g$3(this,"relays"),g$3(this,"debug"),g$3(this,"ndk"),g$3(this,"pool"),this.relays=$n,this.ndk=Dn,this.pool=Un??Dn.pool,this.debug=Dn.debug.extend("relayset")}addRelay($n){this.relays.add($n)}get relayUrls(){return Array.from(this.relays).map($n=>$n.url)}static fromRelayUrls($n,Dn,Un=!0,Bn){if(Bn=Bn??Dn.pool,!Bn)throw new Error("No pool provided");const In=new Set;for(const qn of $n){const Fn=Bn.relays.get(normalizeRelayUrl(qn));if(Fn)Fn.status<5&&Un&&Fn.connect(),In.add(Fn);else{const Kn=new NDKRelay(normalizeRelayUrl(qn),Dn?.relayAuthDefaultPolicy,Dn);Bn.useTemporaryRelay(Kn,void 0,`requested from fromRelayUrls ${$n}`),In.add(Kn)}}return new Gm(new Set(In),Dn,Bn)}async publish($n,Dn,Un=1){var Bn;const In=new Set,qn=new Map,Fn=$n.isEphemeral();$n.publishStatus="pending";const Kn=jn=>{In.add(jn)};$n.on("relay:published",Kn);try{const jn=Array.from(this.relays).map(Yn=>new Promise(Zn=>{const Xn=Dn?setTimeout(()=>{In.has(Yn)||(qn.set(Yn,new Error(`Publish timeout after ${Dn}ms`)),Zn(!1))},Dn):null;Yn.publish($n,Dn).then(Jn=>{Xn&&clearTimeout(Xn),Jn?(In.add(Yn),Zn(!0)):Zn(!1)}).catch(Jn=>{Xn&&clearTimeout(Xn),Fn||qn.set(Yn,Jn),Zn(!1)})}));if(await Promise.all(jn),In.size<Un){if(!Fn){const Yn=new NDKPublishError("Not enough relays received the event ("+In.size+" published, "+Un+" required)",qn,In,this);throw $n.publishStatus="error",$n.publishError=Yn,(Bn=this.ndk)==null||Bn.emit("event:publish-failed",$n,Yn,this.relayUrls),Yn}}else $n.publishStatus="success",$n.emit("published",{relaySet:this,publishedToRelays:In});return In}finally{$n.off("relay:published",Kn)}}get size(){return this.relays.size}},d$4=createDebug5("ndk:outbox:calculate");async function calculateRelaySetFromEvent(s,$n,Dn){var Un,Bn;const In=new Set,qn=await getWriteRelaysFor(s,$n.pubkey);qn&&qn.forEach(jn=>{var Yn;const Zn=(Yn=s.pool)==null?void 0:Yn.getRelay(jn);Zn&&In.add(Zn)});let Fn=$n.tags.filter(jn=>["a","e"].includes(jn[0])).map(jn=>jn[2]).filter(jn=>jn?.startsWith("wss://")).filter(jn=>{try{return new URL(jn),!0}catch{return!1}}).map(jn=>normalizeRelayUrl(jn));Fn=Array.from(new Set(Fn)).slice(0,5),Fn.forEach(jn=>{var Yn;const Zn=(Yn=s.pool)==null?void 0:Yn.getRelay(jn,!0,!0);Zn&&(d$4("Adding relay hint %s",jn),In.add(Zn))});const Kn=$n.getMatchingTags("p").map(jn=>jn[1]);if(Kn.length<5?Array.from(chooseRelayCombinationForPubkeys(s,Kn,"read",{preferredRelays:new Set(qn)}).keys()).forEach(jn=>{var Yn;const Zn=(Yn=s.pool)==null?void 0:Yn.getRelay(jn,!1,!0);Zn&&(d$4("Adding p-tagged relay %s",jn),In.add(Zn))}):d$4("Too many p-tags to consider %d",Kn.length),(Un=s.pool)==null||Un.permanentAndConnectedRelays().forEach(jn=>In.add(jn)),Dn&&In.size<Dn){const jn=(Bn=s.explicitRelayUrls)==null?void 0:Bn.filter(Yn=>!Array.from(In).some(Zn=>Zn.url===Yn)).slice(0,Dn-In.size);jn?.forEach(Yn=>{var Zn;const Xn=(Zn=s.pool)==null?void 0:Zn.getRelay(Yn,!1,!0);Xn&&(d$4("Adding explicit relay %s",Yn),In.add(Xn))})}return new NDKRelaySet(In,s)}function calculateRelaySetsFromFilter(s,$n,Dn,Un){const Bn=new Map,In=new Set;if($n.forEach(qn=>{qn.authors&&qn.authors.forEach(Fn=>In.add(Fn))}),In.size>0){const qn=getRelaysForFilterWithAuthors(s,Array.from(In),Un);for(const Fn of qn.keys())Bn.set(Fn,[]);for(const Fn of $n)if(Fn.authors)for(const[Kn,jn]of qn.entries()){const Yn=Fn.authors.filter(Zn=>jn.includes(Zn));Bn.set(Kn,[...Bn.get(Kn),{...Fn,authors:Yn}])}else for(const Kn of qn.keys())Bn.set(Kn,[...Bn.get(Kn),Fn])}else s.explicitRelayUrls&&s.explicitRelayUrls.forEach(qn=>{Bn.set(qn,$n)});return Bn.size===0&&Dn.permanentAndConnectedRelays().slice(0,5).forEach(qn=>{Bn.set(qn.url,$n)}),Bn}function calculateRelaySetsFromFilters(s,$n,Dn,Un){return calculateRelaySetsFromFilter(s,$n,Dn,Un)}function isValidHex64(s){if(typeof s!="string"||s.length!==64)return!1;for(let $n=0;$n<64;$n++){const Dn=s.charCodeAt($n);if(!(Dn>=48&&Dn<=57||Dn>=97&&Dn<=102||Dn>=65&&Dn<=70))return!1}return!0}function isValidPubkey(s){return isValidHex64(s)}function isValidNip05(s){if(typeof s!="string")return!1;for(let $n=0;$n<s.length;$n++)if(s.charCodeAt($n)===46)return!0;return!1}function mergeTags(s,$n){const Dn=new Map,Un=qn=>qn.join(","),Bn=(qn,Fn)=>qn.every((Kn,jn)=>Kn===Fn[jn]),In=qn=>{for(const[Fn,Kn]of Dn)if(Bn(Kn,qn)||Bn(qn,Kn)){qn.length>=Kn.length&&Dn.set(Fn,qn);return}Dn.set(Un(qn),qn)};return s.concat($n).forEach(In),Array.from(Dn.values())}var hashtagRegex=new RegExp(`(?<=\\s|^)(#[^\\s!@#$%^&*()=+./,[{\\]};:'"?><]+)`,"g");function generateHashtags(s){const $n=s.match(hashtagRegex),Dn=new Set,Un=new Set;if($n)for(const Bn of $n)Dn.has(Bn.slice(1))||(Un.add(Bn.slice(1)),Dn.add(Bn.slice(1)));return Array.from(Un)}async function generateContentTags(s,$n=[],Dn,Un){var Bn,In;if(Dn!=null&&Dn.skipContentTagging)return{content:s,tags:$n};const qn=/(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g,Fn=[],Kn=jn=>{$n.find(Yn=>["q",jn[0]].includes(Yn[0])&&Yn[1]===jn[1])||$n.push(jn)};if(s=s.replace(qn,jn=>{var Yn;try{const Zn=jn.split(/(@|nostr:)/)[2],{type:Xn,data:Jn}=nip19_exports$1.decode(Zn);let Wn;if(Dn!=null&&Dn.filters){const tr=!Dn.filters.includeTypes||Dn.filters.includeTypes.includes(Xn),ir=(Yn=Dn.filters.excludeTypes)==null?void 0:Yn.includes(Xn);if(!tr||ir)return jn}switch(Xn){case"npub":Dn?.pTags!==!1&&(Wn=["p",Jn]);break;case"nprofile":Dn?.pTags!==!1&&(Wn=["p",Jn.pubkey]);break;case"note":Fn.push(new Promise(async tr=>{const ir=await maybeGetEventRelayUrl(Zn);Kn(["q",Jn,ir]),tr()}));break;case"nevent":Fn.push(new Promise(async tr=>{const{id:ir,author:sr}=Jn;let{relays:fr}=Jn;(!fr||fr.length===0)&&(fr=[await maybeGetEventRelayUrl(Zn)]),Kn(["q",ir,fr[0]]),sr&&Dn?.pTags!==!1&&Dn?.pTagOnQTags!==!1&&Kn(["p",sr]),tr()}));break;case"naddr":Fn.push(new Promise(async tr=>{const ir=[Jn.kind,Jn.pubkey,Jn.identifier].join(":");let sr=Jn.relays??[];sr.length===0&&(sr=[await maybeGetEventRelayUrl(Zn)]),Kn(["q",ir,sr[0]]),Dn?.pTags!==!1&&Dn?.pTagOnQTags!==!1&&Dn?.pTagOnATags!==!1&&Kn(["p",Jn.pubkey]),tr()}));break;default:return jn}return Wn&&Kn(Wn),`nostr:${Zn}`}catch{return jn}}),await Promise.all(Fn),!((In=(Bn=Dn?.filters)==null?void 0:Bn.excludeTypes)!=null&&In.includes("hashtag"))){const jn=generateHashtags(s).map(Yn=>["t",Yn]);$n=mergeTags($n,jn)}if(Dn?.pTags!==!1&&Dn!=null&&Dn.copyPTagsFromTarget&&Un){const jn=Un.getMatchingTags("p");for(const Yn of jn)!Yn[1]||!isValidPubkey(Yn[1])||$n.find(Zn=>Zn[0]==="p"&&Zn[1]===Yn[1])||$n.push(Yn)}return{content:s,tags:$n}}async function maybeGetEventRelayUrl(s){return""}async function encrypt(s,$n,Dn="nip44"){let Un;if(!this.ndk)throw new Error("No NDK instance found!");let Bn=$n;if(Bn||(this.ndk.assertSigner(),Bn=this.ndk.signer),!Bn)throw new Error("no NDK signer");const In=s||(()=>{const qn=this.getMatchingTags("p");if(qn.length!==1)throw new Error("No recipient could be determined and no explicit recipient was provided");return this.ndk.getUser({pubkey:qn[0][1]})})();if(Dn==="nip44"&&await isEncryptionEnabled(Bn,"nip44")&&(Un=await Bn.encrypt(In,this.content,"nip44")),(!Un||Dn==="nip04")&&await isEncryptionEnabled(Bn,"nip04")&&(Un=await Bn.encrypt(In,this.content,"nip04")),!Un)throw new Error("Failed to encrypt event.");this.content=Un}async function decrypt(s,$n,Dn){var Un,Bn,In,qn;if((Bn=(Un=this.ndk)==null?void 0:Un.cacheAdapter)!=null&&Bn.getDecryptedEvent){const Zn=await this.ndk.cacheAdapter.getDecryptedEvent(this.id);if(Zn){this.content=Zn.content;return}}let Fn;if(!this.ndk)throw new Error("No NDK instance found!");let Kn=$n;if(Kn||(this.ndk.assertSigner(),Kn=this.ndk.signer),!Kn)throw new Error("no NDK signer");const jn=s||this.author;if(!jn)throw new Error("No sender provided and no author available");const Yn=Dn||(this.content.match(/\\?iv=/)?"nip04":"nip44");if((Yn==="nip04"||this.kind===4)&&await isEncryptionEnabled(Kn,"nip04")&&this.content.search("\\?iv=")&&(Fn=await Kn.decrypt(jn,this.content,"nip04")),!Fn&&Yn==="nip44"&&await isEncryptionEnabled(Kn,"nip44")&&(Fn=await Kn.decrypt(jn,this.content,"nip44")),!Fn)throw new Error("Failed to decrypt event.");this.content=Fn,(qn=(In=this.ndk)==null?void 0:In.cacheAdapter)!=null&&qn.addDecryptedEvent&&this.ndk.cacheAdapter.addDecryptedEvent(this.id,this)}async function isEncryptionEnabled(s,$n){return s.encryptionEnabled?$n?!!await s.encryptionEnabled($n):!0:!1}function eventHasETagMarkers(s){for(const $n of s.tags)if($n[0]==="e"&&($n[3]??"").length>0)return!0;return!1}function getRootTag(s,$n){$n??($n=s.tagType());const Dn=s.tags.find(isTagRootTag);if(!Dn){if(eventHasETagMarkers(s))return;const Un=s.getMatchingTags($n);if(Un.length<3)return Un[0]}return Dn}var nip22RootTags=new Set(["A","E","I"]),nip22ReplyTags=new Set(["a","e","i"]);function getReplyTag(s,$n){if(s.kind===1111){let Bn;for(const In of s.tags)if(nip22RootTags.has(In[0]))Bn=In;else if(nip22ReplyTags.has(In[0])){Bn=In;break}return Bn}$n??($n=s.tagType());let Dn=!1,Un;for(const Bn of s.tags)if(Bn[0]===$n){if((Bn[3]??"").length>0&&(Dn=!0),Dn&&Bn[3]==="reply")return Bn;Dn&&Bn[3]==="root"&&(Un=Bn),Dn||(Un=Bn)}return Un}function isTagRootTag(s){return s[0]==="E"||s[3]==="root"}async function fetchTaggedEvent(s,$n){if(!this.ndk)throw new Error("NDK instance not found");const Dn=this.getMatchingTags(s,$n);if(Dn.length===0)return;const[Un,Bn,In]=Dn[0],qn=In!==""?this.ndk.pool.getRelay(In):void 0;return await this.ndk.fetchEvent(Bn,{},qn)}async function fetchRootEvent(s){if(!this.ndk)throw new Error("NDK instance not found");const $n=getRootTag(this);if($n)return this.ndk.fetchEventFromTag($n,this,s)}async function fetchReplyEvent(s){if(!this.ndk)throw new Error("NDK instance not found");const $n=getReplyTag(this);if($n)return this.ndk.fetchEventFromTag($n,this,s)}function isReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return[0,3].includes(this.kind)||this.kind>=1e4&&this.kind<2e4||this.kind>=3e4&&this.kind<4e4}function isEphemeral(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=2e4&&this.kind<3e4}function isParamReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}var DEFAULT_RELAY_COUNT=2;function encode(s=DEFAULT_RELAY_COUNT){let $n=[];return this.onRelays.length>0?$n=this.onRelays.map(Dn=>Dn.url):this.relay&&($n=[this.relay.url]),$n.length>s&&($n=$n.slice(0,s)),this.isParamReplaceable()?nip19_exports$1.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag(),relays:$n}):$n.length>0?nip19_exports$1.neventEncode({id:this.tagId(),relays:$n,author:this.pubkey}):nip19_exports$1.noteEncode(this.tagId())}async function repost(s=!0,$n){if(!$n&&s){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),$n=this.ndk.signer}const Dn=new NDKEvent(this.ndk,{kind:getKind(this)});return this.isProtected||(Dn.content=JSON.stringify(this.rawEvent())),Dn.tag(this),this.kind!==1&&Dn.tags.push(["k",`${this.kind}`]),$n&&await Dn.sign($n),s&&await Dn.publish(),Dn}function getKind(s){return s.kind===1?6:16}function getEventDetails(s){return"inspect"in s&&typeof s.inspect=="string"?s.inspect:JSON.stringify(s)}function validateForSerialization(s){if(typeof s.kind!="number")throw new Error(`Can't serialize event with invalid properties: kind (must be number, got ${typeof s.kind}). Event: ${getEventDetails(s)}`);if(typeof s.content!="string")throw new Error(`Can't serialize event with invalid properties: content (must be string, got ${typeof s.content}). Event: ${getEventDetails(s)}`);if(typeof s.created_at!="number")throw new Error(`Can't serialize event with invalid properties: created_at (must be number, got ${typeof s.created_at}). Event: ${getEventDetails(s)}`);if(typeof s.pubkey!="string")throw new Error(`Can't serialize event with invalid properties: pubkey (must be string, got ${typeof s.pubkey}). Event: ${getEventDetails(s)}`);if(!Array.isArray(s.tags))throw new Error(`Can't serialize event with invalid properties: tags (must be array, got ${typeof s.tags}). Event: ${getEventDetails(s)}`);for(let $n=0;$n<s.tags.length;$n++){const Dn=s.tags[$n];if(!Array.isArray(Dn))throw new Error(`Can't serialize event with invalid properties: tags[${$n}] (must be array, got ${typeof Dn}). Event: ${getEventDetails(s)}`);for(let Un=0;Un<Dn.length;Un++)if(typeof Dn[Un]!="string")throw new Error(`Can't serialize event with invalid properties: tags[${$n}][${Un}] (must be string, got ${typeof Dn[Un]}). Event: ${getEventDetails(s)}`)}}function serialize(s=!1,$n=!1){validateForSerialization(this);const Dn=[0,this.pubkey,this.created_at,this.kind,this.tags,this.content];return s&&Dn.push(this.sig),$n&&Dn.push(this.id),JSON.stringify(Dn)}function deserialize(s){const $n=JSON.parse(s),Dn={pubkey:$n[1],created_at:$n[2],kind:$n[3],tags:$n[4],content:$n[5]};if($n.length>=7){const Un=$n[6],Bn=$n[7];Un&&Un.length===128?(Dn.sig=Un,Bn&&Bn.length===64&&(Dn.id=Bn)):Un&&Un.length===64&&(Dn.id=Un,Bn&&Bn.length===128&&(Dn.sig=Bn))}return Dn}var worker,processingQueue={};function signatureVerificationInit(s){worker=s,worker.onmessage=$n=>{if(!Array.isArray($n.data)||$n.data.length!==2){console.error("[NDK]  Signature verification worker received incompatible message format.",`

 Expected format: [eventId, boolean]`,`
 Received:`,$n.data,`

 This likely means:`,`
  1. You have a STALE worker.js file that needs updating`,`
  2. Version mismatch between @nostr-dev-kit/ndk and deployed worker`,`
  3. Wrong worker is being used for signature verification`,`

 Solution: Update your worker files:`,`
  cp node_modules/@nostr-dev-kit/ndk/dist/workers/sig-verification.js public/`,`
  cp node_modules/@nostr-dev-kit/cache-sqlite-wasm/dist/worker.js public/`,`

 Or use Vite/bundler imports instead of static files:`,`
  import SigWorker from "@nostr-dev-kit/ndk/workers/sig-verification?worker"`);return}const[Dn,Un]=$n.data,Bn=processingQueue[Dn];if(!Bn){console.error("No record found for event",Dn);return}delete processingQueue[Dn];for(const In of Bn.resolves)In(Un)}}async function verifySignatureAsync(s,$n,Dn){const Un=s.ndk,Bn=Date.now();let In;return Un.signatureVerificationFunction?In=await Un.signatureVerificationFunction(s):In=await new Promise(qn=>{const Fn=s.serialize();let Kn=!1;processingQueue[s.id]||(processingQueue[s.id]={event:s,resolves:[],relay:Dn},Kn=!0),processingQueue[s.id].resolves.push(qn),Kn&&worker?.postMessage({serialized:Fn,id:s.id,sig:s.sig,pubkey:s.pubkey})}),Un.signatureVerificationTimeMs+=Date.now()-Bn,In}var PUBKEY_REGEX=/^[a-f0-9]{64}$/;function validate(){if(typeof this.kind!="number"||typeof this.content!="string"||typeof this.created_at!="number"||typeof this.pubkey!="string"||!this.pubkey.match(PUBKEY_REGEX)||!Array.isArray(this.tags))return!1;for(let s=0;s<this.tags.length;s++){const $n=this.tags[s];if(!Array.isArray($n))return!1;for(let Dn=0;Dn<$n.length;Dn++)if(typeof $n[Dn]=="object")return!1}return!0}var verifiedSignatures=new dist.LRUCache({maxSize:1e3,entryExpirationTimeInMS:6e4});function verifySignature(s){var $n;if(typeof this.signatureVerified=="boolean")return this.signatureVerified;const Dn=verifiedSignatures.get(this.id);if(Dn!==null)return this.signatureVerified=!!Dn,this.signatureVerified;try{if(($n=this.ndk)!=null&&$n.asyncSigVerification){const Un=this.relay;verifySignatureAsync(this,s,Un).then(Bn=>{var In,qn;s&&(this.signatureVerified=Bn,Bn&&verifiedSignatures.set(this.id,this.sig)),Bn?Un&&Un.addValidatedEvent():(Un?(In=this.ndk)==null||In.reportInvalidSignature(this,Un):(qn=this.ndk)==null||qn.reportInvalidSignature(this),verifiedSignatures.set(this.id,!1))}).catch(Bn=>{console.error("signature verification error",this.id,Bn)})}else{const Un=sha256(new TextEncoder().encode(this.serialize())),Bn=schnorr.verify(this.sig,Un,this.pubkey);return Bn?verifiedSignatures.set(this.id,this.sig):verifiedSignatures.set(this.id,!1),this.signatureVerified=Bn,Bn}}catch{return this.signatureVerified=!1,!1}}function getEventHash(){return getEventHashFromSerializedEvent(this.serialize())}function getEventHashFromSerializedEvent(s){const $n=sha256(new TextEncoder().encode(s));return bytesToHex($n)}var skipClientTagOnKinds=new Set([0,4,1059,13,3,9734,5]),NDKEvent=class Qa extends lib$1.EventEmitter{constructor($n,Dn){var Un;super(),g$3(this,"ndk"),g$3(this,"created_at"),g$3(this,"content",""),g$3(this,"tags",[]),g$3(this,"kind"),g$3(this,"id",""),g$3(this,"sig"),g$3(this,"pubkey",""),g$3(this,"signatureVerified"),g$3(this,"_author"),g$3(this,"relay"),g$3(this,"publishStatus","success"),g$3(this,"publishError"),g$3(this,"serialize",serialize.bind(this)),g$3(this,"getEventHash",getEventHash.bind(this)),g$3(this,"validate",validate.bind(this)),g$3(this,"verifySignature",verifySignature.bind(this)),g$3(this,"isReplaceable",isReplaceable.bind(this)),g$3(this,"isEphemeral",isEphemeral.bind(this)),g$3(this,"isDvm",()=>this.kind&&this.kind>=5e3&&this.kind<=7e3),g$3(this,"isParamReplaceable",isParamReplaceable.bind(this)),g$3(this,"encode",encode.bind(this)),g$3(this,"encrypt",encrypt.bind(this)),g$3(this,"decrypt",decrypt.bind(this)),g$3(this,"fetchTaggedEvent",fetchTaggedEvent.bind(this)),g$3(this,"fetchRootEvent",fetchRootEvent.bind(this)),g$3(this,"fetchReplyEvent",fetchReplyEvent.bind(this)),g$3(this,"repost",repost.bind(this)),this.ndk=$n,this.created_at=Dn?.created_at,this.content=Dn?.content||"",this.tags=Dn?.tags||[],this.id=Dn?.id||"",this.sig=Dn?.sig,this.pubkey=Dn?.pubkey||"",this.kind=Dn?.kind,Dn instanceof Qa&&(this.relay&&(this.relay=Dn.relay,(Un=this.ndk)==null||Un.subManager.seenEvent(Dn.id,this.relay)),this.publishStatus=Dn.publishStatus,this.publishError=Dn.publishError)}get onRelays(){let $n=[];return this.ndk?$n=this.ndk.subManager.seenEvents.get(this.id)||[]:this.relay&&$n.push(this.relay),$n}static deserialize($n,Dn){return new Qa($n,deserialize(Dn))}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author($n){var Dn;this.pubkey=$n.pubkey,this._author=$n,(Dn=this._author).ndk??(Dn.ndk=this.ndk)}get author(){if(this._author)return this._author;if(!this.ndk)throw new Error("No NDK instance found");const $n=this.ndk.getUser({pubkey:this.pubkey});return this._author=$n,$n}tagExternal($n,Dn,Un){const Bn=["i"],In=["k"];switch(Dn){case"url":{const qn=new URL($n);qn.hash="",Bn.push(qn.toString()),In.push(`${qn.protocol}//${qn.host}`);break}case"hashtag":Bn.push(`#${$n.toLowerCase()}`),In.push("#");break;case"geohash":Bn.push(`geo:${$n.toLowerCase()}`),In.push("geo");break;case"isbn":Bn.push(`isbn:${$n.replace(/-/g,"")}`),In.push("isbn");break;case"podcast:guid":Bn.push(`podcast:guid:${$n}`),In.push("podcast:guid");break;case"podcast:item:guid":Bn.push(`podcast:item:guid:${$n}`),In.push("podcast:item:guid");break;case"podcast:publisher:guid":Bn.push(`podcast:publisher:guid:${$n}`),In.push("podcast:publisher:guid");break;case"isan":Bn.push(`isan:${$n.split("-").slice(0,4).join("-")}`),In.push("isan");break;case"doi":Bn.push(`doi:${$n.toLowerCase()}`),In.push("doi");break;default:throw new Error(`Unsupported NIP-73 entity type: ${Dn}`)}Un&&Bn.push(Un),this.tags.push(Bn),this.tags.push(In)}tag($n,Dn,Un,Bn,In){let qn=[];if($n.fetchProfile!==void 0){if(Bn??(Bn="p"),Bn==="p"&&In?.pTags===!1)return;const Fn=[Bn,$n.pubkey];Dn&&Fn.push("",Dn),qn.push(Fn)}else if($n instanceof Qa){const Fn=$n;if(Un??(Un=Fn?.pubkey===this.pubkey),qn=Fn.referenceTags(Dn,Un,Bn,In),In?.pTags!==!1)for(const Kn of Fn.getMatchingTags("p"))!Kn[1]||!isValidPubkey(Kn[1])||Kn[1]!==this.pubkey&&(this.tags.find(jn=>jn[0]==="p"&&jn[1]===Kn[1])||this.tags.push(["p",Kn[1]]))}else if(Array.isArray($n))qn=[$n];else throw new Error("Invalid argument",$n);this.tags=mergeTags(this.tags,qn)}async toNostrEvent($n,Dn){var Un,Bn;if(!$n&&this.pubkey===""){const Fn=await((Bn=(Un=this.ndk)==null?void 0:Un.signer)==null?void 0:Bn.user());this.pubkey=Fn?.pubkey||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const{content:In,tags:qn}=await this.generateTags(Dn);this.content=In||"",this.tags=qn;try{this.id=this.getEventHash()}catch{}return this.rawEvent()}getMatchingTags($n,Dn){const Un=this.tags.filter(Bn=>Bn[0]===$n);return Dn===void 0?Un:Un.filter(Bn=>Bn[3]===Dn)}hasTag($n,Dn){return this.tags.some(Un=>Un[0]===$n&&(!Dn||Un[3]===Dn))}tagValue($n,Dn){const Un=this.getMatchingTags($n,Dn);if(Un.length!==0)return Un[0][1]}get alt(){return this.tagValue("alt")}set alt($n){this.removeTag("alt"),$n&&this.tags.push(["alt",$n])}get dTag(){return this.tagValue("d")}set dTag($n){this.removeTag("d"),$n&&this.tags.push(["d",$n])}removeTag($n,Dn){const Un=Array.isArray($n)?$n:[$n];this.tags=this.tags.filter(Bn=>{const In=Un.includes(Bn[0]),qn=Dn?Bn[3]===Dn:!0;return!(In&&qn)})}replaceTag($n){this.removeTag($n[0]),this.tags.push($n)}async sign($n,Dn){var Un,Bn,In,qn,Fn;(In=(Bn=(Un=this.ndk)==null?void 0:Un.aiGuardrails)==null?void 0:Bn.event)==null||In.signing(this),$n?this.author=await $n.user():((qn=this.ndk)==null||qn.assertSigner(),$n=(Fn=this.ndk)==null?void 0:Fn.signer);const Kn=await this.toNostrEvent(void 0,Dn);return this.sig=await $n.sign(Kn),this.sig}async publishReplaceable($n,Dn,Un){return this.id="",this.created_at=Math.floor(Date.now()/1e3),this.sig="",this.publish($n,Dn,Un)}async publish($n,Dn,Un,Bn){var In,qn,Fn,Kn,jn;if(Un||(Un=1),this.sig||await this.sign(void 0,Bn),!this.ndk)throw new Error("NDKEvent must be associated with an NDK instance to publish");if((qn=(In=this.ndk.aiGuardrails)==null?void 0:In.event)==null||qn.publishing(this),(!$n||$n.size===0)&&($n=this.ndk.devWriteRelaySet||await calculateRelaySetFromEvent(this.ndk,this,Un)),this.kind===5&&(Fn=this.ndk.cacheAdapter)!=null&&Fn.deleteEventIds){const Xn=this.getMatchingTags("e").map(Jn=>Jn[1]);this.ndk.cacheAdapter.deleteEventIds(Xn)}const Yn=this.rawEvent();if((Kn=this.ndk.cacheAdapter)!=null&&Kn.addUnpublishedEvent&&shouldTrackUnpublishedEvent(this))try{this.ndk.cacheAdapter.addUnpublishedEvent(this,$n.relayUrls)}catch(Xn){console.error("Error adding unpublished event to cache",Xn)}this.kind===5&&(jn=this.ndk.cacheAdapter)!=null&&jn.deleteEventIds&&this.ndk.cacheAdapter.deleteEventIds(this.getMatchingTags("e").map(Xn=>Xn[1])),this.ndk.subManager.dispatchEvent(Yn,void 0,!0);const Zn=await $n.publish(this,Dn,Un);return Zn.forEach(Xn=>{var Jn;return(Jn=this.ndk)==null?void 0:Jn.subManager.seenEvent(this.id,Xn)}),Zn}async generateTags($n){var Dn,Un,Bn;let In=[];const qn=await generateContentTags(this.content,this.tags,$n,this),Fn=qn.content;if(In=qn.tags,this.kind&&this.isParamReplaceable()&&!this.getMatchingTags("d")[0]){const Kn=this.tagValue("title");let jn=[...Array(Kn?6:16)].map(()=>Math.random().toString(36)[2]).join("");Kn&&Kn.length>0&&(jn=`${Kn.replace(/[^a-z0-9]+/gi,"-").replace(/^-|-$/g,"")}-${jn}`),In.push(["d",jn])}if(this.shouldAddClientTag){const Kn=["client",((Dn=this.ndk)==null?void 0:Dn.clientName)??""];(Un=this.ndk)!=null&&Un.clientNip89&&Kn.push((Bn=this.ndk)==null?void 0:Bn.clientNip89),In.push(Kn)}else this.shouldStripClientTag&&(In=In.filter(Kn=>Kn[0]!=="client"));return{content:Fn||"",tags:In}}get shouldAddClientTag(){var $n,Dn;return!(!(($n=this.ndk)!=null&&$n.clientName)&&!((Dn=this.ndk)!=null&&Dn.clientNip89)||skipClientTagOnKinds.has(this.kind)||this.isEphemeral()||this.isReplaceable()&&!this.isParamReplaceable()||this.isDvm()||this.hasTag("client"))}get shouldStripClientTag(){return skipClientTagOnKinds.has(this.kind)}muted(){var $n;return($n=this.ndk)!=null&&$n.muteFilter&&this.ndk.muteFilter(this)?"muted":null}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const $n=this.getMatchingTags("d")[0];return $n?$n[1]:""}throw new Error("Event is not a parameterized replaceable event")}deduplicationKey(){return this.kind===0||this.kind===3||this.kind&&this.kind>=1e4&&this.kind<2e4?`${this.kind}:${this.pubkey}`:this.tagId()}tagId(){return this.isParamReplaceable()?this.tagAddress():this.id}tagAddress(){if(this.isParamReplaceable()){const $n=this.dTag??"";return`${this.kind}:${this.pubkey}:${$n}`}if(this.isReplaceable())return`${this.kind}:${this.pubkey}:`;throw new Error("Event is not a replaceable event")}tagType(){return this.isParamReplaceable()?"a":"e"}tagReference($n){let Dn;return this.isParamReplaceable()?Dn=["a",this.tagAddress()]:Dn=["e",this.tagId()],this.relay?Dn.push(this.relay.url):Dn.push(""),Dn.push($n??""),this.isParamReplaceable()||Dn.push(this.pubkey),Dn}referenceTags($n,Dn,Un,Bn){let In=[];return this.isParamReplaceable()?In=[[Un??"a",this.tagAddress()],[Un??"e",this.id]]:In=[[Un??"e",this.id]],In=In.map(qn=>{var Fn,Kn,jn;return qn[0]==="e"||$n?qn.push(((Fn=this.relay)==null?void 0:Fn.url)??""):(Kn=this.relay)!=null&&Kn.url&&qn.push((jn=this.relay)==null?void 0:jn.url),qn}),In.forEach(qn=>{qn[0]==="e"?(qn.push($n??""),qn.push(this.pubkey)):$n&&qn.push($n)}),In=[...In,...this.getMatchingTags("h")],!Dn&&Bn?.pTags!==!1&&In.push(...this.author.referenceTags()),In}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}nip22Filter(){return this.isParamReplaceable()?{"#A":[this.tagId()]}:{"#E":[this.tagId()]}}async delete($n,Dn=!0){var Un;if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const Bn=new Qa(this.ndk,{kind:5,content:$n||""});return Bn.tag(this,void 0,!0),Bn.tags.push(["k",(Un=this.kind)==null?void 0:Un.toString()]),Dn&&(this.emit("deleted"),await Bn.publish()),Bn}set isProtected($n){this.removeTag("-"),$n&&this.tags.push(["-"])}get isProtected(){return this.hasTag("-")}async react($n,Dn=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const Un=new Qa(this.ndk,{kind:7,content:$n});return Un.tag(this),this.kind!==1&&Un.tags.push(["k",`${this.kind}`]),Dn&&await Un.publish(),Un}get isValid(){return this.validate()}get inspect(){return JSON.stringify(this.rawEvent(),null,4)}dump(){console.debug(JSON.stringify(this.rawEvent(),null,4)),console.debug("Event on relays:",this.onRelays.map($n=>$n.url).join(", "))}reply($n,Dn){var Un,Bn,In,qn,Fn,Kn,jn,Yn;const Zn=new Qa(this.ndk);if((In=(Bn=(Un=this.ndk)==null?void 0:Un.aiGuardrails)==null?void 0:Bn.event)==null||In.creatingReply(Zn),this.kind===1&&!$n)Zn.kind=1,this.hasTag("e")?Zn.tags=[...Zn.tags,...this.getMatchingTags("e"),...this.getMatchingTags("p"),...this.getMatchingTags("a"),...this.referenceTags("reply",!1,void 0,Dn)]:Zn.tag(this,"root",!1,void 0,Dn);else{Zn.kind=1111;const Xn=["A","E","I","P"],Jn=this.tags.filter(Wn=>Xn.includes(Wn[0]));if(Jn.length>0){const Wn=this.tagValue("K");Zn.tags.push(...Jn),Wn&&Zn.tags.push(["K",Wn]);let tr;if(this.isParamReplaceable()){tr=["a",this.tagAddress()];const ir=((qn=this.relay)==null?void 0:qn.url)??"";ir&&tr.push(ir)}else{tr=["e",this.tagId()];const ir=((Fn=this.relay)==null?void 0:Fn.url)??"";tr.push(ir),tr.push(this.pubkey)}Zn.tags.push(tr)}else{let Wn,tr;const ir=((Kn=this.relay)==null?void 0:Kn.url)??"";this.isParamReplaceable()?(Wn=["a",this.tagAddress(),ir],tr=["A",this.tagAddress(),ir]):(Wn=["e",this.tagId(),ir,this.pubkey],tr=["E",this.tagId(),ir,this.pubkey]),Zn.tags.push(Wn),Zn.tags.push(tr),Zn.tags.push(["K",(jn=this.kind)==null?void 0:jn.toString()]),Dn?.pTags!==!1&&Dn?.pTagOnATags!==!1&&Zn.tags.push(["P",this.pubkey])}Zn.tags.push(["k",(Yn=this.kind)==null?void 0:Yn.toString()]),Dn?.pTags!==!1&&(Zn.tags.push(...this.getMatchingTags("p")),Zn.tags.push(["p",this.pubkey]))}return Zn}},untrackedUnpublishedEvents=new Set([24133,13194,23194,23195]);function shouldTrackUnpublishedEvent(s){return!untrackedUnpublishedEvents.has(s.kind)}var NDKPool=class extends lib$1.EventEmitter{constructor(s,$n,{debug:Dn,name:Un}={}){super(),g$3(this,"_relays",new Map),g$3(this,"status","idle"),g$3(this,"autoConnectRelays",new Set),g$3(this,"debug"),g$3(this,"temporaryRelayTimers",new Map),g$3(this,"flappingRelays",new Set),g$3(this,"backoffTimes",new Map),g$3(this,"ndk"),g$3(this,"disconnectionTimes",new Map),g$3(this,"systemEventDetector"),g$3(this,"_name","unnamed"),this.debug=Dn??$n.debug.extend("pool"),Un&&(this._name=Un),this.ndk=$n,this.relayUrls=s,this.ndk.pools&&this.ndk.pools.push(this)}get relays(){return this._relays}set relayUrls(s){this._relays.clear();for(const $n of s){const Dn=new NDKRelay($n,void 0,this.ndk);Dn.connectivity.netDebug=this.ndk.netDebug,this.addRelay(Dn)}}get name(){return this._name}set name(s){this._name=s,this.debug=this.debug.extend(s)}useTemporaryRelay(s,$n=3e4,Dn){const Un=this.relays.has(s.url);Un||(this.addRelay(s),this.debug("Adding temporary relay %s for filters %o",s.url,Dn));const Bn=this.temporaryRelayTimers.get(s.url);if(Bn&&clearTimeout(Bn),!Un||Bn){const In=setTimeout(()=>{var qn;(qn=this.ndk.explicitRelayUrls)!=null&&qn.includes(s.url)||this.removeRelay(s.url)},$n);this.temporaryRelayTimers.set(s.url,In)}}addRelay(s,$n=!0){var Dn;const Un=this.relays.has(s.url),Bn=s.url.includes("/npub1");let In=!0;const qn=s.url;if(Un)return;if(this.ndk.relayConnectionFilter&&!this.ndk.relayConnectionFilter(qn)){this.debug(`Refusing to add relay ${qn}: blocked by relayConnectionFilter`);return}if(Bn){this.debug(`Refusing to add relay ${qn}: is a filter relay`);return}if((Dn=this.ndk.cacheAdapter)!=null&&Dn.getRelayStatus){const Wn=this.ndk.cacheAdapter.getRelayStatus(qn),tr=Wn instanceof Promise?void 0:Wn;if(tr!=null&&tr.dontConnectBefore){if(tr.dontConnectBefore>Date.now()){const ir=tr.dontConnectBefore-Date.now();this.debug(`Refusing to add relay ${qn}: delayed connect for ${ir}ms`),setTimeout(()=>{this.addRelay(s,$n)},ir);return}In=!1}}const Fn=Wn=>this.emit("notice",s,Wn),Kn=()=>this.handleRelayConnect(qn),jn=()=>this.handleRelayReady(s),Yn=()=>{this.recordDisconnection(s),this.emit("relay:disconnect",s)},Zn=()=>this.handleFlapping(s),Xn=Wn=>this.emit("relay:auth",s,Wn),Jn=()=>this.emit("relay:authed",s);s.off("notice",Fn),s.off("connect",Kn),s.off("ready",jn),s.off("disconnect",Yn),s.off("flapping",Zn),s.off("auth",Xn),s.off("authed",Jn),s.on("notice",Fn),s.on("connect",Kn),s.on("ready",jn),s.on("disconnect",Yn),s.on("flapping",Zn),s.on("auth",Xn),s.on("authed",Jn),s.on("delayed-connect",Wn=>{var tr;(tr=this.ndk.cacheAdapter)!=null&&tr.updateRelayStatus&&this.ndk.cacheAdapter.updateRelayStatus(s.url,{dontConnectBefore:Date.now()+Wn})}),this._relays.set(qn,s),$n&&this.autoConnectRelays.add(qn),$n&&this.status==="active"&&(this.emit("relay:connecting",s),s.connect(void 0,In).catch(Wn=>{this.debug(`Failed to connect to relay ${qn}`,Wn)}))}removeRelay(s){const $n=this.relays.get(s);if($n)return $n.disconnect(),this.relays.delete(s),this.autoConnectRelays.delete(s),this.emit("relay:disconnect",$n),!0;const Dn=this.temporaryRelayTimers.get(s);return Dn&&(clearTimeout(Dn),this.temporaryRelayTimers.delete(s)),!1}isRelayConnected(s){const $n=normalizeRelayUrl(s),Dn=this.relays.get($n);return Dn?Dn.status===5:!1}getRelay(s,$n=!0,Dn=!1,Un){let Bn=this.relays.get(normalizeRelayUrl(s));return Bn||(Bn=new NDKRelay(s,void 0,this.ndk),Bn.connectivity.netDebug=this.ndk.netDebug,Dn?this.useTemporaryRelay(Bn,3e4,Un):this.addRelay(Bn,$n)),Bn}handleRelayConnect(s){const $n=this.relays.get(s);if(!$n){console.error("NDK BUG: relay not found in pool",{relayUrl:s});return}this.emit("relay:connect",$n),this.stats().connected===this.relays.size&&this.emit("connect")}handleRelayReady(s){this.emit("relay:ready",s)}async connect(s){this.status="active",this.debug(`Connecting to ${this.relays.size} relays${s?`, timeout ${s}ms`:""}...`);const $n=Array.from(this.autoConnectRelays.keys()).map(In=>this.relays.get(In)).filter(In=>!!In);for(const In of $n)In.status!==5&&In.status!==4&&(this.emit("relay:connecting",In),In.connect().catch(qn=>{this.debug(`Failed to connect to relay ${In.url}: ${qn??"No reason specified"}`)}));const Dn=()=>$n.every(In=>In.status===5),Un=new Promise(In=>{if(Dn()){In();return}const qn=[];for(const Fn of $n){const Kn=()=>{if(Dn()){for(let jn=0;jn<$n.length;jn++)$n[jn].off("connect",qn[jn]);In()}};qn.push(Kn),Fn.on("connect",Kn)}}),Bn=typeof s=="number"?new Promise(In=>setTimeout(In,s)):new Promise(()=>{});await Promise.race([Un,Bn])}checkOnFlappingRelays(){const s=this.flappingRelays.size,$n=this.relays.size;if(s/$n>=.8)for(const Dn of this.flappingRelays)this.backoffTimes.set(Dn,0)}recordDisconnection(s){const $n=Date.now();this.disconnectionTimes.set(s.url,$n);for(const[Dn,Un]of this.disconnectionTimes.entries())$n-Un>1e4&&this.disconnectionTimes.delete(Dn);this.checkForSystemWideDisconnection()}checkForSystemWideDisconnection(){const s=Date.now(),$n=[];for(const Dn of this.disconnectionTimes.values())s-Dn<5e3&&$n.push(Dn);$n.length>this.relays.size/2&&this.relays.size>1&&(this.debug(`System-wide disconnection detected: ${$n.length}/${this.relays.size} relays disconnected`),this.handleSystemWideReconnection())}handleSystemWideReconnection(){if(this.systemEventDetector){this.debug("System-wide reconnection already in progress, skipping");return}this.debug("Initiating system-wide reconnection with reset backoff"),this.systemEventDetector=setTimeout(()=>{this.systemEventDetector=void 0},1e4);for(const s of this.relays.values())s.connectivity&&(s.connectivity.resetReconnectionState(),s.status!==5&&s.status!==4&&s.connect().catch($n=>{this.debug(`Failed to reconnect relay ${s.url} after system event: ${$n}`)}));this.disconnectionTimes.clear()}handleFlapping(s){this.debug(`Relay ${s.url} is flapping`);let $n=this.backoffTimes.get(s.url)||5e3;$n=$n*2,this.backoffTimes.set(s.url,$n),this.debug(`Backoff time for ${s.url} is ${$n}ms`),setTimeout(()=>{this.debug(`Attempting to reconnect to ${s.url}`),this.emit("relay:connecting",s),s.connect(),this.checkOnFlappingRelays()},$n),s.disconnect(),this.emit("flapping",s)}size(){return this.relays.size}stats(){const s={total:0,connected:0,disconnected:0,connecting:0};for(const $n of this.relays.values())s.total++,$n.status===5?s.connected++:$n.status===1?s.disconnected++:$n.status===4&&s.connecting++;return s}connectedRelays(){return Array.from(this.relays.values()).filter(s=>s.status>=5)}permanentAndConnectedRelays(){return Array.from(this.relays.values()).filter(s=>s.status>=5&&!this.temporaryRelayTimers.has(s.url))}urls(){return Array.from(this.relays.keys())}},Te$3,NDKDVMJobFeedback=(Te$3=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=7e3)}static async from(s){const $n=new Te$3(s.ndk,s.rawEvent());return $n.encrypted&&await $n.dvmDecrypt(),$n}get status(){return this.tagValue("status")}set status(s){this.removeTag("status"),s!==void 0&&this.tags.push(["status",s])}get encrypted(){return!!this.getMatchingTags("encrypted")[0]}async dvmDecrypt(){await this.decrypt();const s=JSON.parse(this.content);this.tags.push(...s)}},g$3(Te$3,"kinds",[7e3]),Te$3),te,NDKCashuMintList=(te=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"_p2pk"),this.kind??(this.kind=10019)}static from(s){return new te(s.ndk,s)}set relays(s){this.tags=this.tags.filter($n=>$n[0]!=="relay");for(const $n of s)this.tags.push(["relay",$n])}get relays(){const s=[];for(const $n of this.tags)$n[0]==="relay"&&s.push($n[1]);return s}set mints(s){this.tags=this.tags.filter($n=>$n[0]!=="mint");for(const $n of s)this.tags.push(["mint",$n])}get mints(){const s=[];for(const $n of this.tags)$n[0]==="mint"&&s.push($n[1]);return Array.from(new Set(s))}get p2pk(){return this._p2pk?this._p2pk:(this._p2pk=this.tagValue("pubkey")??this.pubkey,this._p2pk)}set p2pk(s){this._p2pk=s,this.removeTag("pubkey"),s&&this.tags.push(["pubkey",s])}get relaySet(){return NDKRelaySet.fromRelayUrls(this.relays,this.ndk)}},g$3(te,"kind",10019),g$3(te,"kinds",[10019]),te),ne$1,NDKArticle=(ne$1=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=30023)}static from(s){return new ne$1(s.ndk,s)}get title(){return this.tagValue("title")}set title(s){this.removeTag("title"),s&&this.tags.push(["title",s])}get image(){return this.tagValue("image")}set image(s){this.removeTag("image"),s&&this.tags.push(["image",s])}get summary(){return this.tagValue("summary")}set summary(s){this.removeTag("summary"),s&&this.tags.push(["summary",s])}get published_at(){const s=this.tagValue("published_at");if(s){let $n=Number.parseInt(s);return $n>1e12&&($n=Math.floor($n/1e3)),$n}}set published_at(s){this.removeTag("published_at"),s!==void 0&&this.tags.push(["published_at",s.toString()])}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}get url(){return this.tagValue("url")}set url(s){s?this.tags.push(["url",s]):this.removeTag("url")}},g$3(ne$1,"kind",30023),g$3(ne$1,"kinds",[30023]),ne$1),Se$2,NDKBlossomList=(Se$2=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=10063)}static from(s){return new Se$2(s.ndk,s.rawEvent())}get servers(){return this.tags.filter(s=>s[0]==="server").map(s=>s[1])}set servers(s){this.tags=this.tags.filter($n=>$n[0]!=="server");for(const $n of s)this.tags.push(["server",$n])}get default(){const s=this.servers;return s.length>0?s[0]:void 0}set default(s){if(!s)return;const $n=this.servers.filter(Dn=>Dn!==s);this.servers=[s,...$n]}addServer(s){if(!s)return;const $n=this.servers;$n.includes(s)||(this.servers=[...$n,s])}removeServer(s){if(!s)return;const $n=this.servers;this.servers=$n.filter(Dn=>Dn!==s)}},g$3(Se$2,"kinds",[10063]),Se$2),se$2,NDKFedimintMint=(se$2=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=38173)}static async from(s){return new se$2(s.ndk,s)}get identifier(){return this.tagValue("d")}set identifier(s){this.removeTag("d"),s&&this.tags.push(["d",s])}get inviteCodes(){return this.getMatchingTags("u").map(s=>s[1])}set inviteCodes(s){this.removeTag("u");for(const $n of s)this.tags.push(["u",$n])}get modules(){return this.getMatchingTags("modules").map(s=>s[1])}set modules(s){this.removeTag("modules");for(const $n of s)this.tags.push(["modules",$n])}get network(){return this.tagValue("n")}set network(s){this.removeTag("n"),s&&this.tags.push(["n",s])}get metadata(){if(this.content)try{return JSON.parse(this.content)}catch{return}}set metadata(s){s?this.content=JSON.stringify(s):this.content=""}},g$3(se$2,"kind",38173),g$3(se$2,"kinds",[38173]),se$2),re$1,NDKCashuMintAnnouncement=(re$1=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=38172)}static async from(s){return new re$1(s.ndk,s)}get identifier(){return this.tagValue("d")}set identifier(s){this.removeTag("d"),s&&this.tags.push(["d",s])}get url(){return this.tagValue("u")}set url(s){this.removeTag("u"),s&&this.tags.push(["u",s])}get nuts(){return this.getMatchingTags("nuts").map(s=>s[1])}set nuts(s){this.removeTag("nuts");for(const $n of s)this.tags.push(["nuts",$n])}get network(){return this.tagValue("n")}set network(s){this.removeTag("n"),s&&this.tags.push(["n",s])}get metadata(){if(this.content)try{return JSON.parse(this.content)}catch{return}}set metadata(s){s?this.content=JSON.stringify(s):this.content=""}},g$3(re$1,"kind",38172),g$3(re$1,"kinds",[38172]),re$1),ie,NDKMintRecommendation=(ie=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=38e3)}static async from(s){return new ie(s.ndk,s)}get recommendedKind(){const s=this.tagValue("k");return s?Number(s):void 0}set recommendedKind(s){this.removeTag("k"),s&&this.tags.push(["k",s.toString()])}get identifier(){return this.tagValue("d")}set identifier(s){this.removeTag("d"),s&&this.tags.push(["d",s])}get urls(){return this.getMatchingTags("u").map(s=>s[1])}set urls(s){this.removeTag("u");for(const $n of s)this.tags.push(["u",$n])}get mintEventPointers(){return this.getMatchingTags("a").map(s=>({kind:Number(s[1].split(":")[0]),identifier:s[1].split(":")[2],relay:s[2]}))}addMintEventPointer(s,$n,Dn,Un){const Bn=["a",`${s}:${$n}:${Dn}`];Un&&Bn.push(Un),this.tags.push(Bn)}get review(){return this.content}set review(s){this.content=s}},g$3(ie,"kind",38e3),g$3(ie,"kinds",[38e3]),ie),Re$2,NDKClassified=(Re$2=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=30402)}static from(s){return new Re$2(s.ndk,s)}get title(){return this.tagValue("title")}set title(s){this.removeTag("title"),s&&this.tags.push(["title",s])}get summary(){return this.tagValue("summary")}set summary(s){this.removeTag("summary"),s&&this.tags.push(["summary",s])}get published_at(){const s=this.tagValue("published_at");if(s)return Number.parseInt(s)}set published_at(s){this.removeTag("published_at"),s!==void 0&&this.tags.push(["published_at",s.toString()])}get location(){return this.tagValue("location")}set location(s){this.removeTag("location"),s&&this.tags.push(["location",s])}get price(){const s=this.tags.find($n=>$n[0]==="price");if(s)return{amount:Number.parseFloat(s[1]),currency:s[2],frequency:s[3]}}set price(s){if(typeof s=="string"&&(s={amount:Number.parseFloat(s)}),s!=null&&s.amount){const $n=["price",s.amount.toString()];s.currency&&$n.push(s.currency),s.frequency&&$n.push(s.frequency),this.tags.push($n)}else this.removeTag("price")}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}},g$3(Re$2,"kinds",[30402]),Re$2),oe$1,NDKDraft=(oe$1=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"_event"),g$3(this,"counterparty"),this.kind??(this.kind=31234)}static from(s){return new oe$1(s.ndk,s)}set identifier(s){this.removeTag("d"),this.tags.push(["d",s])}get identifier(){return this.dTag}set event(s){s instanceof NDKEvent?this._event=s:this._event=new NDKEvent(void 0,s),this.prepareEvent()}set checkpoint(s){s?(this.tags.push(s.tagReference()),this.kind=1234):(this.removeTag("a"),this.kind=31234)}get isCheckpoint(){return this.kind===1234}get isProposal(){const s=this.tagValue("p");return!!s&&s!==this.pubkey}async getEvent(s){var $n;if(this._event)return this._event;if(s??(s=($n=this.ndk)==null?void 0:$n.signer),!s)throw new Error("No signer available");if(this.content&&this.content.length>0)try{const Dn=s.pubkey,Un=[this.tagValue("p"),this.pubkey].filter(Boolean).find(qn=>qn!==Dn);let Bn;Bn=new NDKUser({pubkey:Un??Dn}),await this.decrypt(Bn,s);const In=JSON.parse(this.content);return this._event=await wrapEvent(new NDKEvent(this.ndk,In)),this._event}catch(Dn){console.error(Dn);return}else return null}prepareEvent(){if(!this._event)throw new Error("No event has been provided");this.removeTag("k"),this._event.kind&&this.tags.push(["k",this._event.kind.toString()]),this.content=JSON.stringify(this._event.rawEvent())}async save({signer:s,publish:$n,relaySet:Dn}){var Un;if(s??(s=(Un=this.ndk)==null?void 0:Un.signer),!s)throw new Error("No signer available");const Bn=this.counterparty||await s.user();if(await this.encrypt(Bn,s),this.counterparty){const In=this.counterparty.pubkey;this.removeTag("p"),this.tags.push(["p",In])}if($n!==!1)return this.publishReplaceable(Dn)}},g$3(oe$1,"kind",31234),g$3(oe$1,"kinds",[31234,1234]),oe$1);function mapImetaTag(s){const $n={};if(s.length===2){const Un=s[1].split(" ");for(let Bn=0;Bn<Un.length;Bn+=2){const In=Un[Bn],qn=Un[Bn+1];In==="fallback"?($n.fallback||($n.fallback=[]),$n.fallback.push(qn)):$n[In]=qn}return $n}const Dn=s.slice(1);for(const Un of Dn){const Bn=Un.split(" "),In=Bn[0],qn=Bn.slice(1).join(" ");In==="fallback"?($n.fallback||($n.fallback=[]),$n.fallback.push(qn)):$n[In]=qn}return $n}function imetaTagToTag(s){const $n=["imeta"];for(const[Dn,Un]of Object.entries(s))if(Array.isArray(Un))for(const Bn of Un)$n.push(`${Dn} ${Bn}`);else Un&&$n.push(`${Dn} ${Un}`);return $n}var ae,NDKFollowPack=(ae=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=39089)}static from(s){return new ae(s.ndk,s)}get title(){return this.tagValue("title")}set title(s){this.removeTag("title"),s&&this.tags.push(["title",s])}get image(){const s=this.tags.find($n=>$n[0]==="imeta");if(s){const $n=mapImetaTag(s);if($n.url)return $n.url}return this.tagValue("image")}set image(s){this.tags=this.tags.filter($n=>$n[0]!=="imeta"&&$n[0]!=="image"),typeof s=="string"?s!==void 0&&this.tags.push(["image",s]):s&&typeof s=="object"&&(this.tags.push(imetaTagToTag(s)),s.url&&this.tags.push(["image",s.url]))}get pubkeys(){return Array.from(new Set(this.tags.filter(s=>s[0]==="p"&&s[1]&&isValidPubkey(s[1])).map(s=>s[1])))}set pubkeys(s){this.tags=this.tags.filter($n=>$n[0]!=="p");for(const $n of s)this.tags.push(["p",$n])}get description(){return this.tagValue("description")}set description(s){this.removeTag("description"),s&&this.tags.push(["description",s])}},g$3(ae,"kind",39089),g$3(ae,"kinds",[39089,39092]),ae),ce$3,NDKHighlight=(ce$3=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"_article"),this.kind??(this.kind=9802)}static from(s){return new ce$3(s.ndk,s)}get url(){return this.tagValue("r")}set context(s){s===void 0?this.tags=this.tags.filter(([$n,Dn])=>$n!=="context"):(this.tags=this.tags.filter(([$n,Dn])=>$n!=="context"),this.tags.push(["context",s]))}get context(){var s;return((s=this.tags.find(([$n,Dn])=>$n==="context"))==null?void 0:s[1])??void 0}get article(){return this._article}set article(s){this._article=s,typeof s=="string"?this.tags.push(["r",s]):this.tag(s)}getArticleTag(){return this.getMatchingTags("a")[0]||this.getMatchingTags("e")[0]||this.getMatchingTags("r")[0]}async getArticle(){var s;if(this._article!==void 0)return this._article;let $n;const Dn=this.getArticleTag();if(Dn){switch(Dn[0]){case"a":{const[Un,Bn,In]=Dn[1].split(":");$n=nip19_exports$1.naddrEncode({kind:Number.parseInt(Un),pubkey:Bn,identifier:In});break}case"e":$n=nip19_exports$1.noteEncode(Dn[1]);break;case"r":this._article=Dn[1];break}if($n){let Un=await((s=this.ndk)==null?void 0:s.fetchEvent($n));Un&&(Un.kind===30023&&(Un=NDKArticle.from(Un)),this._article=Un)}return this._article}}},g$3(ce$3,"kind",9802),g$3(ce$3,"kinds",[9802]),ce$3),le$3,NDKImage=(le$3=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"_imetas"),this.kind??(this.kind=20)}static from(s){return new le$3(s.ndk,s.rawEvent())}get isValid(){return this.imetas.length>0}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(s=>s[0]==="imeta").map(mapImetaTag).filter(s=>!!s.url),this._imetas)}set imetas(s){this._imetas=s,this.tags=this.tags.filter($n=>$n[0]!=="imeta"),this.tags.push(...s.map(imetaTagToTag))}},g$3(le$3,"kind",20),g$3(le$3,"kinds",[20]),le$3),Ae$3,NDKList=(Ae$3=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"_encryptedTags"),g$3(this,"encryptedTagsLength"),this.kind??(this.kind=30001)}static from(s){return new Ae$3(s.ndk,s)}get title(){return this.tagValue("title")||this.tagValue("name")||(this.kind===3?"Contacts":this.kind===1e4?"Mute":this.kind===10001?"Pinned Notes":this.kind===10002?"Relay Metadata":this.kind===10003?"Bookmarks":this.kind===10004?"Communities":this.kind===10005?"Public Chats":this.kind===10006?"Blocked Relays":this.kind===10007?"Search Relays":this.kind===10050?"Direct Message Receive Relays":this.kind===10015?"Interests":this.kind===10030?"Emojis":this.tagValue("d"))}set title(s){this.removeTag(["title","name"]),s&&this.tags.push(["title",s])}get name(){return this.title}set name(s){this.title=s}get description(){return this.tagValue("description")}set description(s){this.removeTag("description"),s&&this.tags.push(["description",s])}get image(){return this.tagValue("image")}set image(s){this.removeTag("image"),s&&this.tags.push(["image",s])}isEncryptedTagsCacheValid(){return!!(this._encryptedTags&&this.encryptedTagsLength===this.content.length)}async encryptedTags(s=!0){if(s&&this.isEncryptedTagsCacheValid())return this._encryptedTags;if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const $n=await this.ndk.signer.user();try{if(this.content.length>0)try{const Dn=await this.ndk.signer.decrypt($n,this.content),Un=JSON.parse(Dn);return Un!=null&&Un[0]?(this.encryptedTagsLength=this.content.length,this._encryptedTags=Un):(this.encryptedTagsLength=this.content.length,this._encryptedTags=[])}catch{}}catch{}return[]}validateTag(s){return!0}getItems(s){return this.tags.filter($n=>$n[0]===s)}get items(){return this.tags.filter(s=>!["d","L","l","title","name","description","published_at","summary","image","thumb","alt","expiration","subject","client"].includes(s[0]))}async addItem(s,$n=void 0,Dn=!1,Un="bottom"){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");let Bn;if(s instanceof NDKEvent)Bn=[s.tagReference($n)];else if(s instanceof NDKUser)Bn=s.referenceTags();else if(s instanceof NDKRelay)Bn=s.referenceTags();else if(Array.isArray(s))Bn=[s];else throw new Error("Invalid object type");if($n&&Bn[0].push($n),Dn){const In=await this.ndk.signer.user(),qn=await this.encryptedTags();Un==="top"?qn.unshift(...Bn):qn.push(...Bn),this._encryptedTags=qn,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(qn),await this.encrypt(In)}else Un==="top"?this.tags.unshift(...Bn):this.tags.push(...Bn);this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItemByValue(s,$n=!0){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const Dn=this.tags.findIndex(qn=>qn[1]===s);Dn>=0&&this.tags.splice(Dn,1);const Un=await this.ndk.signer.user(),Bn=await this.encryptedTags(),In=Bn.findIndex(qn=>qn[1]===s);if(In>=0&&(Bn.splice(In,1),this._encryptedTags=Bn,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(Bn),await this.encrypt(Un)),$n)return this.publishReplaceable();this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItem(s,$n){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");if($n){const Dn=await this.ndk.signer.user(),Un=await this.encryptedTags();Un.splice(s,1),this._encryptedTags=Un,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(Un),await this.encrypt(Dn)}else this.tags.splice(s,1);return this.created_at=Math.floor(Date.now()/1e3),this.emit("change"),this}has(s){return this.items.some($n=>$n[1]===s)}filterForItems(){const s=new Set,$n=new Map,Dn=[];for(const Un of this.items)if(Un[0]==="e"&&Un[1])s.add(Un[1]);else if(Un[0]==="a"&&Un[1]){const[Bn,In,qn]=Un[1].split(":");if(!Bn||!In)continue;const Fn=`${Bn}:${In}`,Kn=$n.get(Fn)||[];Kn.push(qn||""),$n.set(Fn,Kn)}if(s.size>0&&Dn.push({ids:Array.from(s)}),$n.size>0)for(const[Un,Bn]of $n.entries()){const[In,qn]=Un.split(":");Dn.push({kinds:[Number.parseInt(In)],authors:[qn],"#d":Bn})}return Dn}},g$3(Ae$3,"kinds",[30001,10004,10050,10030,10015,10001,10002,10007,10006,10003]),Ae$3),Ce$2,NDKAppHandlerEvent=(Ce$2=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"profile"),this.kind??(this.kind=31990)}static from(s){const $n=new Ce$2(s.ndk,s.rawEvent());return $n.isValid?$n:null}get isValid(){const s=new Map,$n=Un=>[Un[0],Un[2]].join(":").toLowerCase(),Dn=["web","android","ios"];for(const Un of this.tags)if(Dn.includes(Un[0])){const Bn=$n(Un);if(s.has(Bn)&&s.get(Bn)!==Un[1].toLowerCase())return!1;s.set(Bn,Un[1].toLowerCase())}return!0}async fetchProfile(){if(this.profile===void 0&&this.content.length>0)try{const s=JSON.parse(this.content);if(s!=null&&s.name)return s;this.profile=null}catch{this.profile=null}return new Promise((s,$n)=>{const Dn=this.author;Dn.fetchProfile().then(()=>{s(Dn.profile)}).catch($n)})}},g$3(Ce$2,"kinds",[31990]),Ce$2),Q$2,NDKNutzap=(Q$2=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"debug"),g$3(this,"_proofs",[]),g$3(this,"sender",this.author),this.kind??(this.kind=9321),this.debug=s?.debug.extend("nutzap")??createDebug5("ndk:nutzap"),this.alt||(this.alt="This is a nutzap");try{const Dn=this.getMatchingTags("proof");Dn.length?this._proofs=Dn.map(Un=>JSON.parse(Un[1])):this._proofs=JSON.parse(this.content)}catch{return}}static from(s){const $n=new Q$2(s.ndk,s);if(!(!$n._proofs||!$n._proofs.length))return $n}set comment(s){this.content=s??""}get comment(){return this.tagValue("comment")||this.content}set proofs(s){this._proofs=s,this.tags=this.tags.filter($n=>$n[0]!=="proof");for(const $n of s)this.tags.push(["proof",JSON.stringify($n)])}get proofs(){return this._proofs}get rawP2pk(){var s;const $n=this.proofs[0];try{const Dn=JSON.parse($n.secret);let Un;if(typeof Dn=="string"?(Un=JSON.parse(Dn),this.debug("stringified payload",$n.secret)):typeof Dn=="object"&&(Un=Dn),Array.isArray(Un)&&Un[0]==="P2PK"&&Un.length>1&&typeof Un[1]=="object"&&Un[1]!==null||typeof Un=="object"&&Un!==null&&typeof((s=Un[1])==null?void 0:s.data)=="string")return Un[1].data}catch(Dn){this.debug("error parsing p2pk pubkey",Dn,this.proofs[0])}}get p2pk(){const s=this.rawP2pk;if(s)return s.startsWith("02")?s.slice(2):s}get mint(){return this.tagValue("u")}set mint(s){this.replaceTag(["u",s])}get unit(){let s=this.tagValue("unit")??"sat";return s!=null&&s.startsWith("msat")&&(s="sat"),s}set unit(s){if(this.removeTag("unit"),s!=null&&s.startsWith("msat"))throw new Error("msat is not allowed, use sat denomination instead");s&&this.tag(["unit",s])}get amount(){return this.proofs.reduce((s,$n)=>s+$n.amount,0)}set target(s){this.tags=this.tags.filter($n=>$n[0]!=="p"),s instanceof NDKEvent&&this.tags.push(s.tagReference())}set recipientPubkey(s){this.removeTag("p"),this.tag(["p",s])}get recipientPubkey(){return this.tagValue("p")}get recipient(){const s=this.recipientPubkey;return this.ndk?this.ndk.getUser({pubkey:s}):new NDKUser({pubkey:s})}async toNostrEvent(){this.unit==="msat"&&(this.unit="sat"),this.removeTag("amount"),this.tags.push(["amount",this.amount.toString()]);const s=await super.toNostrEvent();return s.content=this.comment,s}get isValid(){let s=0,$n=0,Dn=0;for(const Un of this.tags)Un[0]==="e"&&s++,Un[0]==="p"&&$n++,Un[0]==="u"&&Dn++;return $n===1&&Dn===1&&s<=1&&this.proofs.length>0}},g$3(Q$2,"kind",9321),g$3(Q$2,"kinds",[Q$2.kind]),Q$2),ue$1,NDKProject=(ue$1=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"_signer"),this.kind=31933}static from(s){return new ue$1(s.ndk,s.rawEvent())}set repo(s){this.removeTag("repo"),s&&this.tags.push(["repo",s])}set hashtags(s){this.removeTag("hashtags"),s.filter($n=>$n.length>0).length&&this.tags.push(["hashtags",...s])}get hashtags(){const s=this.tags.find($n=>$n[0]==="hashtags");return s?s.slice(1):[]}get repo(){return this.tagValue("repo")}get title(){return this.tagValue("title")}set title(s){this.removeTag("title"),s&&this.tags.push(["title",s])}get picture(){return this.tagValue("picture")}set picture(s){this.removeTag("picture"),s&&this.tags.push(["picture",s])}set description(s){this.content=s}get description(){return this.content}get slug(){return this.dTag??"empty-dtag"}async getSigner(){var s,$n;if(this._signer)return this._signer;const Dn=this.tagValue("key");if(!Dn)this._signer=NDKPrivateKeySigner.generate(),await this.encryptAndSaveNsec();else{const Un=await(($n=(s=this.ndk)==null?void 0:s.signer)==null?void 0:$n.decrypt(this.ndk.activeUser,Dn));if(!Un)throw new Error("Failed to decrypt project key or missing signer context.");this._signer=new NDKPrivateKeySigner(Un)}return this._signer}async getNsec(){return(await this.getSigner()).privateKey}async setNsec(s){this._signer=new NDKPrivateKeySigner(s),await this.encryptAndSaveNsec()}async encryptAndSaveNsec(){var s,$n;if(!this._signer)throw new Error("Signer is not set.");const Dn=this._signer.privateKey,Un=await(($n=(s=this.ndk)==null?void 0:s.signer)==null?void 0:$n.encrypt(this.ndk.activeUser,Dn));Un&&(this.removeTag("key"),this.tags.push(["key",Un]))}},g$3(ue$1,"kind",31933),g$3(ue$1,"kinds",[31933]),ue$1),he$2,NDKProjectTemplate=(he$2=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind=30717}static from(s){return new he$2(s.ndk,s.rawEvent())}get templateId(){return this.dTag??""}set templateId(s){this.dTag=s}get name(){return this.tagValue("title")??""}set name(s){this.removeTag("title"),s&&this.tags.push(["title",s])}get description(){return this.tagValue("description")??""}set description(s){this.removeTag("description"),s&&this.tags.push(["description",s])}get repoUrl(){return this.tagValue("uri")??""}set repoUrl(s){this.removeTag("uri"),s&&this.tags.push(["uri",s])}get image(){return this.tagValue("image")}set image(s){this.removeTag("image"),s&&this.tags.push(["image",s])}get command(){return this.tagValue("command")}set command(s){this.removeTag("command"),s&&this.tags.push(["command",s])}get agentConfig(){const s=this.tagValue("agent");if(s)try{return JSON.parse(s)}catch{return}}set agentConfig(s){this.removeTag("agent"),s&&this.tags.push(["agent",JSON.stringify(s)])}get templateTags(){return this.getMatchingTags("t").map(s=>s[1]).filter(Boolean)}set templateTags(s){this.tags=this.tags.filter($n=>$n[0]!=="t"),s.forEach($n=>{$n&&this.tags.push(["t",$n])})}},g$3(he$2,"kind",30717),g$3(he$2,"kinds",[30717]),he$2),READ_MARKER="read",WRITE_MARKER="write",Ie$2,NDKRelayList=(Ie$2=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=10002)}static from(s){return new Ie$2(s.ndk,s.rawEvent())}get readRelayUrls(){return this.tags.filter(s=>s[0]==="r"||s[0]==="relay").filter(s=>!s[2]||s[2]&&s[2]===READ_MARKER).map(s=>tryNormalizeRelayUrl(s[1])).filter(s=>!!s)}set readRelayUrls(s){for(const $n of s)this.tags.push(["r",$n,READ_MARKER])}get writeRelayUrls(){return this.tags.filter(s=>s[0]==="r"||s[0]==="relay").filter(s=>!s[2]||s[2]&&s[2]===WRITE_MARKER).map(s=>tryNormalizeRelayUrl(s[1])).filter(s=>!!s)}set writeRelayUrls(s){for(const $n of s)this.tags.push(["r",$n,WRITE_MARKER])}get bothRelayUrls(){return this.tags.filter(s=>s[0]==="r"||s[0]==="relay").filter(s=>!s[2]).map(s=>s[1])}set bothRelayUrls(s){for(const $n of s)this.tags.push(["r",$n])}get relays(){return this.tags.filter(s=>s[0]==="r"||s[0]==="relay").map(s=>s[1])}get relaySet(){if(!this.ndk)throw new Error("NDKRelayList has no NDK instance");return new NDKRelaySet(new Set(this.relays.map(s=>{var $n;return($n=this.ndk)==null?void 0:$n.pool.getRelay(s)}).filter(s=>!!s)),this.ndk)}},g$3(Ie$2,"kinds",[10002]),Ie$2);function relayListFromKind3(s,$n){try{const Dn=JSON.parse($n.content),Un=new NDKRelayList(s),Bn=new Set,In=new Set;for(let[qn,Fn]of Object.entries(Dn)){try{qn=normalizeRelayUrl(qn)}catch{continue}if(!Fn)Bn.add(qn),In.add(qn);else{const Kn=Fn;Kn.write&&In.add(qn),Kn.read&&Bn.add(qn)}}return Un.readRelayUrls=Array.from(Bn),Un.writeRelayUrls=Array.from(In),Un}catch{}}var Be$3,NDKRepost=(Be$3=class extends NDKEvent{constructor(){super(...arguments),g$3(this,"_repostedEvents")}static from(s){return new Be$3(s.ndk,s.rawEvent())}async repostedEvents(s,$n){const Dn=[];if(!this.ndk)throw new Error("NDK instance not set");if(this._repostedEvents!==void 0)return this._repostedEvents;for(const Un of this.repostedEventIds()){const Bn=filterForId(Un),In=await this.ndk.fetchEvent(Bn,$n);In&&Dn.push(s?s.from(In):In)}return Dn}repostedEventIds(){return this.tags.filter(s=>s[0]==="e"||s[0]==="a").map(s=>s[1])}},g$3(Be$3,"kinds",[6,16]),Be$3);function filterForId(s){if(s.match(/:/)){const[$n,Dn,Un]=s.split(":");return{kinds:[Number.parseInt($n)],authors:[Dn],"#d":[Un]}}return{ids:[s]}}var de$3,NDKSimpleGroupMemberList=(de$3=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"relaySet"),g$3(this,"memberSet",new Set),this.kind??(this.kind=39002),this.memberSet=new Set(this.members)}static from(s){return new de$3(s.ndk,s)}get members(){return this.getMatchingTags("p").map(s=>s[1])}hasMember(s){return this.memberSet.has(s)}async publish(s,$n,Dn){return s??(s=this.relaySet),super.publishReplaceable(s,$n,Dn)}},g$3(de$3,"kind",39002),g$3(de$3,"kinds",[39002]),de$3),pe$3,NDKSimpleGroupMetadata=(pe$3=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=39e3)}static from(s){return new pe$3(s.ndk,s)}get name(){return this.tagValue("name")}get picture(){return this.tagValue("picture")}get about(){return this.tagValue("about")}get scope(){if(this.getMatchingTags("public").length>0)return"public";if(this.getMatchingTags("public").length>0)return"private"}set scope(s){this.removeTag("public"),this.removeTag("private"),s==="public"?this.tags.push(["public",""]):s==="private"&&this.tags.push(["private",""])}get access(){if(this.getMatchingTags("open").length>0)return"open";if(this.getMatchingTags("closed").length>0)return"closed"}set access(s){this.removeTag("open"),this.removeTag("closed"),s==="open"?this.tags.push(["open",""]):s==="closed"&&this.tags.push(["closed",""])}},g$3(pe$3,"kind",39e3),g$3(pe$3,"kinds",[39e3]),pe$3);function strToPosition(s){const[$n,Dn]=s.split(",").map(Number);return{x:$n,y:Dn}}function strToDimension(s){const[$n,Dn]=s.split("x").map(Number);return{width:$n,height:Dn}}var J$3,NDKStorySticker=(J$3=class{constructor(s){if(g$3(this,"type"),g$3(this,"value"),g$3(this,"position"),g$3(this,"dimension"),g$3(this,"properties"),g$3(this,"hasValidDimensions",()=>typeof this.dimension.width=="number"&&typeof this.dimension.height=="number"&&!Number.isNaN(this.dimension.width)&&!Number.isNaN(this.dimension.height)),g$3(this,"hasValidPosition",()=>typeof this.position.x=="number"&&typeof this.position.y=="number"&&!Number.isNaN(this.position.x)&&!Number.isNaN(this.position.y)),Array.isArray(s)){const $n=s;if($n[0]!=="sticker"||$n.length<5)throw new Error("Invalid sticker tag");this.type=$n[1],this.value=$n[2],this.position=strToPosition($n[3]),this.dimension=strToDimension($n[4]);const Dn={};for(let Un=5;Un<$n.length;Un++){const[Bn,...In]=$n[Un].split(" ");Dn[Bn]=In.join(" ")}Object.keys(Dn).length>0&&(this.properties=Dn)}else this.type=s,this.value=void 0,this.position={x:0,y:0},this.dimension={width:0,height:0}}static fromTag(s){try{return new J$3(s)}catch{return null}}get style(){var s;return(s=this.properties)==null?void 0:s.style}set style(s){var $n;s?this.properties={...this.properties,style:s}:($n=this.properties)==null||delete $n.style}get rotation(){var s;return(s=this.properties)!=null&&s.rot?Number.parseFloat(this.properties.rot):void 0}set rotation(s){var $n;s!==void 0?this.properties={...this.properties,rot:s.toString()}:($n=this.properties)==null||delete $n.rot}get isValid(){return this.hasValidDimensions()&&this.hasValidPosition()}toTag(){if(!this.isValid){const Dn=[this.hasValidDimensions()?void 0:"dimensions is invalid",this.hasValidPosition()?void 0:"position is invalid"].filter(Boolean);throw new Error(`Invalid sticker: ${Dn.join(", ")}`)}let s;switch(this.type){case"event":s=this.value.tagId();break;case"pubkey":s=this.value.pubkey;break;default:s=this.value}const $n=["sticker",this.type,s,coordinates(this.position),dimension(this.dimension)];if(this.properties)for(const[Dn,Un]of Object.entries(this.properties))$n.push(`${Dn} ${Un}`);return $n}},g$3(J$3,"Text","text"),g$3(J$3,"Pubkey","pubkey"),g$3(J$3,"Event","event"),g$3(J$3,"Prompt","prompt"),g$3(J$3,"Countdown","countdown"),J$3),ye$2,NDKStory=(ye$2=class extends NDKEvent{constructor(s,$n){if(super(s,$n),g$3(this,"_imeta"),g$3(this,"_dimensions"),this.kind??(this.kind=23),$n)for(const Dn of $n.tags)switch(Dn[0]){case"imeta":this._imeta=mapImetaTag(Dn);break;case"dim":this.dimensions=strToDimension(Dn[1]);break}}static from(s){return new ye$2(s.ndk,s)}get isValid(){return!!this.imeta}get imeta(){return this._imeta}set imeta(s){this._imeta=s,this.tags=this.tags.filter($n=>$n[0]!=="imeta"),s&&this.tags.push(imetaTagToTag(s))}get dimensions(){const s=this.tagValue("dim");if(s)return strToDimension(s)}set dimensions(s){this.removeTag("dim"),s&&this.tags.push(["dim",`${s.width}x${s.height}`])}get duration(){const s=this.tagValue("dur");if(s)return Number.parseInt(s)}set duration(s){this.removeTag("dur"),s!==void 0&&this.tags.push(["dur",s.toString()])}get stickers(){const s=[];for(const $n of this.tags){if($n[0]!=="sticker"||$n.length<5)continue;const Dn=NDKStorySticker.fromTag($n);Dn&&s.push(Dn)}return s}addSticker(s){let $n;if(s instanceof NDKStorySticker)$n=s;else{const Dn=["sticker",s.type,typeof s.value=="string"?s.value:"",coordinates(s.position),dimension(s.dimension)];if(s.properties)for(const[Un,Bn]of Object.entries(s.properties))Dn.push(`${Un} ${Bn}`);$n=new NDKStorySticker(Dn),$n.value=s.value}$n.type==="pubkey"?this.tag($n.value):$n.type==="event"&&this.tag($n.value),this.tags.push($n.toTag())}removeSticker(s){const $n=this.stickers;if(s<0||s>=$n.length)return;let Dn=0;for(let Un=0;Un<this.tags.length;Un++)if(this.tags[Un][0]==="sticker"){if(Dn===s){this.tags.splice(Un,1);break}Dn++}}},g$3(ye$2,"kind",23),g$3(ye$2,"kinds",[23]),ye$2),coordinates=s=>`${s.x},${s.y}`,dimension=s=>`${s.width}x${s.height}`,Ne$2,NDKSubscriptionReceipt=(Ne$2=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"debug"),this.kind??(this.kind=7003),this.debug=s?.debug.extend("subscription-start")??createDebug5("ndk:subscription-start")}static from(s){return new Ne$2(s.ndk,s.rawEvent())}get recipient(){var s;const $n=(s=this.getMatchingTags("p"))==null?void 0:s[0];return $n?new NDKUser({pubkey:$n[1]}):void 0}set recipient(s){this.removeTag("p"),s&&this.tags.push(["p",s.pubkey])}get subscriber(){var s;const $n=(s=this.getMatchingTags("P"))==null?void 0:s[0];return $n?new NDKUser({pubkey:$n[1]}):void 0}set subscriber(s){this.removeTag("P"),s&&this.tags.push(["P",s.pubkey])}set subscriptionStart(s){this.debug(`before setting subscription start: ${this.rawEvent}`),this.removeTag("e"),this.tag(s,"subscription",!0),this.debug(`after setting subscription start: ${this.rawEvent}`)}get tierName(){var s;const $n=(s=this.getMatchingTags("tier"))==null?void 0:s[0];return $n?.[1]}get isValid(){const s=this.validPeriod;if(!s||s.start>s.end)return!1;const $n=this.getMatchingTags("p"),Dn=this.getMatchingTags("P");return!($n.length!==1||Dn.length!==1)}get validPeriod(){var s;const $n=(s=this.getMatchingTags("valid"))==null?void 0:s[0];if($n)try{return{start:new Date(Number.parseInt($n[1])*1e3),end:new Date(Number.parseInt($n[2])*1e3)}}catch{return}}set validPeriod(s){this.removeTag("valid"),s&&this.tags.push(["valid",Math.floor(s.start.getTime()/1e3).toString(),Math.floor(s.end.getTime()/1e3).toString()])}get startPeriod(){var s;return(s=this.validPeriod)==null?void 0:s.start}get endPeriod(){var s;return(s=this.validPeriod)==null?void 0:s.end}isActive(s){s??(s=new Date);const $n=this.validPeriod;return!(!$n||s<$n.start||s>$n.end)}},g$3(Ne$2,"kinds",[7003]),Ne$2),possibleIntervalFrequencies=["daily","weekly","monthly","quarterly","yearly"];function newAmount(s,$n,Dn){return["amount",s.toString(),$n,Dn]}function parseTagToSubscriptionAmount(s){const $n=Number.parseInt(s[1]);if(Number.isNaN($n)||$n===void 0||$n===null||$n<=0)return;const Dn=s[2];if(Dn===void 0||Dn==="")return;const Un=s[3];if(Un!==void 0&&possibleIntervalFrequencies.includes(Un))return{amount:$n,currency:Dn,term:Un}}var me$3,NDKSubscriptionTier=(me$3=class extends NDKArticle{constructor(s,$n){const Dn=$n?.kind??37001;super(s,$n),this.kind=Dn}static from(s){return new me$3(s.ndk,s)}get perks(){return this.getMatchingTags("perk").map(s=>s[1]).filter(s=>s!==void 0)}addPerk(s){this.tags.push(["perk",s])}get amounts(){return this.getMatchingTags("amount").map(s=>parseTagToSubscriptionAmount(s)).filter(s=>s!==void 0)}addAmount(s,$n,Dn){this.tags.push(newAmount(s,$n,Dn))}set relayUrl(s){this.tags.push(["r",s])}get relayUrls(){return this.getMatchingTags("r").map(s=>s[1]).filter(s=>s!==void 0)}get verifierPubkey(){return this.tagValue("p")}set verifierPubkey(s){this.removeTag("p"),s&&this.tags.push(["p",s])}get isValid(){return this.title!==void 0&&this.amounts.length>0}},g$3(me$3,"kind",37001),g$3(me$3,"kinds",[37001]),me$3),Pe$2,NDKSubscriptionStart=(Pe$2=class extends NDKEvent{constructor(s,$n){super(s,$n),g$3(this,"debug"),this.kind??(this.kind=7001),this.debug=s?.debug.extend("subscription-start")??createDebug5("ndk:subscription-start")}static from(s){return new Pe$2(s.ndk,s.rawEvent())}get recipient(){var s;const $n=(s=this.getMatchingTags("p"))==null?void 0:s[0];return $n?new NDKUser({pubkey:$n[1]}):void 0}set recipient(s){this.removeTag("p"),s&&this.tags.push(["p",s.pubkey])}get amount(){var s;const $n=(s=this.getMatchingTags("amount"))==null?void 0:s[0];if($n)return parseTagToSubscriptionAmount($n)}set amount(s){this.removeTag("amount"),s&&this.tags.push(newAmount(s.amount,s.currency,s.term))}get tierId(){var s,$n;const Dn=(s=this.getMatchingTags("e"))==null?void 0:s[0],Un=($n=this.getMatchingTags("a"))==null?void 0:$n[0];if(!(!Dn||!Un))return Dn[1]??Un[1]}set tier(s){this.removeTag("e"),this.removeTag("a"),this.removeTag("event"),s&&(this.tag(s),this.removeTag("p"),this.tags.push(["p",s.pubkey]),this.tags.push(["event",JSON.stringify(s.rawEvent())]))}async fetchTier(){var s;const $n=this.tagValue("event");if($n)try{const Bn=JSON.parse($n);return new NDKSubscriptionTier(this.ndk,Bn)}catch{this.debug("Failed to parse event tag")}const Dn=this.tierId;if(!Dn)return;const Un=await((s=this.ndk)==null?void 0:s.fetchEvent(Dn));if(Un)return NDKSubscriptionTier.from(Un)}get isValid(){return this.getMatchingTags("amount").length!==1?(this.debug("Invalid # of amount tag"),!1):this.amount?this.getMatchingTags("p").length!==1?(this.debug("Invalid # of p tag"),!1):this.recipient?!0:(this.debug("Invalid p tag"),!1):(this.debug("Invalid amount tag"),!1)}},g$3(Pe$2,"kinds",[7001]),Pe$2),be$2,NDKTask=(be$2=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind=1934}static from(s){return new be$2(s.ndk,s.rawEvent())}set title(s){this.removeTag("title"),s&&this.tags.push(["title",s])}get title(){return this.tagValue("title")}set project(s){this.removeTag("a"),this.tags.push(s.tagReference())}get projectSlug(){var s;const $n=this.getMatchingTags("a")[0];return $n?(s=$n[1].split(/:/))==null?void 0:s[2]:void 0}},g$3(be$2,"kind",1934),g$3(be$2,"kinds",[1934]),be$2),we$2,NDKThread=(we$2=class extends NDKEvent{constructor(s,$n){super(s,$n),this.kind??(this.kind=11)}static from(s){return new we$2(s.ndk,s)}get title(){return this.tagValue("title")}set title(s){this.removeTag("title"),s&&this.tags.push(["title",s])}},g$3(we$2,"kind",11),g$3(we$2,"kinds",[11]),we$2),ve$2,NDKVideo=(ve$2=class extends NDKEvent{constructor(){super(...arguments),g$3(this,"_imetas")}static from(s){return new ve$2(s.ndk,s.rawEvent())}get title(){return this.tagValue("title")}set title(s){this.removeTag("title"),s&&this.tags.push(["title",s])}get thumbnail(){var s;let $n;return this.imetas&&this.imetas.length>0&&($n=(s=this.imetas[0].image)==null?void 0:s[0]),$n??this.tagValue("thumb")}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(s=>s[0]==="imeta").map(mapImetaTag),this._imetas)}set imetas(s){this._imetas=s,this.tags=this.tags.filter($n=>$n[0]!=="imeta"),this.tags.push(...s.map(imetaTagToTag))}get url(){return this.imetas&&this.imetas.length>0?this.imetas[0].url:this.tagValue("url")}get published_at(){const s=this.tagValue("published_at");if(s)return Number.parseInt(s)}async generateTags(){var s,$n;if(super.generateTags(),!this.kind&&($n=(s=this.imetas)==null?void 0:s[0])!=null&&$n.dim){const[Dn,Un]=this.imetas[0].dim.split("x"),Bn=Dn&&Un&&Number.parseInt(Dn)<Number.parseInt(Un);this.duration&&this.duration<120&&Bn?this.kind=22:this.kind=21}return super.generateTags()}get duration(){const s=this.tagValue("duration");if(s)return Number.parseInt(s)}set duration(s){this.removeTag("duration"),s!==void 0&&this.tags.push(["duration",Math.floor(s).toString()])}},g$3(ve$2,"kind",21),g$3(ve$2,"kinds",[34235,34236,22,21]),ve$2),Ee$3,NDKWiki=(Ee$3=class extends NDKArticle{static from(s){return new Ee$3(s.ndk,s.rawEvent())}get isDefered(){return this.hasTag("a","defer")}get deferedId(){return this.tagValue("a","defer")}set defer(s){this.removeTag("a","defer"),this.tag(s,"defer")}},g$3(Ee$3,"kind",30818),g$3(Ee$3,"kinds",[30818]),Ee$3),Le$2,NDKWikiMergeRequest=(Le$2=class extends NDKEvent{static from(s){return new Le$2(s.ndk,s.rawEvent())}get targetId(){return this.tagValue("a")}set target(s){this.tags=this.tags.filter($n=>{if($n[0]==="a"||$n[0]==="e"&&$n[3]!=="source")return!0}),this.tag(s)}get sourceId(){return this.tagValue("e","source")}set source(s){this.removeTag("e","source"),this.tag(s,"source",!1,"e")}},g$3(Le$2,"kinds",[818]),Le$2),registeredEventClasses=new Set;function wrapEvent(s){const $n=new Map,Dn=[NDKImage,NDKVideo,NDKCashuMintList,NDKArticle,NDKHighlight,NDKDraft,NDKWiki,NDKWikiMergeRequest,NDKNutzap,NDKProject,NDKTask,NDKProjectTemplate,NDKSimpleGroupMemberList,NDKSimpleGroupMetadata,NDKSubscriptionTier,NDKSubscriptionStart,NDKSubscriptionReceipt,NDKList,NDKRelayList,NDKStory,NDKBlossomList,NDKFollowPack,NDKThread,NDKRepost,NDKClassified,NDKAppHandlerEvent,NDKDVMJobFeedback,NDKCashuMintAnnouncement,NDKFedimintMint,NDKMintRecommendation,...registeredEventClasses];for(const Bn of Dn)for(const In of Bn.kinds)$n.set(In,Bn);const Un=$n.get(s.kind);return Un?Un.from(s):s}function checkMissingKind(s,$n){(s.kind===void 0||s.kind===null)&&$n("event-missing-kind",`Cannot sign event without 'kind'.

 Event data:
    content: ${s.content?`"${s.content.substring(0,50)}${s.content.length>50?"...":""}"`:"(empty)"}
    tags: ${s.tags.length} tag${s.tags.length!==1?"s":""}
    kind: ${s.kind} 

Set event.kind before signing.`,"Example: event.kind = 1; // for text note",!1)}function checkContentIsObject(s,$n){if(typeof s.content=="object"){const Dn=JSON.stringify(s.content,null,2).substring(0,200);$n("event-content-is-object",`Event content is an object. Content must be a string.

 Your content (${typeof s.content}):
${Dn}${JSON.stringify(s.content).length>200?"...":""}

 event.content = { ... }  // WRONG
 event.content = JSON.stringify({ ... })  // CORRECT`,"Use JSON.stringify() for structured data: event.content = JSON.stringify(data)",!1)}}function checkCreatedAtMilliseconds(s,$n){if(s.created_at&&s.created_at>1e10){const Dn=Math.floor(s.created_at/1e3),Un=new Date(s.created_at).toISOString();$n("event-created-at-milliseconds",`Event created_at is in milliseconds, not seconds.

 Your value:
    created_at: ${s.created_at} 
    Interpreted as: ${Un}
    Should be: ${Dn} 

Nostr timestamps MUST be in seconds since Unix epoch.`,"Use Math.floor(Date.now() / 1000) instead of Date.now()",!1)}}function checkInvalidPTags(s,$n){s.getMatchingTags("p").forEach((Dn,Un)=>{if(Dn[1]&&!/^[0-9a-f]{64}$/i.test(Dn[1])){const Bn=JSON.stringify(Dn);$n("tag-invalid-p-tag",`p-tag[${Un}] has invalid pubkey.

 Your tag:
   ${Bn}

 Invalid value: "${Dn[1]}"
    Length: ${Dn[1].length} (expected 64)
    Format: ${Dn[1].startsWith("npub")?"bech32 (npub)":"unknown"}

p-tags MUST contain 64-character hex pubkeys.`,Dn[1].startsWith("npub")?`Use ndkUser.pubkey instead of npub:
    event.tags.push(['p', ndkUser.pubkey])
    event.tags.push(['p', 'npub1...'])`:"p-tags must contain valid hex pubkeys (64 characters, 0-9a-f)",!1)}})}function checkInvalidETags(s,$n){s.getMatchingTags("e").forEach((Dn,Un)=>{if(Dn[1]&&!/^[0-9a-f]{64}$/i.test(Dn[1])){const Bn=JSON.stringify(Dn),In=Dn[1].startsWith("note")||Dn[1].startsWith("nevent");$n("tag-invalid-e-tag",`e-tag[${Un}] has invalid event ID.

 Your tag:
   ${Bn}

 Invalid value: "${Dn[1]}"
    Length: ${Dn[1].length} (expected 64)
    Format: ${In?"bech32 (note/nevent)":"unknown"}

e-tags MUST contain 64-character hex event IDs.`,In?`Use event.id instead of bech32:
    event.tags.push(['e', referencedEvent.id])
    event.tags.push(['e', 'note1...'])`:"e-tags must contain valid hex event IDs (64 characters, 0-9a-f)",!1)}})}function checkManualReplyMarkers(s,$n,Dn){if(s.kind!==1||Dn.has(s))return;const Un=s.tags.filter(Bn=>Bn[0]==="e"&&(Bn[3]==="reply"||Bn[3]==="root"));if(Un.length>0){const Bn=Un.map((In,qn)=>`   ${qn+1}. ${JSON.stringify(In)}`).join(`
`);$n("event-manual-reply-markers",`Event has ${Un.length} e-tag(s) with manual reply/root markers.

 Your tags with markers:
${Bn}

  Manual reply markers detected! This will cause incorrect threading.`,`Reply events MUST be created using .reply():

    CORRECT:
   const replyEvent = originalEvent.reply();
   replyEvent.content = 'good point!';
   await replyEvent.publish();

    WRONG:
   event.tags.push(['e', eventId, '', 'reply']);

NDK handles all reply threading automatically - never add reply/root markers manually.`)}}function checkHashtagsWithPrefix(s,$n){s.getMatchingTags("t").forEach((Dn,Un)=>{if(Dn[1]&&Dn[1].startsWith("#")){const Bn=JSON.stringify(Dn);$n("tag-hashtag-with-prefix",`t-tag[${Un}] contains hashtag with # prefix.

 Your tag:
   ${Bn}

 Invalid value: "${Dn[1]}"

Hashtag tags should NOT include the # symbol.`,`Remove the # prefix from hashtag tags:
    event.tags.push(['t', 'nostr'])
    event.tags.push(['t', '#nostr'])`,!1)}})}function checkReplaceableWithOldTimestamp(s,$n){if(s.kind===void 0||s.kind===null||!s.created_at||!s.isReplaceable())return;const Dn=Math.floor(Date.now()/1e3),Un=Dn-s.created_at;if(Un>10){const Bn=Math.floor(Un/60),In=Bn>0?`${Bn} minute${Bn!==1?"s":""}`:`${Un} seconds`;$n("event-replaceable-old-timestamp",`Publishing a replaceable event with an old created_at timestamp.

 Event details:
    kind: ${s.kind} (replaceable)
    created_at: ${s.created_at}
    age: ${In} old
    current time: ${Dn}

  This is wrong and will be rejected by relays.`,`For replaceable events, use publishReplaceable():

    CORRECT:
   await event.publishReplaceable();
   // Automatically updates created_at to now

    WRONG:
   await event.publish();
   // Uses old created_at`)}}function signing(s,$n,Dn,Un){checkMissingKind(s,$n),checkContentIsObject(s,$n),checkCreatedAtMilliseconds(s,$n),checkInvalidPTags(s,$n),checkInvalidETags(s,$n),checkHashtagsWithPrefix(s,$n),checkManualReplyMarkers(s,Dn,Un)}function publishing(s,$n){checkReplaceableWithOldTimestamp(s,$n)}function isNip33Pattern(s){const $n=Array.isArray(s)?s:[s];if($n.length!==1)return!1;const Dn=$n[0];return Dn.kinds&&Array.isArray(Dn.kinds)&&Dn.kinds.length===1&&Dn.authors&&Array.isArray(Dn.authors)&&Dn.authors.length===1&&Dn["#d"]&&Array.isArray(Dn["#d"])&&Dn["#d"].length===1}function isReplaceableEventFilter(s){const $n=Array.isArray(s)?s:[s];return $n.length===0?!1:$n.every(Dn=>!Dn.kinds||!Array.isArray(Dn.kinds)||Dn.kinds.length===0||!Dn.authors||!Array.isArray(Dn.authors)||Dn.authors.length===0?!1:Dn.kinds.every(Un=>Un===0||Un===3||Un>=1e4&&Un<=19999))}function formatFilter(s){return JSON.stringify(s,null,2).split(`
`).map(($n,Dn)=>Dn===0?$n:`   ${$n}`).join(`
`)}function fetchingEvents(s,$n,Dn,Un,Bn){if(Bn(),$n?.cacheUsage==="ONLY_CACHE")return;const In=Array.isArray(s)?s:[s],qn=In.map(formatFilter).join(`

   ---

   `);if(isNip33Pattern(s))In[0],Dn("fetch-events-usage",`For fetching a NIP-33 addressable event, use fetchEvent() with the naddr directly.

 Your filter:
   `+qn+`

   BAD:  const decoded = nip19.decode(naddr);
           const events = await ndk.fetchEvents({
             kinds: [decoded.data.kind],
             authors: [decoded.data.pubkey],
             "#d": [decoded.data.identifier]
           });
           const event = Array.from(events)[0];

   GOOD: const event = await ndk.fetchEvent(naddr);
   GOOD: const event = await ndk.fetchEvent('naddr1...');

fetchEvent() handles naddr decoding automatically and returns the event directly.`);else{if(isReplaceableEventFilter(s))return;{if(!Un())return;let Fn="";const Kn=In.some(Zn=>Zn.limit!==void 0),jn=new Set(In.flatMap(Zn=>Zn.kinds||[])).size,Yn=new Set(In.flatMap(Zn=>Zn.authors||[])).size;if(Kn){const Zn=Math.max(...In.map(Xn=>Xn.limit||0));Fn+=`
    Limit: ${Zn} event${Zn!==1?"s":""}`}jn>0&&(Fn+=`
    Kinds: ${jn} type${jn!==1?"s":""}`),Yn>0&&(Fn+=`
    Authors: ${Yn} author${Yn!==1?"s":""}`),Dn("fetch-events-usage",`fetchEvents() is a BLOCKING operation that waits for EOSE.
In most cases, you should use subscribe() instead.

 Your filter`+(In.length>1?"s":"")+`:
   `+qn+(Fn?`

 Filter analysis:`+Fn:"")+`

   BAD:  const events = await ndk.fetchEvents(filter);
   GOOD: ndk.subscribe(filter, { onEvent: (e) => ... });

Only use fetchEvents() when you MUST block until data arrives.`,"For one-time queries, use fetchEvent() instead of fetchEvents() when expecting a single result.")}}}var GuardrailCheckId={NDK_NO_CACHE:"ndk-no-cache",FILTER_BECH32_IN_ARRAY:"filter-bech32-in-array",FILTER_INVALID_HEX:"filter-invalid-hex",FILTER_ONLY_LIMIT:"filter-only-limit",FILTER_EMPTY:"filter-empty",FILTER_SINCE_AFTER_UNTIL:"filter-since-after-until",FILTER_INVALID_A_TAG:"filter-invalid-a-tag",FILTER_HASHTAG_WITH_PREFIX:"filter-hashtag-with-prefix"};function checkCachePresence(s,$n){$n(GuardrailCheckId.NDK_NO_CACHE)&&setTimeout(()=>{if(!s.cacheAdapter){const Dn=`
 AI_GUARDRAILS WARNING: NDK initialized without a cache adapter. Apps perform significantly better with caching.

 ${typeof window<"u"?"Consider using @nostr-dev-kit/ndk-cache-dexie or @nostr-dev-kit/ndk-cache-sqlite-wasm":"Consider using @nostr-dev-kit/ndk-cache-redis or @nostr-dev-kit/ndk-cache-sqlite"}

 To disable this check:
   ndk.aiGuardrails.skip('${GuardrailCheckId.NDK_NO_CACHE}')
   or set: ndk.aiGuardrails = { skip: new Set(['${GuardrailCheckId.NDK_NO_CACHE}']) }`;console.warn(Dn)}},2500)}var AIGuardrails=class{constructor(s=!1){g$3(this,"enabled",!1),g$3(this,"skipSet",new Set),g$3(this,"extensions",new Map),g$3(this,"_nextCallDisabled",null),g$3(this,"_replyEvents",new WeakSet),g$3(this,"_fetchEventsCount",0),g$3(this,"_subscribeCount",0),g$3(this,"ndk",{fetchingEvents:($n,Dn)=>{this.enabled&&fetchingEvents($n,Dn,this.warn.bind(this),this.shouldWarnAboutFetchEventsRatio.bind(this),this.incrementFetchEventsCount.bind(this))}}),g$3(this,"event",{signing:$n=>{this.enabled&&signing($n,this.error.bind(this),this.warn.bind(this),this._replyEvents)},publishing:$n=>{this.enabled&&publishing($n,this.warn.bind(this))},received:($n,Dn)=>{this.enabled},creatingReply:$n=>{this.enabled&&this._replyEvents.add($n)}}),g$3(this,"subscription",{created:($n,Dn)=>{this.enabled&&this.incrementSubscribeCount()}}),g$3(this,"relay",{connected:$n=>{this.enabled}}),this.setMode(s)}register(s,$n){this.extensions.has(s)&&console.warn(`AIGuardrails: Extension '${s}' already registered, overwriting`);const Dn={};for(const[Un,Bn]of Object.entries($n))typeof Bn=="function"&&(Dn[Un]=(...In)=>{this.enabled&&Bn(...In,this.shouldCheck.bind(this),this.error.bind(this),this.warn.bind(this))});this.extensions.set(s,Dn),this[s]=Dn}setMode(s){typeof s=="boolean"?(this.enabled=s,this.skipSet.clear()):s&&typeof s=="object"&&(this.enabled=!0,this.skipSet=s.skip||new Set)}isEnabled(){return this.enabled}shouldCheck(s){return!(!this.enabled||this.skipSet.has(s)||this._nextCallDisabled==="all"||this._nextCallDisabled&&this._nextCallDisabled.has(s))}skip(s){this.skipSet.add(s)}enable(s){this.skipSet.delete(s)}getSkipped(){return Array.from(this.skipSet)}captureAndClearNextCallDisabled(){const s=this._nextCallDisabled;return this._nextCallDisabled=null,s}incrementFetchEventsCount(){this._fetchEventsCount++}incrementSubscribeCount(){this._subscribeCount++}shouldWarnAboutFetchEventsRatio(){const s=this._fetchEventsCount+this._subscribeCount;return s<=6?!1:this._fetchEventsCount/s>.5}error(s,$n,Dn,Un=!0){if(!this.shouldCheck(s))return;const Bn=this.formatMessage(s,"ERROR",$n,Dn,Un);throw console.error(Bn),new Error(Bn)}warn(s,$n,Dn){if(!this.shouldCheck(s))return;const Un=this.formatMessage(s,"WARNING",$n,Dn,!0);throw console.error(Un),new Error(Un)}formatMessage(s,$n,Dn,Un,Bn=!0){let In=`
 AI_GUARDRAILS ${$n}: ${Dn}`;return Un&&(In+=`

 ${Un}`),Bn&&(In+=`

 To disable this check:
   ndk.guardrailOff('${s}').yourMethod()  // For one call`,In+=`
   ndk.aiGuardrails.skip('${s}')  // Permanently`,In+=`
   or set: ndk.aiGuardrails = { skip: new Set(['${s}']) }`),In}ndkInstantiated(s){this.enabled&&checkCachePresence(s,this.shouldCheck.bind(this))}};function processFilters(s,$n="validate",Dn,Un){if($n==="ignore")return s;const Bn=[],In=s.map((qn,Fn)=>(Un!=null&&Un.aiGuardrails.isEnabled()&&runAIGuardrailsForFilter(qn,Fn,Un),processFilter(qn,$n,Fn,Bn,Dn)));if($n==="validate"&&Bn.length>0)throw new Error(`Invalid filter(s) detected:
${Bn.join(`
`)}`);return In}function processFilter(s,$n,Dn,Un,Bn){const In=$n==="validate",qn=In?s:{...s};if(s.ids){const Fn=[];s.ids.forEach((Kn,jn)=>{Kn===void 0?In?Un.push(`Filter[${Dn}].ids[${jn}] is undefined`):Bn?.(`Fixed: Removed undefined value at ids[${jn}]`):typeof Kn!="string"?In?Un.push(`Filter[${Dn}].ids[${jn}] is not a string (got ${typeof Kn})`):Bn?.(`Fixed: Removed non-string value at ids[${jn}] (was ${typeof Kn})`):isValidHex64(Kn)?Fn.push(Kn):In?Un.push(`Filter[${Dn}].ids[${jn}] is not a valid 64-char hex string: "${Kn}"`):Bn?.(`Fixed: Removed invalid hex string at ids[${jn}]`)}),In||(qn.ids=Fn.length>0?Fn:void 0)}if(s.authors){const Fn=[];s.authors.forEach((Kn,jn)=>{Kn===void 0?In?Un.push(`Filter[${Dn}].authors[${jn}] is undefined`):Bn?.(`Fixed: Removed undefined value at authors[${jn}]`):typeof Kn!="string"?In?Un.push(`Filter[${Dn}].authors[${jn}] is not a string (got ${typeof Kn})`):Bn?.(`Fixed: Removed non-string value at authors[${jn}] (was ${typeof Kn})`):isValidHex64(Kn)?Fn.push(Kn):In?Un.push(`Filter[${Dn}].authors[${jn}] is not a valid 64-char hex pubkey: "${Kn}"`):Bn?.(`Fixed: Removed invalid hex pubkey at authors[${jn}]`)}),In||(qn.authors=Fn.length>0?Fn:void 0)}if(s.kinds){const Fn=[];s.kinds.forEach((Kn,jn)=>{Kn===void 0?In?Un.push(`Filter[${Dn}].kinds[${jn}] is undefined`):Bn?.(`Fixed: Removed undefined value at kinds[${jn}]`):typeof Kn!="number"?In?Un.push(`Filter[${Dn}].kinds[${jn}] is not a number (got ${typeof Kn})`):Bn?.(`Fixed: Removed non-number value at kinds[${jn}] (was ${typeof Kn})`):Number.isInteger(Kn)?Kn<0||Kn>65535?In?Un.push(`Filter[${Dn}].kinds[${jn}] is out of valid range (0-65535): ${Kn}`):Bn?.(`Fixed: Removed out-of-range kind at kinds[${jn}]: ${Kn}`):Fn.push(Kn):In?Un.push(`Filter[${Dn}].kinds[${jn}] is not an integer: ${Kn}`):Bn?.(`Fixed: Removed non-integer value at kinds[${jn}]: ${Kn}`)}),In||(qn.kinds=Fn.length>0?Fn:void 0)}for(const Fn in s)if(Fn.startsWith("#")&&Fn.length===2){const Kn=s[Fn];if(Array.isArray(Kn)){const jn=[];Kn.forEach((Yn,Zn)=>{Yn===void 0?In?Un.push(`Filter[${Dn}].${Fn}[${Zn}] is undefined`):Bn?.(`Fixed: Removed undefined value at ${Fn}[${Zn}]`):typeof Yn!="string"?In?Un.push(`Filter[${Dn}].${Fn}[${Zn}] is not a string (got ${typeof Yn})`):Bn?.(`Fixed: Removed non-string value at ${Fn}[${Zn}] (was ${typeof Yn})`):(Fn==="#e"||Fn==="#p")&&!isValidHex64(Yn)?In?Un.push(`Filter[${Dn}].${Fn}[${Zn}] is not a valid 64-char hex string: "${Yn}"`):Bn?.(`Fixed: Removed invalid hex string at ${Fn}[${Zn}]`):jn.push(Yn)}),In||(qn[Fn]=jn.length>0?jn:void 0)}}return In||Object.keys(qn).forEach(Fn=>{qn[Fn]===void 0&&delete qn[Fn]}),qn}function runAIGuardrailsForFilter(s,$n,Dn){const Un=Dn.aiGuardrails,Bn=JSON.stringify(s,null,2);if(Object.keys(s).length===1&&s.limit!==void 0&&Un.error(GuardrailCheckId.FILTER_ONLY_LIMIT,`Filter[${$n}] contains only 'limit' without any filtering criteria.

 Your filter:
${Bn}

  This will fetch random events from relays without any criteria.`,`Add filtering criteria:
    { kinds: [1], limit: 10 }
    { authors: [pubkey], limit: 10 }
    { limit: 10 }`),Object.keys(s).length===0&&Un.error(GuardrailCheckId.FILTER_EMPTY,`Filter[${$n}] is empty.

 Your filter:
${Bn}

  This will request ALL events from relays, which is never what you want.`,"Add filtering criteria like 'kinds', 'authors', or tags.",!1),s.since!==void 0&&s.until!==void 0&&s.since>s.until){const qn=new Date(s.since*1e3).toISOString(),Fn=new Date(s.until*1e3).toISOString();Un.error(GuardrailCheckId.FILTER_SINCE_AFTER_UNTIL,`Filter[${$n}] has 'since' AFTER 'until'.

 Your filter:
${Bn}

 since: ${s.since} (${qn})
 until: ${s.until} (${Fn})

No events can match this time range!`,"'since' must be BEFORE 'until'. Both are Unix timestamps in seconds.",!1)}const In=/^n(addr|event|ote|pub|profile)1/;s.ids&&s.ids.forEach((qn,Fn)=>{typeof qn=="string"&&(In.test(qn)?Un.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${$n}].ids[${Fn}] contains bech32: "${qn}". IDs must be hex, not bech32.`,'Use filterFromId() to decode bech32 first: import { filterFromId } from "@nostr-dev-kit/ndk"',!1):isValidHex64(qn)||Un.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${$n}].ids[${Fn}] is not a valid 64-char hex string: "${qn}"`,`Event IDs must be 64-character hexadecimal strings. Invalid IDs often come from corrupted data in user-generated lists. Always validate hex strings before using them in filters:

   const validIds = ids.filter(id => /^[0-9a-f]{64}$/i.test(id));`,!1))}),s.authors&&s.authors.forEach((qn,Fn)=>{typeof qn=="string"&&(In.test(qn)?Un.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${$n}].authors[${Fn}] contains bech32: "${qn}". Authors must be hex pubkeys, not npub.`,"Use ndkUser.pubkey instead. Example: { authors: [ndkUser.pubkey] }",!1):isValidHex64(qn)||Un.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${$n}].authors[${Fn}] is not a valid 64-char hex pubkey: "${qn}"`,`Kind:3 follow lists can contain invalid entries like labels ("Follow List"), partial strings ("highlig"), or other corrupted data. You MUST validate all pubkeys before using them in filters.

   Example:
   const validPubkeys = pubkeys.filter(p => /^[0-9a-f]{64}$/i.test(p));
   ndk.subscribe({ authors: validPubkeys, kinds: [1] });`,!1))});for(const qn in s)if(qn.startsWith("#")&&qn.length===2){const Fn=s[qn];Array.isArray(Fn)&&Fn.forEach((Kn,jn)=>{typeof Kn=="string"&&(qn==="#e"||qn==="#p")&&(In.test(Kn)?Un.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${$n}].${qn}[${jn}] contains bech32: "${Kn}". Tag values must be decoded.`,"Use filterFromId() or nip19.decode() to get the hex value first.",!1):isValidHex64(Kn)||Un.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${$n}].${qn}[${jn}] is not a valid 64-char hex string: "${Kn}"`,`${qn==="#e"?"Event IDs":"Public keys"} in tag filters must be 64-character hexadecimal strings. Kind:3 follow lists and other user-generated content can contain invalid data. Always filter before using:

   const validValues = values.filter(v => /^[0-9a-f]{64}$/i.test(v));`,!1))})}if(s["#a"]){const qn=s["#a"];qn?.forEach((Fn,Kn)=>{if(typeof Fn=="string")if(!/^\d+:[0-9a-f]{64}:.*$/.test(Fn))Un.error(GuardrailCheckId.FILTER_INVALID_A_TAG,`Filter[${$n}].#a[${Kn}] has invalid format: "${Fn}". Must be "kind:pubkey:d-tag".`,'Example: "30023:fa984bd7dbb282f07e16e7ae87b26a2a7b9b90b7246a44771f0cf5ae58018f52:my-article"',!1);else{const jn=Number.parseInt(Fn.split(":")[0],10);(jn<3e4||jn>39999)&&Un.error(GuardrailCheckId.FILTER_INVALID_A_TAG,`Filter[${$n}].#a[${Kn}] uses non-addressable kind ${jn}: "${Fn}". #a filters are only for addressable events (kinds 30000-39999).`,`Addressable events include:
    30000-30039: Parameterized Replaceable Events (profiles, settings, etc.)
    30040-39999: Other addressable events

For regular events (kind ${jn}), use:
    #e filter for specific event IDs
    kinds + authors filters for event queries`,!1)}})}if(s["#t"]){const qn=s["#t"];qn?.forEach((Fn,Kn)=>{typeof Fn=="string"&&Fn.startsWith("#")&&Un.error(GuardrailCheckId.FILTER_HASHTAG_WITH_PREFIX,`Filter[${$n}].#t[${Kn}] contains hashtag with # prefix: "${Fn}". Hashtag values should NOT include the # symbol.`,`Remove the # prefix from hashtag filters:
    { "#t": ["nostr"] }
    { "#t": ["#nostr"] }`,!1)})}}function queryFullyFilled(s){return!!(filterIncludesIds(s.filter)&&resultHasAllRequestedIds(s))}function filterIncludesIds(s){return!!s.ids}function resultHasAllRequestedIds(s){const $n=s.filter.ids;return!!$n&&$n.length===s.eventFirstSeen.size}function filterFromId(s){let $n;if(s.match(NIP33_A_REGEX)){const[Dn,Un,Bn]=s.split(":"),In={authors:[Un],kinds:[Number.parseInt(Dn)]};return Bn&&(In["#d"]=[Bn]),In}if(s.match(BECH32_REGEX))try{switch($n=nip19_exports$1.decode(s),$n.type){case"nevent":{const Dn={ids:[$n.data.id]};return $n.data.author&&(Dn.authors=[$n.data.author]),$n.data.kind&&(Dn.kinds=[$n.data.kind]),Dn}case"note":return{ids:[$n.data]};case"naddr":{const Dn={authors:[$n.data.pubkey],kinds:[$n.data.kind]};return $n.data.identifier&&(Dn["#d"]=[$n.data.identifier]),Dn}}}catch(Dn){console.error("Error decoding",s,Dn)}return{ids:[s]}}function isNip33AValue(s){return s.match(NIP33_A_REGEX)!==null}var NIP33_A_REGEX=/^(\d+):([0-9A-Fa-f]+)(?::(.*))?$/,BECH32_REGEX=/^n(event|ote|profile|pub|addr)1[\d\w]+$/;function relaysFromBech32(s,$n){try{const Dn=nip19_exports$1.decode(s);if(["naddr","nevent"].includes(Dn?.type)){const Un=Dn.data;if(Un!=null&&Un.relays)return Un.relays.map(Bn=>new NDKRelay(Bn,$n.relayAuthDefaultPolicy,$n))}}catch{}return[]}var defaultOpts={closeOnEose:!1,cacheUsage:"CACHE_FIRST",dontSaveToCache:!1,groupable:!0,groupableDelay:100,groupableDelayType:"at-most",cacheUnconstrainFilter:["limit","since","until"],includeMuted:!1},NDKSubscription=class extends lib$1.EventEmitter{constructor(s,$n,Dn,Un){super(),g$3(this,"subId"),g$3(this,"filters"),g$3(this,"opts"),g$3(this,"pool"),g$3(this,"skipVerification",!1),g$3(this,"skipValidation",!1),g$3(this,"exclusiveRelay",!1),g$3(this,"relayFilters"),g$3(this,"relaySet"),g$3(this,"ndk"),g$3(this,"debug"),g$3(this,"eventFirstSeen",new Map),g$3(this,"eosesSeen",new Set),g$3(this,"lastEventReceivedAt"),g$3(this,"mostRecentCacheEventTimestamp"),g$3(this,"internalId"),g$3(this,"closeOnEose"),g$3(this,"poolMonitor"),g$3(this,"skipOptimisticPublishEvent",!1),g$3(this,"cacheUnconstrainFilter"),g$3(this,"onStopped"),g$3(this,"eoseTimeout"),g$3(this,"eosed",!1),this.ndk=s,this.opts={...defaultOpts,...Dn||{}},this.pool=this.opts.pool||s.pool;const Bn=Array.isArray($n)?$n:[$n],In=s.filterValidationMode==="validate"?"validate":s.filterValidationMode==="fix"?"fix":"ignore";if(this.filters=processFilters(Bn,In,s.debug,s),this.filters.length===0)throw new Error("Subscription must have at least one filter");this.subId=Un||this.opts.subId,this.internalId=Math.random().toString(36).substring(7),this.debug=s.debug.extend(`subscription[${this.opts.subId??this.internalId}]`),this.opts.relaySet?this.relaySet=this.opts.relaySet:this.opts.relayUrls&&(this.relaySet=NDKRelaySet.fromRelayUrls(this.opts.relayUrls,this.ndk)),this.skipVerification=this.opts.skipVerification||!1,this.skipValidation=this.opts.skipValidation||!1,this.closeOnEose=this.opts.closeOnEose||!1,this.skipOptimisticPublishEvent=this.opts.skipOptimisticPublishEvent||!1,this.cacheUnconstrainFilter=this.opts.cacheUnconstrainFilter,this.exclusiveRelay=this.opts.exclusiveRelay||!1,this.opts.onEvent&&this.on("event",this.opts.onEvent),this.opts.onEose&&this.on("eose",this.opts.onEose),this.opts.onClose&&this.on("close",this.opts.onClose)}relaysMissingEose(){var s;return this.relayFilters?Array.from((s=this.relayFilters)==null?void 0:s.keys()).filter($n=>!this.eosesSeen.has(this.pool.getRelay($n,!1,!1))):[]}get filter(){return this.filters[0]}get groupableDelay(){var s;if(this.isGroupable())return(s=this.opts)==null?void 0:s.groupableDelay}get groupableDelayType(){var s;return((s=this.opts)==null?void 0:s.groupableDelayType)||"at-most"}isGroupable(){var s;return((s=this.opts)==null?void 0:s.groupable)||!1}shouldQueryCache(){var s;return this.opts.addSinceFromCache?!0:((s=this.opts)==null?void 0:s.cacheUsage)==="ONLY_RELAY"?!1:(this.filters.some($n=>{var Dn;return(Dn=$n.kinds)==null?void 0:Dn.some(Un=>kindIsEphemeral(Un))}),!0)}shouldQueryRelays(){var s;return((s=this.opts)==null?void 0:s.cacheUsage)!=="ONLY_CACHE"}shouldWaitForCache(){var s;return this.opts.addSinceFromCache?!0:!!this.opts.closeOnEose&&!!((s=this.ndk.cacheAdapter)!=null&&s.locking)&&this.opts.cacheUsage!=="PARALLEL"}start(s=!0){let $n;const Dn=Bn=>{for(const In of Bn)In.created_at&&(!this.mostRecentCacheEventTimestamp||In.created_at>this.mostRecentCacheEventTimestamp)&&(this.mostRecentCacheEventTimestamp=In.created_at),this.eventReceived(In,void 0,!0,!1);s||($n=Bn)},Un=()=>{this.shouldQueryRelays()?(this.startWithRelays(),this.startPoolMonitor()):this.emit("eose",this)};return this.shouldQueryCache()?($n=this.startWithCache(),$n instanceof Promise?this.shouldWaitForCache()?($n.then(Bn=>{if(Dn(Bn),queryFullyFilled(this)){this.emit("eose",this);return}Un()}),null):($n.then(Bn=>{Dn(Bn),this.shouldQueryRelays()||this.emit("eose",this)}),this.shouldQueryRelays()&&Un(),null):(Dn($n),queryFullyFilled(this)?this.emit("eose",this):Un(),$n)):(Un(),null)}startPoolMonitor(){this.debug.extend("pool-monitor"),this.poolMonitor=s=>{var $n,Dn;($n=this.relayFilters)!=null&&$n.has(s.url)||calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool,this.opts.relayGoalPerAuthor).get(s.url)&&((Dn=this.relayFilters)==null||Dn.set(s.url,this.filters),s.subscribe(this,this.filters))},this.pool.on("relay:connect",this.poolMonitor)}stop(){var s;this.emit("close",this),this.poolMonitor&&this.pool.off("relay:connect",this.poolMonitor),(s=this.onStopped)==null||s.call(this)}hasAuthorsFilter(){return this.filters.some(s=>{var $n;return($n=s.authors)==null?void 0:$n.length})}startWithCache(){var s;return(s=this.ndk.cacheAdapter)!=null&&s.query?this.ndk.cacheAdapter.query(this):[]}startWithRelays(){let s=this.filters;if(this.opts.addSinceFromCache&&this.mostRecentCacheEventTimestamp){const $n=this.mostRecentCacheEventTimestamp+1;s=s.map(Dn=>({...Dn,since:Math.max(Dn.since||0,$n)}))}if(!this.relaySet||this.relaySet.relays.size===0)this.relayFilters=calculateRelaySetsFromFilters(this.ndk,s,this.pool,this.opts.relayGoalPerAuthor);else{this.relayFilters=new Map;for(const $n of this.relaySet.relays)this.relayFilters.set($n.url,s)}for(const[$n,Dn]of this.relayFilters)this.pool.getRelay($n,!0,!0,Dn).subscribe(this,Dn)}refreshRelayConnections(){var s,$n;if(this.relaySet&&this.relaySet.relays.size>0)return;const Dn=calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool,this.opts.relayGoalPerAuthor);for(const[Un,Bn]of Dn)(s=this.relayFilters)!=null&&s.has(Un)||(($n=this.relayFilters)==null||$n.set(Un,Bn),this.pool.getRelay(Un,!0,!0,Bn).subscribe(this,Bn))}eventReceived(s,$n,Dn=!1,Un=!1){var Bn,In,qn;const Fn=s.id,Kn=this.eventFirstSeen.has(Fn);let jn;if(s instanceof NDKEvent&&(jn=s),Kn){const Yn=Date.now()-(this.eventFirstSeen.get(Fn)||0);if(this.emit("event:dup",s,$n,Yn,this,Dn,Un),(In=this.opts)!=null&&In.onEventDup&&this.opts.onEventDup(s,$n,Yn,this,Dn,Un),!Dn&&!Un&&$n&&(qn=this.ndk.cacheAdapter)!=null&&qn.setEventDup&&!this.opts.dontSaveToCache&&(jn??(jn=s instanceof NDKEvent?s:new NDKEvent(this.ndk,s)),this.ndk.cacheAdapter.setEventDup(jn,$n)),$n){const Zn=verifiedSignatures.get(Fn);if(Zn&&typeof Zn=="string")if(s.sig===Zn)$n.addValidatedEvent();else{const Xn=s instanceof NDKEvent?s:new NDKEvent(this.ndk,s);this.ndk.reportInvalidSignature(Xn,$n)}}}else{if(jn??(jn=new NDKEvent(this.ndk,s)),jn.ndk=this.ndk,jn.relay=$n,!Dn&&!Un){if(!this.skipValidation&&!jn.isValid){this.debug("Event failed validation %s from relay %s",Fn,$n?.url);return}if($n)if($n.shouldValidateEvent()&&!this.skipVerification)if(jn.relay=$n,this.ndk.asyncSigVerification)jn.verifySignature(!0);else{if(!jn.verifySignature(!0)){this.debug("Event failed signature validation",s),this.ndk.reportInvalidSignature(jn,$n);return}$n.addValidatedEvent()}else $n.addNonValidatedEvent();this.ndk.cacheAdapter&&!this.opts.dontSaveToCache&&this.ndk.cacheAdapter.setEvent(jn,this.filters,$n)}if(!this.opts.includeMuted&&this.ndk.muteFilter&&this.ndk.muteFilter(jn)){this.debug("Event muted, skipping");return}(!Un||this.skipOptimisticPublishEvent!==!0)&&(this.emitEvent(((Bn=this.opts)==null?void 0:Bn.wrap)??!1,jn,$n,Dn,Un),this.eventFirstSeen.set(Fn,Date.now()))}this.lastEventReceivedAt=Date.now()}emitEvent(s,$n,Dn,Un,Bn){const In=s?wrapEvent($n):$n;In instanceof Promise?In.then(qn=>this.emitEvent(!1,qn,Dn,Un,Bn)):In&&this.emit("event",In,Dn,this,Un,Bn)}closedReceived(s,$n){this.emit("closed",s,$n)}eoseReceived(s){var $n;this.debug("EOSE received from %s",s.url),this.eosesSeen.add(s);let Dn=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0;const Un=this.eosesSeen.size===(($n=this.relayFilters)==null?void 0:$n.size),Bn=queryFullyFilled(this),In=qn=>{var Fn;this.debug("Performing EOSE: %s %d",qn,this.eosed),!this.eosed&&(this.eoseTimeout&&clearTimeout(this.eoseTimeout),this.emit("eose",this),this.eosed=!0,(Fn=this.opts)!=null&&Fn.closeOnEose&&this.stop())};if(Bn||Un)In("query filled or seen all");else if(this.relayFilters){let qn=1e3;const Fn=new Set(this.pool.connectedRelays().map(Yn=>Yn.url)),Kn=Array.from(this.relayFilters.keys()).filter(Yn=>Fn.has(Yn));if(Kn.length===0){this.debug("No connected relays, waiting for all relays to connect",Array.from(this.relayFilters.keys()).join(", "));return}const jn=this.eosesSeen.size/Kn.length;if(this.debug("Percentage of relays that have sent EOSE",{subId:this.subId,percentageOfRelaysThatHaveSentEose:jn,seen:this.eosesSeen.size,total:Kn.length}),this.eosesSeen.size>=2&&jn>=.5){if(qn=qn*(1-jn),qn===0){In("time to wait was 0");return}this.eoseTimeout&&clearTimeout(this.eoseTimeout);const Yn=()=>{Dn=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0,Dn!==void 0&&Dn<20?this.eoseTimeout=setTimeout(Yn,qn):In(`send eose timeout: ${qn}`)};this.eoseTimeout=setTimeout(Yn,qn)}}}},kindIsEphemeral=s=>s>=2e4&&s<3e4;async function follows(s,$n,Dn=3){var Un,Bn;if(!this.ndk)throw new Error("NDK not set");const In=await this.ndk.fetchEvent({kinds:[Dn],authors:[this.pubkey]},s||{groupable:!1});if(In){const qn=new Set;return In.tags.forEach(Fn=>{Fn[0]==="p"&&Fn[1]&&isValidPubkey(Fn[1])&&qn.add(Fn[1])}),$n&&((Bn=(Un=this.ndk)==null?void 0:Un.outboxTracker)==null||Bn.trackUsers(Array.from(qn))),[...qn].reduce((Fn,Kn)=>{const jn=new NDKUser({pubkey:Kn});return jn.ndk=this.ndk,Fn.add(jn),Fn},new Set)}return new Set}var NIP05_REGEX=/^(?:([\w.+-]+)@)?([\w.-]+)$/;async function getNip05For(s,$n,Dn=fetch,Un={}){return await s.queuesNip05.add({id:$n,func:async()=>{var Bn,In,qn;if((Bn=s.cacheAdapter)!=null&&Bn.loadNip05){const Zn=await s.cacheAdapter.loadNip05($n);if(Zn!=="missing"){if(Zn){const Xn=new NDKUser({pubkey:Zn.pubkey,relayUrls:Zn.relays,nip46Urls:Zn.nip46});return Xn.ndk=s,Xn}if(Un.cache!=="no-cache")return null}}const Fn=$n.match(NIP05_REGEX);if(!Fn)return null;const[Kn,jn="_",Yn]=Fn;try{const Zn=await Dn(`https://${Yn}/.well-known/nostr.json?name=${jn}`,Un),{names:Xn,relays:Jn,nip46:Wn}=parseNIP05Result(await Zn.json()),tr=Xn[jn.toLowerCase()];let ir=null;return tr&&(ir={pubkey:tr,relays:Jn?.[tr],nip46:Wn?.[tr]}),(In=s?.cacheAdapter)!=null&&In.saveNip05&&s.cacheAdapter.saveNip05($n,ir),ir}catch(Zn){return(qn=s?.cacheAdapter)!=null&&qn.saveNip05&&s?.cacheAdapter.saveNip05($n,null),console.error("Failed to fetch NIP05 for",$n,Zn),null}}})}function parseNIP05Result(s){const $n={names:{}};for(const[Dn,Un]of Object.entries(s.names))typeof Dn=="string"&&typeof Un=="string"&&($n.names[Dn.toLowerCase()]=Un);if(s.relays){$n.relays={};for(const[Dn,Un]of Object.entries(s.relays))typeof Dn=="string"&&Array.isArray(Un)&&($n.relays[Dn]=Un.filter(Bn=>typeof Bn=="string"))}if(s.nip46){$n.nip46={};for(const[Dn,Un]of Object.entries(s.nip46))typeof Dn=="string"&&Array.isArray(Un)&&($n.nip46[Dn]=Un.filter(Bn=>typeof Bn=="string"))}return $n}function profileFromEvent(s){const $n={};let Dn;try{Dn=JSON.parse(s.content)}catch(Un){throw new Error(`Failed to parse profile event: ${Un}`)}$n.profileEvent=JSON.stringify(s.rawEvent());for(const Un of Object.keys(Dn))switch(Un){case"name":$n.name=Dn.name;break;case"display_name":$n.displayName=Dn.display_name;break;case"image":case"picture":$n.picture=Dn.picture||Dn.image,$n.image=$n.picture;break;case"banner":$n.banner=Dn.banner;break;case"bio":$n.bio=Dn.bio;break;case"nip05":$n.nip05=Dn.nip05;break;case"lud06":$n.lud06=Dn.lud06;break;case"lud16":$n.lud16=Dn.lud16;break;case"about":$n.about=Dn.about;break;case"website":$n.website=Dn.website;break;default:$n[Un]=Dn[Un];break}return $n.created_at=s.created_at,$n}function serializeProfile(s){const $n={};for(const[Dn,Un]of Object.entries(s))switch(Dn){case"username":case"name":$n.name=Un;break;case"displayName":$n.display_name=Un;break;case"image":case"picture":$n.picture=Un;break;case"bio":case"about":$n.about=Un;break;default:$n[Dn]=Un;break}return JSON.stringify($n)}var NDKUser=class Ym{constructor($n){if(g$3(this,"ndk"),g$3(this,"profile"),g$3(this,"profileEvent"),g$3(this,"_npub"),g$3(this,"_pubkey"),g$3(this,"relayUrls",[]),g$3(this,"nip46Urls",[]),g$3(this,"follows",follows.bind(this)),$n.npub&&(this._npub=$n.npub),$n.hexpubkey&&(this._pubkey=$n.hexpubkey),$n.pubkey&&(this._pubkey=$n.pubkey),$n.relayUrls&&(this.relayUrls=$n.relayUrls),$n.nip46Urls&&(this.nip46Urls=$n.nip46Urls),$n.nprofile)try{const Dn=nip19_exports$1.decode($n.nprofile);Dn.type==="nprofile"&&(this._pubkey=Dn.data.pubkey,Dn.data.relays&&Dn.data.relays.length>0&&this.relayUrls.push(...Dn.data.relays))}catch(Dn){console.error("Failed to decode nprofile",Dn)}}get npub(){if(!this._npub){if(!this._pubkey)throw new Error("pubkey not set");this._npub=nip19_exports$1.npubEncode(this.pubkey)}return this._npub}get nprofile(){var $n,Dn;const Un=(Dn=($n=this.profileEvent)==null?void 0:$n.onRelays)==null?void 0:Dn.map(Bn=>Bn.url);return nip19_exports$1.nprofileEncode({pubkey:this.pubkey,relays:Un})}set npub($n){this._npub=$n}get pubkey(){if(!this._pubkey){if(!this._npub)throw new Error("npub not set");this._pubkey=nip19_exports$1.decode(this.npub).data}return this._pubkey}set pubkey($n){this._pubkey=$n}filter(){return{"#p":[this.pubkey]}}async getZapInfo($n){if(!this.ndk)throw new Error("No NDK instance found");const Dn=async qn=>{if(!$n)return qn;let Fn;const Kn=new Promise((jn,Yn)=>{Fn=setTimeout(()=>Yn(new Error("Timeout")),$n)});try{const jn=await Promise.race([qn,Kn]);return Fn&&clearTimeout(Fn),jn}catch(jn){if(jn instanceof Error&&jn.message==="Timeout")try{return await qn}catch{return}return}},[Un,Bn]=await Promise.all([Dn(this.fetchProfile()),Dn(this.ndk.fetchEvent({kinds:[10019],authors:[this.pubkey]}))]),In=new Map;if(Bn){const qn=NDKCashuMintList.from(Bn);qn.mints.length>0&&In.set("nip61",{mints:qn.mints,relays:qn.relays,p2pk:qn.p2pk})}if(Un){const{lud06:qn,lud16:Fn}=Un;In.set("nip57",{lud06:qn,lud16:Fn})}return In}static async fromNip05($n,Dn,Un=!1){if(!Dn)throw new Error("No NDK instance found");const Bn={};Un&&(Bn.cache="no-cache");const In=await getNip05For(Dn,$n,Dn?.httpFetch,Bn);if(In){const qn=new Ym({pubkey:In.pubkey,relayUrls:In.relays,nip46Urls:In.nip46});return qn.ndk=Dn,qn}}async fetchProfile($n,Dn=!1){if(!this.ndk)throw new Error("NDK not set");let Un=null;if(this.ndk.cacheAdapter&&(this.ndk.cacheAdapter.fetchProfile||this.ndk.cacheAdapter.fetchProfileSync)&&$n?.cacheUsage!=="ONLY_RELAY"){let Bn=null;if(this.ndk.cacheAdapter.fetchProfileSync?Bn=this.ndk.cacheAdapter.fetchProfileSync(this.pubkey):this.ndk.cacheAdapter.fetchProfile&&(Bn=await this.ndk.cacheAdapter.fetchProfile(this.pubkey)),Bn)return this.profile=Bn,Bn}return $n??($n={}),$n.cacheUsage??($n.cacheUsage="ONLY_RELAY"),$n.closeOnEose??($n.closeOnEose=!0),$n.groupable??($n.groupable=!0),$n.groupableDelay??($n.groupableDelay=250),Un||(Un=await this.ndk.fetchEvent({kinds:[0],authors:[this.pubkey]},$n)),Un?(this.profile=profileFromEvent(Un),Dn&&this.profile&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.saveProfile&&this.ndk.cacheAdapter.saveProfile(this.pubkey,this.profile),this.profile):null}async followSet($n,Dn,Un=3){const Bn=await this.follows($n,Dn,Un);return new Set(Array.from(Bn).map(In=>In.pubkey))}tagReference(){return["p",this.pubkey]}referenceTags($n){const Dn=[["p",this.pubkey]];return $n&&Dn[0].push("",$n),Dn}async publish(){if(!this.ndk)throw new Error("No NDK instance found");if(!this.profile)throw new Error("No profile available");this.ndk.assertSigner(),await new NDKEvent(this.ndk,{kind:0,content:serializeProfile(this.profile)}).publish()}async follow($n,Dn,Un=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),Dn||(Dn=await this.follows(void 0,void 0,Un));const Bn=typeof $n=="string"?$n:$n.pubkey;if(Array.from(Dn).some(qn=>typeof qn=="string"?qn===Bn:qn.pubkey===Bn))return!1;Dn.add($n);const In=new NDKEvent(this.ndk,{kind:Un});for(const qn of Dn)typeof qn=="string"?In.tags.push(["p",qn]):In.tag(qn);return await In.publish(),!0}async unfollow($n,Dn,Un=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),Dn||(Dn=await this.follows(void 0,void 0,Un));const Bn=typeof $n=="string"?$n:$n.pubkey,In=new Set;let qn=!1;for(const Kn of Dn)(typeof Kn=="string"?Kn:Kn.pubkey)!==Bn?In.add(Kn):qn=!0;if(!qn)return!1;const Fn=new NDKEvent(this.ndk,{kind:Un});for(const Kn of In)typeof Kn=="string"?Fn.tags.push(["p",Kn]):Fn.tag(Kn);return await Fn.publish()}async validateNip05($n){if(!this.ndk)throw new Error("No NDK instance found");const Dn=await getNip05For(this.ndk,$n);return Dn===null?null:Dn.pubkey===this.pubkey}},signerRegistry=new Map;function registerSigner(s,$n){signerRegistry.set(s,$n)}var NDKPrivateKeySigner=class Bu{constructor($n,Dn){if(g$3(this,"_user"),g$3(this,"_privateKey"),g$3(this,"_pubkey"),typeof $n=="string")if($n.startsWith("nsec1")){const{type:Un,data:Bn}=nip19_exports$1.decode($n);if(Un==="nsec")this._privateKey=Bn;else throw new Error("Invalid private key provided.")}else if($n.length===64)this._privateKey=hexToBytes($n);else throw new Error("Invalid private key provided.");else this._privateKey=$n;this._pubkey=getPublicKey(this._privateKey),Dn&&(this._user=Dn.getUser({pubkey:this._pubkey})),this._user??(this._user=new NDKUser({pubkey:this._pubkey}))}get privateKey(){if(!this._privateKey)throw new Error("Not ready");return bytesToHex(this._privateKey)}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}get nsec(){if(!this._privateKey)throw new Error("Not ready");return nip19_exports$1.nsecEncode(this._privateKey)}get npub(){if(!this._pubkey)throw new Error("Not ready");return nip19_exports$1.npubEncode(this._pubkey)}encryptToNcryptsec($n,Dn=16,Un=2){if(!this._privateKey)throw new Error("Private key not available");return encrypt$1(this._privateKey,$n,Dn,Un)}static generate(){const $n=generateSecretKey();return new Bu($n)}static fromNcryptsec($n,Dn,Un){const Bn=decrypt$1($n,Dn);return new Bu(Bn,Un)}async blockUntilReady(){return this._user}async user(){return this._user}get userSync(){return this._user}async sign($n){if(!this._privateKey)throw Error("Attempted to sign without a private key");return finalizeEvent($n,this._privateKey).sig}async encryptionEnabled($n){const Dn=[];return(!$n||$n==="nip04")&&Dn.push("nip04"),(!$n||$n==="nip44")&&Dn.push("nip44"),Dn}async encrypt($n,Dn,Un){if(!this._privateKey||!this.privateKey)throw Error("Attempted to encrypt without a private key");const Bn=$n.pubkey;if(Un==="nip44"){const In=nip44_exports.v2.utils.getConversationKey(this._privateKey,Bn);return await nip44_exports.v2.encrypt(Dn,In)}return await nip04_exports.encrypt(this._privateKey,Bn,Dn)}async decrypt($n,Dn,Un){if(!this._privateKey||!this.privateKey)throw Error("Attempted to decrypt without a private key");const Bn=$n.pubkey;if(Un==="nip44"){const In=nip44_exports.v2.utils.getConversationKey(this._privateKey,Bn);return await nip44_exports.v2.decrypt(Dn,In)}return await nip04_exports.decrypt(this._privateKey,Bn,Dn)}toPayload(){if(!this._privateKey)throw new Error("Private key not available");const $n={type:"private-key",payload:this.privateKey};return JSON.stringify($n)}static async fromPayload($n,Dn){const Un=JSON.parse($n);if(Un.type!=="private-key")throw new Error(`Invalid payload type: expected 'private-key', got ${Un.type}`);if(!Un.payload||typeof Un.payload!="string")throw new Error("Invalid payload content for private-key signer");return new Bu(Un.payload,Dn)}};registerSigner("private-key",NDKPrivateKeySigner);function dedup(s,$n){return s.created_at>$n.created_at?s:$n}async function getRelayListForUser(s,$n){return(await getRelayListForUsers([s],$n)).get(s)}async function getRelayListForUsers(s,$n,Dn=!1,Un=1e3,Bn){var In;const qn=$n.outboxPool||$n.pool,Fn=new Set;for(const Jn of qn.relays.values())Fn.add(Jn);if(Bn)for(const Jn of Bn.values())for(const Wn of Jn){const tr=qn.getRelay(Wn,!0,!0);tr&&Fn.add(tr)}const Kn=new Map,jn=new Map,Yn=new NDKRelaySet(Fn,$n);if((In=$n.cacheAdapter)!=null&&In.locking&&!Dn){const Jn=await $n.fetchEvents({kinds:[3,10002],authors:Array.from(new Set(s))},{cacheUsage:"ONLY_CACHE",subId:"ndk-relay-list-fetch"});for(const Wn of Jn)Wn.kind===10002&&Kn.set(Wn.pubkey,NDKRelayList.from(Wn));for(const Wn of Jn)if(Wn.kind===3){if(Kn.has(Wn.pubkey))continue;const tr=relayListFromKind3($n,Wn);tr&&jn.set(Wn.pubkey,tr)}s=s.filter(Wn=>!Kn.has(Wn)&&!jn.has(Wn))}if(s.length===0)return Kn;const Zn=new Map,Xn=new Map;return new Promise(Jn=>{let Wn=!1;(async()=>{const tr={closeOnEose:!0,pool:qn,groupable:!0,subId:"ndk-relay-list-fetch",addSinceFromCache:!0,relaySet:Yn};Yn&&(tr.relaySet=Yn),$n.subscribe({kinds:[3,10002],authors:s},tr,{onEvent:ur=>{if(ur.kind===10002){const br=Zn.get(ur.pubkey);if(br&&br.created_at>ur.created_at)return;Zn.set(ur.pubkey,ur)}else if(ur.kind===3){const br=Xn.get(ur.pubkey);if(br&&br.created_at>ur.created_at)return;Xn.set(ur.pubkey,ur)}},onEose:()=>{if(!Wn){Wn=!0,$n.debug(`[getRelayListForUsers] EOSE - relayListEvents: ${Zn.size}, contactListEvents: ${Xn.size}`);for(const ur of Zn.values())Kn.set(ur.pubkey,NDKRelayList.from(ur));for(const ur of s){if(Kn.has(ur))continue;const br=Xn.get(ur);if(!br)continue;const Nr=relayListFromKind3($n,br);Nr&&Kn.set(ur,Nr)}$n.debug(`[getRelayListForUsers] Returning ${Kn.size} relay lists for ${s.length} pubkeys`),Jn(Kn)}}});const ir=Array.from(Fn).some(ur=>ur.status<=2),sr=Array.from(Fn).some(ur=>ur.status===4);let fr=Un;(ir||sr)&&(fr=Un+3e3),$n.debug(`[getRelayListForUsers] Setting fallback timeout to ${fr}ms (disconnected: ${ir}, connecting: ${sr})`,{pubkeys:s}),setTimeout(()=>{Wn||(Wn=!0,$n.debug(`[getRelayListForUsers] Timeout reached, returning ${Kn.size} relay lists`),Jn(Kn))},fr)})()})}var OutboxItem=class{constructor(s){g$3(this,"type"),g$3(this,"relayUrlScores"),g$3(this,"readRelays"),g$3(this,"writeRelays"),this.type=s,this.relayUrlScores=new Map,this.readRelays=new Set,this.writeRelays=new Set}},OutboxTracker=class extends lib$1.EventEmitter{constructor(s){super(),g$3(this,"data"),g$3(this,"ndk"),g$3(this,"debug"),this.ndk=s,this.debug=s.debug.extend("outbox-tracker"),this.data=new dist.LRUCache({maxSize:1e5,entryExpirationTimeInMS:120*1e3})}async trackUsers(s,$n=!1){const Dn=[];for(let Un=0;Un<s.length;Un+=400){const Bn=s.slice(Un,Un+400),In=Bn.map(Fn=>getKeyFromItem(Fn)).filter(Fn=>!this.data.has(Fn));if(In.length===0)continue;for(const Fn of In)this.data.set(Fn,new OutboxItem("user"));const qn=new Map;for(const Fn of Bn)Fn instanceof NDKUser&&Fn.relayUrls.length>0&&qn.set(Fn.pubkey,Fn.relayUrls);Dn.push(new Promise(Fn=>{getRelayListForUsers(In,this.ndk,$n,1e3,qn).then(Kn=>{this.debug(`Received relay lists for ${Kn.size} pubkeys out of ${In.length} requested`);for(const[jn,Yn]of Kn){let Zn=this.data.get(jn);if(Zn??(Zn=new OutboxItem("user")),Yn){if(Zn.readRelays=new Set(normalize(Yn.readRelayUrls)),Zn.writeRelays=new Set(normalize(Yn.writeRelayUrls)),this.ndk.relayConnectionFilter){for(const Xn of Zn.readRelays)this.ndk.relayConnectionFilter(Xn)||Zn.readRelays.delete(Xn);for(const Xn of Zn.writeRelays)this.ndk.relayConnectionFilter(Xn)||Zn.writeRelays.delete(Xn)}this.data.set(jn,Zn),this.emit("user:relay-list-updated",jn,Zn),this.debug(`Adding ${Zn.readRelays.size} read relays and ${Zn.writeRelays.size} write relays for ${jn}`,Yn?.rawEvent())}}}).finally(Fn)}))}return Promise.all(Dn)}track(s,$n,Dn=!0){const Un=getKeyFromItem(s);$n??($n=getTypeFromItem(s));let Bn=this.data.get(Un);return Bn||(Bn=new OutboxItem($n),s instanceof NDKUser&&this.trackUsers([s])),Bn}};function getKeyFromItem(s){return s instanceof NDKUser?s.pubkey:s}function getTypeFromItem(s){return s instanceof NDKUser?"user":"kind"}function correctRelaySet(s,$n){const Dn=$n.connectedRelays();if(!Array.from(s.relays).some(Un=>Dn.map(Bn=>Bn.url).includes(Un.url)))for(const Un of Dn)s.addRelay(Un);if(Dn.length===0)for(const Un of $n.relays.values())s.addRelay(Un);return s}var NDKSubscriptionManager=class{constructor(){g$3(this,"subscriptions"),g$3(this,"seenEvents",new dist.LRUCache({maxSize:1e4,entryExpirationTimeInMS:300*1e3})),this.subscriptions=new Map}add(s){this.subscriptions.set(s.internalId,s),s.onStopped,s.onStopped=()=>{this.subscriptions.delete(s.internalId)},s.on("close",()=>{this.subscriptions.delete(s.internalId)})}seenEvent(s,$n){const Dn=this.seenEvents.get(s)||[];Dn.some(Un=>Un.url===$n.url)||Dn.push($n),this.seenEvents.set(s,Dn)}dispatchEvent(s,$n,Dn=!1){$n&&this.seenEvent(s.id,$n);const Un=this.subscriptions.values(),Bn=[];for(const In of Un)matchFilters(In.filters,s)&&Bn.push(In);for(const In of Bn){if(In.exclusiveRelay&&In.relaySet){let qn=!1;if(Dn?qn=!In.skipOptimisticPublishEvent:$n?qn=In.relaySet.relays.has($n):qn=(this.seenEvents.get(s.id)||[]).some(Fn=>In.relaySet.relays.has(Fn)),!qn){In.debug.extend("exclusive-relay")("Rejected event %s from %s (relay not in exclusive set)",s.id,$n?.url||(Dn?"optimistic":"cache"));continue}}In.eventReceived(s,$n,!1,Dn)}}},debug6=createDebug5("ndk:active-user");async function getUserRelayList(s){if(!this.autoConnectUserRelays)return;const $n=await getRelayListForUser(s.pubkey,this);if($n){for(const Dn of $n.relays){let Un=this.pool.relays.get(Dn);Un||(Un=new NDKRelay(Dn,this.relayAuthDefaultPolicy,this),this.pool.addRelay(Un))}return debug6("Connected to %d user relays",$n.relays.length),$n}}async function setActiveUser(s){if(!this.autoConnectUserRelays)return;const $n=this.outboxPool||this.pool;$n.connectedRelays.length>0?await getUserRelayList.call(this,s):$n.once("connect",async()=>{await getUserRelayList.call(this,s)})}function getEntity(s){try{const $n=nip19_exports$1.decode(s);return $n.type==="npub"?npub(this,$n.data):$n.type==="nprofile"?nprofile(this,$n.data):$n}catch{return null}}function npub(s,$n){return s.getUser({pubkey:$n})}function nprofile(s,$n){const Dn=s.getUser({pubkey:$n.pubkey});return $n.relays&&(Dn.relayUrls=$n.relays),Dn}function isValidHint(s){if(!s||s==="")return!1;try{return new URL(s),!0}catch{return!1}}async function fetchEventFromTag(s,$n,Dn,Un={type:"timeout"}){const Bn=this.debug.extend("fetch-event-from-tag"),[In,qn,Fn]=s;Dn={},Bn("fetching event from tag",s,Dn,Un);const Kn=getRelaysForSync(this,$n.pubkey);if(Kn&&Kn.size>0){Bn("fetching event from author relays %o",Array.from(Kn));const tr=NDKRelaySet.fromRelayUrls(Array.from(Kn),this),ir=await this.fetchEvent(qn,Dn,tr);if(ir)return ir}else Bn("no author relays found for %s",$n.pubkey,$n);const jn=calculateRelaySetsFromFilters(this,[{ids:[qn]}],this.pool);Bn("fetching event without relay hint",jn);const Yn=await this.fetchEvent(qn,Dn);if(Yn)return Yn;if(Fn&&Fn!==""){const tr=await this.fetchEvent(qn,Dn,this.pool.getRelay(Fn,!0,!0,[{ids:[qn]}]));if(tr)return tr}let Zn;const Xn=isValidHint(Fn)?this.pool.getRelay(Fn,!1,!0,[{ids:[qn]}]):void 0,Jn=new Promise(tr=>{this.fetchEvent(qn,Dn,Xn).then(tr)});if(!isValidHint(Fn)||Un.type==="none")return Jn;const Wn=new Promise(async tr=>{const ir=Un.relaySet,sr=Un.timeout??1500,fr=new Promise(ur=>setTimeout(ur,sr));if(Un.type==="timeout"&&await fr,Zn)tr(Zn);else{Bn("fallback fetch triggered");const ur=await this.fetchEvent(qn,Dn,ir);tr(ur)}});switch(Un.type){case"timeout":return Promise.race([Jn,Wn]);case"eose":return Zn=await Jn,Zn||Wn}}var Queue=class{constructor(s,$n){g$3(this,"queue",[]),g$3(this,"maxConcurrency"),g$3(this,"processing",new Set),g$3(this,"promises",new Map),this.maxConcurrency=$n}add(s){if(this.promises.has(s.id))return this.promises.get(s.id);const $n=new Promise((Dn,Un)=>{this.queue.push({...s,func:()=>s.func().then(Bn=>(Dn(Bn),Bn),Bn=>{throw Un(Bn),Bn})}),this.process()});return this.promises.set(s.id,$n),$n.finally(()=>{this.promises.delete(s.id),this.processing.delete(s.id),this.process()}),$n}process(){if(this.processing.size>=this.maxConcurrency||this.queue.length===0)return;const s=this.queue.shift();!s||this.processing.has(s.id)||(this.processing.add(s.id),s.func())}clear(){this.queue=[]}clearProcessing(){this.processing.clear()}clearAll(){this.clear(),this.clearProcessing()}length(){return this.queue.length}},DEFAULT_OUTBOX_RELAYS=["wss://purplepag.es/","wss://nos.lol/"],NDK=class extends lib$1.EventEmitter{constructor(s={}){super(),g$3(this,"_explicitRelayUrls"),g$3(this,"pool"),g$3(this,"outboxPool"),g$3(this,"_signer"),g$3(this,"_activeUser"),g$3(this,"cacheAdapter"),g$3(this,"debug"),g$3(this,"devWriteRelaySet"),g$3(this,"outboxTracker"),g$3(this,"muteFilter"),g$3(this,"relayConnectionFilter"),g$3(this,"clientName"),g$3(this,"clientNip89"),g$3(this,"queuesZapConfig"),g$3(this,"queuesNip05"),g$3(this,"asyncSigVerification",!1),g$3(this,"initialValidationRatio",1),g$3(this,"lowestValidationRatio",.1),g$3(this,"validationRatioFn"),g$3(this,"filterValidationMode","validate"),g$3(this,"subManager"),g$3(this,"aiGuardrails"),g$3(this,"_signatureVerificationFunction"),g$3(this,"_signatureVerificationWorker"),g$3(this,"signatureVerificationTimeMs",0),g$3(this,"publishingFailureHandled",!1),g$3(this,"pools",[]),g$3(this,"relayAuthDefaultPolicy"),g$3(this,"httpFetch"),g$3(this,"netDebug"),g$3(this,"autoConnectUserRelays",!0),g$3(this,"_wallet"),g$3(this,"walletConfig"),g$3(this,"fetchEventFromTag",fetchEventFromTag.bind(this)),g$3(this,"getEntity",getEntity.bind(this)),this.debug=s.debug||createDebug5("ndk"),this.netDebug=s.netDebug,this._explicitRelayUrls=s.explicitRelayUrls||[],this.subManager=new NDKSubscriptionManager,this.pool=new NDKPool(s.explicitRelayUrls||[],this),this.pool.name="Main",this.pool.on("relay:auth",async($n,Dn)=>{this.relayAuthDefaultPolicy&&await this.relayAuthDefaultPolicy($n,Dn)}),this.autoConnectUserRelays=s.autoConnectUserRelays??!0,this.clientName=s.clientName,this.clientNip89=s.clientNip89,this.relayAuthDefaultPolicy=s.relayAuthDefaultPolicy,s.enableOutboxModel!==!1&&(this.outboxPool=new NDKPool(s.outboxRelayUrls||DEFAULT_OUTBOX_RELAYS,this,{debug:this.debug.extend("outbox-pool"),name:"Outbox Pool"}),this.outboxTracker=new OutboxTracker(this),this.outboxTracker.on("user:relay-list-updated",($n,Dn)=>{this.debug(`Outbox relay list updated for ${$n}`);for(const Un of this.subManager.subscriptions.values())Un.filters.some(Bn=>{var In;return(In=Bn.authors)==null?void 0:In.includes($n)})&&typeof Un.refreshRelayConnections=="function"&&(this.debug(`Refreshing relay connections for subscription ${Un.internalId}`),Un.refreshRelayConnections())})),this.signer=s.signer,this.cacheAdapter=s.cacheAdapter,this.muteFilter=s.muteFilter,this.relayConnectionFilter=s.relayConnectionFilter,s.devWriteRelayUrls&&(this.devWriteRelaySet=NDKRelaySet.fromRelayUrls(s.devWriteRelayUrls,this)),this.queuesZapConfig=new Queue("zaps",3),this.queuesNip05=new Queue("nip05",10),s.signatureVerificationWorker&&(this.signatureVerificationWorker=s.signatureVerificationWorker),s.signatureVerificationFunction&&(this.signatureVerificationFunction=s.signatureVerificationFunction),this.initialValidationRatio=s.initialValidationRatio||1,this.lowestValidationRatio=s.lowestValidationRatio||.1,this.validationRatioFn=s.validationRatioFn||this.defaultValidationRatioFn,this.filterValidationMode=s.filterValidationMode||"validate",this.aiGuardrails=new AIGuardrails(s.aiGuardrails||!1),this.aiGuardrails.ndkInstantiated(this);try{this.httpFetch=fetch}catch{}}set explicitRelayUrls(s){this._explicitRelayUrls=s.map(normalizeRelayUrl),this.pool.relayUrls=s}get explicitRelayUrls(){return this._explicitRelayUrls||[]}set signatureVerificationWorker(s){this._signatureVerificationWorker=s,s?(signatureVerificationInit(s),this.asyncSigVerification=!0):this.asyncSigVerification=!1}set signatureVerificationFunction(s){this._signatureVerificationFunction=s,this.asyncSigVerification=!!s}get signatureVerificationFunction(){return this._signatureVerificationFunction}addExplicitRelay(s,$n,Dn=!0){var Un;let Bn;return typeof s=="string"?Bn=new NDKRelay(s,$n,this):Bn=s,this.pool.addRelay(Bn,Dn),(Un=this.explicitRelayUrls)==null||Un.push(Bn.url),Bn}toJSON(){return{relayCount:this.pool.relays.size}.toString()}get activeUser(){return this._activeUser}set activeUser(s){var $n;const Dn=(($n=this._activeUser)==null?void 0:$n.pubkey)!==s?.pubkey;this._activeUser=s,Dn&&this.emit("activeUser:change",s),s&&Dn&&setActiveUser.call(this,s)}get signer(){return this._signer}set signer(s){this._signer=s,s&&this.emit("signer:ready",s),s?.user().then($n=>{$n.ndk=this,this.activeUser=$n})}async connect(s){var $n,Dn,Un;this._signer&&this.autoConnectUserRelays&&(this.debug("Attempting to connect to user relays specified by signer %o",await((Dn=($n=this._signer).relays)==null?void 0:Dn.call($n,this))),this._signer.relays&&(await this._signer.relays(this)).forEach(In=>this.pool.addRelay(In)));const Bn=[this.pool.connect(s)];return this.outboxPool&&Bn.push(this.outboxPool.connect(s)),(Un=this.cacheAdapter)!=null&&Un.initializeAsync&&Bn.push(this.cacheAdapter.initializeAsync(this)),Promise.allSettled(Bn).then(()=>{})}reportInvalidSignature(s,$n){this.debug(`Invalid signature detected for event ${s.id}${$n?` from relay ${$n.url}`:""}`),this.emit("event:invalid-sig",s,$n)}defaultValidationRatioFn(s,$n,Dn){if($n<10)return this.initialValidationRatio;const Un=Math.min($n/100,1),Bn=this.initialValidationRatio*(1-Un)+this.lowestValidationRatio*Un;return Math.max(Bn,this.lowestValidationRatio)}getUser(s){if(typeof s=="string")if(s.startsWith("npub1")){const{type:Dn,data:Un}=nip19_exports$1.decode(s);if(Dn!=="npub")throw new Error(`Invalid npub: ${s}`);return this.getUser({pubkey:Un})}else if(s.startsWith("nprofile1")){const{type:Dn,data:Un}=nip19_exports$1.decode(s);if(Dn!=="nprofile")throw new Error(`Invalid nprofile: ${s}`);return this.getUser({pubkey:Un.pubkey,relayUrls:Un.relays})}else return this.getUser({pubkey:s});const $n=new NDKUser(s);return $n.ndk=this,$n}async getUserFromNip05(s,$n=!1){return NDKUser.fromNip05(s,this,$n)}async fetchUser(s,$n=!1){if(isValidNip05(s))return NDKUser.fromNip05(s,this,$n);if(s.startsWith("npub1")){const{type:Dn,data:Un}=nip19_exports$1.decode(s);if(Dn!=="npub")throw new Error(`Invalid npub: ${s}`);const Bn=new NDKUser({pubkey:Un});return Bn.ndk=this,Bn}else if(s.startsWith("nprofile1")){const{type:Dn,data:Un}=nip19_exports$1.decode(s);if(Dn!=="nprofile")throw new Error(`Invalid nprofile: ${s}`);const Bn=new NDKUser({pubkey:Un.pubkey,relayUrls:Un.relays});return Bn.ndk=this,Bn}else{const Dn=new NDKUser({pubkey:s});return Dn.ndk=this,Dn}}subscribe(s,$n,Dn=!0,Un=!0){var Bn,In,qn;let Fn=$n?.relaySet,Kn=Un;Dn instanceof NDKRelaySet?(console.warn("relaySet is deprecated, use opts.relaySet instead. This will be removed in version v2.14.0"),Fn=Dn,Kn=Un):(typeof Dn=="boolean"||typeof Dn=="object")&&(Kn=Dn);let jn;const Yn={relaySet:Fn,...$n};Kn&&typeof Kn=="object"&&(Kn.onEvent&&(Yn.onEvent=Kn.onEvent),Kn.onEose&&(Yn.onEose=Kn.onEose),Kn.onClose&&(Yn.onClose=Kn.onClose),Kn.onEvents&&(jn=Kn.onEvents));const Zn=new NDKSubscription(this,s,Yn);this.subManager.add(Zn),(In=(Bn=this.aiGuardrails)==null?void 0:Bn.subscription)==null||In.created(Array.isArray(s)?s:[s],Yn);const Xn=Zn.pool;if(Zn.relaySet)for(const Jn of Zn.relaySet.relays)Xn.useTemporaryRelay(Jn,void 0,Zn.filters);if(this.outboxPool&&Zn.hasAuthorsFilter()){const Jn=Zn.filters.filter(Wn=>{var tr;return Wn.authors&&((tr=Wn.authors)==null?void 0:tr.length)>0}).flatMap(Wn=>Wn.authors);(qn=this.outboxTracker)==null||qn.trackUsers(Jn)}return Kn&&setTimeout(async()=>{var Jn;(Jn=this.cacheAdapter)!=null&&Jn.initializeAsync&&!this.cacheAdapter.ready&&await this.cacheAdapter.initializeAsync(this);const Wn=Zn.start(!jn);Wn&&Wn.length>0&&jn&&jn(Wn)},0),Zn}fetchEventSync(s){if(!this.cacheAdapter)throw new Error("Cache adapter not set");let $n;typeof s=="string"?$n=[filterFromId(s)]:$n=s;const Dn=new NDKSubscription(this,$n),Un=this.cacheAdapter.query(Dn);if(Un instanceof Promise)throw new Error("Cache adapter is async");return Un.map(Bn=>(Bn.ndk=this,Bn))}async fetchEvent(s,$n,Dn){var Un,Bn;let In,qn;if(Dn instanceof NDKRelay?qn=new NDKRelaySet(new Set([Dn]),this):Dn instanceof NDKRelaySet&&(qn=Dn),!Dn&&typeof s=="string"&&!isNip33AValue(s)){const Fn=relaysFromBech32(s,this);Fn.length>0&&(qn=new NDKRelaySet(new Set(Fn),this),qn=correctRelaySet(qn,this.pool))}if(typeof s=="string"?In=[filterFromId(s)]:Array.isArray(s)?In=s:In=[s],typeof s!="string"&&((Bn=(Un=this.aiGuardrails)==null?void 0:Un.ndk)==null||Bn.fetchingEvents(In)),In.length===0)throw new Error(`Invalid filter: ${JSON.stringify(s)}`);return new Promise((Fn,Kn)=>{let jn=null;const Yn={...$n||{},closeOnEose:!0};qn&&(Yn.relaySet=qn);const Zn=setTimeout(()=>{Xn.stop(),this.aiGuardrails._nextCallDisabled=null,Fn(jn)},1e4),Xn=this.subscribe(In,Yn,{onEvent:Jn=>{Jn.ndk=this,Jn.isReplaceable()?(!jn||jn.created_at<Jn.created_at)&&(jn=Jn):(clearTimeout(Zn),this.aiGuardrails._nextCallDisabled=null,Fn(Jn))},onEose:()=>{clearTimeout(Zn),this.aiGuardrails._nextCallDisabled=null,Fn(jn)}})})}async fetchEvents(s,$n,Dn){var Un,Bn;return(Bn=(Un=this.aiGuardrails)==null?void 0:Un.ndk)==null||Bn.fetchingEvents(s,$n),new Promise(In=>{const qn=new Map,Fn={...$n||{},closeOnEose:!0};Dn&&(Fn.relaySet=Dn);const Kn=jn=>{let Yn;jn instanceof NDKEvent?Yn=jn:Yn=new NDKEvent(void 0,jn);const Zn=Yn.deduplicationKey(),Xn=qn.get(Zn);Xn&&(Yn=dedup(Xn,Yn)),Yn.ndk=this,qn.set(Zn,Yn)};this.subscribe(s,{...Fn,onEvent:Kn,onEose:()=>{this.aiGuardrails._nextCallDisabled=null,In(new Set(qn.values()))}})})}assertSigner(){if(!this.signer)throw this.emit("signer:required"),new Error("Signer required")}guardrailOff(s){return s?typeof s=="string"?this.aiGuardrails._nextCallDisabled=new Set([s]):this.aiGuardrails._nextCallDisabled=new Set(s):this.aiGuardrails._nextCallDisabled="all",this}set wallet(s){var $n,Dn;if(!s){this._wallet=void 0,this.walletConfig=void 0;return}this._wallet=s,this.walletConfig??(this.walletConfig={}),this.walletConfig.lnPay=($n=s?.lnPay)==null?void 0:$n.bind(s),this.walletConfig.cashuPay=(Dn=s?.cashuPay)==null?void 0:Dn.bind(s)}get wallet(){return this._wallet}},nip19_exports={};__reExport(nip19_exports,nip19_star);var nip49_exports={};__reExport(nip49_exports,nip49_star);function disconnect(s,$n){return $n??($n=createDebug5("ndk:relay:auth-policies:disconnect")),async Dn=>{$n?.(`Relay ${Dn.url} requested authentication, disconnecting`),s.removeRelay(Dn.url)}}async function signAndAuth(s,$n,Dn,Un,Bn,In){try{await s.sign(Dn),Bn(s)}catch(qn){Un?.(`Failed to publish auth event to relay ${$n.url}`,qn),In(s)}}function signIn({ndk:s,signer:$n,debug:Dn}={}){return Dn??(Dn=createDebug5("ndk:auth-policies:signIn")),async(Un,Bn)=>{Dn?.(`Relay ${Un.url} requested authentication, signing in`);const In=new NDKEvent(s);return In.kind=22242,In.tags=[["relay",Un.url],["challenge",Bn]],$n??($n=s?.signer),new Promise(async(qn,Fn)=>{$n?await signAndAuth(In,Un,$n,Dn,qn,Fn):s?.once("signer:ready",async Kn=>{await signAndAuth(In,Un,Kn,Dn,qn,Fn)})})}}var NDKRelayAuthPolicies={disconnect,signIn};async function ndkSignerFromPayload(s,$n){let Dn;try{Dn=JSON.parse(s)}catch(Bn){console.error("Failed to parse signer payload string",s,Bn);return}if(!Dn||typeof Dn.type!="string"){console.error("Failed to parse signer payload string",s,new Error("Missing type field"));return}const Un=signerRegistry.get(Dn.type);if(!Un)throw new Error(`Unknown signer type: ${Dn.type}`);try{return await Un.fromPayload(s,$n)}catch(Bn){const In=Bn instanceof Error?Bn.message:String(Bn);throw new Error(`Failed to deserialize signer type ${Dn.type}: ${In}`)}}var NDKNip07Signer=class Zm{constructor($n=1e3,Dn){g$3(this,"_userPromise"),g$3(this,"encryptionQueue",[]),g$3(this,"encryptionProcessing",!1),g$3(this,"debug"),g$3(this,"waitTimeout"),g$3(this,"_pubkey"),g$3(this,"ndk"),g$3(this,"_user"),this.debug=createDebug5("ndk:nip07"),this.waitTimeout=$n,this.ndk=Dn}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}async blockUntilReady(){var $n;await this.waitForExtension();const Dn=await(($n=window.nostr)==null?void 0:$n.getPublicKey());if(!Dn)throw new Error("User rejected access");this._pubkey=Dn;let Un;return this.ndk?Un=this.ndk.getUser({pubkey:Dn}):Un=new NDKUser({pubkey:Dn}),this._user=Un,Un}async user(){return this._userPromise||(this._userPromise=this.blockUntilReady()),this._userPromise}get userSync(){if(!this._user)throw new Error("User not ready");return this._user}async sign($n){var Dn;await this.waitForExtension();const Un=await((Dn=window.nostr)==null?void 0:Dn.signEvent($n));if(!Un)throw new Error("Failed to sign event");return Un.sig}async relays($n){var Dn,Un;await this.waitForExtension();const Bn=await((Un=(Dn=window.nostr)==null?void 0:Dn.getRelays)==null?void 0:Un.call(Dn))||{},In=[];for(const qn of Object.keys(Bn))Bn[qn].read&&Bn[qn].write&&In.push(qn);return In.map(qn=>new NDKRelay(qn,$n?.relayAuthDefaultPolicy,$n))}async encryptionEnabled($n){var Dn,Un;const Bn=[];return(!$n||$n==="nip04")&&(Dn=window.nostr)!=null&&Dn.nip04&&Bn.push("nip04"),(!$n||$n==="nip44")&&(Un=window.nostr)!=null&&Un.nip44&&Bn.push("nip44"),Bn}async encrypt($n,Dn,Un="nip04"){if(!await this.encryptionEnabled(Un))throw new Error(`${Un}encryption is not available from your browser extension`);await this.waitForExtension();const Bn=$n.pubkey;return this.queueEncryption(Un,"encrypt",Bn,Dn)}async decrypt($n,Dn,Un="nip04"){if(!await this.encryptionEnabled(Un))throw new Error(`${Un}encryption is not available from your browser extension`);await this.waitForExtension();const Bn=$n.pubkey;return this.queueEncryption(Un,"decrypt",Bn,Dn)}async queueEncryption($n,Dn,Un,Bn){return new Promise((In,qn)=>{this.encryptionQueue.push({scheme:$n,method:Dn,counterpartyHexpubkey:Un,value:Bn,resolve:In,reject:qn}),this.encryptionProcessing||this.processEncryptionQueue()})}async processEncryptionQueue($n,Dn=0){var Un,Bn;if(!$n&&this.encryptionQueue.length===0){this.encryptionProcessing=!1;return}this.encryptionProcessing=!0;const In=$n||this.encryptionQueue.shift();if(!In){this.encryptionProcessing=!1;return}const{scheme:qn,method:Fn,counterpartyHexpubkey:Kn,value:jn,resolve:Yn,reject:Zn}=In;this.debug("Processing encryption queue item",{method:Fn,counterpartyHexpubkey:Kn,value:jn});try{const Xn=await((Bn=(Un=window.nostr)==null?void 0:Un[qn])==null?void 0:Bn[Fn](Kn,jn));if(!Xn)throw new Error("Failed to encrypt/decrypt");Yn(Xn)}catch(Xn){const Jn=Xn instanceof Error?Xn.message:String(Xn);if(Jn.includes("call already executing")&&Dn<5){this.debug("Retrying encryption queue item",{method:Fn,counterpartyHexpubkey:Kn,value:jn,retries:Dn}),setTimeout(()=>{this.processEncryptionQueue(In,Dn+1)},50*Dn);return}Zn(Xn instanceof Error?Xn:new Error(Jn))}this.processEncryptionQueue()}waitForExtension(){return new Promise(($n,Dn)=>{if(window.nostr){$n();return}let Un;const Bn=setInterval(()=>{window.nostr&&(clearTimeout(Un),clearInterval(Bn),$n())},100);Un=setTimeout(()=>{clearInterval(Bn),Dn(new Error("NIP-07 extension not available"))},this.waitTimeout)})}toPayload(){return JSON.stringify({type:"nip07",payload:""})}static async fromPayload($n,Dn){const Un=JSON.parse($n);if(Un.type!=="nip07")throw new Error(`Invalid payload type: expected 'nip07', got ${Un.type}`);return new Zm(void 0,Dn)}};registerSigner("nip07",NDKNip07Signer);var NDKNostrRpc=class extends lib$1.EventEmitter{constructor(s,$n,Dn,Un){if(super(),g$3(this,"ndk"),g$3(this,"signer"),g$3(this,"relaySet"),g$3(this,"debug"),g$3(this,"encryptionType","nip04"),g$3(this,"pool"),this.ndk=s,this.signer=$n,Un){this.pool=new NDKPool(Un,s,{debug:Dn.extend("rpc-pool"),name:"Nostr RPC"}),this.relaySet=new NDKRelaySet(new Set,s,this.pool);for(const Bn of Un){const In=this.pool.getRelay(Bn,!1,!1);In.authPolicy=NDKRelayAuthPolicies.signIn({ndk:s,signer:$n,debug:Dn}),this.relaySet.addRelay(In),In.connect()}}this.debug=Dn.extend("rpc")}subscribe(s){return new Promise($n=>{const Dn=this.ndk.subscribe(s,{closeOnEose:!1,groupable:!1,cacheUsage:"ONLY_RELAY",pool:this.pool,relaySet:this.relaySet,onEvent:async Un=>{try{const Bn=await this.parseEvent(Un);Bn.method?this.emit("request",Bn):(this.emit(`response-${Bn.id}`,Bn),this.emit("response",Bn))}catch(Bn){this.debug("error parsing event",Bn,Un.rawEvent())}},onEose:()=>{this.debug("eosed"),$n(Dn)}})})}async parseEvent(s){this.encryptionType==="nip44"&&s.content.includes("?iv=")?this.encryptionType="nip04":this.encryptionType==="nip04"&&!s.content.includes("?iv=")&&(this.encryptionType="nip44");const $n=this.ndk.getUser({pubkey:s.pubkey});$n.ndk=this.ndk;let Dn;try{Dn=await this.signer.decrypt($n,s.content,this.encryptionType)}catch{const jn=this.encryptionType==="nip04"?"nip44":"nip04";Dn=await this.signer.decrypt($n,s.content,jn),this.encryptionType=jn}const Un=JSON.parse(Dn),{id:Bn,method:In,params:qn,result:Fn,error:Kn}=Un;return In?{id:Bn,pubkey:s.pubkey,method:In,params:qn,event:s}:{id:Bn,result:Fn,error:Kn,event:s}}async sendResponse(s,$n,Dn,Un=24133,Bn){const In={id:s,result:Dn};Bn&&(In.error=Bn);const qn=await this.signer.user(),Fn=this.ndk.getUser({pubkey:$n}),Kn=new NDKEvent(this.ndk,{kind:Un,content:JSON.stringify(In),tags:[["p",$n]],pubkey:qn.pubkey});Kn.content=await this.signer.encrypt(Fn,Kn.content,this.encryptionType),await Kn.sign(this.signer),await Kn.publish(this.relaySet)}async sendRequest(s,$n,Dn=[],Un=24133,Bn){const In=Math.random().toString(36).substring(7),qn=await this.signer.user(),Fn=this.ndk.getUser({pubkey:s}),Kn={id:In,method:$n,params:Dn},jn=new Promise(()=>{const Zn=Xn=>{Xn.result==="auth_url"?(this.once(`response-${In}`,Zn),this.emit("authUrl",Xn.error)):Bn&&Bn(Xn)};this.once(`response-${In}`,Zn)}),Yn=new NDKEvent(this.ndk,{kind:Un,content:JSON.stringify(Kn),tags:[["p",s]],pubkey:qn.pubkey});return Yn.content=await this.signer.encrypt(Fn,Yn.content,this.encryptionType),await Yn.sign(this.signer),await Yn.publish(this.relaySet),jn}};function nostrConnectGenerateSecret(){return Math.random().toString(36).substring(2,15)}function generateNostrConnectUri(s,$n,Dn,Un){const Bn={name:Un!=null&&Un.name?encodeURIComponent(Un.name):"",url:Un!=null&&Un.url?encodeURIComponent(Un.url):"",image:Un!=null&&Un.image?encodeURIComponent(Un.image):"",perms:Un!=null&&Un.perms?encodeURIComponent(Un.perms):""};let In=`nostrconnect://${s}?image=${Bn.image}&url=${Bn.url}&name=${Bn.name}&perms=${Bn.perms}&secret=${encodeURIComponent($n)}`;return Dn&&(In+=`&relay=${encodeURIComponent(Dn)}`),In}var NDKNip46Signer=class Ku extends lib$1.EventEmitter{constructor($n,Dn,Un,Bn,In){super(),g$3(this,"ndk"),g$3(this,"_user"),g$3(this,"bunkerPubkey"),g$3(this,"userPubkey"),g$3(this,"secret"),g$3(this,"localSigner"),g$3(this,"nip05"),g$3(this,"rpc"),g$3(this,"debug"),g$3(this,"relayUrls"),g$3(this,"subscription"),g$3(this,"nostrConnectUri"),g$3(this,"nostrConnectSecret"),this.ndk=$n,this.debug=$n.debug.extend("nip46:signer"),this.relayUrls=Bn,Un?typeof Un=="string"?this.localSigner=new NDKPrivateKeySigner(Un):this.localSigner=Un:this.localSigner=NDKPrivateKeySigner.generate(),Dn===!1||(Dn?Dn.startsWith("bunker://")?this.bunkerFlowInit(Dn):this.nip05Init(Dn):this.nostrconnectFlowInit(In)),this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls)}get pubkey(){if(!this.userPubkey)throw new Error("Not ready");return this.userPubkey}static bunker($n,Dn,Un){return new Ku($n,Dn,Un)}static nostrconnect($n,Dn,Un,Bn){return new Ku($n,void 0,Un,[Dn],Bn)}nostrconnectFlowInit($n){var Dn;this.nostrConnectSecret=nostrConnectGenerateSecret();const Un=this.localSigner.pubkey;this.nostrConnectUri=generateNostrConnectUri(Un,this.nostrConnectSecret,(Dn=this.relayUrls)==null?void 0:Dn[0],$n)}bunkerFlowInit($n){const Dn=new URL($n),Un=Dn.hostname||Dn.pathname.replace(/^\/\//,""),Bn=Dn.searchParams.get("pubkey"),In=Dn.searchParams.getAll("relay"),qn=Dn.searchParams.get("secret");this.bunkerPubkey=Un,this.userPubkey=Bn,this.relayUrls=In,this.secret=qn}nip05Init($n){this.nip05=$n}async startListening(){if(this.subscription)return;const $n=await this.localSigner.user();if(!$n)throw new Error("Local signer not ready");this.subscription=await this.rpc.subscribe({kinds:[24133],"#p":[$n.pubkey]})}async user(){return this._user?this._user:this.blockUntilReady()}get userSync(){if(!this._user)throw new Error("Remote user not ready synchronously");return this._user}async blockUntilReadyNostrConnect(){return new Promise(($n,Dn)=>{const Un=Bn=>{Bn.result===this.nostrConnectSecret&&(this._user=Bn.event.author,this.userPubkey=Bn.event.pubkey,this.bunkerPubkey=Bn.event.pubkey,this.rpc.off("response",Un),$n(this._user))};this.startListening(),this.rpc.on("response",Un)})}async blockUntilReady(){if(!this.bunkerPubkey&&!this.nostrConnectSecret&&!this.nip05)throw new Error("Bunker pubkey not set");if(this.nostrConnectSecret)return this.blockUntilReadyNostrConnect();if(this.nip05&&!this.userPubkey){const $n=await NDKUser.fromNip05(this.nip05,this.ndk);$n&&(this._user=$n,this.userPubkey=$n.pubkey,this.relayUrls=$n.nip46Urls,this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls))}if(!this.bunkerPubkey&&this.userPubkey)this.bunkerPubkey=this.userPubkey;else if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");return await this.startListening(),this.rpc.on("authUrl",(...$n)=>{this.emit("authUrl",...$n)}),new Promise(($n,Dn)=>{const Un=[this.userPubkey??""];if(this.secret&&Un.push(this.secret),!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"connect",Un,24133,Bn=>{Bn.result==="ack"?this.getPublicKey().then(In=>{this.userPubkey=In,this._user=this.ndk.getUser({pubkey:In}),$n(this._user)}):Dn(Bn.error)})})}stop(){var $n;($n=this.subscription)==null||$n.stop(),this.subscription=void 0}async getPublicKey(){return this.userPubkey?this.userPubkey:new Promise(($n,Dn)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"get_public_key",[],24133,Un=>{$n(Un.result)})})}async encryptionEnabled($n){return $n?[$n]:Promise.resolve(["nip04","nip44"])}async encrypt($n,Dn,Un="nip04"){return this.encryption($n,Dn,Un,"encrypt")}async decrypt($n,Dn,Un="nip04"){return this.encryption($n,Dn,Un,"decrypt")}async encryption($n,Dn,Un,Bn){return new Promise((In,qn)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,`${Un}_${Bn}`,[$n.pubkey,Dn],24133,Fn=>{Fn.error?qn(Fn.error):In(Fn.result)})})}async sign($n){return new Promise((Dn,Un)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"sign_event",[JSON.stringify($n)],24133,Bn=>{if(Bn.error)Un(Bn.error);else{const In=JSON.parse(Bn.result);Dn(In.sig)}})})}async createAccount($n,Dn,Un){await this.startListening();const Bn=[];return $n&&Bn.push($n),Dn&&Bn.push(Dn),Un&&Bn.push(Un),new Promise((In,qn)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"create_account",Bn,24133,Fn=>{if(Fn.error)qn(Fn.error);else{const Kn=Fn.result;In(Kn)}})})}toPayload(){if(!this.bunkerPubkey||!this.userPubkey)throw new Error("NIP-46 signer is not fully initialized for serialization");const $n={type:"nip46",payload:{bunkerPubkey:this.bunkerPubkey,userPubkey:this.userPubkey,relayUrls:this.relayUrls,secret:this.secret,localSignerPayload:this.localSigner.toPayload(),nip05:this.nip05||null}};return JSON.stringify($n)}static async fromPayload($n,Dn){if(!Dn)throw new Error("NDK instance is required to deserialize NIP-46 signer");const Un=JSON.parse($n);if(Un.type!=="nip46")throw new Error(`Invalid payload type: expected 'nip46', got ${Un.type}`);const Bn=Un.payload;if(!Bn||typeof Bn!="object"||!Bn.localSignerPayload)throw new Error("Invalid payload content for nip46 signer");const In=await ndkSignerFromPayload(Bn.localSignerPayload,Dn);if(!In)throw new Error("Failed to deserialize local signer for NIP-46");if(!(In instanceof NDKPrivateKeySigner))throw new Error("Local signer must be an instance of NDKPrivateKeySigner");let qn;return qn=new Ku(Dn,!1,In,Bn.relayUrls),qn.userPubkey=Bn.userPubkey,qn.bunkerPubkey=Bn.bunkerPubkey,qn.relayUrls=Bn.relayUrls,qn.secret=Bn.secret,Bn.userPubkey&&(qn._user=new NDKUser({pubkey:Bn.userPubkey}),qn._user&&(qn._user.ndk=Dn)),qn}};registerSigner("nip46",NDKNip46Signer);createDebug5("ndk:zapper:ln");createDebug5("ndk:zapper");const index=Object.freeze(Object.defineProperty({__proto__:null,BECH32_REGEX,NDKAppHandlerEvent,NDKArticle,NDKBlossomList,NDKCashuMintAnnouncement,NDKCashuMintList,NDKClassified,NDKDVMJobFeedback,NDKDraft,NDKEvent,NDKFedimintMint,NDKFollowPack,NDKHighlight,NDKImage,NDKKind,NDKList,NDKMintRecommendation,NDKNip07Signer,NDKNip46Signer,NDKNostrRpc,NDKNutzap,NDKPool,NDKPrivateKeySigner,NDKProject,NDKProjectTemplate,NDKPublishError,NDKRelay,NDKRelayAuthPolicies,NDKRelayList,NDKRelaySet,NDKRepost,NDKSimpleGroupMemberList,NDKSimpleGroupMetadata,NDKStory,NDKStorySticker,NDKSubscription,NDKSubscriptionReceipt,NDKSubscriptionStart,NDKSubscriptionTier,NDKTask,NDKThread,NDKUser,NDKVideo,NDKWiki,NDKWikiMergeRequest,NIP33_A_REGEX,calculateRelaySetFromEvent,default:NDK,defaultOpts,deserialize,eventHasETagMarkers,fetchRelayInformation,filterFingerprint,filterFromId,generateContentTags,generateHashtags,getRelayListForUser,getRelayListForUsers,getReplyTag,getRootTag,imetaTagToTag,isNip33AValue,isValidHex64,isValidNip05,isValidPubkey,mapImetaTag,mergeFilters,mergeTags,ndkSignerFromPayload,newAmount,nip19:nip19_exports,nip49:nip49_exports,normalize,normalizeRelayUrl,normalizeUrl,parseTagToSubscriptionAmount,possibleIntervalFrequencies,processFilters,profileFromEvent,queryFullyFilled,registerSigner,relayListFromKind3,relaysFromBech32,serialize,serializeProfile,strToDimension,strToPosition,tryNormalizeRelayUrl,wrapEvent},Symbol.toStringTag,{value:"Module"})),DEFAULT_RELAYS=["wss://relay.damus.io","wss://nostr.wine","wss://relay.nostr.net","wss://nos.lol","wss://nostr-pub.wellorder.net","wss://relay.getalby.com","wss://relay.primal.net"],MILLISATS_PER_SAT=1e3,DEFAULT_PROFILE_IMAGE="./assets/default_dp.png",xe$2=class Ml{constructor(){g$3(this,"ndk"),g$3(this,"isConnected",!1),this.ndk=new NDK}static getInstance(){return Ml.instance||(Ml.instance=new Ml),Ml.instance}async connectToNostr($n=[...DEFAULT_RELAYS]){const Dn=$n.filter(Un=>!this.getRelays().includes(Un));if(this.isConnected&&Dn.length){Dn.forEach(Un=>this.ndk.addExplicitRelay(Un));return}this.ndk.explicitRelayUrls=$n,await this.ndk.connect(),this.isConnected=!0}getRelays(){return this.ndk.explicitRelayUrls||DEFAULT_RELAYS}async resolveNDKUser($n){return $n.npub?this.ndk.getUser({npub:$n.npub}):$n.nip05?await this.ndk.getUserFromNip05($n.nip05)??null:$n.pubkey?this.ndk.getUser({pubkey:$n.pubkey}):null}async resolveNDKEvent($n){return $n.hex?this.ndk.fetchEvent($n.hex):null}async getZapCount($n){const Dn=await this.resolveNDKUser($n);return Dn?this.fetchZaps(Dn):0}async getProfile($n){if(!$n)return null;await $n.fetchProfile();const Dn=$n.profile;return Dn&&(Dn.picture===void 0||Dn.picture===null)&&(Dn.picture=DEFAULT_PROFILE_IMAGE),Dn}async getPost($n){const Dn=await this.ndk.fetchEvent($n);if(!Dn)return null;const Un=Dn.getMatchingTags("e");if(Un.length>0){const In=Un.map(qn=>qn[1]);await this.ndk.fetchEvents({ids:In})}const Bn=Dn.getMatchingTags("a");for(const In of Bn){const qn=In[1],Fn=In[2];qn!=null&&qn.startsWith("video/")&&Fn&&(Dn.content=Dn.content+`
${Fn}`)}return Dn}async fetchFollows($n){try{return(await $n.followSet()).size}catch{return 0}}async fetchFollowers($n){try{const Dn=await this.ndk.fetchEvents({kinds:[NDKKind.Contacts],"#p":[$n.pubkey]}),Un=new Set;return Dn.forEach(Bn=>Un.add(Bn.pubkey)),Un.size}catch{return 0}}async fetchNotesAndReplies($n){try{const Dn=await this.ndk.fetchEvents({kinds:[NDKKind.Text],authors:[$n.pubkey],limit:1e3});let Un=0,Bn=0;Dn.forEach(qn=>{qn&&(qn.tags.some(Fn=>Fn[0]==="e"&&Fn[3]!=="mention")&&Un++,Bn++)});const In=Un;return[Math.max(0,Bn-Un),In]}catch{return[0,0]}}async fetchZaps($n){try{return(await this.ndk.fetchEvents({kinds:[9735],"#p":[$n.pubkey],limit:1e3})).size}catch{return 0}}getNDK(){return this.ndk}hasSigner(){return typeof window<"u"&&window.nostr||typeof window<"u"&&typeof localStorage<"u"&&localStorage.getItem("nostr_nsec")?!0:!!this.ndk.signer}};g$3(xe$2,"instance");let NostrService=xe$2;const nostrServiceCA0Qx4nJ=Object.freeze(Object.defineProperty({__proto__:null,D:DEFAULT_PROFILE_IMAGE,M:MILLISATS_PER_SAT,N:NDKNip07Signer,S:SimplePool,a:nip19_exports$1,b:NostrService,c:DEFAULT_RELAYS,d:NDKEvent,e:NDKKind,f:bytesToHex$2,g:sha256$2,h:nip57_exports,i:finalizeEvent,j:index$1,k:index,n:nip21_exports,s:schnorr$1},Symbol.toStringTag,{value:"Module"}));var w$3=Object.defineProperty,k$2=(s,$n,Dn)=>$n in s?w$3(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,c$4=(s,$n,Dn)=>k$2(s,typeof $n!="symbol"?$n+"":$n,Dn);const I$6=s=>{if(typeof s!="string"||!s.startsWith("npub1"))return"";try{const $n=nip19_exports$1.decode(s);if($n&&typeof $n.data=="string")return $n.data}catch($n){console.error("Failed to decode npub:",$n)}return""};function M$4(s){if(!s||!S$3(s))return"";try{return nip19_exports$1.npubEncode(s.toLowerCase())}catch($n){return console.error("Failed to encode hex to npub:",$n),""}}function O$5(s="",$n=3){const Dn=s.length;if(!s.startsWith("npub1"))return"Invalid nPub: expected npub1...";if(!N$5(s))return"Invalid nPub";let Un="npub1";for(let In=5;In<$n+5;In++)Un+=s[In];Un+="...";let Bn="";for(let In=Dn-1;In>=Dn-$n;In--)Bn=s[In]+Bn;return Un+=Bn,Un}async function z$5(s,$n){const Dn=await s.fetchEvents({kinds:[NDKKind.Repost],"#e":[$n||""]}),Un=Yn=>Yn.tags.filter(Zn=>Zn[0]==="p").length===1,Bn=Yn=>Yn.tags.filter(Zn=>Zn[0]==="e").length===1,In=Array.from(Dn).filter(Un).length,qn=await s.fetchEvents({kinds:[NDKKind.Reaction],"#e":[$n||""]}),Fn=0,Kn=await s.fetchEvents({kinds:[NDKKind.Text],"#e":[$n||""]}),jn=Array.from(Kn).filter(Bn).length;return{likes:qn.size,reposts:In,zaps:Fn/MILLISATS_PER_SAT,replies:jn}}function C$3(s){if(s){const $n=s.split(",").map(Dn=>Dn.trim()).filter(Boolean).filter(y$3);return $n.length?Array.from(new Set($n)):[...DEFAULT_RELAYS]}return[...DEFAULT_RELAYS]}function L$6(s){const $n=s?.trim().toLowerCase();return $n==="light"||$n==="dark"?$n:"light"}function P$4(s){return s===null?!1:s===""||s.toLowerCase()==="true"}function B(s){const $n=document.createElement("div");return $n.textContent=s,$n.innerHTML}function F$4(s){try{const $n=new URL(s);return["http:","https:"].includes($n.protocol)}catch{return!1}}function y$3(s){try{const $n=new URL(s);return $n.protocol==="wss:"||$n.protocol==="ws:"}catch{return!1}}function S$3(s){return/^[0-9a-fA-F]+$/.test(s)&&s.length===64}function N$5(s){try{const{type:$n}=nip19_exports$1.decode(s);return $n==="npub"}catch{return!1}}function j$3(s){return/^[a-zA-Z0-9_\-\.]+@[a-zA-Z0-9_\-\.]+\.[a-zA-Z]{2,}$/.test(s)}function b$1(s,$n){try{const{type:Dn}=nip19_exports$1.decode(s);return Dn===$n}catch{return!1}}function U$3(s){return b$1(s,"note")}function D$5(s){return b$1(s,"nevent")}function H$4(s){return navigator.clipboard.writeText(s)}function q$2(s){try{const $n=Date.now(),Dn=s*1e3,Un=$n-Dn,Bn=Math.floor(Un/1e3);if(Bn<60)return"just now";if(Bn<3600){const qn=Math.floor(Bn/60);return`${qn} ${qn===1?"min":"mins"} ago`}if(Bn<86400){const qn=Math.floor(Bn/3600);return`${qn} ${qn===1?"hour":"hours"} ago`}if(Bn<2592e3){const qn=Math.floor(Bn/86400);return`${qn} ${qn===1?"day":"days"} ago`}if(Bn<31536e3){const qn=Math.floor(Bn/2592e3);return`${qn} ${qn===1?"month":"months"} ago`}const In=Math.floor(Bn/31536e3);return`${In} ${In===1?"year":"years"} ago`}catch($n){return console.error("Error formatting relative time:",$n),"unknown"}}var f$2=(s=>(s[s.Idle=0]="Idle",s[s.Loading=1]="Loading",s[s.Ready=2]="Ready",s[s.Error=3]="Error",s))(f$2||{});const $$5="nc:status";let K$3=class extends HTMLElement{constructor($n=!0){super(),c$4(this,"nostrService",NostrService.getInstance()),c$4(this,"theme","light"),c$4(this,"errorMessage",""),c$4(this,"nostrReady"),c$4(this,"nostrReadyResolve"),c$4(this,"nostrReadyReject"),c$4(this,"conn",this.channel("connection")),c$4(this,"_statuses",new Map),c$4(this,"_overall",0),c$4(this,"connectSeq",0),$n&&this.attachShadow({mode:"open"}),this.resetNostrReadyBarrier()}static get observedAttributes(){return["data-theme","relays"]}connectedCallback(){this.validateInputs()&&(this.getTheme(),this.conn.get()===0&&this.connectToNostr())}disconnectedCallback(){this.shadowRoot&&this._delegated&&this._delegated.clear()}attributeChangedCallback($n,Dn,Un){Dn!==Un&&($n==="data-theme"||$n==="relays")&&this.validateInputs()&&($n==="relays"&&(this.resetNostrReadyBarrier(),this.connectToNostr()),$n==="data-theme"&&(this.getTheme(),this.render()))}setStatusFor($n,Dn,Un){const Bn=this._statuses.get($n);if(!(Bn!==Dn||Dn===3&&Un))return;this._statuses.set($n,Dn),Dn===3&&Un?this.errorMessage=Un:Bn===3&&Dn!==3&&(this.errorMessage="");const In=`${$n}-status`,qn=f$2[Dn].toLowerCase();this.getAttribute(In)!==qn&&this.setAttribute(In,qn);const Fn=this.computeOverall(),Kn=f$2[Fn].toLowerCase();this._overall!==Fn?(this._overall=Fn,this.setAttribute("status",Kn),this.onStatusChange(Fn)):Fn===3&&Un&&this.onStatusChange(Fn),this.dispatchEvent(new CustomEvent($$5,{detail:{key:$n,status:Dn,all:this.snapshotStatuses(),overall:this._overall,errorMessage:this.errorMessage||void 0},bubbles:!0,composed:!0}))}getStatusFor($n){return this._statuses.get($n)??0}snapshotStatuses(){return Object.fromEntries(this._statuses.entries())}onStatusChange($n){}onNostrRelaysConnected(){}computeOverall(){const $n=[...this._statuses.values()];return $n.includes(3)?3:$n.includes(1)?1:$n.includes(2)?2:0}initChannelStatus($n,Dn,Un={reflectOverall:!1}){if(this._statuses.set($n,Dn),this.setAttribute(`${$n}-status`,f$2[Dn].toLowerCase()),Un.reflectOverall){const Bn=this.computeOverall();this._overall=Bn,this.setAttribute("status",f$2[Bn].toLowerCase())}}channel($n){return{set:(Dn,Un)=>this.setStatusFor($n,Dn,Un),get:()=>this.getStatusFor($n)}}validateInputs(){const $n=this.getAttribute("data-theme")||"light",Dn=this.getAttribute("relays"),Un=this.tagName.toLowerCase();if($n==="light"||$n==="dark"){if(Dn&&typeof Dn!="string")return this.conn.set(3,"Invalid relays list"),console.error(`Nostr-Components: ${Un}: ${this.errorMessage}`),!1;if(Dn){const Bn=Dn.split(",").map(In=>In.trim()).filter(Boolean).filter(In=>!y$3(In));if(Bn.length>0){const In=Bn.join(", ");return this.conn.set(3,`Invalid relay URLs: ${In}. Relay URLs must start with 'wss://' or 'ws://'`),console.error(`Nostr-Components: ${Un}: ${this.errorMessage}`),!1}}}else return this.conn.set(3,`Invalid theme '${$n}'. Accepted values are 'light', 'dark'`),console.error(`Nostr-Components: ${Un}: ${this.errorMessage}`),!1;return this.errorMessage="",!0}async connectToNostr(){var $n,Dn;const Un=++this.connectSeq;this.conn.set(1);try{if(await this.nostrService.connectToNostr(this.getRelays()),Un!==this.connectSeq)return;this.conn.set(2),($n=this.nostrReadyResolve)==null||$n.call(this);try{this.onNostrRelaysConnected()}catch(Bn){console.error("Error in onNostrRelaysConnected hook:",Bn)}}catch(Bn){if(Un!==this.connectSeq)return;console.error("Failed to connect to Nostr relays:",Bn),this.conn.set(3,"Failed to connect to relays"),(Dn=this.nostrReadyReject)==null||Dn.call(this,Bn)}}ensureNostrConnected(){return this.nostrReady}getRelays(){return C$3(this.getAttribute("relays"))}getTheme(){this.theme=L$6(this.getAttribute("data-theme"))}delegateEvent($n,Dn,Un){var Bn;const In=this.shadowRoot;if(!In)return;const qn=`${$n}:${Dn}`;(Bn=this._delegated)!=null&&Bn.has(qn)||(this._delegated||(this._delegated=new Set),this._delegated.add(qn),In.addEventListener($n,Fn=>{Fn.target.closest(Dn)&&Un(Fn)}))}addDelegatedListener($n,Dn,Un){this.delegateEvent($n,Dn,Un)}renderError($n){return`Error: ${$n}`}updateHostClasses(){const $n=this.computeOverall()===1,Dn=this.computeOverall()===3,Un=this.computeOverall()===2;this.classList.remove("is-clickable","is-disabled","is-error"),$n?this.classList.add("is-disabled"):Dn?this.classList.add("is-error"):Un&&this.classList.add("is-clickable")}render(){this.updateHostClasses(),this.renderContent()}handleNjumpClick($n,Dn,Un){if(this.computeOverall()!==2)return;const Bn=new CustomEvent($n,{detail:Dn,bubbles:!0,composed:!0,cancelable:!0});this.dispatchEvent(Bn)&&window.open(`https://njump.me/${Un}`,"_blank","noopener,noreferrer")}resetNostrReadyBarrier(){this.connectSeq++,this.nostrReady=new Promise(($n,Dn)=>{this.nostrReadyResolve=$n,this.nostrReadyReject=Dn})}};function x$4(){return`
      :host {
        /* === GENERIC DESIGN TOKENS === */
        --nostrc-color-background: #ffffff;
        --nostrc-color-hover-background: rgba(0, 0, 0, 0.05);
        --nostrc-color-border: #e0e0e0;
        --nostrc-color-error-background: #ffebee;
        --nostrc-color-error-text: #d32f2f;
        --nostrc-color-error-icon: #d32f2f;
        
        /* === TYPOGRAPHY === */
        --nostrc-font-family-primary: ui-sans-serif, system-ui, sans-serif;
        --nostrc-font-family-mono: monospace;
        --nostrc-font-size-base: 1em;
        --nostrc-font-size-small: 0.8em;
        --nostrc-font-size-large: 1.2em;
        --nostrc-font-weight-normal: 400;
        --nostrc-font-weight-medium: 500;
        --nostrc-font-weight-bold: 700;
        
        /* === SPACING === */
        --nostrc-spacing-xs: 4px;
        --nostrc-spacing-sm: 8px;
        --nostrc-spacing-md: 12px;
        --nostrc-spacing-lg: 16px;
        --nostrc-spacing-xl: 20px;
        
        /* === BORDERS === */
        --nostrc-border-radius-sm: 4px;
        --nostrc-border-radius-md: 8px;
        --nostrc-border-radius-lg: 12px;
        --nostrc-border-radius-full: 50%;
        --nostrc-border-width: 1px;
        
        /* === SKELETON === */
        --nostrc-skeleton-color-min: #f0f0f0;
        --nostrc-skeleton-color-max: #e0e0e0;
        --nostrc-skeleton-duration: 1.5s;
        --nostrc-skeleton-timing-function: linear;
        --nostrc-skeleton-iteration-count: infinite;
        
        /* === TRANSITIONS === */
        --nostrc-transition-duration: 0.2s;
        --nostrc-transition-timing: ease;
      }
      
      :host(.is-disabled) {
        opacity: 0.7;
        cursor: not-allowed;
      }
      
      /* === ESSENTIAL UTILITY STYLES === */
      ${h$4.skeleton()}
      ${h$4.copyButton()}
      ${h$4.textRow()}
      ${h$4.profileName()}
      ${h$4.errorIcon()}
  `}function V$3(s){return`
    <style>
      ${x$4()}
      /* === COMPONENT-SPECIFIC STYLES === */
      ${s}
    </style>
  `}const h$4={error:()=>`
    :host(.is-error) {
      color: var(--nostrc-color-error-text);
    }
  `,skeleton:()=>`
    .skeleton {
      background: linear-gradient(
        90deg,
        var(--nostrc-skeleton-color-min) 0%,
        var(--nostrc-skeleton-color-max) 50%,
        var(--nostrc-skeleton-color-min) 100%
      );
      background-size: 200% 100%;
      animation: skeleton-loading var(--nostrc-skeleton-duration) var(--nostrc-skeleton-timing-function) var(--nostrc-skeleton-iteration-count);
      border-radius: var(--nostrc-border-radius-sm);
      height: 16px;
      margin-bottom: var(--nostrc-spacing-xs);
    }
    
    .skeleton:last-child {
      margin-bottom: 0;
    }
    
    @keyframes skeleton-loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    @media (prefers-reduced-motion: reduce) {
      .skeleton { animation: none; }
    }
  `,copyButton:()=>`
    .nc-copy-btn {
      cursor: pointer;
      opacity: 0.7;
      transition: opacity var(--nostrc-transition-duration) var(--nostrc-transition-timing);
      font-size: 1.5em;
      border: none;
      background: transparent;
      color: var(--nostrc-color-text-muted);
    }
    
    .nc-copy-btn:hover {
      opacity: 1;
    }
    
    .nc-copy-btn.copied {
      color: var(--nostrc-color-accent);
    }
  `,profileName:()=>`
    .nostr-profile-name {
      color: var(--nostrc-theme-text-primary, #333333);
      font-weight: var(--nostrc-font-weight-bold);
      padding-bottom: var(--nostrc-spacing-xs);
    }
  `,textRow:()=>`
    .text-row {
      display: flex;
      align-items: center;
      gap: var(--nostrc-spacing-sm);
      font-size: var(--nostrc-font-size-base);
    }
    
    .text-row.mono {
      font-family: var(--nostrc-font-family-mono);
      font-size: var(--nostrc-font-size-small);
    }
  `,errorIcon:()=>`
    .error-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 48px;
      height: 48px;
      border-radius: var(--nostrc-border-radius-full);
      background-color: var(--nostrc-color-error-background);
      color: var(--nostrc-color-error-icon);
      font-size: 2em;
      margin: auto;
    }
  `};let u$1=class{constructor($n){this.nostrService=$n}validateInputs({npub:$n,pubkey:Dn,nip05:Un}){return!$n&&!Dn&&!Un?"Provide npub, nip05 or pubkey attribute":Dn&&!S$3(Dn)?`Invalid Pubkey: ${Dn}`:Un&&!j$3(Un)?`Invalid Nip05: ${Un}`:$n&&!N$5($n)?`Invalid Npub: ${$n}`:null}async resolveUser({npub:$n,pubkey:Dn,nip05:Un}){const Bn=await this.nostrService.resolveNDKUser({npub:$n,pubkey:Dn,nip05:Un});if(!Bn)throw new Error("Unable to resolve user from provided identifier");const In=await this.nostrService.getProfile(Bn);return{user:Bn,profile:In??null}}};var l$6=Object.defineProperty,p=(s,$n,Dn)=>$n in s?l$6(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,n$1=(s,$n,Dn)=>p(s,typeof $n!="symbol"?$n+"":$n,Dn);const d$3="nc:user";let C$2=class extends K$3{constructor($n=!0){super($n),n$1(this,"user",null),n$1(this,"profile",null),n$1(this,"userStatus",this.channel("user")),n$1(this,"loadSeq",0),n$1(this,"resolver",new u$1(this.nostrService))}static get observedAttributes(){return[...super.observedAttributes,"npub","pubkey","nip05"]}connectedCallback(){var $n;($n=super.connectedCallback)==null||$n.call(this),this.userStatus.get()==f$2.Idle&&this.initChannelStatus("user",f$2.Loading,{reflectOverall:!1}),this.validateInputs()&&this.resolveUserAndProfile().catch(Dn=>{console.error("[NostrUserComponent] init failed:",Dn)})}attributeChangedCallback($n,Dn,Un){var Bn;Dn!==Un&&((Bn=super.attributeChangedCallback)==null||Bn.call(this,$n,Dn,Un),($n==="npub"||$n==="nip05"||$n==="pubkey")&&this.validateInputs()&&this.resolveUserAndProfile())}validateInputs(){if(!super.validateInputs())return this.userStatus.set(f$2.Idle),!1;const $n=this.getAttribute("npub"),Dn=this.getAttribute("pubkey"),Un=this.getAttribute("nip05"),Bn=this.tagName.toLowerCase(),In=this.resolver.validateInputs({npub:$n,pubkey:Dn,nip05:Un});return In?(this.userStatus.set(f$2.Error,In),console.error(`Nostr-Components: ${Bn}: ${In}`),!1):(this.errorMessage="",!0)}async resolveUserAndProfile(){const $n=++this.loadSeq;try{await this.ensureNostrConnected()}catch(Dn){if($n!==this.loadSeq)return;console.error("[NostrUserComponent] Relay connect failed before user/profile load:",Dn);return}this.userStatus.set(f$2.Loading);try{const{user:Dn,profile:Un}=await this.resolver.resolveUser({npub:this.getAttribute("npub"),pubkey:this.getAttribute("pubkey"),nip05:this.getAttribute("nip05")});if($n!==this.loadSeq)return;if(Un==null){this.userStatus.set(f$2.Error,"Profile not found");return}this.user=Dn,this.profile=Un,this.userStatus.set(f$2.Ready),this.dispatchEvent(new CustomEvent(d$3,{detail:{user:this.user,profile:this.profile},bubbles:!0,composed:!0})),this.onUserReady(this.user,this.profile)}catch(Dn){if($n!==this.loadSeq)return;const Un=Dn instanceof Error?Dn.message:"Failed to load user/profile";console.error("[NostrUserComponent] "+Un,Dn),this.userStatus.set(f$2.Error,Un)}}renderContent(){}onUserReady($n,Dn){}};function l$5(s){const{value:$n,display:Dn=$n,className:Un="",monospace:Bn=!1,title:In=Dn,showCopyButton:qn=!1}=s,Fn=Un.replace(/[^\w\- ]/g,""),Kn=B(Dn),jn=B(In),Yn="&#x2398;";if(qn){const Zn=B($n);return`
      <div class="${`text-row nc-copy ${Bn?"mono":""} ${Fn}`.trim()}" data-copy="${Zn}" title="${jn}">
        <span class="nc-copy-text">${Kn}</span>
        <button type="button" 
              class="nc-copy-btn"
              aria-label="Copy"
              title="Copy"
              >${Yn}</button>
      </div>
    `}return`
    <div class="${`text-row ${Bn?"mono":""} ${Fn}`.trim()}" title="${jn}">
      ${Kn}
    </div>
  `}function w$2(s){return l$5({value:s,display:O$5(s),monospace:!0,showCopyButton:!0,title:s})}function v$2(s){return l$5({value:s,display:s,monospace:!0,showCopyButton:!0})}function N$4(s){const{name:$n,className:Dn="",title:Un,showCopyButton:Bn=!1}=s;return l$5({value:$n,display:$n,className:`nostr-profile-name ${Dn}`.trim(),title:Un??$n,showCopyButton:Bn})}function g$2(s){s.addDelegatedListener("click",".nc-copy-btn",async $n=>{var Dn;$n.stopPropagation();const Un=(Dn=$n.target)==null?void 0:Dn.closest(".nc-copy-btn");if(!Un)return;const Bn=Un?.closest(".nc-copy"),In=Bn?.dataset.copy??"";if(In)try{await H$4(In),Un.classList.add("copied");const qn=Un.getAttribute("aria-label")||"Copy";Un.setAttribute("aria-label","Copied!"),setTimeout(()=>{Un.classList.remove("copied"),Un.setAttribute("aria-label",qn)},1200)}catch{}})}function A$1({isLoading:s,isError:$n,errorMessage:Dn,userProfile:Un,ndkUser:Bn,showNpub:In,showFollow:qn}){if(s)return L$5();if($n||Un==null)return S$2(Dn||"");const Fn=Un.displayName||Un.name||O$5(Bn?.npub||""),Kn=B(Fn),jn=B(Un.picture||DEFAULT_PROFILE_IMAGE),Yn=Bn?.npub||"",Zn=Un?.nip05||"",Xn=B(Bn?.pubkey||"");return l$4(`<img src='${jn}' alt='Nostr profile image of ${Kn}' loading="lazy" decoding="async"/>`,`${N$4({name:Fn})}
     ${Un.nip05?v$2(Zn):""}
     ${In===!0?w$2(Yn||""):""}
     ${qn===!0&&Bn!=null&&Bn.pubkey?`<nostr-follow-button pubkey="${Xn}"></nostr-follow-button>`:""}`)}function L$5(){return l$4('<div class="skeleton img-skeleton"></div>',`<div class="skeleton" style="width: 120px;"></div>
     <div class="skeleton" style="width: 160px;"></div>`)}function S$2(s){return l$4('<div class="error-icon">&#9888;</div>',B(s))}function l$4(s,$n){return`
    <div class='nostr-profile-badge-container'>
      <div class='nostr-profile-badge-left-container'>
        ${s}
      </div>
      <div class='nostr-profile-badge-right-container'>
        ${$n}
      </div>
    </div>
  `}function $$4(){return V$3(`
    /* === PROFILE BADGE SPECIFIC CSS VARIABLES === */
    :host {
      --nostrc-profile-badge-bg: var(--nostrc-theme-bg, #ffffff);
      --nostrc-profile-badge-text-primary: var(--nostrc-theme-text-primary, #333333);
      --nostrc-profile-badge-text-secondary: var(--nostrc-theme-text-secondary, #666666);
      --nostrc-profile-badge-border: var(--nostrc-theme-border, var(--nostrc-color-border));
      --nostrc-profile-badge-font-family: var(--nostrc-font-family-primary);
      --nostrc-profile-badge-font-size: var(--nostrc-font-size-base);
      
      /* Hover state variables */
      --nostrc-profile-badge-hover-bg: var(--nostrc-theme-hover-bg, rgba(0, 0, 0, 0.05));
      --nostrc-profile-badge-hover-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-profile-badge-hover-border: var(--nostrc-border-width) solid var(--nostrc-theme-border, var(--nostrc-color-border));

      /* Make the host the visual profile badge surface */
      display: block;
      background: var(--nostrc-profile-badge-bg);
      border: var(--nostrc-border-width) solid var(--nostrc-profile-badge-border);
      border-radius: var(--nostrc-border-radius-md);
      font-family: var(--nostrc-profile-badge-font-family);
      font-size: var(--nostrc-profile-badge-font-size);
      transition: background-color var(--nostrc-transition-duration) var(--nostrc-transition-timing);
    }
    
    /* === PROFILE BADGE CONTAINER PATTERN === */
    .nostr-profile-badge-container {
      display: flex;
      gap: var(--nostrc-spacing-md);
      padding: var(--nostrc-spacing-md);
    }

    /* Hover state */
    :host(.is-clickable:hover) {
      background: var(--nostrc-profile-badge-hover-bg);
      color: var(--nostrc-profile-badge-hover-color);
      border: var(--nostrc-profile-badge-hover-border);
    }

    :host(.is-error) .nostr-profile-badge-container {
      justify-content: center;
      align-items: center;
      color: var(--nostrc-color-error-text);
      border: var(--nostrc-border-width) solid var(--nostrc-color-error-text);
    }
    
    .nostr-profile-badge-left-container {
      width: 48px;
      height: 48px;
    }
    
    .nostr-profile-badge-left-container img {
      width: 100%;
      height: 100%;
      border-radius: var(--nostrc-border-radius-full);
      object-fit: cover;
    }
    
    .nostr-profile-badge-right-container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      flex-grow: 1;
      min-width: 0;
    }
    
    /* Profile badge specific styling using component variables */
    .nostr-profile-badge-container .nostr-profile-name {
      color: var(--nostrc-profile-badge-text-primary);
    }
    
    .nostr-profile-badge-container .text-row {
      color: var(--nostrc-profile-badge-text-secondary);
    }
    
    /* Skeleton specific styles */
    .img-skeleton {
      width: 48px;
      height: 48px;
      border-radius: var(--nostrc-border-radius-full);
    }
    
  `)}const D$4="nc:profile_badge";let I$5=class extends C$2{static get observedAttributes(){return[...super.observedAttributes,"show-npub","show-follow"]}connectedCallback(){var $n;($n=super.connectedCallback)==null||$n.call(this),this.attachDelegatedListeners(),g$2({addDelegatedListener:this.addDelegatedListener.bind(this)}),this.render()}attributeChangedCallback($n,Dn,Un){var Bn;Dn!==Un&&((Bn=super.attributeChangedCallback)==null||Bn.call(this,$n,Dn,Un),($n==="show-npub"||$n==="show-follow")&&this.render())}onStatusChange($n){this.render()}onUserReady($n,Dn){this.render()}onProfileClick(){var $n,Dn;const Un=(($n=this.user)==null?void 0:$n.npub)||this.getAttribute("npub")||((Dn=this.profile)==null?void 0:Dn.nip05)||this.getAttribute("nip05");Un&&this.handleNjumpClick(D$4,this.profile,encodeURIComponent(Un))}attachDelegatedListeners(){this.delegateEvent("click",".nostr-profile-badge-container",$n=>{$n.target.closest(".nc-copy-btn, .nostr-follow-button-container, nostr-follow-button")||this.onProfileClick()})}renderContent(){const $n=this.computeOverall(),Dn=$n===f$2.Loading,Un=$n===f$2.Error,Bn=P$4(this.getAttribute("show-follow")),In=P$4(this.getAttribute("show-npub")),qn=Un?super.renderError(this.errorMessage):"",Fn={isLoading:Dn,isError:Un,errorMessage:qn,userProfile:this.profile,ndkUser:this.user,showNpub:In,showFollow:Bn};this.shadowRoot.innerHTML=`
      ${$$4()}
      ${A$1(Fn)}
    `}};customElements.get("nostr-profile-badge")||customElements.define("nostr-profile-badge",I$5);const t$1=`
  <svg width="18" height="18" fill="#00b3ff">
    <path xmlns="http://www.w3.org/2000/svg" d="M12.2197 1.65717C7.73973 1.25408 5.14439 0.940234 3.12891 2.6623C0.948817 4.52502 0.63207 7.66213 2.35603 9.88052C3.01043 10.7226 4.28767 11.9877 5.51513 13.1462C6.75696 14.3184 7.99593 15.426 8.60692 15.9671C8.61074 15.9705 8.61463 15.9739 8.61859 15.9774C8.67603 16.0283 8.74753 16.0917 8.81608 16.1433C8.89816 16.2052 9.01599 16.2819 9.17334 16.3288C9.38253 16.3912 9.60738 16.3912 9.81656 16.3288C9.97391 16.2819 10.0917 16.2052 10.1738 16.1433C10.2424 16.0917 10.3139 16.0283 10.3713 15.9774C10.3753 15.9739 10.3792 15.9705 10.383 15.9671C10.994 15.426 12.2329 14.3184 13.4748 13.1462C14.7022 11.9877 15.9795 10.7226 16.6339 9.88052C18.3512 7.67065 18.0834 4.50935 15.8532 2.65572C13.8153 0.961905 11.2476 1.25349 9.49466 2.78774Z"/>
  </svg>
`,r$1=`
  <svg width="18" height="18">
    <g xmlns="http://www.w3.org/2000/svg">
      <path fill="#ff006d" d="M12.2197 1.65717C7.73973 1.25408 5.14439 0.940234 3.12891 2.6623C0.948817 4.52502 0.63207 7.66213 2.35603 9.88052C3.01043 10.7226 4.28767 11.9877 5.51513 13.1462C6.75696 14.3184 7.99593 15.426 8.60692 15.9671C8.61074 15.9705 8.61463 15.9739 8.61859 15.9774C8.67603 16.0283 8.74753 16.0917 8.81608 16.1433C8.89816 16.2052 9.01599 16.2819 9.17334 16.3288C9.38253 16.3912 9.60738 16.3912 9.81656 16.3288C9.97391 16.2819 10.0917 16.2052 10.1738 16.1433C10.2424 16.0917 10.3139 16.0283 10.3713 15.9774C10.3753 15.9739 10.3792 15.9705 10.383 15.9671C10.994 15.426 12.2329 14.3184 13.4748 13.1462C14.7022 11.9877 15.9795 10.7226 16.6339 9.88052C18.3512 7.67065 18.0834 4.50935 15.8532 2.65572C13.8153 0.961905 11.2476 1.25349 9.49466 2.78774Z"/>
    </g>
  </svg>
`,e$2=(s="dark")=>`
  <svg 
    class="checkmark" 
    xmlns="http://www.w3.org/2000/svg" 
    viewBox="0 0 52 52"
    role="img"
    aria-label="Success checkmark"
  >
    <style>
      .checkmark__circle {
        stroke-dasharray: 166;
        stroke-dashoffset: 166;
        stroke-width: 2;
        stroke-miterlimit: 10;
        stroke: #4bb71b;
        fill: none;
        animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
      }

      .checkmark {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        display: block;
        stroke-width: 3;
        stroke: #4bb71b;
        stroke-miterlimit: 10;
        margin: 0 auto;
        animation: fill 0.4s ease-in-out 0.4s forwards, scale 0.3s ease-in-out 0.9s both;
      }

      .checkmark__check {
        transform-origin: 50% 50%;
        stroke-dasharray: 48;
        stroke-dashoffset: 48;
        animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
      }

      @keyframes stroke {
        100% { stroke-dashoffset: 0; }
      }

      @keyframes scale {
        0%, 100% { transform: none; }
        50% { transform: scale3d(1.1, 1.1, 1); }
      }

      @keyframes fill {
        100% { box-shadow: inset 0 0 0 30px ${s==="dark"?"#FFF":"#000"}; }
      }
    </style>
    <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="${s==="dark"?"#FFF":"#000"}"/>
    <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
  </svg>
`,a$3=(s=21,$n=24)=>`
  <svg 
    width="${s}" 
    height="${$n}" 
    viewBox="0 0 21 24" 
    fill="none" 
    xmlns="http://www.w3.org/2000/svg"
    role="img"
    aria-label="Nostr logo"
  >
    <style>
    .nostrich {
      transform-origin: center;
    }
    </style>
    <g class="nostrich">
      <path d="M17.7084 10.1607C18.1683 13.3466 14.8705 14.0207 12.9733 13.9618C12.8515 13.958 12.7366 14.0173 12.6647 14.1157C12.4684 14.384 12.1547 14.7309 11.9125 14.7309C11.6405 14.7309 11.3957 15.254 11.284 15.5795C11.2723 15.6137 11.3059 15.6452 11.3403 15.634C14.345 14.6584 15.5241 14.3238 16.032 14.4178C16.4421 14.4937 17.209 15.8665 17.5413 16.5434C16.7155 16.5909 16.4402 15.8507 16.2503 15.7178C16.0985 15.6116 16.0415 16.0974 16.032 16.3536C15.8517 16.2587 15.6239 16.1259 15.6049 15.7178C15.5859 15.3098 15.3771 15.4142 15.2157 15.4332C15.0544 15.4521 12.5769 16.2493 12.2067 16.3536C11.8366 16.458 11.4094 16.6004 11.0582 16.8471C10.4697 17.1318 10.09 16.9325 9.98561 16.4485C9.90208 16.0614 10.4444 14.8701 10.726 14.3229C10.3779 14.4526 9.65529 14.7158 9.54898 14.7309C9.44588 14.7457 8.13815 15.7552 7.43879 16.3038C7.398 16.3358 7.37174 16.3827 7.36236 16.4336C7.25047 17.0416 6.89335 17.2118 6.27423 17.5303C5.77602 17.7867 4.036 20.4606 3.14127 21.9041C3.0794 22.0039 2.9886 22.0806 2.8911 22.1461C2.32279 22.5276 1.74399 23.4985 1.50923 23.9737C1.17511 23.0095 1.61048 22.1802 1.86993 21.886C1.75602 21.7873 1.49341 21.8449 1.37634 21.886C1.69907 20.7757 2.82862 20.7757 2.79066 20.7757C2.99948 20.5954 5.44842 17.0938 5.50538 16.9325C5.56187 16.7725 5.46892 16.0242 6.69975 15.6139C6.7193 15.6073 6.73868 15.5984 6.75601 15.5873C7.71493 14.971 8.43427 13.9774 8.67571 13.5542C7.39547 13.4662 5.92943 12.7525 5.16289 12.294C4.99765 12.1952 4.8224 12.1092 4.63108 12.0875C3.58154 11.9687 2.53067 12.6401 2.10723 13.0228C1.93258 12.7799 2.12938 12.0739 2.24961 11.7513C1.82437 11.6905 1.19916 12.308 0.939711 12.6243C0.658747 12.184 0.904907 11.397 1.06311 11.0585C0.501179 11.0737 0.120232 11.3306 0 11.4571C0.465109 7.99343 4.02275 9.00076 4.06259 9.04675C3.87275 8.84937 3.88857 8.59126 3.92021 8.48688C6.0749 8.54381 7.08105 8.18321 7.71702 7.81313C12.7288 5.01374 14.8882 6.73133 15.6856 7.1631C16.4829 7.59487 17.9304 7.77042 18.9318 7.37187C20.1278 6.83097 19.9478 5.43673 19.7054 4.90461C19.4397 4.32101 17.9399 3.51438 17.4084 2.49428C16.8768 1.47418 17.34 0.233672 17.9558 0.0607684C18.5425 -0.103972 18.9615 0.0876835 19.2831 0.378128C19.4974 0.571763 20.0994 0.710259 20.3509 0.800409C20.6024 0.890558 21.0201 1.00918 20.9964 1.08035C20.9726 1.15152 20.5699 1.14202 20.5075 1.14202C20.3794 1.14202 20.2275 1.161 20.3794 1.23217C20.5575 1.30439 20.8263 1.40936 20.955 1.47846C20.9717 1.48744 20.9683 1.51084 20.95 1.51577C20.0765 1.75085 19.2966 1.26578 18.7183 1.82526C18.1298 2.39463 19.3827 2.83114 20.0282 3.51438C20.6736 4.19762 21.3381 5.01372 20.8065 6.87365C20.395 8.31355 18.6703 9.53781 17.7795 10.0167C17.7282 10.0442 17.7001 10.1031 17.7084 10.1607Z"/>
    </g>
  </svg>
`,o$2=()=>`
  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <style>
      @keyframes nostrich-run {
        0% { transform: translateX(0) rotate(0deg); }
        20% { transform: translateX(10px) rotate(5deg); }
        40% { transform: translateX(0) rotate(0deg); }
        60% { transform: translateX(-10px) rotate(-5deg); }
        80% { transform: translateX(0) rotate(0deg); }
        100% { transform: translateX(0) rotate(0deg); }
      }
      .nostrich {
        animation: nostrich-run 1.5s infinite ease-in-out;
        transform-origin: center;
      }
    </style>
    <g class="nostrich">
      <path d="M17.7084 10.1607C18.1683 13.3466 14.8705 14.0207 12.9733 13.9618C12.8515 13.958 12.7366 14.0173 12.6647 14.1157C12.4684 14.384 12.1547 14.7309 11.9125 14.7309C11.6405 14.7309 11.3957 15.254 11.284 15.5795C11.2723 15.6137 11.3059 15.6452 11.3403 15.634C14.345 14.6584 15.5241 14.3238 16.032 14.4178C16.4421 14.4937 17.209 15.8665 17.5413 16.5434C16.7155 16.5909 16.4402 15.8507 16.2503 15.7178C16.0985 15.6116 16.0415 16.0974 16.032 16.3536C15.8517 16.2587 15.6239 16.1259 15.6049 15.7178C15.5859 15.3098 15.3771 15.4142 15.2157 15.4332C15.0544 15.4521 12.5769 16.2493 12.2067 16.3536C11.8366 16.458 11.4094 16.6004 11.0582 16.8471C10.4697 17.1318 10.09 16.9325 9.98561 16.4485C9.90208 16.0614 10.4444 14.8701 10.726 14.3229C10.3779 14.4526 9.65529 14.7158 9.54898 14.7309C9.44588 14.7457 8.13815 15.7552 7.43879 16.3038C7.398 16.3358 7.37174 16.3827 7.36236 16.4336C7.25047 17.0416 6.89335 17.2118 6.27423 17.5303C5.77602 17.7867 4.036 20.4606 3.14127 21.9041C3.0794 22.0039 2.9886 22.0806 2.8911 22.1461C2.32279 22.5276 1.74399 23.4985 1.50923 23.9737C1.17511 23.0095 1.61048 22.1802 1.86993 21.886C1.75602 21.7873 1.49341 21.8449 1.37634 21.886C1.69907 20.7757 2.82862 20.7757 2.79066 20.7757C2.99948 20.5954 5.44842 17.0938 5.50538 16.9325C5.56187 16.7725 5.46892 16.0242 6.69975 15.6139C6.7193 15.6073 6.73868 15.5984 6.75601 15.5873C7.71493 14.971 8.43427 13.9774 8.67571 13.5542C7.39547 13.4662 5.92943 12.7525 5.16289 12.294C4.99765 12.1952 4.8224 12.1092 4.63108 12.0875C3.58154 11.9687 2.53067 12.6401 2.10723 13.0228C1.93258 12.7799 2.12938 12.0739 2.24961 11.7513C1.82437 11.6905 1.19916 12.308 0.939711 12.6243C0.658747 12.184 0.904907 11.397 1.06311 11.0585C0.501179 11.0737 0.120232 11.3306 0 11.4571C0.465109 7.99343 4.02275 9.00076 4.06259 9.04675C3.87275 8.84937 3.88857 8.59126 3.92021 8.48688C6.0749 8.54381 7.08105 8.18321 7.71702 7.81313C12.7288 5.01374 14.8882 6.73133 15.6856 7.1631C16.4829 7.59487 17.9304 7.77042 18.9318 7.37187C20.1278 6.83097 19.9478 5.43673 19.7054 4.90461C19.4397 4.32101 17.9399 3.51438 17.4084 2.49428C16.8768 1.47418 17.34 0.233672 17.9558 0.0607684C18.5425 -0.103972 18.9615 0.0876835 19.2831 0.378128C19.4974 0.571763 20.0994 0.710259 20.3509 0.800409C20.6024 0.890558 21.0201 1.00918 20.9964 1.08035C20.9726 1.15152 20.5699 1.14202 20.5075 1.14202C20.3794 1.14202 20.2275 1.161 20.3794 1.23217C20.5575 1.30439 20.8263 1.40936 20.955 1.47846C20.9717 1.48744 20.9683 1.51084 20.95 1.51577C20.0765 1.75085 19.2966 1.26578 18.7183 1.82526C18.1298 2.39463 19.3827 2.83114 20.0282 3.51438C20.6736 4.19762 21.3381 5.01372 20.8065 6.87365C20.395 8.31355 18.6703 9.53781 17.7795 10.0167C17.7282 10.0442 17.7001 10.1031 17.7084 10.1607Z"/>
    </g>
  </svg>
`;var Qu=Object.defineProperty,Zu=(s,$n,Dn)=>$n in s?Qu(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,N$3=(s,$n,Dn)=>Zu(s,typeof $n!="symbol"?$n+"":$n,Dn);function mu(s,$n){var Dn=Object.keys(s);if(Object.getOwnPropertySymbols){var Un=Object.getOwnPropertySymbols(s);$n&&(Un=Un.filter(function(Bn){return Object.getOwnPropertyDescriptor(s,Bn).enumerable})),Dn.push.apply(Dn,Un)}return Dn}function pu(s){for(var $n=1;$n<arguments.length;$n++){var Dn=arguments[$n]!=null?arguments[$n]:{};$n%2?mu(Object(Dn),!0).forEach(function(Un){ne(s,Un,Dn[Un])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(Dn)):mu(Object(Dn)).forEach(function(Un){Object.defineProperty(s,Un,Object.getOwnPropertyDescriptor(Dn,Un))})}return s}function Y$1(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Y$1=function($n){return typeof $n}:Y$1=function($n){return $n&&typeof Symbol=="function"&&$n.constructor===Symbol&&$n!==Symbol.prototype?"symbol":typeof $n},Y$1(s)}function G(s,$n){if(!(s instanceof $n))throw new TypeError("Cannot call a class as a function")}function re(s,$n){for(var Dn=0;Dn<$n.length;Dn++){var Un=$n[Dn];Un.enumerable=Un.enumerable||!1,Un.configurable=!0,"value"in Un&&(Un.writable=!0),Object.defineProperty(s,Un.key,Un)}}function uu(s,$n,Dn){return $n&&re(s.prototype,$n),s}function ne(s,$n,Dn){return $n in s?Object.defineProperty(s,$n,{value:Dn,enumerable:!0,configurable:!0,writable:!0}):s[$n]=Dn,s}function se$1(s,$n){if(typeof $n!="function"&&$n!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create($n&&$n.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),$n&&ru(s,$n)}function F$3(s){return F$3=Object.setPrototypeOf?Object.getPrototypeOf:function($n){return $n.__proto__||Object.getPrototypeOf($n)},F$3(s)}function ru(s,$n){return ru=Object.setPrototypeOf||function(Dn,Un){return Dn.__proto__=Un,Dn},ru(s,$n)}function ce$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function de$2(s,$n){if($n&&(typeof $n=="object"||typeof $n=="function"))return $n;if($n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oe(s)}function fe$1(s){var $n=ce$2();return function(){var Dn=F$3(s),Un;if($n){var Bn=F$3(this).constructor;Un=Reflect.construct(Dn,arguments,Bn)}else Un=Dn.apply(this,arguments);return de$2(this,Un)}}function le$2(s,$n){for(;!Object.prototype.hasOwnProperty.call(s,$n)&&(s=F$3(s),s!==null););return s}function J$2(){return typeof Reflect<"u"&&Reflect.get?J$2=Reflect.get:J$2=function(s,$n,Dn){var Un=le$2(s,$n);if(Un){var Bn=Object.getOwnPropertyDescriptor(Un,$n);return Bn.get?Bn.get.call(arguments.length<3?s:Dn):Bn.value}},J$2.apply(this,arguments)}var be$1={type:"slider",startAt:0,perView:1,focusAt:0,gap:10,autoplay:!1,hoverpause:!0,keyboard:!0,bound:!1,swipeThreshold:80,dragThreshold:120,perSwipe:"",touchRatio:.5,touchAngle:45,animationDuration:400,rewind:!0,rewindDuration:800,animationTimingFunc:"cubic-bezier(.165, .840, .440, 1)",waitForTransition:!0,throttle:10,direction:"ltr",peek:0,cloningRatio:1,breakpoints:{},classes:{swipeable:"glide--swipeable",dragging:"glide--dragging",direction:{ltr:"glide--ltr",rtl:"glide--rtl"},type:{slider:"glide--slider",carousel:"glide--carousel"},slide:{clone:"glide__slide--clone",active:"glide__slide--active"},arrow:{disabled:"glide__arrow--disabled"},nav:{active:"glide__bullet--active"}}};function z$4(s){console.error("[Glide warn]: ".concat(s))}function _$5(s){return parseInt(s)}function he$1(s){return parseFloat(s)}function nu(s){return typeof s=="string"}function W$1(s){var $n=Y$1(s);return $n==="function"||$n==="object"&&!!s}function K$2(s){return typeof s=="function"}function Pu(s){return typeof s>"u"}function su(s){return s.constructor===Array}function me$2(s,$n,Dn){var Un={};for(var Bn in $n)K$2($n[Bn])?Un[Bn]=$n[Bn](s,Un,Dn):z$4("Extension must be a function");for(var In in Un)K$2(Un[In].mount)&&Un[In].mount();return Un}function S$1(s,$n,Dn){Object.defineProperty(s,$n,Dn)}function pe$2(s){return Object.keys(s).sort().reduce(function($n,Dn){return $n[Dn]=s[Dn],$n[Dn],$n},{})}function cu(s,$n){var Dn=Object.assign({},s,$n);if($n.hasOwnProperty("classes")){Dn.classes=Object.assign({},s.classes,$n.classes);var Un=["direction","type","slide","arrow","nav"];Un.forEach(function(Bn){$n.classes.hasOwnProperty(Bn)&&(Dn.classes[Bn]=pu(pu({},s.classes[Bn]),$n.classes[Bn]))})}return $n.hasOwnProperty("breakpoints")&&(Dn.breakpoints=Object.assign({},s.breakpoints,$n.breakpoints)),Dn}var ge$1=(function(){function s(){var $n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(this,s),this.events=$n,this.hop=$n.hasOwnProperty}return uu(s,[{key:"on",value:function($n,Dn){if(su($n)){for(var Un=0;Un<$n.length;Un++)this.on($n[Un],Dn);return}this.hop.call(this.events,$n)||(this.events[$n]=[]);var Bn=this.events[$n].push(Dn)-1;return{remove:function(){delete this.events[$n][Bn]}}}},{key:"emit",value:function($n,Dn){if(su($n)){for(var Un=0;Un<$n.length;Un++)this.emit($n[Un],Dn);return}this.hop.call(this.events,$n)&&this.events[$n].forEach(function(Bn){Bn(Dn||{})})}}]),s})(),xe$1=(function(){function s($n){var Dn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};G(this,s),this._c={},this._t=[],this._e=new ge$1,this.disabled=!1,this.selector=$n,this.settings=cu(be$1,Dn),this.index=this.settings.startAt}return uu(s,[{key:"mount",value:function(){var $n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._e.emit("mount.before"),W$1($n)?this._c=me$2(this,$n,this._e):z$4("You need to provide a object on `mount()`"),this._e.emit("mount.after"),this}},{key:"mutate",value:function(){var $n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return su($n)?this._t=$n:z$4("You need to provide a array on `mutate()`"),this}},{key:"update",value:function(){var $n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.settings=cu(this.settings,$n),$n.hasOwnProperty("startAt")&&(this.index=$n.startAt),this._e.emit("update"),this}},{key:"go",value:function($n){return this._c.Run.make($n),this}},{key:"move",value:function($n){return this._c.Transition.disable(),this._c.Move.make($n),this}},{key:"destroy",value:function(){return this._e.emit("destroy"),this}},{key:"play",value:function(){var $n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return $n&&(this.settings.autoplay=$n),this._e.emit("play"),this}},{key:"pause",value:function(){return this._e.emit("pause"),this}},{key:"disable",value:function(){return this.disabled=!0,this}},{key:"enable",value:function(){return this.disabled=!1,this}},{key:"on",value:function($n,Dn){return this._e.on($n,Dn),this}},{key:"isType",value:function($n){return this.settings.type===$n}},{key:"settings",get:function(){return this._o},set:function($n){W$1($n)?this._o=$n:z$4("Options must be an `object` instance.")}},{key:"index",get:function(){return this._i},set:function($n){this._i=_$5($n)}},{key:"type",get:function(){return this.settings.type}},{key:"disabled",get:function(){return this._d},set:function($n){this._d=!!$n}}]),s})();function ve$1(s,$n,Dn){var Un={mount:function(){this._o=!1},make:function(Kn){var jn=this;s.disabled||(!s.settings.waitForTransition||s.disable(),this.move=Kn,Dn.emit("run.before",this.move),this.calculate(),Dn.emit("run",this.move),$n.Transition.after(function(){jn.isStart()&&Dn.emit("run.start",jn.move),jn.isEnd()&&Dn.emit("run.end",jn.move),jn.isOffset()&&(jn._o=!1,Dn.emit("run.offset",jn.move)),Dn.emit("run.after",jn.move),s.enable()}))},calculate:function(){var Kn=this.move,jn=this.length,Yn=Kn.steps,Zn=Kn.direction,Xn=1;if(Zn==="="){if(s.settings.bound&&_$5(Yn)>jn){s.index=jn;return}s.index=Yn;return}if(Zn===">"&&Yn===">"){s.index=jn;return}if(Zn==="<"&&Yn==="<"){s.index=0;return}if(Zn==="|"&&(Xn=s.settings.perView||1),Zn===">"||Zn==="|"&&Yn===">"){var Jn=Bn(Xn);Jn>jn&&(this._o=!0),s.index=In(Jn,Xn);return}if(Zn==="<"||Zn==="|"&&Yn==="<"){var Wn=qn(Xn);Wn<0&&(this._o=!0),s.index=Fn(Wn,Xn);return}z$4("Invalid direction pattern [".concat(Zn).concat(Yn,"] has been used"))},isStart:function(){return s.index<=0},isEnd:function(){return s.index>=this.length},isOffset:function(){var Kn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return Kn?this._o?Kn==="|>"?this.move.direction==="|"&&this.move.steps===">":Kn==="|<"?this.move.direction==="|"&&this.move.steps==="<":this.move.direction===Kn:!1:this._o},isBound:function(){return s.isType("slider")&&s.settings.focusAt!=="center"&&s.settings.bound}};function Bn(Kn){var jn=s.index;return s.isType("carousel")?jn+Kn:jn+(Kn-jn%Kn)}function In(Kn,jn){var Yn=Un.length;return Kn<=Yn?Kn:s.isType("carousel")?Kn-(Yn+1):s.settings.rewind?Un.isBound()&&!Un.isEnd()?Yn:0:Un.isBound()?Yn:Math.floor(Yn/jn)*jn}function qn(Kn){var jn=s.index;if(s.isType("carousel"))return jn-Kn;var Yn=Math.ceil(jn/Kn);return(Yn-1)*Kn}function Fn(Kn,jn){var Yn=Un.length;return Kn>=0?Kn:s.isType("carousel")?Kn+(Yn+1):s.settings.rewind?Un.isBound()&&Un.isStart()?Yn:Math.floor(Yn/jn)*jn:0}return S$1(Un,"move",{get:function(){return this._m},set:function(Kn){var jn=Kn.substr(1);this._m={direction:Kn.substr(0,1),steps:jn?_$5(jn)?_$5(jn):jn:0}}}),S$1(Un,"length",{get:function(){var Kn=s.settings,jn=$n.Html.slides.length;return this.isBound()?jn-1-(_$5(Kn.perView)-1)+_$5(Kn.focusAt):jn-1}}),S$1(Un,"offset",{get:function(){return this._o}}),Un}function gu(){return new Date().getTime()}function eu(s,$n){var Dn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Un,Bn,In,qn,Fn=0,Kn=function(){Fn=Dn.leading===!1?0:gu(),Un=null,qn=s.apply(Bn,In),Un||(Bn=In=null)},jn=function(){var Yn=gu();!Fn&&Dn.leading===!1&&(Fn=Yn);var Zn=$n-(Yn-Fn);return Bn=this,In=arguments,Zn<=0||Zn>$n?(Un&&(clearTimeout(Un),Un=null),Fn=Yn,qn=s.apply(Bn,In),Un||(Bn=In=null)):!Un&&Dn.trailing!==!1&&(Un=setTimeout(Kn,Zn)),qn};return jn.cancel=function(){clearTimeout(Un),Fn=0,Un=Bn=In=null},jn}var Q$1={ltr:["marginLeft","marginRight"],rtl:["marginRight","marginLeft"]};function ye$1(s,$n,Dn){var Un={apply:function(Bn){for(var In=0,qn=Bn.length;In<qn;In++){var Fn=Bn[In].style,Kn=$n.Direction.value;In!==0?Fn[Q$1[Kn][0]]="".concat(this.value/2,"px"):Fn[Q$1[Kn][0]]="",In!==Bn.length-1?Fn[Q$1[Kn][1]]="".concat(this.value/2,"px"):Fn[Q$1[Kn][1]]=""}},remove:function(Bn){for(var In=0,qn=Bn.length;In<qn;In++){var Fn=Bn[In].style;Fn.marginLeft="",Fn.marginRight=""}}};return S$1(Un,"value",{get:function(){return _$5(s.settings.gap)}}),S$1(Un,"grow",{get:function(){return Un.value*$n.Sizes.length}}),S$1(Un,"reductor",{get:function(){var Bn=s.settings.perView;return Un.value*(Bn-1)/Bn}}),Dn.on(["build.after","update"],eu(function(){Un.apply($n.Html.wrapper.children)},30)),Dn.on("destroy",function(){Un.remove($n.Html.wrapper.children)}),Un}function Mu(s){if(s&&s.parentNode){for(var $n=s.parentNode.firstChild,Dn=[];$n;$n=$n.nextSibling)$n.nodeType===1&&$n!==s&&Dn.push($n);return Dn}return[]}function ou(s){return Array.prototype.slice.call(s)}var we$1='[data-glide-el="track"]';function Se$1(s,$n,Dn){var Un={mount:function(){this.root=s.selector,this.track=this.root.querySelector(we$1),this.collectSlides()},collectSlides:function(){this.slides=ou(this.wrapper.children).filter(function(Bn){return!Bn.classList.contains(s.settings.classes.slide.clone)})}};return S$1(Un,"root",{get:function(){return Un._r},set:function(Bn){nu(Bn)&&(Bn=document.querySelector(Bn)),Bn!==null?Un._r=Bn:z$4("Root element must be a existing Html node")}}),S$1(Un,"track",{get:function(){return Un._t},set:function(Bn){Un._t=Bn}}),S$1(Un,"wrapper",{get:function(){return Un.track.children[0]}}),Dn.on("update",function(){Un.collectSlides()}),Un}function Ae$2(s,$n,Dn){var Un={mount:function(){this.value=s.settings.peek}};return S$1(Un,"value",{get:function(){return Un._v},set:function(Bn){W$1(Bn)?(Bn.before=_$5(Bn.before),Bn.after=_$5(Bn.after)):Bn=_$5(Bn),Un._v=Bn}}),S$1(Un,"reductor",{get:function(){var Bn=Un.value,In=s.settings.perView;return W$1(Bn)?Bn.before/In+Bn.after/In:Bn*2/In}}),Dn.on(["resize","update"],function(){Un.mount()}),Un}function Te$2(s,$n,Dn){var Un={mount:function(){this._o=0},make:function(){var Bn=this,In=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.offset=In,Dn.emit("move",{movement:this.value}),$n.Transition.after(function(){Dn.emit("move.after",{movement:Bn.value})})}};return S$1(Un,"offset",{get:function(){return Un._o},set:function(Bn){Un._o=Pu(Bn)?0:_$5(Bn)}}),S$1(Un,"translate",{get:function(){return $n.Sizes.slideWidth*s.index}}),S$1(Un,"value",{get:function(){var Bn=this.offset,In=this.translate;return $n.Direction.is("rtl")?In+Bn:In-Bn}}),Dn.on(["build.before","run"],function(){Un.make()}),Un}function Ee$2(s,$n,Dn){var Un={setupSlides:function(){for(var Bn="".concat(this.slideWidth,"px"),In=$n.Html.slides,qn=0;qn<In.length;qn++)In[qn].style.width=Bn},setupWrapper:function(){$n.Html.wrapper.style.width="".concat(this.wrapperSize,"px")},remove:function(){for(var Bn=$n.Html.slides,In=0;In<Bn.length;In++)Bn[In].style.width="";$n.Html.wrapper.style.width=""}};return S$1(Un,"length",{get:function(){return $n.Html.slides.length}}),S$1(Un,"width",{get:function(){return $n.Html.track.offsetWidth}}),S$1(Un,"wrapperSize",{get:function(){return Un.slideWidth*Un.length+$n.Gaps.grow+$n.Clones.grow}}),S$1(Un,"slideWidth",{get:function(){return Un.width/s.settings.perView-$n.Peek.reductor-$n.Gaps.reductor}}),Dn.on(["build.before","resize","update"],function(){Un.setupSlides(),Un.setupWrapper()}),Dn.on("destroy",function(){Un.remove()}),Un}function ke$1(s,$n,Dn){var Un={mount:function(){Dn.emit("build.before"),this.typeClass(),this.activeClass(),Dn.emit("build.after")},typeClass:function(){$n.Html.root.classList.add(s.settings.classes.type[s.settings.type])},activeClass:function(){var Bn=s.settings.classes,In=$n.Html.slides[s.index];In&&(In.classList.add(Bn.slide.active),Mu(In).forEach(function(qn){qn.classList.remove(Bn.slide.active)}))},removeClasses:function(){var Bn=s.settings.classes,In=Bn.type,qn=Bn.slide;$n.Html.root.classList.remove(In[s.settings.type]),$n.Html.slides.forEach(function(Fn){Fn.classList.remove(qn.active)})}};return Dn.on(["destroy","update"],function(){Un.removeClasses()}),Dn.on(["resize","update"],function(){Un.mount()}),Dn.on("move.after",function(){Un.activeClass()}),Un}function _e$1(s,$n,Dn){var Un={mount:function(){this.items=[],s.isType("carousel")&&(this.items=this.collect())},collect:function(){var Bn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],In=$n.Html.slides,qn=s.settings,Fn=qn.perView,Kn=qn.classes,jn=qn.cloningRatio;if(In.length>0)for(var Yn=+!!s.settings.peek,Zn=Fn+Yn+Math.round(Fn/2),Xn=In.slice(0,Zn).reverse(),Jn=In.slice(Zn*-1),Wn=0;Wn<Math.max(jn,Math.floor(Fn/In.length));Wn++){for(var tr=0;tr<Xn.length;tr++){var ir=Xn[tr].cloneNode(!0);ir.classList.add(Kn.slide.clone),Bn.push(ir)}for(var sr=0;sr<Jn.length;sr++){var fr=Jn[sr].cloneNode(!0);fr.classList.add(Kn.slide.clone),Bn.unshift(fr)}}return Bn},append:function(){for(var Bn=this.items,In=$n.Html,qn=In.wrapper,Fn=In.slides,Kn=Math.floor(Bn.length/2),jn=Bn.slice(0,Kn).reverse(),Yn=Bn.slice(Kn*-1).reverse(),Zn="".concat($n.Sizes.slideWidth,"px"),Xn=0;Xn<Yn.length;Xn++)qn.appendChild(Yn[Xn]);for(var Jn=0;Jn<jn.length;Jn++)qn.insertBefore(jn[Jn],Fn[0]);for(var Wn=0;Wn<Bn.length;Wn++)Bn[Wn].style.width=Zn},remove:function(){for(var Bn=this.items,In=0;In<Bn.length;In++)$n.Html.wrapper.removeChild(Bn[In])}};return S$1(Un,"grow",{get:function(){return($n.Sizes.slideWidth+$n.Gaps.value)*Un.items.length}}),Dn.on("update",function(){Un.remove(),Un.mount(),Un.append()}),Dn.on("build.before",function(){s.isType("carousel")&&Un.append()}),Dn.on("destroy",function(){Un.remove()}),Un}var $$3=(function(){function s(){var $n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(this,s),this.listeners=$n}return uu(s,[{key:"on",value:function($n,Dn,Un){var Bn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;nu($n)&&($n=[$n]);for(var In=0;In<$n.length;In++)this.listeners[$n[In]]=Un,Dn.addEventListener($n[In],this.listeners[$n[In]],Bn)}},{key:"off",value:function($n,Dn){var Un=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;nu($n)&&($n=[$n]);for(var Bn=0;Bn<$n.length;Bn++)Dn.removeEventListener($n[Bn],this.listeners[$n[Bn]],Un)}},{key:"destroy",value:function(){delete this.listeners}}]),s})();function Ie$1(s,$n,Dn){var Un=new $$3,Bn={mount:function(){this.bind()},bind:function(){Un.on("resize",window,eu(function(){Dn.emit("resize")},s.settings.throttle))},unbind:function(){Un.off("resize",window)}};return Dn.on("destroy",function(){Bn.unbind(),Un.destroy()}),Bn}var Ne$1=["ltr","rtl"],qe$2={">":"<","<":">","=":"="};function De$1(s,$n,Dn){var Un={mount:function(){this.value=s.settings.direction},resolve:function(Bn){var In=Bn.slice(0,1);return this.is("rtl")?Bn.split(In).join(qe$2[In]):Bn},is:function(Bn){return this.value===Bn},addClass:function(){$n.Html.root.classList.add(s.settings.classes.direction[this.value])},removeClass:function(){$n.Html.root.classList.remove(s.settings.classes.direction[this.value])}};return S$1(Un,"value",{get:function(){return Un._v},set:function(Bn){Ne$1.indexOf(Bn)>-1?Un._v=Bn:z$4("Direction value must be `ltr` or `rtl`")}}),Dn.on(["destroy","update"],function(){Un.removeClass()}),Dn.on("update",function(){Un.mount()}),Dn.on(["build.before","update"],function(){Un.addClass()}),Un}function Re$1(s,$n){return{modify:function(Dn){return $n.Direction.is("rtl")?-Dn:Dn}}}function Le$1(s,$n){return{modify:function(Dn){var Un=Math.floor(Dn/$n.Sizes.slideWidth);return Dn+$n.Gaps.value*Un}}}function Oe$1(s,$n){return{modify:function(Dn){return Dn+$n.Clones.grow/2}}}function Be$2(s,$n){return{modify:function(Dn){if(s.settings.focusAt>=0){var Un=$n.Peek.value;return W$1(Un)?Dn-Un.before:Dn-Un}return Dn}}}function Pe$1(s,$n){return{modify:function(Dn){var Un=$n.Gaps.value,Bn=$n.Sizes.width,In=s.settings.focusAt,qn=$n.Sizes.slideWidth;return In==="center"?Dn-(Bn/2-qn/2):Dn-qn*In-Un*In}}}function Me$1(s,$n,Dn){var Un=[Le$1,Oe$1,Be$2,Pe$1].concat(s._t,[Re$1]);return{mutate:function(Bn){for(var In=0;In<Un.length;In++){var qn=Un[In];K$2(qn)&&K$2(qn().modify)?Bn=qn(s,$n,Dn).modify(Bn):z$4("Transformer should be a function that returns an object with `modify()` method")}return Bn}}}function He$2(s,$n,Dn){var Un={set:function(Bn){var In=Me$1(s,$n).mutate(Bn),qn="translate3d(".concat(-1*In,"px, 0px, 0px)");$n.Html.wrapper.style.mozTransform=qn,$n.Html.wrapper.style.webkitTransform=qn,$n.Html.wrapper.style.transform=qn},remove:function(){$n.Html.wrapper.style.transform=""},getStartIndex:function(){var Bn=$n.Sizes.length,In=s.index,qn=s.settings.perView;return $n.Run.isOffset(">")||$n.Run.isOffset("|>")?Bn+(In-qn):(In+qn)%Bn},getTravelDistance:function(){var Bn=$n.Sizes.slideWidth*s.settings.perView;return $n.Run.isOffset(">")||$n.Run.isOffset("|>")?Bn*-1:Bn}};return Dn.on("move",function(Bn){if(!s.isType("carousel")||!$n.Run.isOffset())return Un.set(Bn.movement);$n.Transition.after(function(){Dn.emit("translate.jump"),Un.set($n.Sizes.slideWidth*s.index)});var In=$n.Sizes.slideWidth*$n.Translate.getStartIndex();return Un.set(In-$n.Translate.getTravelDistance())}),Dn.on("destroy",function(){Un.remove()}),Un}function Ve$2(s,$n,Dn){var Un=!1,Bn={compose:function(In){var qn=s.settings;return Un?"".concat(In," 0ms ").concat(qn.animationTimingFunc):"".concat(In," ").concat(this.duration,"ms ").concat(qn.animationTimingFunc)},set:function(){var In=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";$n.Html.wrapper.style.transition=this.compose(In)},remove:function(){$n.Html.wrapper.style.transition=""},after:function(In){setTimeout(function(){In()},this.duration)},enable:function(){Un=!1,this.set()},disable:function(){Un=!0,this.set()}};return S$1(Bn,"duration",{get:function(){var In=s.settings;return s.isType("slider")&&$n.Run.offset?In.rewindDuration:In.animationDuration}}),Dn.on("move",function(){Bn.set()}),Dn.on(["build.before","resize","translate.jump"],function(){Bn.disable()}),Dn.on("run",function(){Bn.enable()}),Dn.on("destroy",function(){Bn.remove()}),Bn}var Hu=!1;try{var xu=Object.defineProperty({},"passive",{get:function(){Hu=!0}});window.addEventListener("testPassive",null,xu),window.removeEventListener("testPassive",null,xu)}catch{}var du=Hu,Z$3=["touchstart","mousedown"],vu=["touchmove","mousemove"],yu=["touchend","touchcancel","mouseup","mouseleave"],wu=["mousedown","mousemove","mouseup","mouseleave"];function ze$1(s,$n,Dn){var Un=new $$3,Bn=0,In=0,qn=0,Fn=!1,Kn=du?{passive:!0}:!1,jn={mount:function(){this.bindSwipeStart()},start:function(Yn){if(!Fn&&!s.disabled){this.disable();var Zn=this.touches(Yn);Bn=null,In=_$5(Zn.pageX),qn=_$5(Zn.pageY),this.bindSwipeMove(),this.bindSwipeEnd(),Dn.emit("swipe.start")}},move:function(Yn){if(!s.disabled){var Zn=s.settings,Xn=Zn.touchAngle,Jn=Zn.touchRatio,Wn=Zn.classes,tr=this.touches(Yn),ir=_$5(tr.pageX)-In,sr=_$5(tr.pageY)-qn,fr=Math.abs(ir<<2),ur=Math.abs(sr<<2),br=Math.sqrt(fr+ur),Nr=Math.sqrt(ur);if(Bn=Math.asin(Nr/br),Bn*180/Math.PI<Xn)Yn.stopPropagation(),$n.Move.make(ir*he$1(Jn)),$n.Html.root.classList.add(Wn.dragging),Dn.emit("swipe.move");else return!1}},end:function(Yn){if(!s.disabled){var Zn=s.settings,Xn=Zn.perSwipe,Jn=Zn.touchAngle,Wn=Zn.classes,tr=this.touches(Yn),ir=this.threshold(Yn),sr=tr.pageX-In,fr=Bn*180/Math.PI;this.enable(),sr>ir&&fr<Jn?$n.Run.make($n.Direction.resolve("".concat(Xn,"<"))):sr<-ir&&fr<Jn?$n.Run.make($n.Direction.resolve("".concat(Xn,">"))):$n.Move.make(),$n.Html.root.classList.remove(Wn.dragging),this.unbindSwipeMove(),this.unbindSwipeEnd(),Dn.emit("swipe.end")}},bindSwipeStart:function(){var Yn=this,Zn=s.settings,Xn=Zn.swipeThreshold,Jn=Zn.dragThreshold;Xn&&Un.on(Z$3[0],$n.Html.wrapper,function(Wn){Yn.start(Wn)},Kn),Jn&&Un.on(Z$3[1],$n.Html.wrapper,function(Wn){Yn.start(Wn)},Kn)},unbindSwipeStart:function(){Un.off(Z$3[0],$n.Html.wrapper,Kn),Un.off(Z$3[1],$n.Html.wrapper,Kn)},bindSwipeMove:function(){var Yn=this;Un.on(vu,$n.Html.wrapper,eu(function(Zn){Yn.move(Zn)},s.settings.throttle),Kn)},unbindSwipeMove:function(){Un.off(vu,$n.Html.wrapper,Kn)},bindSwipeEnd:function(){var Yn=this;Un.on(yu,$n.Html.wrapper,function(Zn){Yn.end(Zn)})},unbindSwipeEnd:function(){Un.off(yu,$n.Html.wrapper)},touches:function(Yn){return wu.indexOf(Yn.type)>-1?Yn:Yn.touches[0]||Yn.changedTouches[0]},threshold:function(Yn){var Zn=s.settings;return wu.indexOf(Yn.type)>-1?Zn.dragThreshold:Zn.swipeThreshold},enable:function(){return Fn=!1,$n.Transition.enable(),this},disable:function(){return Fn=!0,$n.Transition.disable(),this}};return Dn.on("build.after",function(){$n.Html.root.classList.add(s.settings.classes.swipeable)}),Dn.on("destroy",function(){jn.unbindSwipeStart(),jn.unbindSwipeMove(),jn.unbindSwipeEnd(),Un.destroy()}),jn}function Ue$1(s,$n,Dn){var Un=new $$3,Bn={mount:function(){this.bind()},bind:function(){Un.on("dragstart",$n.Html.wrapper,this.dragstart)},unbind:function(){Un.off("dragstart",$n.Html.wrapper)},dragstart:function(In){In.preventDefault()}};return Dn.on("destroy",function(){Bn.unbind(),Un.destroy()}),Bn}function $e$2(s,$n,Dn){var Un=new $$3,Bn=!1,In=!1,qn={mount:function(){this._a=$n.Html.wrapper.querySelectorAll("a"),this.bind()},bind:function(){Un.on("click",$n.Html.wrapper,this.click)},unbind:function(){Un.off("click",$n.Html.wrapper)},click:function(Fn){In&&(Fn.stopPropagation(),Fn.preventDefault())},detach:function(){if(In=!0,!Bn){for(var Fn=0;Fn<this.items.length;Fn++)this.items[Fn].draggable=!1;Bn=!0}return this},attach:function(){if(In=!1,Bn){for(var Fn=0;Fn<this.items.length;Fn++)this.items[Fn].draggable=!0;Bn=!1}return this}};return S$1(qn,"items",{get:function(){return qn._a}}),Dn.on("swipe.move",function(){qn.detach()}),Dn.on("swipe.end",function(){$n.Transition.after(function(){qn.attach()})}),Dn.on("destroy",function(){qn.attach(),qn.unbind(),Un.destroy()}),qn}var Ce$1='[data-glide-el="controls[nav]"]',lu='[data-glide-el^="controls"]',je$1="".concat(lu,' [data-glide-dir*="<"]'),Fe$1="".concat(lu,' [data-glide-dir*=">"]');function We$2(s,$n,Dn){var Un=new $$3,Bn=du?{passive:!0}:!1,In={mount:function(){this._n=$n.Html.root.querySelectorAll(Ce$1),this._c=$n.Html.root.querySelectorAll(lu),this._arrowControls={previous:$n.Html.root.querySelectorAll(je$1),next:$n.Html.root.querySelectorAll(Fe$1)},this.addBindings()},setActive:function(){for(var qn=0;qn<this._n.length;qn++)this.addClass(this._n[qn].children)},removeActive:function(){for(var qn=0;qn<this._n.length;qn++)this.removeClass(this._n[qn].children)},addClass:function(qn){var Fn=s.settings,Kn=qn[s.index];Kn&&(Kn.classList.add(Fn.classes.nav.active),Mu(Kn).forEach(function(jn){jn.classList.remove(Fn.classes.nav.active)}))},removeClass:function(qn){var Fn=qn[s.index];Fn?.classList.remove(s.settings.classes.nav.active)},setArrowState:function(){if(!s.settings.rewind){var qn=In._arrowControls.next,Fn=In._arrowControls.previous;this.resetArrowState(qn,Fn),s.index===0&&this.disableArrow(Fn),s.index===$n.Run.length&&this.disableArrow(qn)}},resetArrowState:function(){for(var qn=s.settings,Fn=arguments.length,Kn=new Array(Fn),jn=0;jn<Fn;jn++)Kn[jn]=arguments[jn];Kn.forEach(function(Yn){ou(Yn).forEach(function(Zn){Zn.classList.remove(qn.classes.arrow.disabled)})})},disableArrow:function(){for(var qn=s.settings,Fn=arguments.length,Kn=new Array(Fn),jn=0;jn<Fn;jn++)Kn[jn]=arguments[jn];Kn.forEach(function(Yn){ou(Yn).forEach(function(Zn){Zn.classList.add(qn.classes.arrow.disabled)})})},addBindings:function(){for(var qn=0;qn<this._c.length;qn++)this.bind(this._c[qn].children)},removeBindings:function(){for(var qn=0;qn<this._c.length;qn++)this.unbind(this._c[qn].children)},bind:function(qn){for(var Fn=0;Fn<qn.length;Fn++)Un.on("click",qn[Fn],this.click),Un.on("touchstart",qn[Fn],this.click,Bn)},unbind:function(qn){for(var Fn=0;Fn<qn.length;Fn++)Un.off(["click","touchstart"],qn[Fn])},click:function(qn){!du&&qn.type==="touchstart"&&qn.preventDefault();var Fn=qn.currentTarget.getAttribute("data-glide-dir");$n.Run.make($n.Direction.resolve(Fn))}};return S$1(In,"items",{get:function(){return In._c}}),Dn.on(["mount.after","move.after"],function(){In.setActive()}),Dn.on(["mount.after","run"],function(){In.setArrowState()}),Dn.on("destroy",function(){In.removeBindings(),In.removeActive(),Un.destroy()}),In}function Qe$1(s,$n,Dn){var Un=new $$3,Bn={mount:function(){s.settings.keyboard&&this.bind()},bind:function(){Un.on("keyup",document,this.press)},unbind:function(){Un.off("keyup",document)},press:function(In){var qn=s.settings.perSwipe,Fn={ArrowRight:">",ArrowLeft:"<"};["ArrowRight","ArrowLeft"].includes(In.code)&&$n.Run.make($n.Direction.resolve("".concat(qn).concat(Fn[In.code])))}};return Dn.on(["destroy","update"],function(){Bn.unbind()}),Dn.on("update",function(){Bn.mount()}),Dn.on("destroy",function(){Un.destroy()}),Bn}function Ze$1(s,$n,Dn){var Un=new $$3,Bn={mount:function(){this.enable(),this.start(),s.settings.hoverpause&&this.bind()},enable:function(){this._e=!0},disable:function(){this._e=!1},start:function(){var In=this;this._e&&(this.enable(),s.settings.autoplay&&Pu(this._i)&&(this._i=setInterval(function(){In.stop(),$n.Run.make(">"),In.start(),Dn.emit("autoplay")},this.time)))},stop:function(){this._i=clearInterval(this._i)},bind:function(){var In=this;Un.on("mouseover",$n.Html.root,function(){In._e&&In.stop()}),Un.on("mouseout",$n.Html.root,function(){In._e&&In.start()})},unbind:function(){Un.off(["mouseover","mouseout"],$n.Html.root)}};return S$1(Bn,"time",{get:function(){var In=$n.Html.slides[s.index].getAttribute("data-glide-autoplay");return _$5(In||s.settings.autoplay)}}),Dn.on(["destroy","update"],function(){Bn.unbind()}),Dn.on(["run.before","swipe.start","update"],function(){Bn.stop()}),Dn.on(["pause","destroy"],function(){Bn.disable(),Bn.stop()}),Dn.on(["run.after","swipe.end"],function(){Bn.start()}),Dn.on(["play"],function(){Bn.enable(),Bn.start()}),Dn.on("update",function(){Bn.mount()}),Dn.on("destroy",function(){Un.destroy()}),Bn}function Su(s){return W$1(s)?pe$2(s):(z$4("Breakpoints option must be an object"),{})}function Xe$1(s,$n,Dn){var Un=new $$3,Bn=s.settings,In=Su(Bn.breakpoints),qn=Object.assign({},Bn),Fn={match:function(Kn){if(typeof window.matchMedia<"u"){for(var jn in Kn)if(Kn.hasOwnProperty(jn)&&window.matchMedia("(max-width: ".concat(jn,"px)")).matches)return Kn[jn]}return qn}};return Object.assign(Bn,Fn.match(In)),Un.on("resize",window,eu(function(){s.settings=cu(Bn,Fn.match(In))},s.settings.throttle)),Dn.on("update",function(){In=Su(In),qn=Object.assign({},Bn)}),Dn.on("destroy",function(){Un.off("resize",window)}),Fn}var Ye$2={Html:Se$1,Translate:He$2,Transition:Ve$2,Direction:De$1,Peek:Ae$2,Sizes:Ee$2,Gaps:ye$1,Move:Te$2,Clones:_e$1,Resize:Ie$1,Build:ke$1,Run:ve$1,Swipe:ze$1,Images:Ue$1,Anchors:$e$2,Controls:We$2,Keyboard:Qe$1,Autoplay:Ze$1,Breakpoints:Xe$1},Je$1=(function(s){se$1(Dn,s);var $n=fe$1(Dn);function Dn(){return G(this,Dn),$n.apply(this,arguments)}return uu(Dn,[{key:"mount",value:function(){var Un=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return J$2(F$3(Dn.prototype),"mount",this).call(this,Object.assign({},Ye$2,Un))}}]),Dn})(xe$1);const Ke$2=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(s=>s.charCodeAt(0))),Ge$2=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(s=>s.charCodeAt(0)));var au;const ut$1=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Au=(au=String.fromCodePoint)!==null&&au!==void 0?au:function(s){let $n="";return s>65535&&(s-=65536,$n+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),$n+=String.fromCharCode(s),$n};function et$1(s){var $n;return s>=55296&&s<=57343||s>1114111?65533:($n=ut$1.get(s))!==null&&$n!==void 0?$n:s}var E$2;(function(s){s[s.NUM=35]="NUM",s[s.SEMI=59]="SEMI",s[s.EQUALS=61]="EQUALS",s[s.ZERO=48]="ZERO",s[s.NINE=57]="NINE",s[s.LOWER_A=97]="LOWER_A",s[s.LOWER_F=102]="LOWER_F",s[s.LOWER_X=120]="LOWER_X",s[s.LOWER_Z=122]="LOWER_Z",s[s.UPPER_A=65]="UPPER_A",s[s.UPPER_F=70]="UPPER_F",s[s.UPPER_Z=90]="UPPER_Z"})(E$2||(E$2={}));const tt$1=32;var U$2;(function(s){s[s.VALUE_LENGTH=49152]="VALUE_LENGTH",s[s.BRANCH_LENGTH=16256]="BRANCH_LENGTH",s[s.JUMP_TABLE=127]="JUMP_TABLE"})(U$2||(U$2={}));function fu(s){return s>=E$2.ZERO&&s<=E$2.NINE}function at$1(s){return s>=E$2.UPPER_A&&s<=E$2.UPPER_F||s>=E$2.LOWER_A&&s<=E$2.LOWER_F}function it$1(s){return s>=E$2.UPPER_A&&s<=E$2.UPPER_Z||s>=E$2.LOWER_A&&s<=E$2.LOWER_Z||fu(s)}function rt$1(s){return s===E$2.EQUALS||it$1(s)}var T$1;(function(s){s[s.EntityStart=0]="EntityStart",s[s.NumericStart=1]="NumericStart",s[s.NumericDecimal=2]="NumericDecimal",s[s.NumericHex=3]="NumericHex",s[s.NamedEntity=4]="NamedEntity"})(T$1||(T$1={}));var P$3;(function(s){s[s.Legacy=0]="Legacy",s[s.Strict=1]="Strict",s[s.Attribute=2]="Attribute"})(P$3||(P$3={}));let nt$1=class{constructor($n,Dn,Un){this.decodeTree=$n,this.emitCodePoint=Dn,this.errors=Un,this.state=T$1.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=P$3.Strict}startEntity($n){this.decodeMode=$n,this.state=T$1.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write($n,Dn){switch(this.state){case T$1.EntityStart:return $n.charCodeAt(Dn)===E$2.NUM?(this.state=T$1.NumericStart,this.consumed+=1,this.stateNumericStart($n,Dn+1)):(this.state=T$1.NamedEntity,this.stateNamedEntity($n,Dn));case T$1.NumericStart:return this.stateNumericStart($n,Dn);case T$1.NumericDecimal:return this.stateNumericDecimal($n,Dn);case T$1.NumericHex:return this.stateNumericHex($n,Dn);case T$1.NamedEntity:return this.stateNamedEntity($n,Dn)}}stateNumericStart($n,Dn){return Dn>=$n.length?-1:($n.charCodeAt(Dn)|tt$1)===E$2.LOWER_X?(this.state=T$1.NumericHex,this.consumed+=1,this.stateNumericHex($n,Dn+1)):(this.state=T$1.NumericDecimal,this.stateNumericDecimal($n,Dn))}addToNumericResult($n,Dn,Un,Bn){if(Dn!==Un){const In=Un-Dn;this.result=this.result*Math.pow(Bn,In)+Number.parseInt($n.substr(Dn,In),Bn),this.consumed+=In}}stateNumericHex($n,Dn){const Un=Dn;for(;Dn<$n.length;){const Bn=$n.charCodeAt(Dn);if(fu(Bn)||at$1(Bn))Dn+=1;else return this.addToNumericResult($n,Un,Dn,16),this.emitNumericEntity(Bn,3)}return this.addToNumericResult($n,Un,Dn,16),-1}stateNumericDecimal($n,Dn){const Un=Dn;for(;Dn<$n.length;){const Bn=$n.charCodeAt(Dn);if(fu(Bn))Dn+=1;else return this.addToNumericResult($n,Un,Dn,10),this.emitNumericEntity(Bn,2)}return this.addToNumericResult($n,Un,Dn,10),-1}emitNumericEntity($n,Dn){var Un;if(this.consumed<=Dn)return(Un=this.errors)===null||Un===void 0||Un.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if($n===E$2.SEMI)this.consumed+=1;else if(this.decodeMode===P$3.Strict)return 0;return this.emitCodePoint(et$1(this.result),this.consumed),this.errors&&($n!==E$2.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity($n,Dn){const{decodeTree:Un}=this;let Bn=Un[this.treeIndex],In=(Bn&U$2.VALUE_LENGTH)>>14;for(;Dn<$n.length;Dn++,this.excess++){const qn=$n.charCodeAt(Dn);if(this.treeIndex=st$1(Un,Bn,this.treeIndex+Math.max(1,In),qn),this.treeIndex<0)return this.result===0||this.decodeMode===P$3.Attribute&&(In===0||rt$1(qn))?0:this.emitNotTerminatedNamedEntity();if(Bn=Un[this.treeIndex],In=(Bn&U$2.VALUE_LENGTH)>>14,In!==0){if(qn===E$2.SEMI)return this.emitNamedEntityData(this.treeIndex,In,this.consumed+this.excess);this.decodeMode!==P$3.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var $n;const{result:Dn,decodeTree:Un}=this,Bn=(Un[Dn]&U$2.VALUE_LENGTH)>>14;return this.emitNamedEntityData(Dn,Bn,this.consumed),($n=this.errors)===null||$n===void 0||$n.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData($n,Dn,Un){const{decodeTree:Bn}=this;return this.emitCodePoint(Dn===1?Bn[$n]&~U$2.VALUE_LENGTH:Bn[$n+1],Un),Dn===3&&this.emitCodePoint(Bn[$n+2],Un),Un}end(){var $n;switch(this.state){case T$1.NamedEntity:return this.result!==0&&(this.decodeMode!==P$3.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case T$1.NumericDecimal:return this.emitNumericEntity(0,2);case T$1.NumericHex:return this.emitNumericEntity(0,3);case T$1.NumericStart:return($n=this.errors)===null||$n===void 0||$n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case T$1.EntityStart:return 0}}};function st$1(s,$n,Dn,Un){const Bn=($n&U$2.BRANCH_LENGTH)>>7,In=$n&U$2.JUMP_TABLE;if(Bn===0)return In!==0&&Un===In?Dn:-1;if(In){const Kn=Un-In;return Kn<0||Kn>=Bn?-1:s[Dn+Kn]-1}let qn=Dn,Fn=qn+Bn-1;for(;qn<=Fn;){const Kn=qn+Fn>>>1,jn=s[Kn];if(jn<Un)qn=Kn+1;else if(jn>Un)Fn=Kn-1;else return s[Kn+Bn]}return-1}var h$3;(function(s){s[s.Tab=9]="Tab",s[s.NewLine=10]="NewLine",s[s.FormFeed=12]="FormFeed",s[s.CarriageReturn=13]="CarriageReturn",s[s.Space=32]="Space",s[s.ExclamationMark=33]="ExclamationMark",s[s.Number=35]="Number",s[s.Amp=38]="Amp",s[s.SingleQuote=39]="SingleQuote",s[s.DoubleQuote=34]="DoubleQuote",s[s.Dash=45]="Dash",s[s.Slash=47]="Slash",s[s.Zero=48]="Zero",s[s.Nine=57]="Nine",s[s.Semi=59]="Semi",s[s.Lt=60]="Lt",s[s.Eq=61]="Eq",s[s.Gt=62]="Gt",s[s.Questionmark=63]="Questionmark",s[s.UpperA=65]="UpperA",s[s.LowerA=97]="LowerA",s[s.UpperF=70]="UpperF",s[s.LowerF=102]="LowerF",s[s.UpperZ=90]="UpperZ",s[s.LowerZ=122]="LowerZ",s[s.LowerX=120]="LowerX",s[s.OpeningSquareBracket=91]="OpeningSquareBracket"})(h$3||(h$3={}));var o$1;(function(s){s[s.Text=1]="Text",s[s.BeforeTagName=2]="BeforeTagName",s[s.InTagName=3]="InTagName",s[s.InSelfClosingTag=4]="InSelfClosingTag",s[s.BeforeClosingTagName=5]="BeforeClosingTagName",s[s.InClosingTagName=6]="InClosingTagName",s[s.AfterClosingTagName=7]="AfterClosingTagName",s[s.BeforeAttributeName=8]="BeforeAttributeName",s[s.InAttributeName=9]="InAttributeName",s[s.AfterAttributeName=10]="AfterAttributeName",s[s.BeforeAttributeValue=11]="BeforeAttributeValue",s[s.InAttributeValueDq=12]="InAttributeValueDq",s[s.InAttributeValueSq=13]="InAttributeValueSq",s[s.InAttributeValueNq=14]="InAttributeValueNq",s[s.BeforeDeclaration=15]="BeforeDeclaration",s[s.InDeclaration=16]="InDeclaration",s[s.InProcessingInstruction=17]="InProcessingInstruction",s[s.BeforeComment=18]="BeforeComment",s[s.CDATASequence=19]="CDATASequence",s[s.InSpecialComment=20]="InSpecialComment",s[s.InCommentLike=21]="InCommentLike",s[s.BeforeSpecialS=22]="BeforeSpecialS",s[s.BeforeSpecialT=23]="BeforeSpecialT",s[s.SpecialStartSequence=24]="SpecialStartSequence",s[s.InSpecialTag=25]="InSpecialTag",s[s.InEntity=26]="InEntity"})(o$1||(o$1={}));function V$2(s){return s===h$3.Space||s===h$3.NewLine||s===h$3.Tab||s===h$3.FormFeed||s===h$3.CarriageReturn}function X(s){return s===h$3.Slash||s===h$3.Gt||V$2(s)}function ct$1(s){return s>=h$3.LowerA&&s<=h$3.LowerZ||s>=h$3.UpperA&&s<=h$3.UpperZ}var M$3;(function(s){s[s.NoValue=0]="NoValue",s[s.Unquoted=1]="Unquoted",s[s.Single=2]="Single",s[s.Double=3]="Double"})(M$3||(M$3={}));const A={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101]),TextareaEnd:new Uint8Array([60,47,116,101,120,116,97,114,101,97]),XmpEnd:new Uint8Array([60,47,120,109,112])};let ot$1=class{constructor({xmlMode:$n=!1,decodeEntities:Dn=!0},Un){this.cbs=Un,this.state=o$1.Text,this.buffer="",this.sectionStart=0,this.index=0,this.entityStart=0,this.baseState=o$1.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.xmlMode=$n,this.decodeEntities=Dn,this.entityDecoder=new nt$1($n?Ge$2:Ke$2,(Bn,In)=>this.emitCodePoint(Bn,In))}reset(){this.state=o$1.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=o$1.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write($n){this.offset+=this.buffer.length,this.buffer=$n,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}stateText($n){$n===h$3.Lt||!this.decodeEntities&&this.fastForwardTo(h$3.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=o$1.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&$n===h$3.Amp&&this.startEntity()}stateSpecialStartSequence($n){const Dn=this.sequenceIndex===this.currentSequence.length;if(!(Dn?X($n):($n|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!Dn){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=o$1.InTagName,this.stateInTagName($n)}stateInSpecialTag($n){if(this.sequenceIndex===this.currentSequence.length){if($n===h$3.Gt||V$2($n)){const Dn=this.index-this.currentSequence.length;if(this.sectionStart<Dn){const Un=this.index;this.index=Dn,this.cbs.ontext(this.sectionStart,Dn),this.index=Un}this.isSpecial=!1,this.sectionStart=Dn+2,this.stateInClosingTagName($n);return}this.sequenceIndex=0}($n|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===A.TitleEnd?this.decodeEntities&&$n===h$3.Amp&&this.startEntity():this.fastForwardTo(h$3.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+($n===h$3.Lt)}stateCDATASequence($n){$n===A.Cdata[this.sequenceIndex]?++this.sequenceIndex===A.Cdata.length&&(this.state=o$1.InCommentLike,this.currentSequence=A.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=o$1.InDeclaration,this.stateInDeclaration($n))}fastForwardTo($n){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===$n)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike($n){$n===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===A.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=o$1.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):$n!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar($n){return this.xmlMode?!X($n):ct$1($n)}startSpecial($n,Dn){this.isSpecial=!0,this.currentSequence=$n,this.sequenceIndex=Dn,this.state=o$1.SpecialStartSequence}stateBeforeTagName($n){if($n===h$3.ExclamationMark)this.state=o$1.BeforeDeclaration,this.sectionStart=this.index+1;else if($n===h$3.Questionmark)this.state=o$1.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar($n)){const Dn=$n|32;this.sectionStart=this.index,this.xmlMode?this.state=o$1.InTagName:Dn===A.ScriptEnd[2]?this.state=o$1.BeforeSpecialS:Dn===A.TitleEnd[2]||Dn===A.XmpEnd[2]?this.state=o$1.BeforeSpecialT:this.state=o$1.InTagName}else $n===h$3.Slash?this.state=o$1.BeforeClosingTagName:(this.state=o$1.Text,this.stateText($n))}stateInTagName($n){X($n)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=o$1.BeforeAttributeName,this.stateBeforeAttributeName($n))}stateBeforeClosingTagName($n){V$2($n)||($n===h$3.Gt?this.state=o$1.Text:(this.state=this.isTagStartChar($n)?o$1.InClosingTagName:o$1.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName($n){($n===h$3.Gt||V$2($n))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=o$1.AfterClosingTagName,this.stateAfterClosingTagName($n))}stateAfterClosingTagName($n){($n===h$3.Gt||this.fastForwardTo(h$3.Gt))&&(this.state=o$1.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName($n){$n===h$3.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=o$1.InSpecialTag,this.sequenceIndex=0):this.state=o$1.Text,this.sectionStart=this.index+1):$n===h$3.Slash?this.state=o$1.InSelfClosingTag:V$2($n)||(this.state=o$1.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag($n){$n===h$3.Gt?(this.cbs.onselfclosingtag(this.index),this.state=o$1.Text,this.sectionStart=this.index+1,this.isSpecial=!1):V$2($n)||(this.state=o$1.BeforeAttributeName,this.stateBeforeAttributeName($n))}stateInAttributeName($n){($n===h$3.Eq||X($n))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=this.index,this.state=o$1.AfterAttributeName,this.stateAfterAttributeName($n))}stateAfterAttributeName($n){$n===h$3.Eq?this.state=o$1.BeforeAttributeValue:$n===h$3.Slash||$n===h$3.Gt?(this.cbs.onattribend(M$3.NoValue,this.sectionStart),this.sectionStart=-1,this.state=o$1.BeforeAttributeName,this.stateBeforeAttributeName($n)):V$2($n)||(this.cbs.onattribend(M$3.NoValue,this.sectionStart),this.state=o$1.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue($n){$n===h$3.DoubleQuote?(this.state=o$1.InAttributeValueDq,this.sectionStart=this.index+1):$n===h$3.SingleQuote?(this.state=o$1.InAttributeValueSq,this.sectionStart=this.index+1):V$2($n)||(this.sectionStart=this.index,this.state=o$1.InAttributeValueNq,this.stateInAttributeValueNoQuotes($n))}handleInAttributeValue($n,Dn){$n===Dn||!this.decodeEntities&&this.fastForwardTo(Dn)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(Dn===h$3.DoubleQuote?M$3.Double:M$3.Single,this.index+1),this.state=o$1.BeforeAttributeName):this.decodeEntities&&$n===h$3.Amp&&this.startEntity()}stateInAttributeValueDoubleQuotes($n){this.handleInAttributeValue($n,h$3.DoubleQuote)}stateInAttributeValueSingleQuotes($n){this.handleInAttributeValue($n,h$3.SingleQuote)}stateInAttributeValueNoQuotes($n){V$2($n)||$n===h$3.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(M$3.Unquoted,this.index),this.state=o$1.BeforeAttributeName,this.stateBeforeAttributeName($n)):this.decodeEntities&&$n===h$3.Amp&&this.startEntity()}stateBeforeDeclaration($n){$n===h$3.OpeningSquareBracket?(this.state=o$1.CDATASequence,this.sequenceIndex=0):this.state=$n===h$3.Dash?o$1.BeforeComment:o$1.InDeclaration}stateInDeclaration($n){($n===h$3.Gt||this.fastForwardTo(h$3.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=o$1.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction($n){($n===h$3.Gt||this.fastForwardTo(h$3.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=o$1.Text,this.sectionStart=this.index+1)}stateBeforeComment($n){$n===h$3.Dash?(this.state=o$1.InCommentLike,this.currentSequence=A.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=o$1.InDeclaration}stateInSpecialComment($n){($n===h$3.Gt||this.fastForwardTo(h$3.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=o$1.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS($n){const Dn=$n|32;Dn===A.ScriptEnd[3]?this.startSpecial(A.ScriptEnd,4):Dn===A.StyleEnd[3]?this.startSpecial(A.StyleEnd,4):(this.state=o$1.InTagName,this.stateInTagName($n))}stateBeforeSpecialT($n){switch($n|32){case A.TitleEnd[3]:{this.startSpecial(A.TitleEnd,4);break}case A.TextareaEnd[3]:{this.startSpecial(A.TextareaEnd,4);break}case A.XmpEnd[3]:{this.startSpecial(A.XmpEnd,4);break}default:this.state=o$1.InTagName,this.stateInTagName($n)}}startEntity(){this.baseState=this.state,this.state=o$1.InEntity,this.entityStart=this.index,this.entityDecoder.startEntity(this.xmlMode?P$3.Strict:this.baseState===o$1.Text||this.baseState===o$1.InSpecialTag?P$3.Legacy:P$3.Attribute)}stateInEntity(){const $n=this.entityDecoder.write(this.buffer,this.index-this.offset);$n>=0?(this.state=this.baseState,$n===0&&(this.index=this.entityStart)):this.index=this.offset+this.buffer.length-1}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===o$1.Text||this.state===o$1.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===o$1.InAttributeValueDq||this.state===o$1.InAttributeValueSq||this.state===o$1.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const $n=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case o$1.Text:{this.stateText($n);break}case o$1.SpecialStartSequence:{this.stateSpecialStartSequence($n);break}case o$1.InSpecialTag:{this.stateInSpecialTag($n);break}case o$1.CDATASequence:{this.stateCDATASequence($n);break}case o$1.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes($n);break}case o$1.InAttributeName:{this.stateInAttributeName($n);break}case o$1.InCommentLike:{this.stateInCommentLike($n);break}case o$1.InSpecialComment:{this.stateInSpecialComment($n);break}case o$1.BeforeAttributeName:{this.stateBeforeAttributeName($n);break}case o$1.InTagName:{this.stateInTagName($n);break}case o$1.InClosingTagName:{this.stateInClosingTagName($n);break}case o$1.BeforeTagName:{this.stateBeforeTagName($n);break}case o$1.AfterAttributeName:{this.stateAfterAttributeName($n);break}case o$1.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes($n);break}case o$1.BeforeAttributeValue:{this.stateBeforeAttributeValue($n);break}case o$1.BeforeClosingTagName:{this.stateBeforeClosingTagName($n);break}case o$1.AfterClosingTagName:{this.stateAfterClosingTagName($n);break}case o$1.BeforeSpecialS:{this.stateBeforeSpecialS($n);break}case o$1.BeforeSpecialT:{this.stateBeforeSpecialT($n);break}case o$1.InAttributeValueNq:{this.stateInAttributeValueNoQuotes($n);break}case o$1.InSelfClosingTag:{this.stateInSelfClosingTag($n);break}case o$1.InDeclaration:{this.stateInDeclaration($n);break}case o$1.BeforeDeclaration:{this.stateBeforeDeclaration($n);break}case o$1.BeforeComment:{this.stateBeforeComment($n);break}case o$1.InProcessingInstruction:{this.stateInProcessingInstruction($n);break}case o$1.InEntity:{this.stateInEntity();break}}this.index++}this.cleanup()}finish(){this.state===o$1.InEntity&&(this.entityDecoder.end(),this.state=this.baseState),this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const $n=this.buffer.length+this.offset;this.sectionStart>=$n||(this.state===o$1.InCommentLike?this.currentSequence===A.CdataEnd?this.cbs.oncdata(this.sectionStart,$n,0):this.cbs.oncomment(this.sectionStart,$n,0):this.state===o$1.InTagName||this.state===o$1.BeforeAttributeName||this.state===o$1.BeforeAttributeValue||this.state===o$1.AfterAttributeName||this.state===o$1.InAttributeName||this.state===o$1.InAttributeValueSq||this.state===o$1.InAttributeValueDq||this.state===o$1.InAttributeValueNq||this.state===o$1.InClosingTagName||this.cbs.ontext(this.sectionStart,$n))}emitCodePoint($n,Dn){this.baseState!==o$1.Text&&this.baseState!==o$1.InSpecialTag?(this.sectionStart<this.entityStart&&this.cbs.onattribdata(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+Dn,this.index=this.sectionStart-1,this.cbs.onattribentity($n)):(this.sectionStart<this.entityStart&&this.cbs.ontext(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+Dn,this.index=this.sectionStart-1,this.cbs.ontextentity($n,this.sectionStart))}};const j$2=new Set(["input","option","optgroup","select","button","datalist","textarea"]),v$1=new Set(["p"]),Tu=new Set(["thead","tbody"]),Eu=new Set(["dd","dt"]),ku=new Set(["rt","rp"]),dt$1=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",v$1],["h1",v$1],["h2",v$1],["h3",v$1],["h4",v$1],["h5",v$1],["h6",v$1],["select",j$2],["input",j$2],["output",j$2],["button",j$2],["datalist",j$2],["textarea",j$2],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",Eu],["dt",Eu],["address",v$1],["article",v$1],["aside",v$1],["blockquote",v$1],["details",v$1],["div",v$1],["dl",v$1],["fieldset",v$1],["figcaption",v$1],["figure",v$1],["footer",v$1],["form",v$1],["header",v$1],["hr",v$1],["main",v$1],["nav",v$1],["ol",v$1],["pre",v$1],["section",v$1],["table",v$1],["ul",v$1],["rt",ku],["rp",ku],["tbody",Tu],["tfoot",Tu]]),ft$1=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),_u=new Set(["math","svg"]),Iu=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),lt$1=/\s|\//;let bt$1=class{constructor($n,Dn={}){var Un,Bn,In,qn,Fn,Kn;this.options=Dn,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=$n??{},this.htmlMode=!this.options.xmlMode,this.lowerCaseTagNames=(Un=Dn.lowerCaseTags)!==null&&Un!==void 0?Un:this.htmlMode,this.lowerCaseAttributeNames=(Bn=Dn.lowerCaseAttributeNames)!==null&&Bn!==void 0?Bn:this.htmlMode,this.recognizeSelfClosing=(In=Dn.recognizeSelfClosing)!==null&&In!==void 0?In:!this.htmlMode,this.tokenizer=new((qn=Dn.Tokenizer)!==null&&qn!==void 0?qn:ot$1)(this.options,this),this.foreignContext=[!this.htmlMode],(Kn=(Fn=this.cbs).onparserinit)===null||Kn===void 0||Kn.call(Fn,this)}ontext($n,Dn){var Un,Bn;const In=this.getSlice($n,Dn);this.endIndex=Dn-1,(Bn=(Un=this.cbs).ontext)===null||Bn===void 0||Bn.call(Un,In),this.startIndex=Dn}ontextentity($n,Dn){var Un,Bn;this.endIndex=Dn-1,(Bn=(Un=this.cbs).ontext)===null||Bn===void 0||Bn.call(Un,Au($n)),this.startIndex=Dn}isVoidElement($n){return this.htmlMode&&ft$1.has($n)}onopentagname($n,Dn){this.endIndex=Dn;let Un=this.getSlice($n,Dn);this.lowerCaseTagNames&&(Un=Un.toLowerCase()),this.emitOpenTag(Un)}emitOpenTag($n){var Dn,Un,Bn,In;this.openTagStart=this.startIndex,this.tagname=$n;const qn=this.htmlMode&&dt$1.get($n);if(qn)for(;this.stack.length>0&&qn.has(this.stack[0]);){const Fn=this.stack.shift();(Un=(Dn=this.cbs).onclosetag)===null||Un===void 0||Un.call(Dn,Fn,!0)}this.isVoidElement($n)||(this.stack.unshift($n),this.htmlMode&&(_u.has($n)?this.foreignContext.unshift(!0):Iu.has($n)&&this.foreignContext.unshift(!1))),(In=(Bn=this.cbs).onopentagname)===null||In===void 0||In.call(Bn,$n),this.cbs.onopentag&&(this.attribs={})}endOpenTag($n){var Dn,Un;this.startIndex=this.openTagStart,this.attribs&&((Un=(Dn=this.cbs).onopentag)===null||Un===void 0||Un.call(Dn,this.tagname,this.attribs,$n),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend($n){this.endIndex=$n,this.endOpenTag(!1),this.startIndex=$n+1}onclosetag($n,Dn){var Un,Bn,In,qn,Fn,Kn,jn,Yn;this.endIndex=Dn;let Zn=this.getSlice($n,Dn);if(this.lowerCaseTagNames&&(Zn=Zn.toLowerCase()),this.htmlMode&&(_u.has(Zn)||Iu.has(Zn))&&this.foreignContext.shift(),this.isVoidElement(Zn))this.htmlMode&&Zn==="br"&&((qn=(In=this.cbs).onopentagname)===null||qn===void 0||qn.call(In,"br"),(Kn=(Fn=this.cbs).onopentag)===null||Kn===void 0||Kn.call(Fn,"br",{},!0),(Yn=(jn=this.cbs).onclosetag)===null||Yn===void 0||Yn.call(jn,"br",!1));else{const Xn=this.stack.indexOf(Zn);if(Xn!==-1)for(let Jn=0;Jn<=Xn;Jn++){const Wn=this.stack.shift();(Bn=(Un=this.cbs).onclosetag)===null||Bn===void 0||Bn.call(Un,Wn,Jn!==Xn)}else this.htmlMode&&Zn==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=Dn+1}onselfclosingtag($n){this.endIndex=$n,this.recognizeSelfClosing||this.foreignContext[0]?(this.closeCurrentTag(!1),this.startIndex=$n+1):this.onopentagend($n)}closeCurrentTag($n){var Dn,Un;const Bn=this.tagname;this.endOpenTag($n),this.stack[0]===Bn&&((Un=(Dn=this.cbs).onclosetag)===null||Un===void 0||Un.call(Dn,Bn,!$n),this.stack.shift())}onattribname($n,Dn){this.startIndex=$n;const Un=this.getSlice($n,Dn);this.attribname=this.lowerCaseAttributeNames?Un.toLowerCase():Un}onattribdata($n,Dn){this.attribvalue+=this.getSlice($n,Dn)}onattribentity($n){this.attribvalue+=Au($n)}onattribend($n,Dn){var Un,Bn;this.endIndex=Dn,(Bn=(Un=this.cbs).onattribute)===null||Bn===void 0||Bn.call(Un,this.attribname,this.attribvalue,$n===M$3.Double?'"':$n===M$3.Single?"'":$n===M$3.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName($n){const Dn=$n.search(lt$1);let Un=Dn<0?$n:$n.substr(0,Dn);return this.lowerCaseTagNames&&(Un=Un.toLowerCase()),Un}ondeclaration($n,Dn){this.endIndex=Dn;const Un=this.getSlice($n,Dn);if(this.cbs.onprocessinginstruction){const Bn=this.getInstructionName(Un);this.cbs.onprocessinginstruction(`!${Bn}`,`!${Un}`)}this.startIndex=Dn+1}onprocessinginstruction($n,Dn){this.endIndex=Dn;const Un=this.getSlice($n,Dn);if(this.cbs.onprocessinginstruction){const Bn=this.getInstructionName(Un);this.cbs.onprocessinginstruction(`?${Bn}`,`?${Un}`)}this.startIndex=Dn+1}oncomment($n,Dn,Un){var Bn,In,qn,Fn;this.endIndex=Dn,(In=(Bn=this.cbs).oncomment)===null||In===void 0||In.call(Bn,this.getSlice($n,Dn-Un)),(Fn=(qn=this.cbs).oncommentend)===null||Fn===void 0||Fn.call(qn),this.startIndex=Dn+1}oncdata($n,Dn,Un){var Bn,In,qn,Fn,Kn,jn,Yn,Zn,Xn,Jn;this.endIndex=Dn;const Wn=this.getSlice($n,Dn-Un);!this.htmlMode||this.options.recognizeCDATA?((In=(Bn=this.cbs).oncdatastart)===null||In===void 0||In.call(Bn),(Fn=(qn=this.cbs).ontext)===null||Fn===void 0||Fn.call(qn,Wn),(jn=(Kn=this.cbs).oncdataend)===null||jn===void 0||jn.call(Kn)):((Zn=(Yn=this.cbs).oncomment)===null||Zn===void 0||Zn.call(Yn,`[CDATA[${Wn}]]`),(Jn=(Xn=this.cbs).oncommentend)===null||Jn===void 0||Jn.call(Xn)),this.startIndex=Dn+1}onend(){var $n,Dn;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let Un=0;Un<this.stack.length;Un++)this.cbs.onclosetag(this.stack[Un],!0)}(Dn=($n=this.cbs).onend)===null||Dn===void 0||Dn.call($n)}reset(){var $n,Dn,Un,Bn;(Dn=($n=this.cbs).onreset)===null||Dn===void 0||Dn.call($n),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(Bn=(Un=this.cbs).onparserinit)===null||Bn===void 0||Bn.call(Un,this),this.buffers.length=0,this.foreignContext.length=0,this.foreignContext.unshift(!this.htmlMode),this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete($n){this.reset(),this.end($n)}getSlice($n,Dn){for(;$n-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let Un=this.buffers[0].slice($n-this.bufferOffset,Dn-this.bufferOffset);for(;Dn-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),Un+=this.buffers[0].slice(0,Dn-this.bufferOffset);return Un}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write($n){var Dn,Un;if(this.ended){(Un=(Dn=this.cbs).onerror)===null||Un===void 0||Un.call(Dn,new Error(".write() after done!"));return}this.buffers.push($n),this.tokenizer.running&&(this.tokenizer.write($n),this.writeIndex++)}end($n){var Dn,Un;if(this.ended){(Un=(Dn=this.cbs).onerror)===null||Un===void 0||Un.call(Dn,new Error(".end() after done!"));return}$n&&this.write($n),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk($n){this.write($n)}done($n){this.end($n)}};var D$3;(function(s){s.Root="root",s.Text="text",s.Directive="directive",s.Comment="comment",s.Script="script",s.Style="style",s.Tag="tag",s.CDATA="cdata",s.Doctype="doctype"})(D$3||(D$3={}));function ht$1(s){return s.type===D$3.Tag||s.type===D$3.Script||s.type===D$3.Style}D$3.Root;D$3.Text;D$3.Directive;D$3.Comment;D$3.Script;D$3.Style;D$3.Tag;D$3.CDATA;D$3.Doctype;function mt$1(s){return ht$1(s)}function pt$1(s){return Object.prototype.hasOwnProperty.call(s,"children")}var O$4;(function(s){s.Root="root",s.Text="text",s.Directive="directive",s.Comment="comment",s.Script="script",s.Style="style",s.Tag="tag",s.CDATA="cdata",s.Doctype="doctype"})(O$4||(O$4={}));const gt$1=O$4.Root,xt$1=O$4.Text,vt$1=O$4.Directive,yt=O$4.Comment,wt$1=O$4.Script,St$1=O$4.Style,At$1=O$4.Tag,Tt$2=O$4.CDATA,Et$2=O$4.Doctype,Nu=/["&'<>$\x80-\uFFFF]/g,kt$1=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),_t$2=String.prototype.codePointAt!=null?(s,$n)=>s.codePointAt($n):(s,$n)=>(s.charCodeAt($n)&64512)===55296?(s.charCodeAt($n)-55296)*1024+s.charCodeAt($n+1)-56320+65536:s.charCodeAt($n);function Vu(s){let $n="",Dn=0,Un;for(;(Un=Nu.exec(s))!==null;){const Bn=Un.index,In=s.charCodeAt(Bn),qn=kt$1.get(In);qn!==void 0?($n+=s.substring(Dn,Bn)+qn,Dn=Bn+1):($n+=`${s.substring(Dn,Bn)}&#x${_t$2(s,Bn).toString(16)};`,Dn=Nu.lastIndex+=+((In&64512)===55296))}return $n+s.substr(Dn)}function zu(s,$n){return function(Dn){let Un,Bn=0,In="";for(;Un=s.exec(Dn);)Bn!==Un.index&&(In+=Dn.substring(Bn,Un.index)),In+=$n.get(Un[0].charCodeAt(0)),Bn=Un.index+1;return In+Dn.substring(Bn)}}const It$2=zu(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),Nt$1=zu(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),qt$1=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(s=>[s.toLowerCase(),s])),Dt$2=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(s=>[s.toLowerCase(),s])),Rt$2=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function Lt$2(s){return s.replace(/"/g,"&quot;")}function Ot$1(s,$n){var Dn;if(!s)return;const Un=((Dn=$n.encodeEntities)!==null&&Dn!==void 0?Dn:$n.decodeEntities)===!1?Lt$2:$n.xmlMode||$n.encodeEntities!=="utf8"?Vu:It$2;return Object.keys(s).map(Bn=>{var In,qn;const Fn=(In=s[Bn])!==null&&In!==void 0?In:"";return $n.xmlMode==="foreign"&&(Bn=(qn=Dt$2.get(Bn))!==null&&qn!==void 0?qn:Bn),!$n.emptyAttrs&&!$n.xmlMode&&Fn===""?Bn:`${Bn}="${Un(Fn)}"`}).join(" ")}const qu=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function bu(s,$n={}){const Dn="length"in s?s:[s];let Un="";for(let Bn=0;Bn<Dn.length;Bn++)Un+=Bt$1(Dn[Bn],$n);return Un}function Bt$1(s,$n){switch(s.type){case gt$1:return bu(s.children,$n);case Et$2:case vt$1:return Vt$1(s);case yt:return $t$1(s);case Tt$2:return Ut$1(s);case wt$1:case St$1:case At$1:return Ht$1(s,$n);case xt$1:return zt$1(s,$n)}}const Pt$2=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),Mt$1=new Set(["svg","math"]);function Ht$1(s,$n){var Dn;$n.xmlMode==="foreign"&&(s.name=(Dn=qt$1.get(s.name))!==null&&Dn!==void 0?Dn:s.name,s.parent&&Pt$2.has(s.parent.name)&&($n={...$n,xmlMode:!1})),!$n.xmlMode&&Mt$1.has(s.name)&&($n={...$n,xmlMode:"foreign"});let Un=`<${s.name}`;const Bn=Ot$1(s.attribs,$n);return Bn&&(Un+=` ${Bn}`),s.children.length===0&&($n.xmlMode?$n.selfClosingTags!==!1:$n.selfClosingTags&&qu.has(s.name))?($n.xmlMode||(Un+=" "),Un+="/>"):(Un+=">",s.children.length>0&&(Un+=bu(s.children,$n)),($n.xmlMode||!qu.has(s.name))&&(Un+=`</${s.name}>`)),Un}function Vt$1(s){return`<${s.data}>`}function zt$1(s,$n){var Dn;let Un=s.data||"";return((Dn=$n.encodeEntities)!==null&&Dn!==void 0?Dn:$n.decodeEntities)!==!1&&!(!$n.xmlMode&&s.parent&&Rt$2.has(s.parent.name))&&(Un=$n.xmlMode||$n.encodeEntities!=="utf8"?Vu(Un):Nt$1(Un)),Un}function Ut$1(s){return`<![CDATA[${s.children[0].data}]]>`}function $t$1(s){return`<!--${s.data}-->`}function Ct$2(s,$n){return bu(s,$n)}function jt$1(s,$n){const Dn=[],Un=[Array.isArray($n)?$n:[$n]],Bn=[0];for(;;){if(Bn[0]>=Un[0].length){if(Un.length===1)return Dn;Un.shift(),Bn.shift();continue}const In=Un[0][Bn[0]++];mt$1(In)&&s(In)&&Dn.push(In),pt$1(In)&&In.children.length>0&&(Bn.unshift(0),Un.unshift(In.children))}}var Ft$1={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag",CDATA:"cdata"},Uu={exports:{}},Wt=Uu.exports={get firstChild(){var s=this.children;return s&&s[0]||null},get lastChild(){var s=this.children;return s&&s[s.length-1]||null},get nodeType(){return Ru[this.type]||Ru.element}},Du={tagName:"name",childNodes:"children",parentNode:"parent",previousSibling:"prev",nextSibling:"next",nodeValue:"data"},Ru={element:1,text:3,cdata:4,comment:8};Object.keys(Du).forEach(function(s){var $n=Du[s];Object.defineProperty(Wt,s,{get:function(){return this[$n]||null},set:function(Dn){return this[$n]=Dn,Dn}})});var $u=Uu.exports,Cu={exports:{}},Qt$1=$u,Zt$2=Cu.exports=Object.create(Qt$1),Lu={tagName:"name"};Object.keys(Lu).forEach(function(s){var $n=Lu[s];Object.defineProperty(Zt$2,s,{get:function(){return this[$n]||null},set:function(Dn){return this[$n]=Dn,Dn}})});var Xt=Cu.exports,L$4=Ft$1,iu=/\s+/g,Yt=$u,Jt$1=Xt;function I$4(s,$n,Dn){typeof s=="object"?(Dn=$n,$n=s,s=null):typeof $n=="function"&&(Dn=$n,$n=Ou),this._callback=s,this._options=$n||Ou,this._elementCB=Dn,this.dom=[],this._done=!1,this._tagStack=[],this._parser=this._parser||null}var Ou={normalizeWhitespace:!1,withStartIndices:!1,withEndIndices:!1};I$4.prototype.onparserinit=function(s){this._parser=s};I$4.prototype.onreset=function(){I$4.call(this,this._callback,this._options,this._elementCB)};I$4.prototype.onend=function(){this._done||(this._done=!0,this._parser=null,this._handleCallback(null))};I$4.prototype._handleCallback=I$4.prototype.onerror=function(s){if(typeof this._callback=="function")this._callback(s,this.dom);else if(s)throw s};I$4.prototype.onclosetag=function(){var s=this._tagStack.pop();this._options.withEndIndices&&s&&(s.endIndex=this._parser.endIndex),this._elementCB&&this._elementCB(s)};I$4.prototype._createDomElement=function(s){if(!this._options.withDomLvl1)return s;var $n;s.type==="tag"?$n=Object.create(Jt$1):$n=Object.create(Yt);for(var Dn in s)s.hasOwnProperty(Dn)&&($n[Dn]=s[Dn]);return $n};I$4.prototype._addDomElement=function(s){var $n=this._tagStack[this._tagStack.length-1],Dn=$n?$n.children:this.dom,Un=Dn[Dn.length-1];s.next=null,this._options.withStartIndices&&(s.startIndex=this._parser.startIndex),this._options.withEndIndices&&(s.endIndex=this._parser.endIndex),Un?(s.prev=Un,Un.next=s):s.prev=null,Dn.push(s),s.parent=$n||null};I$4.prototype.onopentag=function(s,$n){var Dn={type:s==="script"?L$4.Script:s==="style"?L$4.Style:L$4.Tag,name:s,attribs:$n,children:[]},Un=this._createDomElement(Dn);this._addDomElement(Un),this._tagStack.push(Un)};I$4.prototype.ontext=function(s){var $n=this._options.normalizeWhitespace||this._options.ignoreWhitespace,Dn;if(!this._tagStack.length&&this.dom.length&&(Dn=this.dom[this.dom.length-1]).type===L$4.Text)$n?Dn.data=(Dn.data+s).replace(iu," "):Dn.data+=s;else if(this._tagStack.length&&(Dn=this._tagStack[this._tagStack.length-1])&&(Dn=Dn.children[Dn.children.length-1])&&Dn.type===L$4.Text)$n?Dn.data=(Dn.data+s).replace(iu," "):Dn.data+=s;else{$n&&(s=s.replace(iu," "));var Un=this._createDomElement({data:s,type:L$4.Text});this._addDomElement(Un)}};I$4.prototype.oncomment=function(s){var $n=this._tagStack[this._tagStack.length-1];if($n&&$n.type===L$4.Comment){$n.data+=s;return}var Dn={data:s,type:L$4.Comment},Un=this._createDomElement(Dn);this._addDomElement(Un),this._tagStack.push(Un)};I$4.prototype.oncdatastart=function(){var s={children:[{data:"",type:L$4.Text}],type:L$4.CDATA},$n=this._createDomElement(s);this._addDomElement($n),this._tagStack.push($n)};I$4.prototype.oncommentend=I$4.prototype.oncdataend=function(){this._tagStack.pop()};I$4.prototype.onprocessinginstruction=function(s,$n){var Dn=this._createDomElement({name:s,data:$n,type:L$4.Directive});this._addDomElement(Dn)};var Kt$1=I$4;function Gt(s){const{isLoading:$n,isError:Dn,errorMessage:Un,author:Bn,date:In,shouldShowStats:qn,stats:Fn,statsLoading:Kn,htmlToRender:jn}=s;return Dn?i0(Un||""):`
    <div class="nostr-post-container">
      ${u0($n,Bn,In)}
      ${e0($n,jn)}
      ${qn?t0($n,Fn,Kn):""}
    </div>
  `}function u0(s,$n,Dn){return s?`
      <div class="post-header">
        <div class="post-header-left">
          <div class="author-picture">
            <div style="width: 35px; height: 35px; border-radius: 50%;" class="skeleton"></div>
          </div>
        </div>
        <div class="post-header-middle">
          <div style="width: 70%; height: 10px; border-radius: 10px;" class="skeleton"></div>
          <div style="width: 80%; height: 8px; border-radius: 10px; margin-top: 5px;" class="skeleton"></div>
        </div>
        <div class="post-header-right">
          <div style="width: 100px; height: 10px; border-radius: 10px;" class="skeleton"></div>
        </div>
      </div>
    `:`
    <div class="post-header">
      <div class="post-header-left">
        <div class="author-picture">
          ${$n!=null&&$n.image?`<img src="${$n.image}" alt="Author" />`:""}
        </div>
      </div>
      <div class="post-header-middle">
        ${$n!=null&&$n.displayName?`<span class="author-name">${$n.displayName}</span>`:""}
        ${$n!=null&&$n.nip05?`<span class="author-username">${$n.nip05}</span>`:""}
      </div>
      <div class="post-header-right">
        <span class="post-date">${Dn}</span>
      </div>
    </div>
  `}function e0(s,$n){return s?`
      <div class="post-body">
        <div style="width: 100%; height: 10px; border-radius: 10px; margin-bottom: 15px;" class="skeleton"></div>
        <div style="width: 100%; height: 10px; border-radius: 10px; margin-bottom: 15px;" class="skeleton"></div>
        <div style="width: 30%; height: 10px; border-radius: 10px;" class="skeleton"></div>
      </div>
    `:`
    <div class="post-body">
      ${$n}
    </div>
  `}function t0(s,$n,Dn){return s||Dn?`
      <div class="post-footer">
        <div class='stats-container'>
          <div class="stat">
            <div style="width: 16px; height: 16px; border-radius: 4px;" class="skeleton"></div>
            <div style="width: 20px; height: 16px; border-radius: 4px;" class="skeleton"></div>
          </div>
          <div class="stat">
            <div style="width: 16px; height: 16px; border-radius: 4px;" class="skeleton"></div>
            <div style="width: 20px; height: 16px; border-radius: 4px;" class="skeleton"></div>
          </div>
        </div>
      </div>
    `:`
    <div class="post-footer">
      <div class='stats-container'>
        <div class="stat">
          ${t$1}
          <span>${$n?.replies??0}</span>
        </div>
        <div class="stat">
          ${r$1}
          <span>${$n?.likes??0}</span>
        </div>
      </div>
    </div>
  `}function a0(s,$n,Dn,Un){const Bn=$n?.displayName||"",In=[];let qn=Un;try{const Kn=[],jn=new Kt$1.DomHandler((Zn,Xn)=>{if(Zn)throw Zn;Kn.push(...Xn)},{normalizeWhitespace:!1,withEndIndices:!1,withStartIndices:!1}),Yn=new bt$1(jn);Yn.write(Un),Yn.end(),jt$1(Zn=>{var Xn;return Zn.type==="tag"&&(Zn.name==="img"||Zn.name==="video")&&((Xn=Zn.attribs)==null?void 0:Xn.src)},Kn).forEach(Zn=>{var Xn;if((Xn=Zn.attribs)!=null&&Xn.src){const Jn=Zn.name==="img"?"image":"video";In.push({type:Jn,url:Zn.attribs.src});const Wn=Zn.parent;Wn!=null&&Wn.children&&(Wn.children=Wn.children.filter(tr=>tr!==Zn))}}),qn=Kn.map(Zn=>Ct$2(Zn)).join("")}catch(Kn){console.error("Error processing HTML content:",Kn),qn=Un}let Fn="";if(In.length>0){Fn='<div class="embedded-media-list">';for(const Kn of In)Kn.type==="image"?Fn+=`<div class="embedded-media-item"><img src="${Kn.url}" alt="Embedded image" loading="lazy" /></div>`:Kn.type==="video"&&(Fn+=`<div class="embedded-media-item"><video src="${Kn.url}" controls preload="none"></video></div>`);Fn+="</div>"}return`
    <div class="embedded-post" data-note-id="${s}">
      <div class="embedded-post-header">
        <div class="embedded-author-avatar" style="cursor: pointer;">
          ${$n!=null&&$n.image?`<img src="${$n.image}" alt="Profile">`:""}
        </div>
        <div class="embedded-author-info" style="cursor: pointer;">
          <span class="embedded-author-name">${Bn}</span>
          ${$n!=null&&$n.nip05?`<span class="embedded-author-username">${$n.nip05}</span>`:""}
        </div>
        <div class="embedded-post-date">${Dn}</div>
      </div>
      <div class="embedded-post-content">
        ${qn}
        ${Fn?`<div class="embedded-post-media">${Fn}</div>`:""}
      </div>
    </div>
  `}function i0(s){return`
    <div class="nostr-post-container">
      <div class="post-header">
        <div class="error-icon"></div>
      </div>
      <div class="post-body">
        ${B(s)}
      </div>
    </div>
  `}async function ju(s,$n,Dn,Un){let Bn=s,In=[];const qn=/(nostr:)?(note[a-zA-Z0-9]{59,60}|nevent[a-zA-Z0-9]{58,})/g,Fn=[...Bn.matchAll(qn)];for(const sr of Fn){const fr=sr[0],ur=sr[2],br=sr.index||0;In.push({id:ur,position:br});try{if(!Dn.has(ur)){const Nr=await Un.getPost(ur);Nr&&Dn.set(ur,Nr)}}catch(Nr){console.error(`Failed to fetch embedded post ${ur}:`,Nr)}Bn=Bn.replace(fr," ")}const Kn=[...Bn.matchAll(new RegExp(nip21_exports.NOSTR_URI_REGEX,"g"))],jn=[],Yn=Kn.map(async sr=>{try{const fr=nip21_exports.parse(sr[0]),ur=fr.decoded.data;let br="";if(typeof ur=="string"?br=ur:br=ur.pubkey,br){const Nr=await Un.getNDK().getUser({pubkey:br}).fetchProfile(),Ar=Nr?.displayName||"";jn.push({original:sr[0],replacement:`<a href="https://njump.me/${fr.value}" target="_blank">@${Ar}</a>`})}}catch(fr){console.error("Failed to process Nostr URI:",fr)}});await Promise.all(Yn);for(const sr of jn)Bn=Bn.replace(sr.original,sr.replacement);const Zn=/(\s|^)@(\w+)/g,Xn=[...Bn.matchAll(Zn)],Jn=[];for(const sr of Xn){const fr=sr[0],ur=sr[2];Jn.push({original:fr,replacement:`${sr[1]}<span class="nostr-mention" data-username="${ur}">@${ur}</span>`})}for(const sr of Jn)Bn=Bn.replace(sr.original,sr.replacement);const Wn=[];if($n){const sr=$n.getMatchingTags("a");for(const fr of sr){const ur=fr[1],br=fr[2];ur!=null&&ur.startsWith("video/")&&br&&Wn.push({type:"video",value:br})}}const tr=/(https:\/\/(?!njump\.me)[\w.-]+(?:\.[\w.-]+)+(?:\/[^\s]*)?)/g,ir=[...Bn.matchAll(tr)];if(ir.length>0){let sr=0;for(const fr of ir){const ur=fr.index,br=ur+fr[0].length;ur>sr&&Wn.push({type:"text",value:Bn.substring(sr,ur)});const Nr=fr[0],Ar=new URL(Nr).pathname.toLowerCase();let _r;Ar.match(/\.(jpg|jpeg|png)$/)?_r="image":Ar.endsWith(".gif")?_r="gif":Ar.match(/\.(mp4|webm|mov)$/)?_r="video":_r="link",Wn.push({type:_r,value:Nr}),sr=br}sr<Bn.length&&Wn.push({type:"text",value:Bn.substring(sr)})}else Wn.push({type:"text",value:Bn});if(In.length>0){In.sort((sr,fr)=>fr.position-sr.position);for(const sr of In)Wn.push({type:"embedded-note",noteId:sr.id})}return Wn}function Fu(s){return s===void 0?"":new Date(s*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function Wu(s){const $n=[];let Dn=0,Un="";for(const Bn of s)if(Bn.type==="text")Un+=Bn.value??"";else if(Bn.type==="embedded-note")Un&&($n.push(`<span class="text-content">${Un.replace(/\n/g,"<br />")}</span>`),Un=""),$n.push(`<div class="embedded-post-placeholder" data-note-id="${Bn.noteId}"></div>`);else{Un&&($n.push(`<span class="text-content">${Un.replace(/\n/g,"<br />")}</span>`),Un="");const In=Bn.value??"";if(!F$4(In))continue;switch(Bn.type){case"image":$n.push(`<img class="post-media-item" src="${In}" alt="User uploaded image" loading="lazy">`),Dn++;break;case"gif":$n.push(`<img class="post-media-item" src="${In}" alt="User uploaded GIF" loading="lazy">`),Dn++;break;case"video":$n.push(`<video class="post-media-item" src="${In}" controls></video>`),Dn++;break;case"link":$n.push(`<a href="${In}">${In}</a>`);break}}if(Un&&$n.push(`<span class="text-content">${Un.replace(/\n/g,"<br />")}</span>`),Dn>1){const Bn=[],In=[];let qn=0,Fn=-1;for(let Yn=0;Yn<$n.length;Yn++){const Zn=$n[Yn];(Zn.startsWith("<img")||Zn.startsWith("<video"))&&(Fn===-1&&(Fn=Yn),Bn.push(`<li class="glide__slide">${Zn}</li>`),In.push(`<button class="glide__bullet" data-glide-dir="=${qn}"></button>`),qn++)}const Kn=$n.filter(Yn=>!Yn.startsWith("<img")&&!Yn.startsWith("<video")),jn=`
        <div class="glide" style="margin-top: 20px">
            <div class="glide__track" data-glide-el="track">
                <ul class="glide__slides">
                    ${Bn.join("")}
                </ul>
            </div>

              <div class="glide__bullets" data-glide-el="controls[nav]">
                ${In.join("")}
            </div>
        </div>
      `;$n.length=0,$n.push(...Kn),$n.splice(Fn,0,jn)}return $n.join("")}async function r0(s,$n,Dn,Un){var Bn;const In=s?.querySelectorAll(".embedded-post-placeholder");if(In)for(const qn of In){const Fn=qn.getAttribute("data-note-id");if(Fn){const Kn=await n0(Fn,$n,Dn,Un),jn=document.createElement("div");jn.innerHTML=Kn,(Bn=qn.parentNode)==null||Bn.replaceChild(jn.firstElementChild,qn)}}}async function n0(s,$n,Dn,Un){const Bn=$n.get(s);if(!Bn)return'<div class="embedded-post-error">Post not found</div>';let In=null;try{In=await Bn.author.fetchProfile()}catch(Yn){console.error(`Failed to fetch profile for embedded post ${s}:`,Yn)}const qn=Fu(Bn.created_at),Fn=await ju(Bn.content,Bn,$n,Un),Kn=Wu(Fn),jn=In?{displayName:In.displayName||"",image:F$4(In.picture||"")?In.picture:"",nip05:In.nip05||""}:void 0;return a0(s,jn,qn,Kn)}class s0{constructor($n){this.nostrService=$n}validateInputs({hex:$n,noteid:Dn,eventid:Un}){return!$n&&!Dn&&!Un?"Provide hex, noteid, or eventid attribute":$n&&!S$3($n)?`Invalid hex: ${$n}`:Dn&&!U$3(Dn)?`Invalid noteid: ${Dn}`:Un&&!D$5(Un)?`Invalid eventid: ${Un}`:null}normalizeToHex($n){try{const Dn=nip19_exports$1.decode($n);return Dn.type==="note"?Dn.data:Dn.type==="nevent"?Dn.data.id:null}catch{return S$3($n)?$n:null}}async resolveEvent({hex:$n,noteid:Dn,eventid:Un}){let Bn=null;if(Dn?Bn=this.normalizeToHex(Dn):$n?Bn=$n:Un&&(Bn=this.normalizeToHex(Un)),!Bn)throw new Error("Unable to normalize identifier to hex format");if(!S$3(Bn))throw new Error(`Invalid hex: ${Bn}`);const In=await this.nostrService.resolveNDKEvent({hex:Bn});if(!In)throw new Error("Unable to resolve event from provided identifier");return In}}const c0="nc:event";class o0 extends K$3{constructor($n=!0){super($n),N$3(this,"event",null),N$3(this,"author",null),N$3(this,"authorProfile",null),N$3(this,"formattedDate",""),N$3(this,"eventStatus",this.channel("event")),N$3(this,"authorStatus",this.channel("author")),N$3(this,"loadSeq",0),N$3(this,"eventResolver"),N$3(this,"userResolver"),this.initChannelStatus("event",f$2.Loading,{reflectOverall:!1}),this.initChannelStatus("author",f$2.Loading,{reflectOverall:!1}),this.eventResolver=new s0(this.nostrService),this.userResolver=new u$1(this.nostrService)}static get observedAttributes(){return[...super.observedAttributes,"hex","noteid","eventid"]}connectedCallback(){var $n;($n=super.connectedCallback)==null||$n.call(this),this.validateInputs()&&this.resolveEventAndLoad().catch(Dn=>{console.error("[NostrEventComponent] init failed:",Dn)})}attributeChangedCallback($n,Dn,Un){var Bn;Dn!==Un&&((Bn=super.attributeChangedCallback)==null||Bn.call(this,$n,Dn,Un),($n==="hex"||$n==="noteid"||$n==="eventid")&&this.validateInputs()&&this.resolveEventAndLoad())}validateInputs(){if(!super.validateInputs())return this.eventStatus.set(f$2.Idle),this.authorStatus.set(f$2.Idle),!1;const $n=this.getAttribute("hex"),Dn=this.getAttribute("noteid"),Un=this.getAttribute("eventid"),Bn=this.tagName.toLowerCase(),In=this.eventResolver.validateInputs({hex:$n,noteid:Dn,eventid:Un});return In?(this.eventStatus.set(f$2.Error,In),this.authorStatus.set(f$2.Error,In),console.error(`Nostr-Components: ${Bn}: ${In}`),this.errorMessage=In,!1):(this.errorMessage="",!0)}async resolveEventAndLoad(){const $n=++this.loadSeq;try{await this.ensureNostrConnected()}catch(Dn){if($n!==this.loadSeq)return;console.error("[NostrEventComponent] Relay connect failed before event load:",Dn);return}this.eventStatus.set(f$2.Loading),this.authorStatus.set(f$2.Loading),this.event=null,this.author=null,this.authorProfile=null;try{const Dn=this.getAttribute("hex"),Un=this.getAttribute("noteid"),Bn=this.getAttribute("eventid"),In=await this.eventResolver.resolveEvent({hex:Dn,noteid:Un,eventid:Bn});if($n!==this.loadSeq)return;this.event=In,this.formattedDate=this.formatEventDate(In),this.eventStatus.set(f$2.Ready),this.loadAuthorProfile(In.pubkey,$n),this.dispatchEvent(new CustomEvent(c0,{detail:{event:this.event},bubbles:!0,composed:!0})),this.checkEventAndAuthorReady()}catch(Dn){if($n!==this.loadSeq)return;const Un=Dn instanceof Error?Dn.message:"Failed to load event";console.error("[NostrEventComponent] "+Un,Dn),this.eventStatus.set(f$2.Error,Un)}}async loadAuthorProfile($n,Dn){try{const{user:Un,profile:Bn}=await this.userResolver.resolveUser({pubkey:$n});if(Dn!==this.loadSeq)return;this.author=Un,this.authorProfile=Bn,this.authorStatus.set(f$2.Ready),this.checkEventAndAuthorReady()}catch(Un){if(Dn!==this.loadSeq)return;const Bn=Un instanceof Error?Un.message:"Failed to load author profile";console.error("[NostrEventComponent] "+Bn,Un),this.authorStatus.set(f$2.Error,Bn)}}checkEventAndAuthorReady(){const $n=this.eventStatus.get()===f$2.Ready,Dn=this.authorStatus.get()===f$2.Ready;$n&&Dn&&this.event&&this.onEventReady(this.event)}formatEventDate($n){return Fu($n.created_at)}renderContent(){}onEventReady($n){}}function d0(){return V$3(`
    /* === POST CSS VARIABLES === */
    :host {
      --nostrc-post-bg: var(--nostrc-theme-bg, #ffffff);
      --nostrc-post-text-primary: var(--nostrc-theme-text-primary, #333333);
      --nostrc-post-text-secondary: var(--nostrc-theme-text-secondary, #666666);
      --nostrc-post-border: var(--nostrc-border-width) solid var(--nostrc-color-border);
      --nostrc-post-font-family: var(--nostrc-font-family-primary);
      --nostrc-post-font-size: var(--nostrc-font-size-base);
      
      /* Hover state variables */
      --nostrc-post-hover-bg: var(--nostrc-theme-hover-bg, rgba(0, 0, 0, 0.05));
      --nostrc-post-hover-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-post-hover-border: var(--nostrc-border-width) solid var(--nostrc-theme-border, var(--nostrc-color-border));

      /* Make the host the visual post surface */
      display: block;
      background: var(--nostrc-post-bg);
      color: var(--nostrc-post-text-primary);
      border: var(--nostrc-post-border);
      border-radius: var(--nostrc-border-radius-md);
      font-family: var(--nostrc-post-font-family);
      font-size: var(--nostrc-post-font-size);
      transition: background-color var(--nostrc-transition-duration) var(--nostrc-transition-timing);
    }

    /* === POST CONTAINER PATTERN === */
    .nostr-post-container {
      display: flex;
      flex-direction: column;
      gap: var(--nostrc-spacing-lg);
      padding: var(--nostrc-spacing-md);
      min-height: 100px;
    }

    /* Hover state */
    :host(.is-clickable:hover) {
      background: var(--nostrc-post-hover-bg);
      color: var(--nostrc-post-hover-color);
      border: var(--nostrc-post-hover-border);
    }

    :host(.is-clickable) {
      cursor: pointer;
    }

    :host(.is-error) .nostr-post-container {
      justify-content: center;
      align-items: center;
      color: var(--nostrc-color-error-text);
      border: var(--nostrc-border-width) solid var(--nostrc-color-error-text);
    }

    /* === POST HEADER PATTERN === */
    .post-header {
      display: flex;
      gap: var(--nostrc-spacing-sm);
    }
    
    .post-body {
      display: block;
      width: 100%;
    }

    .post-header-left {
      width: 35px;
      flex-shrink: 0;
    }

    .post-header-left img {
      width: 35px;
      height: 35px;
      border-radius: var(--nostrc-border-radius-full);
      object-fit: cover;
    }

    .post-header-middle {
      display: flex;
      flex-direction: column;
      width: 100%;
      gap: var(--nostrc-spacing-xs);
    }

    .post-header-right {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: end;
    }

    /* === AUTHOR INFO STYLES === */
    .author-name {
      color: var(--nostrc-post-text-primary);
      font-weight: var(--nostrc-font-weight-bold);
      word-break: break-word;
    }

    .author-username {
      font-weight: var(--nostrc-font-weight-normal);
      color: var(--nostrc-post-text-secondary);
      font-size: var(--nostrc-font-size-sm);
      word-break: break-all;
    }

    .post-date {
      font-weight: var(--nostrc-font-weight-normal);
      color: var(--nostrc-post-text-secondary);
      font-size: var(--nostrc-font-size-sm);
    }

    .text-content {
      word-break: break-word;
    }

    /* === POST FOOTER PATTERN === */
    .post-footer {
      margin-top: var(--nostrc-spacing-lg);
      display: block;
      width: 100%;
    }

    .stats-container {
      display: flex;
      gap: var(--nostrc-spacing-lg);
    }

    .stat {
      display: flex;
      gap: var(--nostrc-spacing-xs);
      color: var(--nostrc-post-text-secondary);
    }

    /* === MEDIA STYLING === */
    .post-media-item {
      max-width: 100%;
      max-height: 500px;
      width: auto;
      height: auto;
      object-fit: contain;
      border-radius: var(--nostrc-border-radius-md);
      display: block;
      margin: var(--nostrc-spacing-sm) 0;
    }

    /* === EMBEDDED MEDIA STYLING === */
    .embedded-media-item {
      width: 100%;
      border-radius: var(--nostrc-border-radius-sm);
      overflow: hidden;
      margin: var(--nostrc-spacing-xs) 0;
    }

    .embedded-media-item img,
    .embedded-media-item video {
      width: 100%;
      max-height: 500px;
      object-fit: contain;
      display: block;
    }

    /* === GLIDE CAROUSEL STYLES === */
    .glide {
      position: relative;
      width: 100%;
      box-sizing: border-box;
    }
    .glide * {
      box-sizing: inherit;
    }
    .glide__track {
      overflow: hidden;
    }
    .glide__slides {
      position: relative;
      width: 100%;
      list-style: none;
      backface-visibility: hidden;
      transform-style: preserve-3d;
      touch-action: pan-Y;
      overflow: hidden;
      margin: 0;
      padding: 0;
      white-space: nowrap;
      display: flex;
      flex-wrap: nowrap;
      will-change: transform;
    }
    .glide__slide {
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      white-space: normal;
      user-select: none;
      -webkit-touch-callout: none;
      -webkit-tap-highlight-color: transparent;
    }
    .glide__slide * {
      border-radius: var(--nostrc-border-radius-md);
    }
    .glide__bullets {
      -webkit-touch-callout: none;
      user-select: none;
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 12px;
    }
    .glide__bullet {
      background-color: rgba(0, 0, 0, 0.3);
      border: none;
      border-radius: 50%;
      width: 8px;
      height: 8px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    .glide__bullet:hover,
    .glide__bullet--active {
      background-color: rgba(0, 0, 0, 0.7);
    }

    /* === MENTION STYLES === */
    .nostr-mention {
      color: var(--nostrc-post-accent);
      font-weight: var(--nostrc-font-weight-medium);
      cursor: pointer;
    }
    
    /* === EMBEDDED POST STYLES === */
    .embedded-post {
      margin: var(--nostrc-spacing-sm) 0;
      padding: var(--nostrc-spacing-sm);
      border: var(--nostrc-post-border);
      border-radius: var(--nostrc-border-radius-md);
      background: var(--nostrc-color-background-secondary);
    }
    
    .embedded-post-header {
      display: flex;
      align-items: center;
      margin-bottom: var(--nostrc-spacing-xs);
    }
    
    .embedded-author-avatar {
      width: 24px;
      height: 24px;
      border-radius: var(--nostrc-border-radius-full);
      overflow: hidden;
      margin-right: var(--nostrc-spacing-xs);
    }
    
    .embedded-author-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .embedded-author-info {
      display: flex;
      flex-direction: column;
      flex: 1;
    }
    
    .embedded-author-name {
      font-weight: var(--nostrc-font-weight-bold);
      font-size: var(--nostrc-font-size-sm);
      color: var(--nostrc-post-text-primary);
    }
    
    .embedded-author-username {
      font-size: var(--nostrc-font-size-xs);
      color: var(--nostrc-post-text-secondary);
    }
    
    .embedded-post-date {
      font-size: var(--nostrc-font-size-xs);
      color: var(--nostrc-post-text-secondary);
    }
    
    .embedded-post-content {
      font-size: var(--nostrc-font-size-sm);
      color: var(--nostrc-post-text-primary);
      line-height: 1.4;
      white-space: pre-line;
    }
    
    .embedded-post-media {
      margin-top: var(--nostrc-spacing-sm);
    }
    
    .embedded-media-list {
      display: flex;
      flex-direction: column;
      gap: var(--nostrc-spacing-xs);
    }
    
    .embedded-media-item {
      width: 100%;
      border-radius: var(--nostrc-border-radius-sm);
      overflow: hidden;
    }
    
    .embedded-media-item img,
    .embedded-media-item video {
      width: 100%;
      max-height: 300px;
      object-fit: contain;
      display: block;
    }
    
    .embedded-post-error {
      padding: var(--nostrc-spacing-sm);
      color: var(--nostrc-color-error-text);
      background-color: var(--nostrc-color-error-background);
      border: var(--nostrc-post-border);
      border-radius: var(--nostrc-border-radius-sm);
      font-size: var(--nostrc-font-size-sm);
    }

    :host(.is-error) .post-body {
      text-align: center;
    }
  `)}const f0="nc:post",l0="nc:author",b0="nc:mention";class h0 extends o0{constructor(){super(...arguments),N$3(this,"stats",null),N$3(this,"statsLoading",!1),N$3(this,"embeddedPosts",new Map),N$3(this,"glideInitialized",!1),N$3(this,"cachedParsedContent",null),N$3(this,"cachedHtmlToRender",null)}async connectedCallback(){var $n;($n=super.connectedCallback)==null||$n.call(this),this.attachDelegatedListeners(),this.render()}static get observedAttributes(){return[...super.observedAttributes,"show-stats"]}attributeChangedCallback($n,Dn,Un){var Bn;Dn!==Un&&((Bn=super.attributeChangedCallback)==null||Bn.call(this,$n,Dn,Un),$n==="show-stats"&&this.render())}onStatusChange($n){this.render()}async onEventReady($n){this.invalidateCache(),this.getPostStats(),this.render()}invalidateCache(){this.cachedParsedContent=null,this.cachedHtmlToRender=null,this.glideInitialized=!1}async getPostStats(){try{const $n=this.getAttribute("show-stats")==="true";if(this.event&&$n){this.statsLoading=!0,this.render();const Dn=await z$5(this.nostrService.getNDK(),this.event.id);Dn&&(this.stats=Dn)}}catch($n){const Dn=$n instanceof Error?$n.message:"Failed to load post stats";console.error("[NostrPostComponent] "+Dn,$n),this.eventStatus.set(f$2.Error,Dn)}finally{this.statsLoading=!1,this.render()}}onPostClick(){var $n;const Dn=this.getAttribute("id")||(($n=this.event)==null?void 0:$n.id);Dn&&this.handleNjumpClick(f0,this.event,Dn)}onAuthorClick(){var $n,Dn,Un;const Bn=(($n=this.author)==null?void 0:$n.npub)||((Dn=this.authorProfile)==null?void 0:Dn.nip05);Bn&&this.handleNjumpClick(l0,{author:this.author,authorProfile:this.authorProfile,npub:(Un=this.author)==null?void 0:Un.npub},Bn)}onMentionClick($n){this.handleNjumpClick(b0,{username:$n},`p/${$n}`)}attachDelegatedListeners(){this.delegateEvent("click",".nostr-post-container",$n=>{$n.target.closest("a, .nostr-mention, video, img, .nc-copy-btn, .post-header-left, .post-header-middle")||this.onPostClick()}),this.delegateEvent("click",".post-header-left",$n=>{this.onAuthorClick()}),this.delegateEvent("click",".post-header-middle",$n=>{this.onAuthorClick()}),this.delegateEvent("click",".nostr-mention",$n=>{var Dn;const Un=$n.target,Bn=Un.getAttribute("data-username")||((Dn=Un.textContent)==null?void 0:Dn.slice(1));Bn&&this.onMentionClick(Bn)})}async renderContent(){var $n;const Dn=this.computeOverall()==f$2.Loading,Un=this.computeOverall()===f$2.Error,Bn=this.formattedDate,In=(($n=this.event)==null?void 0:$n.content)||"";if(!this.cachedParsedContent||!this.cachedHtmlToRender){const Yn=await ju(In,this.event,this.embeddedPosts,this.nostrService);this.cachedParsedContent=JSON.stringify(Yn),this.cachedHtmlToRender=Wu(Yn)}const qn=this.cachedHtmlToRender,Fn=this.errorMessage,Kn=this.getAttribute("show-stats")==="true",jn={isLoading:Dn,isError:Un,errorMessage:Fn,author:this.authorProfile,date:Bn,shouldShowStats:Kn,stats:this.stats,statsLoading:this.statsLoading,htmlToRender:qn};this.shadowRoot.innerHTML=`
      ${d0()}
      ${Gt(jn)}
    `,qn.includes("glide")&&!this.glideInitialized&&setTimeout(()=>{var Yn;const Zn=(Yn=this.shadowRoot)==null?void 0:Yn.querySelector(".glide");Zn&&(new Je$1(Zn).mount(),this.glideInitialized=!0)},0),qn.includes("embedded-post-placeholder")&&setTimeout(()=>{r0(this.shadowRoot,this.embeddedPosts,this.event,this.nostrService)},0)}}customElements.get("nostr-post")||customElements.define("nostr-post",h0);var S=Object.defineProperty,L$3=(s,$n,Dn)=>$n in s?S(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,n=(s,$n,Dn)=>L$3(s,typeof $n!="symbol"?$n+"":$n,Dn);function l$3(s,$n,Dn){const Un=B(s);return`
    <div class="stat" data-orientation="horizontal" aria-busy="${Dn}" aria-live="polite">
      <div class="stat-inner">
        <div class="stat-value">
          ${Dn?'<div style="width: 50px; height: 28px; border-radius: 5px" class="skeleton"></div>':$n.toLocaleString()}
        </div>
        <div class="stat-name">${Un}</div>
      </div>
    </div>
  `}function R$2(s){const{isLoading:$n,isError:Dn,errorMessage:Un,npub:Bn,userProfile:In,isStatsLoading:qn,isStatsFollowersLoading:Fn,isStatsFollowsLoading:Kn,isZapsLoading:jn,stats:Yn,showFollow:Zn,showNpub:Xn}=s;if(Dn)return Z$2(Un||"");const Jn=In?.displayName||In?.name||"",Wn=In?.nip05||"",tr=In?.picture||"",ir=In?.about||"",sr=In?.website||"",fr=()=>!Zn||Bn===""?"":`
      <nostr-follow-button
        npub="${Bn}">
      </nostr-follow-button>
    `;return`
    <div class="nostr-profile-container">
      <div class="profile-banner">
        ${$n?'<div style="width: 100%; height: 100%;" class="skeleton"></div>':In!=null&&In.banner?`<img src="${In.banner}" width="524px"/>`:'<div class="banner-placeholder"></div>'}

        <div class="dp-container">
          <div class="avatar" role="img" aria-label="${Jn}">
            ${$n?'<div style="width: 100%; height: 100%; border-radius: 50%" class="skeleton"></div>':`<img
                  src="${tr}"
                  alt="${Jn}"
                  width="142" height="142"
                  loading="lazy" decoding="async"
                  onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 142 142%22%3E%3Crect width=%22142%22 height=%22142%22 fill=%22%23ccc%22/%3E%3C/svg%3E'"
                />`}
          </div>
        </div>
      </div>

      <div class="profile_actions">
        ${Zn?$n?'<div style="width: 100px; height: 36px; border-radius: 18px;" class="skeleton"></div>':fr():""}
      </div>
        
      <div class="profile_data">
        ${$n?'<div style="width: 100px; height: 24px;" class="skeleton"></div>':N$4({name:Jn})}
          
        ${$n?'<div style="width: 75px; height: 20px;" class="skeleton"></div>':v$2(Wn)}

        ${Xn?$n?'<div style="width: 75px; height: 20px;" class="skeleton"></div>':w$2(Bn):""}

        <div class="margin-bottom-md"> </div>
        
        ${$n?'<div style="width: 100%; margin-bottom: 12px; height: 18px" class="skeleton"></div>':l$5({display:ir,value:ir})}

        <div class="margin-bottom-md"> </div>
        
        ${$n?'<div style="width: 150px" class="skeleton"></div>':sr?`<div class="website">
              <a target="_blank" href="${sr}">${sr}</a>
              </div>`:""}
      
        <div class="stats">

          ${l$3("Following",Yn.follows,Kn)}
          
          ${l$3("Followers",Yn.followers,Fn)}

          ${l$3("Notes",Yn.notes,qn)}
          
          ${l$3("Replies",Yn.replies,qn)}
          
          ${l$3("Zaps",Yn.zaps,jn)}
          
        </div>
      </div>
    </div>
  `}function Z$2(s){return`
    <div class='nostr-profile-container'>
      <div class='nostr-profile-top-container'>
        <div class="error-icon">&#9888;</div>
      </div>
      <div class='nostr-profile-bottom-container'>
        ${s}
      </div>
    </div>
  `}function _$4(){return V$3(`
    /* === PROFILE CSS VARIABLES & CONTAINER PATTERN === */
    :host {
      /* Override follow button styles for profile context */
      --nostrc-follow-btn-padding: 5px 8px !important;
      --nostrc-follow-btn-font-size: 14px !important;
      --nostrc-follow-btn-border-radius: 12px !important;
      --nostrc-follow-btn-border: var(--nostrc-border-width) solid var(--nostrc-color-border) !important;
      --nostrc-follow-btn-horizontal-alignment: end !important;
      --nostrc-follow-btn-min-height: auto !important;
      --nostrc-follow-btn-width: 280px;

      /* Component theme variables (fallback to global theme tokens) */
      --nostrc-profile-bg: var(--nostrc-theme-bg, #ffffff);
      --nostrc-profile-text-primary: var(--nostrc-theme-text-primary, #333333);
      --nostrc-profile-text-secondary: var(--nostrc-theme-text-secondary, #666666);
      --nostrc-profile-border: var(--nostrc-theme-border, var(--nostrc-border-width) solid var(--nostrc-color-border));
      --nostrc-profile-banner-placeholder: var(--nostrc-profile-border);
      --nostrc-profile-font-family: var(--nostrc-font-family-primary);
      --nostrc-profile-font-size: var(--nostrc-font-size-base);
      
      /* Hover state variables */
      --nostrc-profile-hover-bg: var(--nostrc-theme-hover-bg, rgba(0, 0, 0, 0.05));
      --nostrc-profile-hover-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-profile-hover-border: var(--nostrc-theme-hover-border, var(--nostrc-border-width) solid var(--nostrc-color-border));

      /* Make the host the visual profile surface */
      display: block;
      background: var(--nostrc-profile-bg);
      color: var(--nostrc-profile-text-primary);
      border: var(--nostrc-profile-border);
      border-radius: var(--nostrc-border-radius-md);
      font-family: var(--nostrc-profile-font-family);
      font-size: var(--nostrc-profile-font-size);
      transition: background-color var(--nostrc-transition-duration) var(--nostrc-transition-timing);
    }

    .nostr-profile-container {
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: var(--nostrc-spacing-md);
      min-height: 500px;
      padding: 0px;
    }

    :host(.is-error) .nostr-profile-container {
      justify-content: center;
      align-items: center;
      color: var(--nostrc-color-error-text);
      border: var(--nostrc-border-width) solid var(--nostrc-color-error-text);
    }

    /* Hover state */
    :host(.is-clickable:hover) {
      background: var(--nostrc-profile-hover-bg);
      color: var(--nostrc-profile-hover-color);
      border: var(--nostrc-profile-hover-border);
    }

    .nostr-profile-top-container img {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
    }

    .nostr-profile-bottom-container {
      min-width: 0;
      text-align: center;
    }

    .profile-banner {
      position: relative;
      width: 100%;
      height: 214px;
      cursor: pointer;
      border-radius: var(--nostrc-border-radius-md) var(--nostrc-border-radius-md) 0px 0px;
    }

    .banner-placeholder {
      width: 100%;
      height: 100%;
      background-color: var(--nostrc-profile-banner-placeholder);
      border-radius: var(--nostrc-border-radius-md) var(--nostrc-border-radius-md) 0px 0px;
    }

    .profile-banner img {
      width: 100%;
      height: 214px;
      object-fit: cover;
    }

    .dp-container {
      position: absolute;
      top: 140px;
      left: var(--nostrc-spacing-md);
    }

    .avatar {
      --avatar-size: 142px;
      --avatar-ring: 4px;

      inline-size: var(--avatar-size);
      block-size: var(--avatar-size);
      border-radius: var(--nostrc-border-radius-full);
      overflow: hidden;

      /* ring + backfill in one place */
      background-color: var(--nostrc-profile-bg);
      border: var(--avatar-ring) solid var(--nostrc-profile-bg);
    }

    .avatar img {
      inline-size: 100%;
      block-size: 100%;
      border-radius: var(--nostrc-border-radius-full);
      display: block;
      object-fit: cover;
    }

    .profile_actions {
      height: 56px;
      align-self: flex-end;
      padding: 0 var(--nostrc-spacing-lg);
    }

    .profile_data {
      padding: var(--nostrc-spacing-md);
    }

    .website {
      font-weight: 400;
      font-size: var(--nostrc-font-size-base);
      line-height: 20px;
      display: flex;
      align-items: center;
    }

    .website a {
      line-height: 20px;
      outline: none;
      color: var(--nostrc-profile-accent);
      max-width: 350px;
      overflow: hidden;
      text-overflow: ellipsis;
      word-wrap: normal;
    }

    .stats {
      position: relative;
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      border-radius: 0;
      border-top: none;
      margin-top: var(--nostrc-spacing-md);
    }

    .stat {
      position: relative;
      display: inline-block;
      padding-inline: var(--nostrc-spacing-md);
      padding-block: var(--nostrc-spacing-xs);
      border: none;
      background: none;
      width: fit-content;
      height: 40px;
      margin: 0 0 var(--nostrc-spacing-md);
    }

    .stat-inner {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .stat-inner .stat-value {
      font-weight: 100;
      font-size: 1.5em;
      color: var(--nostrc-profile-text-primary);
    }

    .stat-inner .stat-name {
      font-weight: 400;
      line-height: 16px;
      text-transform: lowercase;
      color: var(--nostrc-profile-text-secondary);
    }

    @media only screen and (max-width: 600px) {
      .stat .stat-value {
        font-size: 18px !important;
      }
      :host {
        --nostrc-follow-btn-padding: 5px 8px !important;
        --nostrc-follow-btn-font-size: 12px !important;
        --nostrc-follow-btn-min-height: auto !important;
        --nostrc-follow-btn-border-radius: 8px !important;
        --nostrc-follow-btn-error-max-width: 150px !important;
      }
    }

  `)}const j$1="nc:profile";let O$3=class extends C$2{constructor(){super(...arguments),n(this,"profileStatus",this.channel("profile")),n(this,"isStatsLoading",!0),n(this,"isStatsFollowsLoading",!0),n(this,"isStatsFollowersLoading",!0),n(this,"isZapsLoading",!0),n(this,"stats",{follows:0,followers:0,notes:0,replies:0,zaps:0,relays:0}),n(this,"getUserStats",async()=>{try{this.isStatsLoading=!0,this.isStatsFollowsLoading=!0,this.isStatsFollowersLoading=!0,this.isZapsLoading=!0,this.nostrService.fetchFollows(this.user).then($n=>{this.stats={...this.stats,follows:$n},this.isStatsFollowsLoading=!1,this.render()}).catch($n=>{console.error("Error loading follows:",$n),this.isStatsFollowsLoading=!1,this.render()}),this.nostrService.fetchFollowers(this.user).then($n=>{this.stats={...this.stats,followers:$n},this.isStatsFollowersLoading=!1,this.render()}).catch($n=>{console.error("Error loading followers:",$n),this.isStatsFollowersLoading=!1,this.render()}),this.nostrService.fetchNotesAndReplies(this.user).then(([$n,Dn])=>{this.stats={...this.stats,notes:$n,replies:Dn},this.isStatsLoading=!1,this.render()}).catch($n=>{console.error("Error loading notes and replies",$n),this.isStatsLoading=!1,this.render()}),this.nostrService.fetchZaps(this.user).then($n=>{this.stats={...this.stats,zaps:$n},this.isZapsLoading=!1,this.render()}).catch($n=>{console.error("Error loading Zaps:",$n),this.isZapsLoading=!1,this.render()})}catch($n){this.profileStatus.set(f$2.Error),console.error("getUserStats failed:",$n)}finally{this.render()}})}static get observedAttributes(){return[...super.observedAttributes,"show-npub","show-follow"]}async connectedCallback(){var $n;($n=super.connectedCallback)==null||$n.call(this),this.attachDelegatedListeners(),g$2({addDelegatedListener:this.addDelegatedListener.bind(this)}),this.render()}onStatusChange($n){this.render()}onUserReady($n,Dn){this.getUserStats(),this.render()}attributeChangedCallback($n,Dn,Un){var Bn;Dn!==Un&&((Bn=super.attributeChangedCallback)==null||Bn.call(this,$n,Dn,Un),($n==="show-npub"||$n==="show-follow")&&this.render())}onProfileClick(){var $n,Dn;if(this.profileStatus.get()===f$2.Error)return;const Un=(($n=this.user)==null?void 0:$n.npub)||this.getAttribute("npub")||((Dn=this.profile)==null?void 0:Dn.nip05)||this.getAttribute("nip05");Un&&this.handleNjumpClick(j$1,this.profile,encodeURIComponent(Un))}attachDelegatedListeners(){this.delegateEvent("click",".profile-banner",$n=>{$n.target.closest(".nc-copy-btn, .nostr-follow-button-container, nostr-follow-button")||this.onProfileClick()})}renderContent(){var $n;const Dn=this.computeOverall()===f$2.Loading,Un=this.computeOverall()===f$2.Error,Bn=this.getAttribute("show-npub")==="true",In=this.getAttribute("show-follow")==="true",qn={isLoading:Dn,isError:Un,errorMessage:this.errorMessage,npub:(($n=this.user)==null?void 0:$n.npub)||"",userProfile:this.profile,isStatsLoading:this.isStatsLoading,isStatsFollowersLoading:this.isStatsFollowersLoading,isStatsFollowsLoading:this.isStatsFollowsLoading,isZapsLoading:this.isZapsLoading,stats:{notes:this.stats.notes,replies:this.stats.replies,follows:this.stats.follows,followers:this.stats.followers,zaps:this.stats.zaps,relays:this.stats.relays},showFollow:In,showNpub:Bn};this.shadowRoot.innerHTML=`
      ${_$4()}
      ${R$2(qn)}
    `}};customElements.get("nostr-profile")||customElements.define("nostr-profile",O$3);function c$3(s=21,$n=24){return a$3(s,$n)}function i$2(){return o$2()}function e$1(s="dark"){return e$2(s)}const scriptRel="modulepreload",assetsURL=function(s){return"/memory-game/"+s},seen={},__vitePreload=function s($n,Dn,Un){let Bn=Promise.resolve();if(Dn&&Dn.length>0){let Kn=function(jn){return Promise.all(jn.map(Yn=>Promise.resolve(Yn).then(Zn=>({status:"fulfilled",value:Zn}),Zn=>({status:"rejected",reason:Zn}))))};document.getElementsByTagName("link");const qn=document.querySelector("meta[property=csp-nonce]"),Fn=qn?.nonce||qn?.getAttribute("nonce");Bn=Kn(Dn.map(jn=>{if(jn=assetsURL(jn),jn in seen)return;seen[jn]=!0;const Yn=jn.endsWith(".css"),Zn=Yn?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${jn}"]${Zn}`))return;const Xn=document.createElement("link");if(Xn.rel=Yn?"stylesheet":scriptRel,Yn||(Xn.as="script"),Xn.crossOrigin="",Xn.href=jn,Fn&&Xn.setAttribute("nonce",Fn),document.head.appendChild(Xn),Yn)return new Promise((Jn,Wn)=>{Xn.addEventListener("load",Jn),Xn.addEventListener("error",()=>Wn(new Error(`Unable to preload CSS for ${jn}`)))})}))}function In(qn){const Fn=new Event("vite:preloadError",{cancelable:!0});if(Fn.payload=qn,window.dispatchEvent(Fn),!Fn.defaultPrevented)throw qn}return Bn.then(qn=>{for(const Fn of qn||[])Fn.status==="rejected"&&In(Fn.reason);return $n().catch(In)})},h$2="modulepreload",E$1=function(s){return"/"+s},a$2={},y$2=function(s,$n,Dn){let Un=Promise.resolve();if($n&&$n.length>0){document.getElementsByTagName("link");const In=document.querySelector("meta[property=csp-nonce]"),qn=In?.nonce||In?.getAttribute("nonce");Un=Promise.allSettled($n.map(Fn=>{if(Fn=E$1(Fn),Fn in a$2)return;a$2[Fn]=!0;const Kn=Fn.endsWith(".css"),jn=Kn?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${Fn}"]${jn}`))return;const Yn=document.createElement("link");if(Yn.rel=Kn?"stylesheet":h$2,Kn||(Yn.as="script"),Yn.crossOrigin="",Yn.href=Fn,qn&&Yn.setAttribute("nonce",qn),document.head.appendChild(Yn),Kn)return new Promise((Zn,Xn)=>{Yn.addEventListener("load",Zn),Yn.addEventListener("error",()=>Xn(new Error(`Unable to preload CSS for ${Fn}`)))})}))}function Bn(In){const qn=new Event("vite:preloadError",{cancelable:!0});if(qn.payload=In,window.dispatchEvent(qn),!qn.defaultPrevented)throw In}return Un.then(In=>{for(const qn of In||[])qn.status==="rejected"&&Bn(qn.reason);return s().catch(Bn)})};let i$1=!1,e=null;async function r(){if(!i$1)return e||(e=(async()=>{try{const{init:s}=await y$2(async()=>{const{init:$n}=await __vitePreload(()=>import("./index.esm-ByUtE_cm-CCjng9-y.js"),[]);return{init:$n}},[]);s({methods:["connect","extension"]}),i$1=!0}catch(s){throw console.error("Failed to initialize NostrLogin:",s),e=null,s}})(),e)}function o(){return typeof window<"u"&&!!window.nostr}async function l$2(){if(await r(),!o())return null;try{return await window.nostr.getPublicKey()||null}catch(s){return console.error("Failed to get public key from NostrLogin:",s),null}}async function c$2(s){if(await r(),!o())throw new Error("NostrLogin is not available");try{return await window.nostr.signEvent(s)}catch($n){throw console.error("Failed to sign event with NostrLogin:",$n),$n}}var w$1=Object.defineProperty,g$1=(s,$n,Dn)=>$n in s?w$1(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,h$1=(s,$n,Dn)=>g$1(s,typeof $n!="symbol"?$n+"":$n,Dn);function k$1({isLoading:s,isError:$n,errorMessage:Dn,isFollowed:Un,isFollowing:Bn,showAvatar:In=!1,user:qn,profile:Fn,customText:Kn="Follow me on nostr"}){if(Bn)return N$2();if(s)return x$3();if($n)return L$2(Dn||"");const jn=Un?e$1("light"):In&&qn&&Fn!=null&&Fn.image?`<img src="${B(Fn.image)}" alt="${B(Fn.name||qn.npub)}" class="user-avatar" />`:c$3(),Yn=Un?"Followed":`<span>${B(Kn)}</span>`;return c$1(jn,Yn)}function x$3(){return c$1(i$2(),"<span>Loading...</span>")}function N$2(){return c$1(i$2(),"<span>Following...</span>")}function L$2(s){return c$1('<div class="error-icon">&#9888;</div>',B(s))}function c$1(s,$n){return`
    <div class='nostr-follow-button-container'>
      <div class='nostr-follow-button-left-container'>
        ${s}
      </div>
      <div class='nostr-follow-button-right-container'>
        ${$n}
      </div>
    </div>
  `}function E(){return V$3(`
    /* === FOLLOW BUTTON CONTAINER PATTERN === */
    :host {
      /* Icon sizing (overridable) */
      --nostrc-icon-height: 25px;
      --nostrc-icon-width: 25px;

      /* Follow button CSS variables (overridable by parent components) */
      --nostrc-follow-btn-padding: var(--nostrc-spacing-sm) var(--nostrc-spacing-md);
      --nostrc-follow-btn-border-radius: var(--nostrc-border-radius-md);
      --nostrc-follow-btn-border: var(--nostrc-border-width) solid var(--nostrc-color-border);
      --nostrc-follow-btn-min-height: auto;
      --nostrc-follow-btn-width: auto;
      --nostrc-follow-btn-horizontal-alignment: left;
      --nostrc-follow-btn-bg: var(--nostrc-theme-bg, #ffffff);
      --nostrc-follow-btn-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-follow-btn-font-family: var(--nostrc-font-family-primary);
      --nostrc-follow-btn-font-size: var(--nostrc-font-size-base);
      
      /* Hover state variables */
      --nostrc-follow-btn-hover-bg: var(--nostrc-theme-hover-bg, rgba(0, 0, 0, 0.05));
      --nostrc-follow-btn-hover-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-follow-btn-hover-border: var(--nostrc-border-width) solid var(--nostrc-theme-border, var(--nostrc-color-border));

      /* Make the host the visual button surface */
      display: inline-flex;
      align-items: center;
      justify-content: var(--nostrc-follow-btn-horizontal-alignment);
      gap: var(--nostrc-spacing-md);
      background: var(--nostrc-follow-btn-bg);
      color: var(--nostrc-follow-btn-color);
      border: var(--nostrc-follow-btn-border);
      border-radius: var(--nostrc-follow-btn-border-radius);
      font-family: var(--nostrc-follow-btn-font-family);
      font-size: var(--nostrc-follow-btn-font-size);
      min-height: var(--nostrc-follow-btn-min-height);
      width: var(--nostrc-follow-btn-width);
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
    }

    /* Hover state */
    :host(.is-clickable:hover) {
      background: var(--nostrc-follow-btn-hover-bg);
      color: var(--nostrc-follow-btn-hover-color);
      border: var(--nostrc-follow-btn-hover-border);
    }

    /* Focus state for accessibility */
    :host(:focus-visible) {
      outline: 2px solid var(--nostrc-color-primary, #007bff);
      outline-offset: 2px;
    }

    :host(.is-error) .nostr-follow-button-container {
      color: var(--nostrc-color-error-text);
      border: var(--nostrc-border-width) solid var(--nostrc-color-error-text);
    }

    .nostr-follow-button-container {
      display: flex;
      gap: var(--nostrc-spacing-md);
      width: fit-content;
      padding: var(--nostrc-follow-btn-padding);
    }
    
    .nostr-follow-button-right-container {
      margin: auto;
    }
    
    /* SVG Icon Styles */
    .nostr-follow-button-left-container svg {
      fill: var(--nostrc-follow-btn-color);
      display: inline-block;
      vertical-align: middle;
      width: var(--nostrc-icon-width);
      height: var(--nostrc-icon-height);
    }

    /* User Avatar Styles */
    .nostr-follow-button-left-container .user-avatar {
      width: var(--nostrc-icon-width);
      height: var(--nostrc-icon-height);
      border-radius: 50%;
      object-fit: cover;
      display: inline-block;
      vertical-align: middle;
    }
  `)}let z$3=class extends C$2{constructor(){super(...arguments),h$1(this,"followStatus",this.channel("follow")),h$1(this,"isFollowed",!1)}static get observedAttributes(){return[...super.observedAttributes,"show-avatar","text"]}connectedCallback(){var $n;($n=super.connectedCallback)==null||$n.call(this),this.attachDelegatedListeners(),this.render()}attributeChangedCallback($n,Dn,Un){Dn!==Un&&(super.attributeChangedCallback($n,Dn,Un),this.render())}onStatusChange($n){this.render()}onUserReady($n,Dn){this.render()}async handleFollowClick(){if(this.computeOverall()===f$2.Ready){this.followStatus.set(f$2.Loading),this.render();try{await r();const $n=new NDKNip07Signer,Dn=this.nostrService.getNDK();if(Dn.signer=$n,!this.user){this.followStatus.set(f$2.Error,"Could not resolve user to follow."),this.render();return}const Un=await $n.user();Un&&await Un.follow(this.user),this.isFollowed=!0,this.followStatus.set(f$2.Ready)}catch($n){const Dn=$n.message||"Please authorize, click the button to try again!";this.followStatus.set(f$2.Error,Dn)}finally{this.render()}}}attachDelegatedListeners(){this.delegateEvent("click",".nostr-follow-button-container",$n=>{var Dn,Un;(Dn=$n.preventDefault)==null||Dn.call($n),(Un=$n.stopPropagation)==null||Un.call($n),this.handleFollowClick()})}renderContent(){const $n=this.computeOverall()==f$2.Loading,Dn=this.followStatus.get()==f$2.Loading,Un=this.computeOverall()===f$2.Error,Bn=super.renderError(this.errorMessage),In=this.hasAttribute("show-avatar"),qn=this.getAttribute("text")||"Follow me on nostr",Fn={isLoading:$n,isError:Un,errorMessage:Bn,isFollowed:this.isFollowed,isFollowing:Dn,showAvatar:In,user:this.user,profile:this.profile,customText:qn};this.shadowRoot.innerHTML=`
      ${E()}
      ${k$1(Fn)}
    `}};customElements.get("nostr-follow-button")||customElements.define("nostr-follow-button",z$3);var d$2=Object.defineProperty,c=(s,$n,Dn)=>$n in s?d$2(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,l$1=(s,$n,Dn)=>c(s,$n+"",Dn);const h=()=>`
    /* Base Dialog Styles */
    .nostr-base-dialog {
      width: 400px;
      max-width: 90vw;
      border: none;
      border-radius: var(--nostrc-border-radius-lg, 10px);
      padding: var(--nostrc-spacing-xl, 20px);
      background: var(--nostrc-theme-bg, #ffffff);
      color: var(--nostrc-theme-text-primary, #000000);
      margin: auto;
      font-family: var(--nostrc-font-family-primary, ui-sans-serif, system-ui, sans-serif);
      /* Ensure dialog is centered when opened */
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .nostr-base-dialog[open] {
      display: block;
    }

    .nostr-base-dialog::backdrop {
      background: rgba(0, 0, 0, 0.5);
    }

    .dialog-header {
      position: relative;
      margin-bottom: var(--nostrc-spacing-lg, 16px);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .dialog-header h2 {
      font-size: var(--nostrc-font-size-large, 1.25rem);
      font-weight: var(--nostrc-font-weight-bold, 700);
      margin: 0;
      flex: 1;
      text-align: left;
      padding-top: 2px;
      color: var(--nostrc-theme-text-primary, #000000);
    }

    .dialog-close-btn {
      border: none;
      background: var(--nostrc-theme-hover-bg, #f7fafc);
      border-radius: var(--nostrc-border-radius-full, 50%);
      width: 32px;
      height: 32px;
      min-width: 32px;
      font-size: var(--nostrc-font-size-base, 16px);
      cursor: pointer;
      color: var(--nostrc-theme-text-secondary, #666666);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dialog-close-btn:hover {
      background: var(--nostrc-theme-border, rgba(0, 0, 0, 0.05));
      color: var(--nostrc-theme-text-primary, #000000);
    }

    .dialog-content {
      line-height: 1.6;
      color: var(--nostrc-theme-text-primary, #000000);
    }
  `;class g extends HTMLElement{constructor(){super(),l$1(this,"dialog",null)}static get observedAttributes(){return["header","data-theme"]}injectStyles(){if(document.querySelector("style[data-dialog-component-styles]"))return;const $n=document.createElement("style");$n.setAttribute("data-dialog-component-styles","true"),$n.textContent=h(),document.head.appendChild($n)}render(){this.injectStyles();const $n=this.getAttribute("header")||"Dialog",Dn=this.getAttribute("data-theme");this.dialog=document.createElement("dialog"),this.dialog.className="nostr-base-dialog",Dn&&this.dialog.setAttribute("data-theme",Dn);const Un=document.createElement("div");Un.className="dialog-header";const Bn=document.createElement("h2");Bn.textContent=$n;const In=document.createElement("button");In.className="dialog-close-btn",In.setAttribute("aria-label","Close dialog"),In.textContent="",Un.appendChild(Bn),Un.appendChild(In);const qn=document.createElement("div");for(qn.className="dialog-content";this.firstChild;)qn.appendChild(this.firstChild);this.dialog.appendChild(Un),this.dialog.appendChild(qn),document.body.appendChild(this.dialog),this.setupEventListeners()}setupEventListeners(){if(!this.dialog)return;const $n=this.dialog.querySelector(".dialog-close-btn");$n?.addEventListener("click",()=>{this.close()}),this.dialog.addEventListener("click",Dn=>{Dn.target===this.dialog&&this.close()}),this.dialog.addEventListener("cancel",Dn=>{Dn.preventDefault(),this.close()}),this.dialog.addEventListener("close",()=>{this.cleanup()})}show(){this.showModal()}showModal(){var $n;this.dialog||this.render(),($n=this.dialog)==null||$n.showModal()}close(){var $n;($n=this.dialog)==null||$n.close()}cleanup(){this.dialog&&this.dialog.isConnected&&this.dialog.remove(),this.isConnected&&this.remove(),this.dialog=null}disconnectedCallback(){this.cleanup()}attributeChangedCallback($n,Dn,Un){if($n==="header"&&this.dialog){const Bn=this.dialog.querySelector(".dialog-header h2");Bn&&(Bn.textContent=Un||"Dialog")}else $n==="data-theme"&&this.dialog&&(Un?this.dialog.setAttribute("data-theme",Un):this.dialog.removeAttribute("data-theme"))}}customElements.get("dialog-component")||customElements.define("dialog-component",g);function t(s){try{const $n=new URL(s);return $n.origin.replace("://m.","://").replace("://mobile.","://").replace("http://","https://").replace(/:\d+/,Dn=>Dn===":443"||Dn===":80"?"":Dn)+$n.pathname.replace(/\/+/g,"/").replace(/\/*$/,"")}catch{return console.error("Invalid URL:",s),s}}function a$1(s){return/^[a-f0-9]{64}$/.test(s)}const d$1={},x$2=async s=>{if(d$1[s])return d$1[s];const $n=new SimplePool,Dn=["wss://purplepag.es","wss://relay.damus.io","wss://nostr.wine"];try{const Un=await $n.get(Dn,{authors:[s],kinds:[0]});return d$1[s]=Un,Un}finally{$n.close(Dn)}},D$2=async s=>{const $n=s.filter(Bn=>!d$1[Bn]);if($n.length===0)return s.map(Bn=>({id:Bn,profile:d$1[Bn]}));const Dn=new SimplePool,Un=["wss://purplepag.es","wss://relay.damus.io","wss://nostr.wine"];try{return(await Dn.querySync(Un,{authors:$n,kinds:[0]})).forEach(Bn=>{d$1[Bn.pubkey]=Bn}),s.map(Bn=>({id:Bn,profile:d$1[Bn]||null}))}finally{Dn.close(Un)}},J$1=s=>{try{return JSON.parse(s?.content||"{}")}catch{return{}}},I$3=async s=>{const $n=await nip57_exports.getZapEndpoint(s);if(!$n)throw new Error("Failed to retrieve zap LNURL");return $n},L$1=async(s,$n)=>{try{return await r(),await c$2(s)}catch{}return finalizeEvent(s,C$1())},Z$1=async({profile:s,nip19Target:$n,amount:Dn,relays:Un,comment:Bn,anon:In,url:qn})=>{const Fn={pubkey:s,amount:Dn,relays:Un,comment:Bn||""};debugger;const Kn=nip57_exports.makeZapRequest(Fn);qn&&(Kn.tags.push(["k","web"]),Kn.tags.push(["i",t(qn)]));let jn=!1;try{await r(),jn=typeof window<"u"&&!!window.nostr}catch{jn=!1}return(!jn||In)&&Kn.tags.push(["anon"]),L$1(Kn)},M$2=async({zapEndpoint:s,amount:$n,comment:Dn,authorId:Un,nip19Target:Bn,normalizedRelays:In,anon:qn,url:Fn})=>{const Kn=await Z$1({profile:Un,nip19Target:Bn,amount:$n,relays:In,comment:Dn??"",anon:qn,url:Fn});let jn=`${s}?amount=${$n}&nostr=${encodeURIComponent(JSON.stringify(Kn))}`;Dn&&(jn+=`&comment=${encodeURIComponent(Dn??"")}`);const Yn=await fetch(jn,{method:"GET"});if(!Yn.ok)throw new Error(`LNURL request failed: ${Yn.status} ${Yn.statusText}`);let Zn;try{Zn=await Yn.json()}catch{throw new Error("Invalid JSON from LNURL endpoint")}const{pr:Xn,reason:Jn,status:Wn}=Zn||{};if(Xn)return Xn;throw Wn==="ERROR"?new Error(Jn??"Unable to fetch invoice"):new Error("Unable to fetch invoice")},C$1=()=>{const s=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function")crypto.getRandomValues(s);else{console.warn("crypto.getRandomValues not available, using Math.random as fallback");for(let $n=0;$n<32;$n++)s[$n]=Math.floor(Math.random()*256)}return s},V$1=async({pubkey:s,relays:$n,url:Dn})=>{var Un,Bn,In,qn;const Fn=Dn?t(Dn):void 0,Kn=new SimplePool;let jn=0;const Yn=[];try{const Zn={kinds:[9735],"#p":[s],limit:1e3},Xn=await Kn.querySync($n,Zn);for(const Jn of Xn){const Wn=(Un=Jn.tags)==null?void 0:Un.find(tr=>tr[0]==="description");if(Wn!=null&&Wn[1])try{const tr=JSON.parse(Wn[1]),ir=(Bn=tr?.tags)==null?void 0:Bn.find(sr=>sr[0]==="amount");if(Fn){const sr=(In=tr?.tags)==null?void 0:In.find(br=>br[0]==="k"),fr=(qn=tr?.tags)==null?void 0:qn.find(br=>br[0]==="i"),ur=fr!=null&&fr[1]?t(fr[1]):"";if(sr?.[1]==="web"&&ur===Fn&&ir!=null&&ir[1]){const br=parseInt(ir[1],10);br>0&&(jn+=br,Yn.push({amount:br/1e3,date:new Date(Jn.created_at*1e3),authorPubkey:tr.pubkey,comment:tr.content}))}}else if(ir!=null&&ir[1]){const sr=parseInt(ir[1],10);sr>0&&(jn+=sr,Yn.push({amount:sr/1e3,date:new Date(Jn.created_at*1e3),authorPubkey:tr.pubkey,comment:tr.content}))}}catch(tr){console.error("Nostr-Components: Zap button: Could not parse zap request from description tag",tr)}}}catch(Zn){console.error("Nostr-Components: Zap button: Error fetching zap receipts",Zn)}finally{Kn.close($n)}return Yn.sort((Zn,Xn)=>Xn.date.getTime()-Zn.date.getTime()),{totalAmount:jn/1e3,zapDetails:Yn}},_$3=({relays:s,receiversPubKey:$n,invoice:Dn,onSuccess:Un})=>{const Bn=new SimplePool,In=Array.from(new Set(s)),qn=Math.floor((Date.now()-1440*60*1e3)/1e3);Bn.subscribe(In,{kinds:[9735],"#p":[$n],since:qn},{onevent(Kn){Kn.tags.some(jn=>jn[0]==="bolt11"&&jn[1]===Dn)&&(Un(),Fn())}});const Fn=()=>{Bn.close(In)};return Fn},zapUtilsBiKkJPt6=Object.freeze(Object.defineProperty({__proto__:null,extractProfileMetadataContent:J$1,fetchInvoice:M$2,fetchTotalZapAmount:V$1,getBatchedProfileMetadata:D$2,getProfileMetadata:x$2,getZapEndpoint:I$3,listenForZapReceipt:_$3},Symbol.toStringTag,{value:"Module"})),__vite__mapDeps$2=(s,$n=__vite__mapDeps$2,Dn=$n.f||($n.f=["assets/zap-utils-BiKkJPt6.js","assets/nostr-service-CA0Qx4nJ.js","assets/nostr-login-service-D2FmscPI.js","assets/preload-helper-D7HrI6pR.js","assets/utils--bxLbhGF.js"]))=>s.map(Un=>Dn[Un]);var Jt=Object.defineProperty,$t=(s,$n,Dn)=>$n in s?Jt(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,Z=(s,$n,Dn)=>$t(s,typeof $n!="symbol"?$n+"":$n,Dn);const se=(s="light")=>{const $n=s==="dark";return`
    /* === ZAP DIALOG CONTENT STYLES === */
    .zap-dialog-content {
      text-align: center;
      color: ${$n?"#ffffff":"#000000"};
    }

    .zap-dialog-content p {
      margin: 4px 0;
      word-break: break-word;
    }

    /* === AMOUNT BUTTONS === */
    .zap-dialog-content .amount-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 16px 0 8px;
    }

    .zap-dialog-content .amount-buttons button {
      flex: 1 1 30%;
      min-width: 72px;
      padding: 8px 0;
      border: 1px solid ${$n?"#3a3a3a":"#e2e8f0"};
      border-radius: 6px;
      background: ${$n?"#262626":"#f7fafc"};
      cursor: pointer;
      font-size: 14px;
      color: ${$n?"#ffffff":"#000000"};
    }

    .zap-dialog-content .amount-buttons button.active {
      background: #7f00ff;
      color: #ffffff;
    }

    /* === ACTION BUTTONS === */
    .zap-dialog-content .cta-btn {
      width: 100%;
      padding: 12px 0;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      margin-top: 16px;
      cursor: pointer;
      background: #7f00ff;
      color: #ffffff;
    }

    .zap-dialog-content .copy-btn {
      margin-top: 12px;
      cursor: pointer;
      font-size: 14px;
      background: none;
      border: none;
      color: #7f00ff;
    }

    .zap-dialog-content .update-zap-btn {
      background: #7f00ff;
      color: #ffffff;
    }

    /* === QR CODE === */
    .zap-dialog-content img.qr {
      margin-top: 16px;
      border: 1px solid ${$n?"#3a3a3a":"#e2e8f0"};
      border-radius: 8px;
    }

    /* === INPUT CONTAINERS === */
    .zap-dialog-content .update-zap-container {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 8px;
    }

    .zap-dialog-content .update-zap-container .custom-amount {
      flex-grow: 1;
    }

    .zap-dialog-content .comment-container {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 8px;
    }

    .zap-dialog-content .comment-container .comment-input {
      flex-grow: 1;
    }

    .zap-dialog-content input {
      background: ${$n?"#262626":"#ffffff"};
      border: 1px solid ${$n?"#3a3a3a":"#e2e8f0"};
      color: ${$n?"#ffffff":"#000000"};
    }

    /* === LOADING OVERLAY === */
    .nostr-base-dialog .loading-overlay {
      position: absolute;
      inset: 0;
      background: ${$n?"rgba(0, 0, 0, 0.7)":"rgba(255, 255, 255, 0.7)"};
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 10px;
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
    }

    .nostr-base-dialog.loading .loading-overlay {
      opacity: 1;
      pointer-events: auto;
    }

    .nostr-base-dialog .loading-overlay .loader {
      width: 40px;
      height: 40px;
      border: 4px solid ${$n?"#3a3a3a":"#ccc"};
      border-top-color: #7f00ff;
      border-radius: 50%;
      animation: nstrc-spin 1s linear infinite;
    }

    /* === SUCCESS OVERLAY === */
    .nostr-base-dialog .success-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.65);
      display: flex;
      justify-content: center;
      align-items: center;
      color: #ffffff;
      font-size: 24px;
      border-radius: 10px;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .nostr-base-dialog.success .success-overlay {
      opacity: 1;
      pointer-events: auto;
    }

    /* === ANIMATIONS === */
    @keyframes nstrc-spin {
      to {
        transform: rotate(360deg);
      }
    }
  `};var ce$1=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},xt={},P$2={};let pt;const le$1=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];P$2.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17};P$2.getSymbolTotalCodewords=function(s){return le$1[s]};P$2.getBCHDigit=function(s){let $n=0;for(;s!==0;)$n++,s>>>=1;return $n};P$2.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');pt=s};P$2.isKanjiModeEnabled=function(){return typeof pt<"u"};P$2.toSJIS=function(s){return pt(s)};var tt={};(function(s){s.L={bit:1},s.M={bit:0},s.Q={bit:3},s.H={bit:2};function $n(Dn){if(typeof Dn!="string")throw new Error("Param is not a string");switch(Dn.toLowerCase()){case"l":case"low":return s.L;case"m":case"medium":return s.M;case"q":case"quartile":return s.Q;case"h":case"high":return s.H;default:throw new Error("Unknown EC Level: "+Dn)}}s.isValid=function(Dn){return Dn&&typeof Dn.bit<"u"&&Dn.bit>=0&&Dn.bit<4},s.from=function(Dn,Un){if(s.isValid(Dn))return Dn;try{return $n(Dn)}catch{return Un}}})(tt);function Tt$1(){this.buffer=[],this.length=0}Tt$1.prototype={get:function(s){const $n=Math.floor(s/8);return(this.buffer[$n]>>>7-s%8&1)===1},put:function(s,$n){for(let Dn=0;Dn<$n;Dn++)this.putBit((s>>>$n-Dn-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(s){const $n=Math.floor(this.length/8);this.buffer.length<=$n&&this.buffer.push(0),s&&(this.buffer[$n]|=128>>>this.length%8),this.length++}};var ue=Tt$1;function K$1(s){if(!s||s<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=s,this.data=new Uint8Array(s*s),this.reservedBit=new Uint8Array(s*s)}K$1.prototype.set=function(s,$n,Dn,Un){const Bn=s*this.size+$n;this.data[Bn]=Dn,Un&&(this.reservedBit[Bn]=!0)};K$1.prototype.get=function(s,$n){return this.data[s*this.size+$n]};K$1.prototype.xor=function(s,$n,Dn){this.data[s*this.size+$n]^=Dn};K$1.prototype.isReserved=function(s,$n){return this.reservedBit[s*this.size+$n]};var de$1=K$1,Bt={};(function(s){const $n=P$2.getSymbolSize;s.getRowColCoords=function(Dn){if(Dn===1)return[];const Un=Math.floor(Dn/7)+2,Bn=$n(Dn),In=Bn===145?26:Math.ceil((Bn-13)/(2*Un-2))*2,qn=[Bn-7];for(let Fn=1;Fn<Un-1;Fn++)qn[Fn]=qn[Fn-1]-In;return qn.push(6),qn.reverse()},s.getPositions=function(Dn){const Un=[],Bn=s.getRowColCoords(Dn),In=Bn.length;for(let qn=0;qn<In;qn++)for(let Fn=0;Fn<In;Fn++)qn===0&&Fn===0||qn===0&&Fn===In-1||qn===In-1&&Fn===0||Un.push([Bn[qn],Bn[Fn]]);return Un}})(Bt);var It$1={};const fe=P$2.getSymbolSize,Ct$1=7;It$1.getPositions=function(s){const $n=fe(s);return[[0,0],[$n-Ct$1,0],[0,$n-Ct$1]]};var Pt$1={};(function(s){s.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const $n={N1:3,N2:3,N3:40,N4:10};s.isValid=function(Un){return Un!=null&&Un!==""&&!isNaN(Un)&&Un>=0&&Un<=7},s.from=function(Un){return s.isValid(Un)?parseInt(Un,10):void 0},s.getPenaltyN1=function(Un){const Bn=Un.size;let In=0,qn=0,Fn=0,Kn=null,jn=null;for(let Yn=0;Yn<Bn;Yn++){qn=Fn=0,Kn=jn=null;for(let Zn=0;Zn<Bn;Zn++){let Xn=Un.get(Yn,Zn);Xn===Kn?qn++:(qn>=5&&(In+=$n.N1+(qn-5)),Kn=Xn,qn=1),Xn=Un.get(Zn,Yn),Xn===jn?Fn++:(Fn>=5&&(In+=$n.N1+(Fn-5)),jn=Xn,Fn=1)}qn>=5&&(In+=$n.N1+(qn-5)),Fn>=5&&(In+=$n.N1+(Fn-5))}return In},s.getPenaltyN2=function(Un){const Bn=Un.size;let In=0;for(let qn=0;qn<Bn-1;qn++)for(let Fn=0;Fn<Bn-1;Fn++){const Kn=Un.get(qn,Fn)+Un.get(qn,Fn+1)+Un.get(qn+1,Fn)+Un.get(qn+1,Fn+1);(Kn===4||Kn===0)&&In++}return In*$n.N2},s.getPenaltyN3=function(Un){const Bn=Un.size;let In=0,qn=0,Fn=0;for(let Kn=0;Kn<Bn;Kn++){qn=Fn=0;for(let jn=0;jn<Bn;jn++)qn=qn<<1&2047|Un.get(Kn,jn),jn>=10&&(qn===1488||qn===93)&&In++,Fn=Fn<<1&2047|Un.get(jn,Kn),jn>=10&&(Fn===1488||Fn===93)&&In++}return In*$n.N3},s.getPenaltyN4=function(Un){let Bn=0;const In=Un.data.length;for(let qn=0;qn<In;qn++)Bn+=Un.data[qn];return Math.abs(Math.ceil(Bn*100/In/5)-10)*$n.N4};function Dn(Un,Bn,In){switch(Un){case s.Patterns.PATTERN000:return(Bn+In)%2===0;case s.Patterns.PATTERN001:return Bn%2===0;case s.Patterns.PATTERN010:return In%3===0;case s.Patterns.PATTERN011:return(Bn+In)%3===0;case s.Patterns.PATTERN100:return(Math.floor(Bn/2)+Math.floor(In/3))%2===0;case s.Patterns.PATTERN101:return Bn*In%2+Bn*In%3===0;case s.Patterns.PATTERN110:return(Bn*In%2+Bn*In%3)%2===0;case s.Patterns.PATTERN111:return(Bn*In%3+(Bn+In)%2)%2===0;default:throw new Error("bad maskPattern:"+Un)}}s.applyMask=function(Un,Bn){const In=Bn.size;for(let qn=0;qn<In;qn++)for(let Fn=0;Fn<In;Fn++)Bn.isReserved(Fn,qn)||Bn.xor(Fn,qn,Dn(Un,Fn,qn))},s.getBestMask=function(Un,Bn){const In=Object.keys(s.Patterns).length;let qn=0,Fn=1/0;for(let Kn=0;Kn<In;Kn++){Bn(Kn),s.applyMask(Kn,Un);const jn=s.getPenaltyN1(Un)+s.getPenaltyN2(Un)+s.getPenaltyN3(Un)+s.getPenaltyN4(Un);s.applyMask(Kn,Un),jn<Fn&&(Fn=jn,qn=Kn)}return qn}})(Pt$1);var et={};const U$1=tt,J=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],$$2=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];et.getBlocksCount=function(s,$n){switch($n){case U$1.L:return J[(s-1)*4+0];case U$1.M:return J[(s-1)*4+1];case U$1.Q:return J[(s-1)*4+2];case U$1.H:return J[(s-1)*4+3];default:return}};et.getTotalCodewordsCount=function(s,$n){switch($n){case U$1.L:return $$2[(s-1)*4+0];case U$1.M:return $$2[(s-1)*4+1];case U$1.Q:return $$2[(s-1)*4+2];case U$1.H:return $$2[(s-1)*4+3];default:return}};var Lt$1={},nt={};const V=new Uint8Array(512),Q=new Uint8Array(256);(function(){let s=1;for(let $n=0;$n<255;$n++)V[$n]=s,Q[s]=$n,s<<=1,s&256&&(s^=285);for(let $n=255;$n<512;$n++)V[$n]=V[$n-255]})();nt.log=function(s){if(s<1)throw new Error("log("+s+")");return Q[s]};nt.exp=function(s){return V[s]};nt.mul=function(s,$n){return s===0||$n===0?0:V[Q[s]+Q[$n]]};(function(s){const $n=nt;s.mul=function(Dn,Un){const Bn=new Uint8Array(Dn.length+Un.length-1);for(let In=0;In<Dn.length;In++)for(let qn=0;qn<Un.length;qn++)Bn[In+qn]^=$n.mul(Dn[In],Un[qn]);return Bn},s.mod=function(Dn,Un){let Bn=new Uint8Array(Dn);for(;Bn.length-Un.length>=0;){const In=Bn[0];for(let Fn=0;Fn<Un.length;Fn++)Bn[Fn]^=$n.mul(Un[Fn],In);let qn=0;for(;qn<Bn.length&&Bn[qn]===0;)qn++;Bn=Bn.slice(qn)}return Bn},s.generateECPolynomial=function(Dn){let Un=new Uint8Array([1]);for(let Bn=0;Bn<Dn;Bn++)Un=s.mul(Un,new Uint8Array([1,$n.exp(Bn)]));return Un}})(Lt$1);const Mt=Lt$1;function gt(s){this.genPoly=void 0,this.degree=s,this.degree&&this.initialize(this.degree)}gt.prototype.initialize=function(s){this.degree=s,this.genPoly=Mt.generateECPolynomial(this.degree)};gt.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const $n=new Uint8Array(s.length+this.degree);$n.set(s);const Dn=Mt.mod($n,this.genPoly),Un=this.degree-Dn.length;if(Un>0){const Bn=new Uint8Array(this.degree);return Bn.set(Dn,Un),Bn}return Dn};var pe$1=gt,Rt$1={},_$2={},ht={};ht.isValid=function(s){return!isNaN(s)&&s>=1&&s<=40};var L={};const Dt$1="[0-9]+",ge="[A-Z $%*+\\-./:]+";let j="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";j=j.replace(/u/g,"\\u");const he="(?:(?![A-Z0-9 $%*+\\-./:]|"+j+`)(?:.|[\r
]))+`;L.KANJI=new RegExp(j,"g");L.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");L.BYTE=new RegExp(he,"g");L.NUMERIC=new RegExp(Dt$1,"g");L.ALPHANUMERIC=new RegExp(ge,"g");const me$1=new RegExp("^"+j+"$"),be=new RegExp("^"+Dt$1+"$"),ye=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");L.testKanji=function(s){return me$1.test(s)};L.testNumeric=function(s){return be.test(s)};L.testAlphanumeric=function(s){return ye.test(s)};(function(s){const $n=ht,Dn=L;s.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},s.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},s.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},s.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},s.MIXED={bit:-1},s.getCharCountIndicator=function(Bn,In){if(!Bn.ccBits)throw new Error("Invalid mode: "+Bn);if(!$n.isValid(In))throw new Error("Invalid version: "+In);return In>=1&&In<10?Bn.ccBits[0]:In<27?Bn.ccBits[1]:Bn.ccBits[2]},s.getBestModeForData=function(Bn){return Dn.testNumeric(Bn)?s.NUMERIC:Dn.testAlphanumeric(Bn)?s.ALPHANUMERIC:Dn.testKanji(Bn)?s.KANJI:s.BYTE},s.toString=function(Bn){if(Bn&&Bn.id)return Bn.id;throw new Error("Invalid mode")},s.isValid=function(Bn){return Bn&&Bn.bit&&Bn.ccBits};function Un(Bn){if(typeof Bn!="string")throw new Error("Param is not a string");switch(Bn.toLowerCase()){case"numeric":return s.NUMERIC;case"alphanumeric":return s.ALPHANUMERIC;case"kanji":return s.KANJI;case"byte":return s.BYTE;default:throw new Error("Unknown mode: "+Bn)}}s.from=function(Bn,In){if(s.isValid(Bn))return Bn;try{return Un(Bn)}catch{return In}}})(_$2);(function(s){const $n=P$2,Dn=et,Un=tt,Bn=_$2,In=ht,qn=7973,Fn=$n.getBCHDigit(qn);function Kn(Xn,Jn,Wn){for(let tr=1;tr<=40;tr++)if(Jn<=s.getCapacity(tr,Wn,Xn))return tr}function jn(Xn,Jn){return Bn.getCharCountIndicator(Xn,Jn)+4}function Yn(Xn,Jn){let Wn=0;return Xn.forEach(function(tr){const ir=jn(tr.mode,Jn);Wn+=ir+tr.getBitsLength()}),Wn}function Zn(Xn,Jn){for(let Wn=1;Wn<=40;Wn++)if(Yn(Xn,Wn)<=s.getCapacity(Wn,Jn,Bn.MIXED))return Wn}s.from=function(Xn,Jn){return In.isValid(Xn)?parseInt(Xn,10):Jn},s.getCapacity=function(Xn,Jn,Wn){if(!In.isValid(Xn))throw new Error("Invalid QR Code version");typeof Wn>"u"&&(Wn=Bn.BYTE);const tr=$n.getSymbolTotalCodewords(Xn),ir=Dn.getTotalCodewordsCount(Xn,Jn),sr=(tr-ir)*8;if(Wn===Bn.MIXED)return sr;const fr=sr-jn(Wn,Xn);switch(Wn){case Bn.NUMERIC:return Math.floor(fr/10*3);case Bn.ALPHANUMERIC:return Math.floor(fr/11*2);case Bn.KANJI:return Math.floor(fr/13);case Bn.BYTE:default:return Math.floor(fr/8)}},s.getBestVersionForData=function(Xn,Jn){let Wn;const tr=Un.from(Jn,Un.M);if(Array.isArray(Xn)){if(Xn.length>1)return Zn(Xn,tr);if(Xn.length===0)return 1;Wn=Xn[0]}else Wn=Xn;return Kn(Wn.mode,Wn.getLength(),tr)},s.getEncodedBits=function(Xn){if(!In.isValid(Xn)||Xn<7)throw new Error("Invalid QR Code version");let Jn=Xn<<12;for(;$n.getBCHDigit(Jn)-Fn>=0;)Jn^=qn<<$n.getBCHDigit(Jn)-Fn;return Xn<<12|Jn}})(Rt$1);var Ut={};const lt=P$2,_t$1=1335,we=21522,Et$1=lt.getBCHDigit(_t$1);Ut.getEncodedBits=function(s,$n){const Dn=s.bit<<3|$n;let Un=Dn<<10;for(;lt.getBCHDigit(Un)-Et$1>=0;)Un^=_t$1<<lt.getBCHDigit(Un)-Et$1;return(Dn<<10|Un)^we};var Zt$1={};const ve=_$2;function F$2(s){this.mode=ve.NUMERIC,this.data=s.toString()}F$2.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)};F$2.prototype.getLength=function(){return this.data.length};F$2.prototype.getBitsLength=function(){return F$2.getBitsLength(this.data.length)};F$2.prototype.write=function(s){let $n,Dn,Un;for($n=0;$n+3<=this.data.length;$n+=3)Dn=this.data.substr($n,3),Un=parseInt(Dn,10),s.put(Un,10);const Bn=this.data.length-$n;Bn>0&&(Dn=this.data.substr($n),Un=parseInt(Dn,10),s.put(Un,Bn*3+1))};var Ce=F$2;const Ee$1=_$2,rt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function q$1(s){this.mode=Ee$1.ALPHANUMERIC,this.data=s}q$1.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)};q$1.prototype.getLength=function(){return this.data.length};q$1.prototype.getBitsLength=function(){return q$1.getBitsLength(this.data.length)};q$1.prototype.write=function(s){let $n;for($n=0;$n+2<=this.data.length;$n+=2){let Dn=rt.indexOf(this.data[$n])*45;Dn+=rt.indexOf(this.data[$n+1]),s.put(Dn,11)}this.data.length%2&&s.put(rt.indexOf(this.data[$n]),6)};var ze=q$1;const Se=_$2;function H$3(s){this.mode=Se.BYTE,typeof s=="string"?this.data=new TextEncoder().encode(s):this.data=new Uint8Array(s)}H$3.getBitsLength=function(s){return s*8};H$3.prototype.getLength=function(){return this.data.length};H$3.prototype.getBitsLength=function(){return H$3.getBitsLength(this.data.length)};H$3.prototype.write=function(s){for(let $n=0,Dn=this.data.length;$n<Dn;$n++)s.put(this.data[$n],8)};var ke=H$3;const Ae$1=_$2,Ne=P$2;function O$2(s){this.mode=Ae$1.KANJI,this.data=s}O$2.getBitsLength=function(s){return s*13};O$2.prototype.getLength=function(){return this.data.length};O$2.prototype.getBitsLength=function(){return O$2.getBitsLength(this.data.length)};O$2.prototype.write=function(s){let $n;for($n=0;$n<this.data.length;$n++){let Dn=Ne.toSJIS(this.data[$n]);if(Dn>=33088&&Dn<=40956)Dn-=33088;else if(Dn>=57408&&Dn<=60351)Dn-=49472;else throw new Error("Invalid SJIS character: "+this.data[$n]+`
Make sure your charset is UTF-8`);Dn=(Dn>>>8&255)*192+(Dn&255),s.put(Dn,13)}};var xe=O$2,Ft={exports:{}};(function(s){var $n={single_source_shortest_paths:function(Dn,Un,Bn){var In={},qn={};qn[Un]=0;var Fn=$n.PriorityQueue.make();Fn.push(Un,0);for(var Kn,jn,Yn,Zn,Xn,Jn,Wn,tr,ir;!Fn.empty();){Kn=Fn.pop(),jn=Kn.value,Zn=Kn.cost,Xn=Dn[jn]||{};for(Yn in Xn)Xn.hasOwnProperty(Yn)&&(Jn=Xn[Yn],Wn=Zn+Jn,tr=qn[Yn],ir=typeof qn[Yn]>"u",(ir||tr>Wn)&&(qn[Yn]=Wn,Fn.push(Yn,Wn),In[Yn]=jn))}if(typeof Bn<"u"&&typeof qn[Bn]>"u"){var sr=["Could not find a path from ",Un," to ",Bn,"."].join("");throw new Error(sr)}return In},extract_shortest_path_from_predecessor_list:function(Dn,Un){for(var Bn=[],In=Un;In;)Bn.push(In),Dn[In],In=Dn[In];return Bn.reverse(),Bn},find_path:function(Dn,Un,Bn){var In=$n.single_source_shortest_paths(Dn,Un,Bn);return $n.extract_shortest_path_from_predecessor_list(In,Bn)},PriorityQueue:{make:function(Dn){var Un=$n.PriorityQueue,Bn={},In;Dn=Dn||{};for(In in Un)Un.hasOwnProperty(In)&&(Bn[In]=Un[In]);return Bn.queue=[],Bn.sorter=Dn.sorter||Un.default_sorter,Bn},default_sorter:function(Dn,Un){return Dn.cost-Un.cost},push:function(Dn,Un){var Bn={value:Dn,cost:Un};this.queue.push(Bn),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};s.exports=$n})(Ft);var Te$1=Ft.exports;(function(s){const $n=_$2,Dn=Ce,Un=ze,Bn=ke,In=xe,qn=L,Fn=P$2,Kn=Te$1;function jn(sr){return unescape(encodeURIComponent(sr)).length}function Yn(sr,fr,ur){const br=[];let Nr;for(;(Nr=sr.exec(ur))!==null;)br.push({data:Nr[0],index:Nr.index,mode:fr,length:Nr[0].length});return br}function Zn(sr){const fr=Yn(qn.NUMERIC,$n.NUMERIC,sr),ur=Yn(qn.ALPHANUMERIC,$n.ALPHANUMERIC,sr);let br,Nr;return Fn.isKanjiModeEnabled()?(br=Yn(qn.BYTE,$n.BYTE,sr),Nr=Yn(qn.KANJI,$n.KANJI,sr)):(br=Yn(qn.BYTE_KANJI,$n.BYTE,sr),Nr=[]),fr.concat(ur,br,Nr).sort(function(Ar,_r){return Ar.index-_r.index}).map(function(Ar){return{data:Ar.data,mode:Ar.mode,length:Ar.length}})}function Xn(sr,fr){switch(fr){case $n.NUMERIC:return Dn.getBitsLength(sr);case $n.ALPHANUMERIC:return Un.getBitsLength(sr);case $n.KANJI:return In.getBitsLength(sr);case $n.BYTE:return Bn.getBitsLength(sr)}}function Jn(sr){return sr.reduce(function(fr,ur){const br=fr.length-1>=0?fr[fr.length-1]:null;return br&&br.mode===ur.mode?(fr[fr.length-1].data+=ur.data,fr):(fr.push(ur),fr)},[])}function Wn(sr){const fr=[];for(let ur=0;ur<sr.length;ur++){const br=sr[ur];switch(br.mode){case $n.NUMERIC:fr.push([br,{data:br.data,mode:$n.ALPHANUMERIC,length:br.length},{data:br.data,mode:$n.BYTE,length:br.length}]);break;case $n.ALPHANUMERIC:fr.push([br,{data:br.data,mode:$n.BYTE,length:br.length}]);break;case $n.KANJI:fr.push([br,{data:br.data,mode:$n.BYTE,length:jn(br.data)}]);break;case $n.BYTE:fr.push([{data:br.data,mode:$n.BYTE,length:jn(br.data)}])}}return fr}function tr(sr,fr){const ur={},br={start:{}};let Nr=["start"];for(let Ar=0;Ar<sr.length;Ar++){const _r=sr[Ar],Rr=[];for(let Dr=0;Dr<_r.length;Dr++){const zr=_r[Dr],dr=""+Ar+Dr;Rr.push(dr),ur[dr]={node:zr,lastCount:0},br[dr]={};for(let pr=0;pr<Nr.length;pr++){const lr=Nr[pr];ur[lr]&&ur[lr].node.mode===zr.mode?(br[lr][dr]=Xn(ur[lr].lastCount+zr.length,zr.mode)-Xn(ur[lr].lastCount,zr.mode),ur[lr].lastCount+=zr.length):(ur[lr]&&(ur[lr].lastCount=zr.length),br[lr][dr]=Xn(zr.length,zr.mode)+4+$n.getCharCountIndicator(zr.mode,fr))}}Nr=Rr}for(let Ar=0;Ar<Nr.length;Ar++)br[Nr[Ar]].end=0;return{map:br,table:ur}}function ir(sr,fr){let ur;const br=$n.getBestModeForData(sr);if(ur=$n.from(fr,br),ur!==$n.BYTE&&ur.bit<br.bit)throw new Error('"'+sr+'" cannot be encoded with mode '+$n.toString(ur)+`.
 Suggested mode is: `+$n.toString(br));switch(ur===$n.KANJI&&!Fn.isKanjiModeEnabled()&&(ur=$n.BYTE),ur){case $n.NUMERIC:return new Dn(sr);case $n.ALPHANUMERIC:return new Un(sr);case $n.KANJI:return new In(sr);case $n.BYTE:return new Bn(sr)}}s.fromArray=function(sr){return sr.reduce(function(fr,ur){return typeof ur=="string"?fr.push(ir(ur,null)):ur.data&&fr.push(ir(ur.data,ur.mode)),fr},[])},s.fromString=function(sr,fr){const ur=Zn(sr,Fn.isKanjiModeEnabled()),br=Wn(ur),Nr=tr(br,fr),Ar=Kn.find_path(Nr.map,"start","end"),_r=[];for(let Rr=1;Rr<Ar.length-1;Rr++)_r.push(Nr.table[Ar[Rr]].node);return s.fromArray(Jn(_r))},s.rawSplit=function(sr){return s.fromArray(Zn(sr,Fn.isKanjiModeEnabled()))}})(Zt$1);const ot=P$2,at=tt,Be$1=ue,Ie=de$1,Pe=Bt,Le=It$1,ut=Pt$1,dt=et,Me=pe$1,W=Rt$1,Re=Ut,De=_$2,it=Zt$1;function Ue(s,$n){const Dn=s.size,Un=Le.getPositions($n);for(let Bn=0;Bn<Un.length;Bn++){const In=Un[Bn][0],qn=Un[Bn][1];for(let Fn=-1;Fn<=7;Fn++)if(!(In+Fn<=-1||Dn<=In+Fn))for(let Kn=-1;Kn<=7;Kn++)qn+Kn<=-1||Dn<=qn+Kn||(Fn>=0&&Fn<=6&&(Kn===0||Kn===6)||Kn>=0&&Kn<=6&&(Fn===0||Fn===6)||Fn>=2&&Fn<=4&&Kn>=2&&Kn<=4?s.set(In+Fn,qn+Kn,!0,!0):s.set(In+Fn,qn+Kn,!1,!0))}}function _e(s){const $n=s.size;for(let Dn=8;Dn<$n-8;Dn++){const Un=Dn%2===0;s.set(Dn,6,Un,!0),s.set(6,Dn,Un,!0)}}function Ze(s,$n){const Dn=Pe.getPositions($n);for(let Un=0;Un<Dn.length;Un++){const Bn=Dn[Un][0],In=Dn[Un][1];for(let qn=-2;qn<=2;qn++)for(let Fn=-2;Fn<=2;Fn++)qn===-2||qn===2||Fn===-2||Fn===2||qn===0&&Fn===0?s.set(Bn+qn,In+Fn,!0,!0):s.set(Bn+qn,In+Fn,!1,!0)}}function Fe(s,$n){const Dn=s.size,Un=W.getEncodedBits($n);let Bn,In,qn;for(let Fn=0;Fn<18;Fn++)Bn=Math.floor(Fn/3),In=Fn%3+Dn-8-3,qn=(Un>>Fn&1)===1,s.set(Bn,In,qn,!0),s.set(In,Bn,qn,!0)}function st(s,$n,Dn){const Un=s.size,Bn=Re.getEncodedBits($n,Dn);let In,qn;for(In=0;In<15;In++)qn=(Bn>>In&1)===1,In<6?s.set(In,8,qn,!0):In<8?s.set(In+1,8,qn,!0):s.set(Un-15+In,8,qn,!0),In<8?s.set(8,Un-In-1,qn,!0):In<9?s.set(8,15-In-1+1,qn,!0):s.set(8,15-In-1,qn,!0);s.set(Un-8,8,1,!0)}function qe$1(s,$n){const Dn=s.size;let Un=-1,Bn=Dn-1,In=7,qn=0;for(let Fn=Dn-1;Fn>0;Fn-=2)for(Fn===6&&Fn--;;){for(let Kn=0;Kn<2;Kn++)if(!s.isReserved(Bn,Fn-Kn)){let jn=!1;qn<$n.length&&(jn=($n[qn]>>>In&1)===1),s.set(Bn,Fn-Kn,jn),In--,In===-1&&(qn++,In=7)}if(Bn+=Un,Bn<0||Dn<=Bn){Bn-=Un,Un=-Un;break}}}function He$1(s,$n,Dn){const Un=new Be$1;Dn.forEach(function(Kn){Un.put(Kn.mode.bit,4),Un.put(Kn.getLength(),De.getCharCountIndicator(Kn.mode,s)),Kn.write(Un)});const Bn=ot.getSymbolTotalCodewords(s),In=dt.getTotalCodewordsCount(s,$n),qn=(Bn-In)*8;for(Un.getLengthInBits()+4<=qn&&Un.put(0,4);Un.getLengthInBits()%8!==0;)Un.putBit(0);const Fn=(qn-Un.getLengthInBits())/8;for(let Kn=0;Kn<Fn;Kn++)Un.put(Kn%2?17:236,8);return Oe(Un,s,$n)}function Oe(s,$n,Dn){const Un=ot.getSymbolTotalCodewords($n),Bn=dt.getTotalCodewordsCount($n,Dn),In=Un-Bn,qn=dt.getBlocksCount($n,Dn),Fn=Un%qn,Kn=qn-Fn,jn=Math.floor(Un/qn),Yn=Math.floor(In/qn),Zn=Yn+1,Xn=jn-Yn,Jn=new Me(Xn);let Wn=0;const tr=new Array(qn),ir=new Array(qn);let sr=0;const fr=new Uint8Array(s.buffer);for(let _r=0;_r<qn;_r++){const Rr=_r<Kn?Yn:Zn;tr[_r]=fr.slice(Wn,Wn+Rr),ir[_r]=Jn.encode(tr[_r]),Wn+=Rr,sr=Math.max(sr,Rr)}const ur=new Uint8Array(Un);let br=0,Nr,Ar;for(Nr=0;Nr<sr;Nr++)for(Ar=0;Ar<qn;Ar++)Nr<tr[Ar].length&&(ur[br++]=tr[Ar][Nr]);for(Nr=0;Nr<Xn;Nr++)for(Ar=0;Ar<qn;Ar++)ur[br++]=ir[Ar][Nr];return ur}function Ve$1(s,$n,Dn,Un){let Bn;if(Array.isArray(s))Bn=it.fromArray(s);else if(typeof s=="string"){let jn=$n;if(!jn){const Yn=it.rawSplit(s);jn=W.getBestVersionForData(Yn,Dn)}Bn=it.fromString(s,jn||40)}else throw new Error("Invalid data");const In=W.getBestVersionForData(Bn,Dn);if(!In)throw new Error("The amount of data is too big to be stored in a QR Code");if(!$n)$n=In;else if($n<In)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+In+`.
`);const qn=He$1($n,Dn,Bn),Fn=ot.getSymbolSize($n),Kn=new Ie(Fn);return Ue(Kn,$n),_e(Kn),Ze(Kn,$n),st(Kn,Dn,0),$n>=7&&Fe(Kn,$n),qe$1(Kn,qn),isNaN(Un)&&(Un=ut.getBestMask(Kn,st.bind(null,Kn,Dn))),ut.applyMask(Un,Kn),st(Kn,Dn,Un),{modules:Kn,version:$n,errorCorrectionLevel:Dn,maskPattern:Un,segments:Bn}}xt.create=function(s,$n){if(typeof s>"u"||s==="")throw new Error("No input text");let Dn=at.M,Un,Bn;return typeof $n<"u"&&(Dn=at.from($n.errorCorrectionLevel,at.M),Un=W.from($n.version),Bn=ut.from($n.maskPattern),$n.toSJISFunc&&ot.setToSJISFunction($n.toSJISFunc)),Ve$1(s,Un,Dn,Bn)};var qt={},mt={};(function(s){function $n(Dn){if(typeof Dn=="number"&&(Dn=Dn.toString()),typeof Dn!="string")throw new Error("Color should be defined as hex string");let Un=Dn.slice().replace("#","").split("");if(Un.length<3||Un.length===5||Un.length>8)throw new Error("Invalid hex color: "+Dn);(Un.length===3||Un.length===4)&&(Un=Array.prototype.concat.apply([],Un.map(function(In){return[In,In]}))),Un.length===6&&Un.push("F","F");const Bn=parseInt(Un.join(""),16);return{r:Bn>>24&255,g:Bn>>16&255,b:Bn>>8&255,a:Bn&255,hex:"#"+Un.slice(0,6).join("")}}s.getOptions=function(Dn){Dn||(Dn={}),Dn.color||(Dn.color={});const Un=typeof Dn.margin>"u"||Dn.margin===null||Dn.margin<0?4:Dn.margin,Bn=Dn.width&&Dn.width>=21?Dn.width:void 0,In=Dn.scale||4;return{width:Bn,scale:Bn?4:In,margin:Un,color:{dark:$n(Dn.color.dark||"#000000ff"),light:$n(Dn.color.light||"#ffffffff")},type:Dn.type,rendererOpts:Dn.rendererOpts||{}}},s.getScale=function(Dn,Un){return Un.width&&Un.width>=Dn+Un.margin*2?Un.width/(Dn+Un.margin*2):Un.scale},s.getImageWidth=function(Dn,Un){const Bn=s.getScale(Dn,Un);return Math.floor((Dn+Un.margin*2)*Bn)},s.qrToImageData=function(Dn,Un,Bn){const In=Un.modules.size,qn=Un.modules.data,Fn=s.getScale(In,Bn),Kn=Math.floor((In+Bn.margin*2)*Fn),jn=Bn.margin*Fn,Yn=[Bn.color.light,Bn.color.dark];for(let Zn=0;Zn<Kn;Zn++)for(let Xn=0;Xn<Kn;Xn++){let Jn=(Zn*Kn+Xn)*4,Wn=Bn.color.light;if(Zn>=jn&&Xn>=jn&&Zn<Kn-jn&&Xn<Kn-jn){const tr=Math.floor((Zn-jn)/Fn),ir=Math.floor((Xn-jn)/Fn);Wn=Yn[qn[tr*In+ir]?1:0]}Dn[Jn++]=Wn.r,Dn[Jn++]=Wn.g,Dn[Jn++]=Wn.b,Dn[Jn]=Wn.a}}})(mt);(function(s){const $n=mt;function Dn(Bn,In,qn){Bn.clearRect(0,0,In.width,In.height),In.style||(In.style={}),In.height=qn,In.width=qn,In.style.height=qn+"px",In.style.width=qn+"px"}function Un(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}s.render=function(Bn,In,qn){let Fn=qn,Kn=In;typeof Fn>"u"&&(!In||!In.getContext)&&(Fn=In,In=void 0),In||(Kn=Un()),Fn=$n.getOptions(Fn);const jn=$n.getImageWidth(Bn.modules.size,Fn),Yn=Kn.getContext("2d"),Zn=Yn.createImageData(jn,jn);return $n.qrToImageData(Zn.data,Bn,Fn),Dn(Yn,Kn,jn),Yn.putImageData(Zn,0,0),Kn},s.renderToDataURL=function(Bn,In,qn){let Fn=qn;typeof Fn>"u"&&(!In||!In.getContext)&&(Fn=In,In=void 0),Fn||(Fn={});const Kn=s.render(Bn,In,Fn),jn=Fn.type||"image/png",Yn=Fn.rendererOpts||{};return Kn.toDataURL(jn,Yn.quality)}})(qt);var Ht={};const je=mt;function zt(s,$n){const Dn=s.a/255,Un=$n+'="'+s.hex+'"';return Dn<1?Un+" "+$n+'-opacity="'+Dn.toFixed(2).slice(1)+'"':Un}function ct(s,$n,Dn){let Un=s+$n;return typeof Dn<"u"&&(Un+=" "+Dn),Un}function Ke$1(s,$n,Dn){let Un="",Bn=0,In=!1,qn=0;for(let Fn=0;Fn<s.length;Fn++){const Kn=Math.floor(Fn%$n),jn=Math.floor(Fn/$n);!Kn&&!In&&(In=!0),s[Fn]?(qn++,Fn>0&&Kn>0&&s[Fn-1]||(Un+=In?ct("M",Kn+Dn,.5+jn+Dn):ct("m",Bn,0),Bn=0,In=!1),Kn+1<$n&&s[Fn+1]||(Un+=ct("h",qn),qn=0)):Bn++}return Un}Ht.render=function(s,$n,Dn){const Un=je.getOptions($n),Bn=s.modules.size,In=s.modules.data,qn=Bn+Un.margin*2,Fn=Un.color.light.a?"<path "+zt(Un.color.light,"fill")+' d="M0 0h'+qn+"v"+qn+'H0z"/>':"",Kn="<path "+zt(Un.color.dark,"stroke")+' d="'+Ke$1(In,Bn,Un.margin)+'"/>',jn='viewBox="0 0 '+qn+" "+qn+'"',Yn='<svg xmlns="http://www.w3.org/2000/svg" '+(Un.width?'width="'+Un.width+'" height="'+Un.width+'" ':"")+jn+' shape-rendering="crispEdges">'+Fn+Kn+`</svg>
`;return typeof Dn=="function"&&Dn(null,Yn),Yn};const Ye$1=ce$1,ft=xt,Ot=qt,Je=Ht;function bt(s,$n,Dn,Un,Bn){const In=[].slice.call(arguments,1),qn=In.length,Fn=typeof In[qn-1]=="function";if(!Fn&&!Ye$1())throw new Error("Callback required as last argument");if(Fn){if(qn<2)throw new Error("Too few arguments provided");qn===2?(Bn=Dn,Dn=$n,$n=Un=void 0):qn===3&&($n.getContext&&typeof Bn>"u"?(Bn=Un,Un=void 0):(Bn=Un,Un=Dn,Dn=$n,$n=void 0))}else{if(qn<1)throw new Error("Too few arguments provided");return qn===1?(Dn=$n,$n=Un=void 0):qn===2&&!$n.getContext&&(Un=Dn,Dn=$n,$n=void 0),new Promise(function(Kn,jn){try{const Yn=ft.create(Dn,Un);Kn(s(Yn,$n,Un))}catch(Yn){jn(Yn)}})}try{const Kn=ft.create(Dn,Un);Bn(null,s(Kn,$n,Un))}catch(Kn){Bn(Kn)}}ft.create;bt.bind(null,Ot.render);var $e$1=bt.bind(null,Ot.renderToDataURL);bt.bind(null,function(s,$n,Dn){return Je.render(s,Dn)});const Ge$1=(s="light")=>{document.querySelectorAll("style[data-zap-dialog-styles]").forEach(Dn=>Dn.remove());const $n=document.createElement("style");$n.setAttribute("data-zap-dialog-styles","true"),$n.textContent=se(s),document.head.appendChild($n)};async function Qe(s){var $n;const{npub:Dn,relays:Un,cachedDialogComponent:Bn,buttonColor:In,fixedAmount:qn,defaultAmount:Fn,initialAmount:Kn,url:jn}=s,Yn=I$6(Dn);if(customElements.get("dialog-component")||await customElements.whenDefined("dialog-component"),Bn){const er=document.querySelector(".nostr-base-dialog");if(er){er.classList.remove("success"),er.querySelectorAll(".amount-buttons, .update-zap-container, .comment-container, .cta-btn, .copy-btn").forEach(vr=>{vr instanceof HTMLElement&&(vr.style.display="")});const or=er.querySelector(".update-zap-btn");or&&(or.style.display="");const wr=er.querySelector(".success-overlay");return wr&&(wr.style.opacity="0",wr.style.pointerEvents="none"),ur(er),Bn.showModal(),Bn}}const Zn=[21,100,1e3];let Xn;typeof qn=="number"&&qn>0?Xn=qn:typeof Fn=="number"&&Fn>0?Xn=Fn:typeof Kn=="number"&&Kn>0?Xn=Kn:Xn=Zn[0];let Jn="",Wn="",tr=null;async function ir(er,or){const wr=Yn,vr=await x$2(wr),Sr=await I$3(vr),rr=await M$2({zapEndpoint:Sr,amount:er*1e3,comment:or,authorId:wr,nip19Target:void 0,normalizedRelays:Un.split(","),anon:s.anon,url:jn});Wn=rr;const gr=Un.split(",");tr&&tr(),tr=_$3({relays:gr,receiversPubKey:Yn,invoice:rr,onSuccess:ar})}async function sr(er){try{return await $e$1(er,{width:240,margin:1,color:{dark:"#000000",light:"#ffffff"}})}catch(or){return console.error("Failed to generate QR code:",or),`data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="240" height="240" viewBox="0 0 100 100">
        <rect width="100%" height="100%" fill="white"/>
        <text x="50%" y="50%" font-family="monospace" font-size="10" text-anchor="middle" dominant-baseline="middle" fill="black">
          Invoice: ${er.substring(0,10)}...
        </text>
      </svg>`}}function fr(er,or){er.querySelectorAll("button").forEach(wr=>{wr.dataset.val===String(or)?wr.classList.add("active"):wr.classList.remove("active")})}async function ur(er){er.classList.add("loading");try{await ir(Xn,Jn);const or=er.querySelector("img.qr");sr(Wn).then(vr=>{or.src=vr});const wr=er.querySelector(".cta-btn");wr.disabled=!1}finally{er.classList.remove("loading")}}Ge$1(s.theme||"light");const br=document.createElement("dialog-component");br.setAttribute("header","Send a Zap"),s.theme&&br.setAttribute("data-theme",s.theme);const Nr=Zn.map(er=>`<button type="button" data-val="${er}">${er} </button>`).join(""),Ar=typeof qn=="number"&&qn>0;br.innerHTML=`
      <div class="zap-dialog-content">
        ${Ar?"":`<div class="amount-buttons">${Nr}</div>`}
        ${Ar?`<p class="zapping-amount">Zapping ${qn} sats</p>`:""}
        ${Ar?"":`<div class="update-zap-container">
          <input type="number" min="1" placeholder="Custom sats" class="custom-amount" style="width:100%;padding:8px;border:1px solid #e2e8f0;border-radius:6px" />
          <button type="button" class="update-zap-btn" style="padding:8px 12px;border:none;border-radius:6px;background:#7f00ff;color:#fff">Update Zap</button>
        </div>`}
        ${Ar?"":`<div class="comment-container">
          <input type="text" placeholder="Comment (optional)" class="comment-input" style="width:100%;padding:8px;border:1px solid #e2e8f0;border-radius:6px" />
          <button type="button" class="add-comment-btn" style="padding:8px 12px;border:none;border-radius:6px;background:#7f00ff;color:#fff">Add</button>
        </div>`}
        <img class="qr" width="240" height="240" alt="QR" style="cursor:pointer" />
        <br />
        <button type="button" class="copy-btn">Copy invoice</button>
        <button type="button" class="cta-btn" disabled>Open in wallet</button>
        <div class="loading-overlay"><div class="loader"></div></div>
        <div class="success-overlay"> Thank you!</div>
      </div>
  `,br.showModal();const _r=br.querySelector(".nostr-base-dialog")||(($n=br.shadowRoot)==null?void 0:$n.querySelector(".nostr-base-dialog"))||document.body.querySelector(".nostr-base-dialog");if(!_r)throw console.error("[showZapDialog] Failed to find dialog element after showModal()"),new Error("Dialog element not found. The dialog may not have been created properly.");const Rr=_r,Dr=Rr.querySelector(".amount-buttons");Dr&&Dr.addEventListener("click",async er=>{const or=er.target;if(or.tagName==="BUTTON"){const wr=Number(or.dataset.val);if(!isNaN(wr)){Xn=wr,fr(Dr,wr);const vr=Rr.querySelector(".cta-btn");vr.disabled=!0,await ur(Rr)}}});const zr=Rr.querySelector(".custom-amount");zr&&zr.addEventListener("input",async er=>{const or=Number(er.target.value);if(or>0){Xn=or,Dr&&fr(Dr,-1);const wr=Rr.querySelector(".cta-btn");wr.disabled=!0}});const dr=Rr.querySelector(".comment-input");dr&&dr.addEventListener("input",er=>{Jn=er.target.value.slice(0,200)});const pr=async()=>{Wn&&(await navigator.clipboard.writeText(Wn),Rr.querySelector(".copy-btn").textContent="Copied!",setTimeout(()=>{Rr.querySelector(".copy-btn").textContent="Copy invoice"},1500))};Rr.querySelector(".copy-btn").onclick=pr,Rr.querySelector("img.qr").onclick=pr;const lr=Rr.querySelector(".update-zap-btn");lr&&lr.addEventListener("click",async()=>{const er=Number(zr?.value);!isNaN(er)&&er>0&&(Xn=er,lr.disabled=!0,await ur(Rr),lr.disabled=!1)});const mr=Rr.querySelector(".add-comment-btn");mr&&mr.addEventListener("click",async()=>{mr.disabled=!0,await ur(Rr),mr.disabled=!1}),Rr.querySelector(".cta-btn").onclick=async()=>{if(Wn){if(window.webln)try{await window.webln.enable(),await window.webln.sendPayment(Wn),ar();return}catch(er){console.error("Nostr-Components: Zap button: webln payment failed",er),Rr.close()}window.location.href=`lightning:${Wn}`}};function ar(){Rr.classList.add("success");const er=Rr.querySelector(".success-overlay");er.style.opacity="1",er.style.pointerEvents="none",Rr.querySelectorAll(".amount-buttons, .update-zap-container, .comment-container, .cta-btn, .copy-btn").forEach(or=>{or instanceof HTMLElement&&(or.style.display="none")})}if(Rr.addEventListener("close",()=>{tr&&tr()}),In){const er=In;Rr.querySelector(".cta-btn").style.background=er,Rr.querySelector(".cta-btn").style.color=We$1(er)}if(await ur(Rr),Dr&&Zn.includes(Xn))fr(Dr,Xn);else if(!Ar){const er=Rr.querySelector(".custom-amount");er&&(er.value=String(Xn)),Dr&&fr(Dr,-1)}return br}function We$1(s){s=s.replace("#",""),s.length===3&&(s=s.split("").map(Bn=>Bn+Bn).join(""));const $n=parseInt(s.slice(0,2),16),Dn=parseInt(s.slice(2,4),16),Un=parseInt(s.slice(4,6),16);return($n*299+Dn*587+Un*114)/1e3>125?"#000":"#fff"}const Xe=()=>`
    /* Help Dialog Content Styles */
    .help-content {
      padding: var(--nostrc-spacing-md, 12px);
    }

    .help-content p {
      margin: 0 0 var(--nostrc-spacing-md, 12px) 0;
      color: var(--nostrc-theme-text-primary, #333333);
      line-height: 1.5;
    }

    .help-content p:last-child {
      margin-bottom: 0;
    }

    .help-content ul {
      margin: 0 0 var(--nostrc-spacing-md, 12px) 0;
      padding-left: var(--nostrc-spacing-lg, 16px);
      color: var(--nostrc-theme-text-primary, #333333);
    }

    .help-content li {
      margin-bottom: var(--nostrc-spacing-xs, 4px);
      line-height: 1.5;
    }

    .help-content li:last-child {
      margin-bottom: 0;
    }

    .help-content strong {
      font-weight: 600;
      color: var(--nostrc-theme-text-primary, #333333);
    }

    .help-content a:not(.youtube-link) {
      color: var(--nostrc-theme-primary, #0066cc);
      text-decoration: underline;
    }

    .help-content a:not(.youtube-link):hover {
      color: var(--nostrc-theme-primary-hover, #0052a3);
    }

    .youtube-link {
      display: inline-block;
      background: var(--nostrc-color-primary, #7f00ff);
      color: var(--nostrc-color-text-on-primary, #ffffff);
      padding: var(--nostrc-spacing-sm, 8px) var(--nostrc-spacing-md, 12px);
      border-radius: var(--nostrc-border-radius-md, 6px);
      text-decoration: none;
      font-weight: var(--nostrc-font-weight-medium, 500);
      margin-top: var(--nostrc-spacing-md, 12px);
      transition: background-color 0.2s ease;
    }

    .youtube-link:hover {
      background: var(--nostrc-color-primary-hover, #6b00d9);
    }
  `,tn="https://www.youtube.com/shorts/PDnrh8pkF3g",en=()=>{if(document.querySelector("style[data-help-dialog-styles]"))return;const s=document.createElement("style");s.setAttribute("data-help-dialog-styles","true"),s.textContent=Xe(),document.head.appendChild(s)},nn$1=async s=>{en(),customElements.get("dialog-component")||await customElements.whenDefined("dialog-component");const $n=document.createElement("dialog-component");$n.setAttribute("header","What is a Zap?"),$n.setAttribute("data-theme",s),$n.innerHTML=`
    <div class="help-content">
      <p>Send instant tips to support content creators! Zaps are small Bitcoin Lightning payments that go directly to creatorsno middleman.</p>
      <ul>
        <li>Send any amount instantly</li>
        <li>Money goes straight to the creator</li>
        <li>Powered by Bitcoin Lightning Network</li>
      </ul>
      <p><strong>How it works:</strong> Click zap, choose amount, scan QR code with a Lightning wallet, done!</p>
      <a href="${tn}" target="_blank" rel="noopener noreferrer" class="youtube-link">
        Watch Tutorial
      </a>
    </div>
  `,$n.showModal()};function on$1(s="light"){const $n=s==="dark";return V$3(`
    /* === ZAPPERS DIALOG CONTENT STYLES === */
    .zappers-dialog-content {
      overflow: hidden;
    }

    .zappers-list {
      max-height: 60vh;
      overflow-y: auto;
    }

    /* Individual zap entry */
    .zap-entry {
      padding: var(--nostrc-spacing-md, 16px);
      border-bottom: 1px solid ${$n?"#333333":"#f3f4f6"};
      transition: background-color 0.2s ease;
    }

    .zap-entry:last-child {
      border-bottom: none;
    }

    .zap-entry:hover {
      background: ${$n?"#2a2a2a":"#f9fafb"};
    }

    .zap-author-info {
      display: flex;
      align-items: center;
      gap: var(--nostrc-spacing-md, 16px);
    }

    .zap-author-picture {
      width: 40px;
      height: 40px;
      border-radius: var(--nostrc-border-radius-full, 50%);
      object-fit: cover;
      border: 2px solid ${$n?"#374151":"#e5e7eb"};
    }

    .zap-author-picture-default {
      width: 40px;
      height: 40px;
      border-radius: var(--nostrc-border-radius-full, 50%);
      background: ${$n?"#374151":"#f3f4f6"};
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--nostrc-font-size-lg, 18px);
      color: ${$n?"#9ca3af":"#6b7280"};
      border: 2px solid ${$n?"#4b5563":"#d1d5db"};
    }

    .zap-author-details {
      flex: 1;
      min-width: 0;
    }

    .zap-author-link {
      display: block;
      font-weight: 500;
      color: ${$n?"#ffffff":"#1a1a1a"};
      text-decoration: none;
      font-size: var(--nostrc-font-size-base, 16px);
      margin-bottom: var(--nostrc-spacing-xs, 4px);
      transition: color 0.2s ease;
    }

    .zap-author-link:hover {
      color: var(--nostrc-color-primary, #7f00ff);
    }

    .zap-comment {
      font-size: var(--nostrc-font-size-sm, 14px);
      color: ${$n?"#d1d5db":"#4b5563"};
      margin: var(--nostrc-spacing-xs, 4px) 0;
      line-height: 1.4;
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    .zap-amount-date {
      font-size: var(--nostrc-font-size-sm, 14px);
      color: ${$n?"#9ca3af":"#6b7280"};
      display: flex;
      align-items: center;
      gap: var(--nostrc-spacing-xs, 4px);
    }

    /* Loading skeleton with npub */
    .skeleton-entry {
      display: flex;
      align-items: center;
      gap: var(--nostrc-spacing-md, 16px);
      padding: var(--nostrc-spacing-md, 16px);
      border-bottom: 1px solid ${$n?"#333333":"#f3f4f6"};
    }

    .skeleton-entry:last-child {
      border-bottom: none;
    }

    .skeleton-picture {
      width: 40px;
      height: 40px;
      border-radius: var(--nostrc-border-radius-full, 50%);
      background: linear-gradient(90deg, 
        ${$n?"#374151":"#f0f0f0"} 25%, 
        ${$n?"#4b5563":"#e0e0e0"} 50%, 
        ${$n?"#374151":"#f0f0f0"} 75%
      );
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s infinite;
    }

    .skeleton-name {
      font-size: var(--nostrc-font-size-base, 16px);
      font-weight: 500;
      color: ${$n?"#9ca3af":"#6b7280"};
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
      word-break: break-all;
      line-height: 1.2;
    }

    @keyframes skeleton-loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }

    /* Empty state */
    .no-zaps {
      text-align: center;
      padding: var(--nostrc-spacing-xl, 32px);
      color: ${$n?"#9ca3af":"#6b7280"};
      font-size: var(--nostrc-font-size-base, 16px);
    }

    /* Responsive design */
    @media (max-width: 640px) {
      .zap-author-picture,
      .zap-author-picture-default,
      .skeleton-picture {
        width: 36px;
        height: 36px;
      }
      
      .zap-author-link {
        font-size: var(--nostrc-font-size-sm, 14px);
      }
      
      .zap-amount-date {
        font-size: var(--nostrc-font-size-xs, 12px);
      }
    }

    /* Scrollbar styling */
    .zappers-list::-webkit-scrollbar {
      width: 6px;
    }

    .zappers-list::-webkit-scrollbar-track {
      background: ${$n?"#2a2a2a":"#f1f5f9"};
      border-radius: 3px;
    }

    .zappers-list::-webkit-scrollbar-thumb {
      background: ${$n?"#4b5563":"#cbd5e1"};
      border-radius: 3px;
    }

    .zappers-list::-webkit-scrollbar-thumb:hover {
      background: ${$n?"#6b7280":"#94a3b8"};
    }
  `)}const rn$1=(s="light")=>{document.querySelectorAll("style[data-zappers-dialog-styles]").forEach(Dn=>Dn.remove());const $n=document.createElement("style");$n.setAttribute("data-zappers-dialog-styles","true"),$n.textContent=on$1(s),document.head.appendChild($n)};function Vt(s,$n){const Dn=B(s.authorName||"Unknown zapper"),Un=`https://njump.me/${a$1(s.authorNpub||"")?s.authorNpub:""}`,Bn=F$4(s.authorPicture||"")&&s.authorPicture||"",In=s.authorPicture?`<img src="${Bn}" alt="${Dn}" class="zap-author-picture" />`:'<div class="zap-author-picture-default"></div>',qn=s.comment?`<div class="zap-comment">${s.comment}</div>`:"";return`
    <div class="zap-entry" data-zap-index="${$n}" data-author-pubkey="${s.authorPubkey}">
      <div class="zap-author-info">
        ${In}
        <div class="zap-author-details">
          <a href="${Un}" target="_blank" rel="noopener noreferrer" class="zap-author-link">
            ${Dn}
          </a>
          ${qn}
          <div class="zap-amount-date">
            ${s.amount.toLocaleString()}   ${q$2(Math.floor(s.date.getTime()/1e3))}
          </div>
        </div>
      </div>
    </div>
  `}function an$1(s,$n,Dn){return`
    <div class="zap-entry skeleton-entry" data-zap-index="${Dn}" data-author-pubkey="${s.authorPubkey}">
      <div class="zap-author-info">
        <div class="skeleton-picture"></div>
        <div class="zap-author-details">
          <div class="zap-author-link skeleton-name">
            ${B($n)}
          </div>
          <div class="zap-amount-date">
            ${s.amount.toLocaleString()}   ${q$2(Math.floor(s.date.getTime()/1e3))}
          </div>
        </div>
      </div>
    </div>
  `}async function sn$1(s){var $n;const{zapDetails:Dn,theme:Un="light"}=s;rn$1(Un),customElements.get("dialog-component")||await customElements.whenDefined("dialog-component");const Bn=document.createElement("dialog-component");Bn.setAttribute("header","Zappers"),s.theme&&Bn.setAttribute("data-theme",s.theme);const In=await cn$1(Dn);Bn.innerHTML=In,Bn.showModal();const qn=Bn.querySelector(".nostr-base-dialog")||(($n=Bn.shadowRoot)==null?void 0:$n.querySelector(".nostr-base-dialog"))||document.body.querySelector(".nostr-base-dialog");if(!qn)throw console.error("[showZappersDialog] Failed to find dialog element after showModal()"),new Error("Dialog element not found. The dialog may not have been created properly.");const Fn=qn;return Fn&&Dn.length>0&&ln$1(Fn,Dn),Bn}async function cn$1(s){if(s.length===0)return`
      <div class="zappers-dialog-content">
        <div class="zappers-list">
          <div class="no-zaps">No zaps received yet</div>
        </div>
      </div>
    `;const $n=s.map(Dn=>M$4(Dn.authorPubkey));return`
    <div class="zappers-dialog-content">
      <div class="zappers-list">
        ${s.map((Dn,Un)=>an$1(Dn,$n[Un],Un)).join("")}
      </div>
    </div>
  `}async function ln$1(s,$n){const Dn=s.querySelector(".zappers-list");if(!Dn)return;const Un=[...new Set($n.map(Bn=>Bn.authorPubkey))];console.log("Nostr-Components: Zappers dialog: Fetching profiles for",Un.length,"unique authors");try{const Bn=await D$2(Un),In=new Map;Bn.forEach(Fn=>{In.set(Fn.id,Fn.profile)});const qn=new Map;Un.forEach(Fn=>{qn.set(Fn,M$4(Fn))});for(let Fn=0;Fn<$n.length;Fn++){const Kn=$n[Fn],jn=In.get(Kn.authorPubkey),Yn=qn.get(Kn.authorPubkey)||Kn.authorPubkey;let Zn;if(jn){const Jn=J$1(jn);Zn={...Kn,authorName:Jn.display_name||Jn.name||Yn,authorPicture:Jn.picture,authorNpub:Yn}}else Zn={...Kn,authorName:Yn,authorNpub:Yn};const Xn=Dn.querySelector(`[data-zap-index="${Fn}"]`);if(Xn){const Jn=Vt(Zn,Fn);Xn.outerHTML=Jn}}console.log("Nostr-Components: Zappers dialog: Progressive enhancement completed for",$n.length,"zap entries")}catch(Bn){console.error("Nostr-Components: Zappers dialog: Error in batched profile enhancement",Bn),console.log("Nostr-Components: Zappers dialog: Falling back to individual profile fetching"),await un$1(s,$n)}}async function un$1(s,$n){const Dn=s.querySelector(".zappers-list");if(!Dn)return;const Un=new Map,Bn=$n.map(async(In,qn)=>{if(Un.has(In.authorPubkey)){const Fn=Un.get(In.authorPubkey);return{index:qn,enhanced:{...In,authorName:Fn.authorName,authorPicture:Fn.authorPicture,authorNpub:Fn.authorNpub}}}try{const{getProfileMetadata:Fn}=await y$2(async()=>{const{getProfileMetadata:Xn}=await __vitePreload(()=>Promise.resolve().then(()=>zapUtilsBiKkJPt6),void 0);return{getProfileMetadata:Xn}},__vite__mapDeps$2([0,1,2,3,4])),Kn=await Fn(In.authorPubkey),jn=J$1(Kn),Yn=M$4(In.authorPubkey),Zn={...In,authorName:jn.display_name||jn.name||Yn,authorPicture:jn.picture,authorNpub:Yn};return Un.set(In.authorPubkey,Zn),{index:qn,enhanced:Zn}}catch(Fn){console.error("Nostr-Components: Zappers dialog: Error fetching profile for",In.authorPubkey,Fn);const Kn=M$4(In.authorPubkey),jn={...In,authorName:Kn,authorNpub:Kn};return Un.set(In.authorPubkey,jn),{index:qn,enhanced:jn}}});for(const In of Bn)try{const{index:qn,enhanced:Fn}=await In,Kn=Dn.querySelector(`[data-zap-index="${qn}"]`);if(Kn){const jn=Vt(Fn,qn);Kn.outerHTML=jn}}catch(qn){console.error("Nostr-Components: Zappers dialog: Error processing profile enhancement",qn)}}function dn$1({isLoading:s,isError:$n,isSuccess:Dn,errorMessage:Un,buttonText:Bn,totalZapAmount:In,isAmountLoading:qn,hasZaps:Fn=!1}){if($n)return pn$1(Un||"");if(s)return fn$1(qn);const Kn=Kt(),jn=`<span>${B(Bn)}</span>`;return jt(Kn,jn,In,qn,Fn)}function fn$1(s){return jt(Kt(),'<span class="button-text-skeleton"></span>',null,s)}function pn$1(s){return gn$1('<div class="error-icon">&#9888;</div>',B(s))}function gn$1(s,$n){return`
    <div class="nostr-zap-button-container">
      <div class="nostr-zap-button-left-container">
        ${s}
      </div>
      <div class="nostr-zap-button-right-container">
        ${$n}
      </div>
    </div>
  `}function jt(s,$n,Dn,Un,Bn=!1){const In=Un?'<span class="total-zap-amount skeleton"></span>':Dn!==null?`<span class="total-zap-amount${Bn?" clickable":""}">${Dn.toLocaleString()}  sats received</span>`:"";return`
    <div class="nostr-zap-button-container">
      <button class="nostr-zap-button">
        ${s}
        ${$n}
      </button>
      ${In} <button class="help-icon" title="What is a zap?">?</button>
    </div>
  `}function Kt(){return'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 2L3 14h7v8l10-12h-7z" fill="#FFC800"/></svg>'}function hn$1(){return V$3(`
    /* === ZAP BUTTON CONTAINER PATTERN === */
    :host {
      /* Icon sizing (overridable via CSS variables) */
      --nostrc-icon-height: 25px;
      --nostrc-icon-width: 25px;

      /* Zap button CSS variables (overridable by parent components) */
      --nostrc-zap-btn-padding: var(--nostrc-spacing-sm) var(--nostrc-spacing-md);
      --nostrc-zap-btn-border-radius: var(--nostrc-border-radius-md);
      --nostrc-zap-btn-border: var(--nostrc-border-width) solid var(--nostrc-color-border);
      --nostrc-zap-btn-min-height: 47px;
      --nostrc-zap-btn-width: auto;
      --nostrc-zap-btn-horizontal-alignment: left;
      --nostrc-zap-btn-bg: var(--nostrc-theme-bg, #ffffff);
      --nostrc-zap-btn-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-zap-btn-font-family: var(--nostrc-font-family-primary);
      --nostrc-zap-btn-font-size: var(--nostrc-font-size-base);
      
      /* Hover state variables */
      --nostrc-zap-btn-hover-bg: var(--nostrc-theme-hover-bg, rgba(0, 0, 0, 0.05));
      --nostrc-zap-btn-hover-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-zap-btn-hover-border: var(--nostrc-border-width) solid var(--nostrc-theme-border, var(--nostrc-color-border));

      /* Make the host a flex container for button + amount */
      display: inline-flex;
      flex-direction: row;
      align-items: center;
      gap: var(--nostrc-spacing-md);
      font-family: var(--nostrc-zap-btn-font-family);
      font-size: var(--nostrc-zap-btn-font-size);
    }

    /* Focus state for accessibility */
    :host(:focus-visible) {
      outline: 2px solid var(--nostrc-color-primary, #007bff);
      outline-offset: 2px;
    }

    :host(.is-error) .nostr-zap-button-container {
      border: var(--nostrc-border-width) solid var(--nostrc-color-error-text);
      border-radius: var(--nostrc-border-radius-md);
      padding: var(--nostrc-spacing-sm);
      color: var(--nostrc-color-error-text);
    }

    .nostr-zap-button-container {
      display: flex;
      align-items: center;
      gap: var(--nostrc-spacing-md);
      width: fit-content;
    }

    .nostr-zap-button-left-container {
      display: flex;
      align-items: center;
    }

    .nostr-zap-button-right-container {
      display: flex;
      align-items: center;
    }

    .nostr-zap-button {
      display: flex;
      align-items: center;
      justify-content: var(--nostrc-zap-btn-horizontal-alignment);
      gap: var(--nostrc-spacing-sm);
      background: var(--nostrc-zap-btn-bg);
      color: var(--nostrc-zap-btn-color);
      border: var(--nostrc-zap-btn-border);
      border-radius: var(--nostrc-zap-btn-border-radius);
      padding: var(--nostrc-zap-btn-padding);
      min-height: var(--nostrc-zap-btn-min-height);
      width: var(--nostrc-zap-btn-width);
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
      font-family: inherit;
      font-size: inherit;
    }

    /* Hover state on the button */
    .nostr-zap-button:hover {
      background: var(--nostrc-zap-btn-hover-bg);
      color: var(--nostrc-zap-btn-hover-color);
      border: var(--nostrc-zap-btn-hover-border);
    }

    .nostr-zap-button:disabled {
      pointer-events: none;
      user-select: none;
      opacity: 0.6;
    }

    :host:not([user-status="ready"]) .nostr-zap-button {
      cursor: not-allowed;
    }

    /* SVG Icon Styles */
    .nostr-zap-button svg {
      display: inline-block;
      vertical-align: middle;
      width: var(--nostrc-icon-width);
      height: var(--nostrc-icon-height);
    }

    /* Total zap amount display */
    .total-zap-amount {
      font-size: var(--nostrc-font-size-sm);
      color: var(--nostrc-theme-text-secondary, #666666);
      white-space: nowrap;
    }

    /* Clickable zap amount */
    .total-zap-amount.clickable {
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .total-zap-amount.clickable:hover {
      color: var(--nostrc-color-primary, #7f00ff);
    }

    /* Help icon */
    .help-icon {
      background: none;
      border: 1px solid var(--nostrc-color-border, #e0e0e0);
      border-radius: var(--nostrc-border-radius-full, 50%);
      width: var(--nostrc-help-icon-size, 16px);
      height: var(--nostrc-help-icon-size, 16px);
      font-size: calc(var(--nostrc-help-icon-size, 16px) * 0.7);
      font-weight: bold;
      color: var(--nostrc-theme-text-secondary, #666666);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-left: var(--nostrc-spacing-xs, 4px);
      transition: all 0.2s ease;
    }

    .help-icon:hover {
      background: var(--nostrc-color-hover-background, rgba(0, 0, 0, 0.05));
      border-color: var(--nostrc-color-primary, #7f00ff);
      color: var(--nostrc-color-primary, #7f00ff);
    }

    /* Skeleton loader for zap amount */
    .total-zap-amount.skeleton {
      background: linear-gradient(90deg, 
        var(--nostrc-color-skeleton, #f0f0f0) 25%, 
        var(--nostrc-color-skeleton-highlight, #e0e0e0) 50%, 
        var(--nostrc-color-skeleton, #f0f0f0) 75%
      );
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s infinite;
      border-radius: var(--nostrc-border-radius-sm);
      width: 80px;
      height: 1.2em;
      display: inline-block;
    }

    /* Skeleton loader for button text */
    .button-text-skeleton {
      background: linear-gradient(90deg, 
        var(--nostrc-color-skeleton, #f0f0f0) 25%, 
        var(--nostrc-color-skeleton-highlight, #e0e0e0) 50%, 
        var(--nostrc-color-skeleton, #f0f0f0) 75%
      );
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s infinite;
      border-radius: var(--nostrc-border-radius-sm);
      width: 60px;
      height: 1em;
      display: inline-block;
    }

    @keyframes skeleton-loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }

    /* Error message styling */
    .nostr-zap-button-error small {
      color: var(--nostrc-color-error-text);
      font-size: var(--nostrc-font-size-sm);
      line-height: 1em;
      max-width: 250px;
      white-space: pre-line;
    }
  `)}let mn$1=class extends C$2{constructor(){super(),Z(this,"zapActionStatus",this.channel("zapAction")),Z(this,"zapListStatus",this.channel("zapList")),Z(this,"totalZapAmount",null),Z(this,"cachedZapDetails",[]),Z(this,"cachedAmountDialog",null)}connectedCallback(){var $n;($n=super.connectedCallback)==null||$n.call(this),this.zapListStatus.get()==f$2.Idle&&this.initChannelStatus("zapList",f$2.Loading,{reflectOverall:!1}),this.attachDelegatedListeners(),this.render()}static get observedAttributes(){return[...super.observedAttributes,"text","amount","default-amount","url"]}attributeChangedCallback($n,Dn,Un){Dn!==Un&&(super.attributeChangedCallback($n,Dn,Un),this.render())}disconnectedCallback(){this.cachedAmountDialog&&typeof this.cachedAmountDialog.close=="function"&&this.cachedAmountDialog.close()}onStatusChange($n){this.render()}onUserReady($n,Dn){this.render(),this.updateZapCount()}validateInputs(){if(!super.validateInputs())return this.zapActionStatus.set(f$2.Idle),this.zapListStatus.set(f$2.Idle),!1;const $n=this.getAttribute("text"),Dn=this.getAttribute("amount"),Un=this.getAttribute("default-amount"),Bn=this.getAttribute("url"),In=this.tagName.toLowerCase();let qn=null;if($n&&$n.length>128)qn="Max text length: 128 characters";else if(Dn){const Fn=Number(Dn);isNaN(Fn)||Fn<=0?qn="Invalid amount":Fn>21e4&&(qn="Amount too high (max 210,000 sats)")}else if(Un){const Fn=Number(Un);isNaN(Fn)||Fn<=0?qn="Invalid default-amount":Fn>21e4&&(qn="Default-amount too high (max 210,000 sats)")}else Bn&&(F$4(Bn)||(qn="Invalid URL format"));return qn?(this.zapActionStatus.set(f$2.Error,qn),this.zapListStatus.set(f$2.Error,qn),this.userStatus.set(f$2.Idle),console.error(`Nostr-Components: ${In}: ${qn}`),!1):!0}async handleZapClick(){if(this.userStatus.get()===f$2.Ready){this.zapActionStatus.set(f$2.Loading),this.render();try{if(await r(),!this.user){this.zapActionStatus.set(f$2.Error,"Could not resolve user to zap."),this.render();return}const $n=this.getRelays().join(","),Dn=this.user.npub;this.cachedAmountDialog=await Qe({npub:Dn,relays:$n,cachedDialogComponent:this.cachedAmountDialog,theme:this.theme==="dark"?"dark":"light",fixedAmount:(()=>{const Un=this.getAttribute("amount");if(!Un)return;const Bn=Number(Un);if(isNaN(Bn)||Bn<=0||Bn>21e4){console.error("Nostr-Components: Zap button: Max zap amount: 210,000 sats");return}return Bn})(),defaultAmount:(()=>{const Un=this.getAttribute("default-amount");if(!Un)return 21;const Bn=Number(Un);return isNaN(Bn)||Bn<=0||Bn>21e4?(console.error("Nostr-Components: Zap button: Max zap amount: 210,000 sats"),21):Bn})(),url:this.getAttribute("url")||void 0,anon:!1}),this.zapActionStatus.set(f$2.Ready)}catch($n){this.zapActionStatus.set(f$2.Error,$n?.message||"Unable to zap")}finally{this.render()}}}async handleHelpClick(){try{await nn$1(this.theme==="dark"?"dark":"light")}catch($n){console.error("Error showing help dialog:",$n)}}async handleZappersClick(){if(this.cachedZapDetails.length!==0)try{await sn$1({zapDetails:this.cachedZapDetails,theme:this.theme==="dark"?"dark":"light"})}catch($n){console.error("Nostr-Components: Zap button: Error opening zappers dialog",$n)}}attachDelegatedListeners(){this.delegateEvent("click",".nostr-zap-button",$n=>{var Dn,Un;(Dn=$n.preventDefault)==null||Dn.call($n),(Un=$n.stopPropagation)==null||Un.call($n),this.handleZapClick()}),this.delegateEvent("click",".help-icon",$n=>{var Dn,Un;(Dn=$n.preventDefault)==null||Dn.call($n),(Un=$n.stopPropagation)==null||Un.call($n),this.handleHelpClick()}),this.delegateEvent("click",".total-zap-amount",$n=>{var Dn,Un;(Dn=$n.preventDefault)==null||Dn.call($n),(Un=$n.stopPropagation)==null||Un.call($n),this.handleZappersClick()})}async updateZapCount(){if(this.user)try{this.zapListStatus.set(f$2.Loading),this.render(),await this.ensureNostrConnected();const $n=await V$1({pubkey:this.user.pubkey,relays:this.getRelays(),url:this.getAttribute("url")||void 0});this.totalZapAmount=$n.totalAmount,this.cachedZapDetails=$n.zapDetails,this.zapListStatus.set(f$2.Ready)}catch($n){console.error("Nostr-Components: Zap button: Failed to fetch zap count",$n),this.totalZapAmount=null,this.zapListStatus.set(f$2.Error)}finally{this.render()}}renderContent(){const $n=this.userStatus.get()==f$2.Loading,Dn=this.zapListStatus.get()==f$2.Loading,Un=this.computeOverall()===f$2.Error,Bn=this.errorMessage,In=this.getAttribute("text")||"Zap",qn={isLoading:$n,isAmountLoading:Dn,isError:Un,isSuccess:!1,errorMessage:Bn,buttonText:In,totalZapAmount:this.totalZapAmount,hasZaps:this.cachedZapDetails.length>0};this.shadowRoot.innerHTML=`
      ${hn$1()}
      ${dn$1(qn)}
    `}};customElements.get("nostr-zap")||customElements.define("nostr-zap",mn$1);const __vite__mapDeps$1=(s,$n=__vite__mapDeps$1,Dn=$n.f||($n.f=["assets/pure-DOoUcNQv.js","assets/nostr-service-CA0Qx4nJ.js"]))=>s.map(Un=>Dn[Un]);var Zt=Object.defineProperty,Qt=(s,$n,Dn)=>$n in s?Zt(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,f$1=(s,$n,Dn)=>Qt(s,typeof $n!="symbol"?$n+"":$n,Dn);function Y(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function nn(s){const $n=Date.now()/1e3-s;return $n<60?"just now":$n<3600?`${Math.floor($n/60)}m ago`:$n<86400?`${Math.floor($n/3600)}h ago`:$n<2592e3?`${Math.floor($n/86400)}d ago`:new Date(s*1e3).toLocaleDateString()}function Rt(s){var $n,Dn;return($n=s.userProfile)!=null&&$n.displayName?s.userProfile.displayName:(Dn=s.userProfile)!=null&&Dn.name?s.userProfile.name:`${s.pubkey.slice(0,8)}...${s.pubkey.slice(-4)}`}function on(s){var $n,Dn;if(($n=s.userProfile)!=null&&$n.image&&s.userProfile.image.trim()!==""){let Un=s.userProfile.image.trim();return console.log("Processing image URL:",Un,"for user:",s.userProfile.name||s.pubkey),(Un.startsWith("Qm")||Un.startsWith("bafy"))&&(Un=`https://ipfs.io/ipfs/${Un}`,console.log("Converted IPFS to gateway URL:",Un)),Un.startsWith("//")&&(Un="https:"+Un,console.log("Added protocol to URL:",Un)),console.log("Final image URL:",Un),Un}return console.log("No image found for user:",((Dn=s.userProfile)==null?void 0:Dn.name)||s.pubkey,"using default"),"../../assets/default_dp.png"}function Lt(s,$n=!1,Dn=null,Un=null,Bn="anon",In=!1){const qn=Rt(s),Fn=on(s),Kn=nn(s.created_at),jn=s.depth||0,Yn=6,Zn=Dn===s.id;return`
    <div class="modern-comment" data-comment-id="${Y(s.id)}" data-depth="${jn}">
      <div class="comment-content-wrapper">
        <div class="comment-avatar-section">
          <img src="${Fn}" alt="Avatar" class="comment-avatar" />
        </div>
        <div class="comment-body">
          <div class="comment-header">
            <span class="comment-author">${Y(qn)}</span>
            <span class="comment-time">${Y(Kn)}</span>
          </div>
          <div class="comment-text">
            ${Y(s.content.trim())}
          </div>
          <div class="comment-actions">
            ${$n?"":`<button class="reply-btn" data-comment-id="${Y(s.id)}" aria-label="Reply to comment">
              <span class="reply-icon"></span>
              <span class="reply-text">Reply</span>
            </button>`}
          </div>
          ${Zn?rn(s,Un,Bn,In):""}
        </div>
      </div>
      ${s.replies.length>0?`
        <div class="comment-replies" style="margin-left: ${Math.min(jn+1,Yn)*24}px;">
          ${s.replies.map(Xn=>Lt(Xn,$n,Dn,Un,Bn,In)).join("")}
        </div>
      `:""}
    </div>
  `}function rn(s,$n,Dn="anon",Un=!1){let Bn="../../assets/default_dp.png";if(console.log("renderInlineReplyForm - currentUserProfile:",$n),$n!=null&&$n.image&&$n.image.trim()!==""){let qn=$n.image.trim();console.log("Inline reply form - Processing image URL:",qn),(qn.startsWith("Qm")||qn.startsWith("bafy"))&&(qn=`https://ipfs.io/ipfs/${qn}`,console.log("Inline reply form - Converted IPFS to gateway URL:",qn)),qn.startsWith("//")&&(qn="https:"+qn,console.log("Inline reply form - Added protocol to URL:",qn)),console.log("Inline reply form - Final image URL:",qn),Bn=qn}else console.log("Inline reply form - No image found, using default");const In=Rt(s);return`
    <div class="inline-reply-form">
      <div class="reply-context">
        <span class="reply-context-text"> Replying to <strong>${Y(In)}</strong></span>
        <button data-role="cancel-reply" class="cancel-reply-btn" aria-label="Cancel reply"></button>
      </div>
      <div class="reply-input-container">
        <div class="reply-input-avatar">
          <img src="${Bn}" alt="Your avatar" class="user-avatar" />
        </div>
        <div class="reply-input-main">
          <textarea 
            data-role="comment-input" 
            placeholder="Write your reply..."
            rows="2"
            class="modern-comment-textarea"
          ></textarea>
          <div class="reply-input-footer">
            <div class="identity-toggle">
              <button data-role="toggle-as-user" class="identity-btn ${Dn==="user"?"active":""}" ${Un?"":"disabled"} title="${Un?"Use your Nostr extension":"NIP-07 extension not detected"}">
                <span class="identity-icon">${Un?"":""}</span>
                <span class="identity-text">User</span>
              </button>
              <button data-role="toggle-as-anon" class="identity-btn ${Dn==="anon"?"active":""}" title="Comment anonymously">
                <span class="identity-icon"></span>
                <span class="identity-text">Anonymous</span>
              </button>
            </div>
            <div class="reply-actions">
              <button data-role="cancel-reply" class="cancel-reply-btn" aria-label="Cancel reply">Cancel</button>
              <button data-role="submit-comment" class="submit-reply-btn" aria-label="Submit reply">
                <span class="submit-icon"></span>
                <span class="submit-text">Reply</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  `}function an(s,$n,Dn,Un,Bn,In="anon",qn=!1){return s?"":(console.log("renderCommentForm - currentUserProfile:",Un),`
    <div class="modern-comment-form">
      <div class="comment-input-container">
        <div class="comment-input-main">
          <textarea 
            data-role="comment-input" 
            placeholder="${Y($n)}"
            rows="3"
            ${Dn?"disabled":""}
            class="modern-comment-textarea"
          ></textarea>
          <div class="comment-input-footer">
            <div class="identity-toggle">
              <button data-role="toggle-as-user" class="identity-btn ${In==="user"?"active":""}" ${qn?"":"disabled"} title="${qn?"Use your Nostr extension":"NIP-07 extension not detected"}">
                <span class="identity-icon">${qn?"":""}</span>
                <span class="identity-text">User</span>
              </button>
              <button data-role="toggle-as-anon" class="identity-btn ${In==="anon"?"active":""}" title="Comment anonymously">
                <span class="identity-icon"></span>
                <span class="identity-text">Anonymous</span>
              </button>
            </div>
            <button 
              data-role="submit-comment" 
              class="submit-comment-btn"
              ${Dn?"disabled":""}
              aria-label="${Dn?"Submitting comment":"Submit comment"}"
            >
              ${Dn?"":""}
              <span class="submit-text">${Dn?"Submitting...":"Comment"}</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  `)}function sn(s,$n=!1,Dn=null,Un=null,Bn="anon",In=!1){const qn=Pt(s);return qn===0?`
      <div class="no-comments">
        <p>No comments yet. Be the first to comment!</p>
      </div>
    `:`
    <div class="comments-list">
      <div class="comments-header">
        <div class="comments-title">
          <span class="comments-label">Comments</span>
          <span class="comments-count-badge">${qn}</span>
        </div>
      </div>
      <div class="comments-container">
        ${s.map(Fn=>Lt(Fn,$n,Dn,Un,Bn,In)).join("")}
      </div>
    </div>
  `}function Pt(s){let $n=0;for(const Dn of s)$n+=1+Pt(Dn.replies);return $n}function ln(s,$n,Dn,Un,Bn,In,qn,Fn=null,Kn=null,jn="anon",Yn=!1){return s?`
      <div class="comment-widget loading">
        <div class="loading-indicator">
          <div class="loading-spinner"></div>
          <p>Loading comments...</p>
        </div>
      </div>
    `:$n?`
      <div class="comment-widget error">
        <div class="error-message">
          <p> Failed to load comments</p>
          ${Dn?`<small>${Y(Dn)}</small>`:""}
        </div>
      </div>
    `:`
    <div class="comment-widget">
      ${an(Bn,In,qn,Fn,Kn,jn,Yn)}
      ${sn(Un,Bn,Kn,Fn,jn,Yn)}
      <div class="powered-by">
        <small>Powered by <a href="https://nostr.org" target="_blank">Nostr</a></small>
      </div>
    </div>
  `}function cn(s){return`
    <style>
      :host {
        /* Define CSS variables on the host element */
        --nstrc-comment-background: var(--nstrc-comment-background-${s});
        --nstrc-comment-text-color: var(--nstrc-comment-text-color-${s});
        --nstrc-comment-border-color: var(--nstrc-comment-border-color-${s});
        --nstrc-comment-input-background: var(--nstrc-comment-input-background-${s});
        --nstrc-comment-button-background: var(--nstrc-comment-button-background-${s});
        --nstrc-comment-button-text: var(--nstrc-comment-button-text-${s});
        --nstrc-comment-hover-background: var(--nstrc-comment-hover-background-${s});
        --nstrc-comment-meta-color: var(--nstrc-comment-meta-color-${s});
        --nstrc-comment-shadow: var(--nstrc-comment-shadow-${s});
        display: block;
        contain: content;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }

      :host(.dark) {
        --nstrc-comment-background: var(--nstrc-comment-background-dark);
        --nstrc-comment-text-color: var(--nstrc-comment-text-color-dark);
        --nstrc-comment-border-color: var(--nstrc-comment-border-color-dark);
        --nstrc-comment-input-background: var(--nstrc-comment-input-background-dark);
        --nstrc-comment-button-background: var(--nstrc-comment-button-background-dark);
        --nstrc-comment-button-text: var(--nstrc-comment-button-text-dark);
        --nstrc-comment-meta-color: var(--nstrc-comment-meta-color-dark);
        --nstrc-comment-hover-background: var(--nstrc-comment-hover-background-dark);
        --nstrc-comment-shadow: var(--nstrc-comment-shadow-dark);
      }

      /* CSS Variables with defaults */
      :host {
        --nstrc-comment-background-light: #f8f9fa;
        --nstrc-comment-background-dark: #1a1a1a;
        --nstrc-comment-text-color-light: #333333;
        --nstrc-comment-text-color-dark: #ffffff;
        --nstrc-comment-border-color-light: #e1e5e9;
        --nstrc-comment-border-color-dark: #404040;
        --nstrc-comment-input-background-light: #f5f5f5;
        --nstrc-comment-input-background-dark: #2a2a2a;
        --nstrc-comment-button-background-light: #ff6b35;
        --nstrc-comment-button-background-dark: #ff6b35;
        --nstrc-comment-button-text-light: #ffffff;
        --nstrc-comment-button-text-dark: #ffffff;
        --nstrc-comment-meta-color-light: #6c757d;
        --nstrc-comment-meta-color-dark: #adb5bd;
        --nstrc-comment-hover-background-light: #e9ecef;
        --nstrc-comment-hover-background-dark: #2d2d30;
        --nstrc-comment-shadow-light: 0 2px 8px rgba(0, 0, 0, 0.1);
        --nstrc-comment-shadow-dark: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      .nostr-comment-wrapper {
        display: block;
        width: 100%;
      }

      .comment-widget {
        background: var(--nstrc-comment-background, #ffffff);
        color: var(--nstrc-comment-text-color, #333333);
        border-radius: 8px;
        max-width: 100%;
        box-sizing: border-box;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }

      .comment-widget.loading,
      .comment-widget.error {
        text-align: center;
        padding: 40px 20px;
      }

      .loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
      }

      .loading-spinner {
        width: 24px;
        height: 24px;
        border: 2px solid var(--nstrc-comment-border-color, #e1e5e9);
        border-top: 2px solid var(--nstrc-comment-button-background, #007bff);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      .error-message {
        color: #dc3545;
      }

      /* Modern Comment Form */
      .modern-comment-form {
        margin-bottom: 16px;
        background: var(--nstrc-comment-input-background, #f5f5f5);
        border: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
        border-radius: 12px;
        overflow: hidden;
        box-shadow: var(--nstrc-comment-shadow, 0 2px 8px rgba(0, 0, 0, 0.1));
      }

      .comment-input-container {
        display: flex;
        padding: 16px;
        gap: 12px;
        align-items: flex-start;
      }

      .comment-input-main {
        flex: 1;
        min-width: 0;
      }

      .comment-input-main textarea {
        width: 100%;
        min-height: 60px;
        padding: 12px 16px;
        border: none;
        border-radius: 8px;
        background: var(--nstrc-comment-background, #f8f9fa);
        color: var(--nstrc-comment-text-color, #333333);
        font-family: inherit;
        font-size: 14px;
        resize: vertical;
        box-sizing: border-box;
        transition: all 0.2s ease;
        line-height: 1.4;
      }

      .comment-input-main textarea:focus {
        outline: none;
        background: var(--nstrc-comment-background, #f8f9fa);
        box-shadow: 0 0 0 2px var(--nstrc-comment-button-background, #ff6b35);
      }

      .comment-input-main textarea:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        background: var(--nstrc-comment-hover-background, #e9ecef);
      }

      .comment-input-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 12px;
        padding-top: 12px;
        border-top: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
      }

      .identity-toggle {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .identity-btn {
        display: flex;
        align-items: center;
        gap: 4px;
        padding: 6px 12px;
        font-size: 12px;
        border: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
        background: var(--nstrc-comment-background, #f8f9fa);
        color: var(--nstrc-comment-text-color, #333333);
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-weight: 500;
      }

      .identity-btn:hover {
        background: var(--nstrc-comment-hover-background);
        transform: translateY(-1px);
      }

      .identity-btn.active {
        background: var(--nstrc-comment-button-background);
        color: var(--nstrc-comment-button-text, #ffffff);
        border-color: var(--nstrc-comment-button-background);
      }

      .identity-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      .identity-icon {
        font-size: 14px;
      }

      .identity-text {
        font-weight: 500;
      }

      .reply-indicator {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--nstrc-comment-hover-background);
        padding: 8px 12px;
        border-radius: 4px;
        margin-bottom: 8px;
        font-size: 13px;
        color: var(--nstrc-comment-button-background, #007bff);
        border: 1px solid var(--nstrc-comment-border-color);
      }

      .cancel-reply-btn {
        background: none;
        border: none;
        color: var(--nstrc-comment-meta-color, #6c757d);
        cursor: pointer;
        font-size: 14px;
        padding: 4px 8px;
        border-radius: 3px;
        line-height: 1;
        font-weight: bold;
      }

      .cancel-reply-btn:hover {
        background: #dc3545;
        color: white;
      }

      .reddit-textarea {
        width: 100%;
        min-height: 80px;
        padding: 12px;
        border: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
        border-radius: 4px;
        background: var(--nstrc-comment-input-background, #ffffff);
        color: var(--nstrc-comment-text-color, #333333);
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 14px;
        resize: vertical;
        box-sizing: border-box;
        transition: border-color 0.2s ease;
      }

      .reddit-textarea:focus {
        outline: none;
        border-color: var(--nstrc-comment-button-background, #007bff);
        box-shadow: 0 0 0 1px var(--nstrc-comment-button-background, #007bff);
      }

      .reddit-textarea:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        background: var(--nstrc-comment-hover-background);
      }

      .comment-form-toolbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 8px;
        padding-top: 8px;
        border-top: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
      }

      .formatting-help {
        color: var(--nstrc-comment-meta-color, #6c757d);
      }

      .formatting-help small {
        font-size: 12px;
      }

      .submit-comment-btn {
        display: flex;
        align-items: center;
        gap: 6px;
        background: var(--nstrc-comment-button-background, #ff6b35);
        color: white;
        border: none;
        border-radius: 8px;
        padding: 8px 16px;
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(255, 107, 53, 0.2);
      }

      .submit-comment-btn:hover:not(:disabled) {
        background: #e55a2b;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
      }

      .submit-comment-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .submit-icon {
        font-size: 16px;
      }

      .submit-text {
        font-weight: 600;
      }


      .comments-list {
        margin-bottom: 16px;
      }

      .comments-header {
        margin-bottom: 12px;
      }

      .comments-title {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .comments-label {
        font-size: 18px;
        font-weight: 600;
        color: var(--nstrc-comment-text-color, #333333);
      }

      .comments-count-badge {
        background: var(--nstrc-comment-button-background, #007bff);
        color: white;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        min-width: 20px;
        text-align: center;
      }

      .no-comments {
        text-align: center;
        padding: 40px 20px;
        color: var(--nstrc-comment-meta-color, #6c757d);
      }

      .no-comments p {
        margin: 0;
        font-style: italic;
      }

      .comments-container {
        display: flex;
        flex-direction: column;
      }

      /* Ultra-Compact Modern Comments */
      .modern-comment {
        background: var(--nstrc-comment-background, #ffffff);
        border-bottom: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
        margin-bottom: 0;
        transition: background-color 0.2s ease;
      }

      .modern-comment:hover {
        background: var(--nstrc-comment-hover-background, #f8f9fa);
      }

      .modern-comment:last-child {
        border-bottom: none;
      }

      .comment-content-wrapper {
        display: flex;
        padding: 8px 12px;
        gap: 8px;
        align-items: flex-start;
      }

      .comment-avatar-section {
        flex-shrink: 0;
      }

      .comment-avatar {
        width: 26px;
        height: 26px;
        border-radius: 50%;
        object-fit: cover;
        background: var(--nstrc-comment-border-color, #e1e5e9);
        border: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
      }

      .comment-body {
        flex: 1;
        min-width: 0;
        margin: 0;
        padding: 0;
      }

      .comment-header {
        display: flex;
        align-items: center;
        gap: 6px;
        margin-bottom: 2px;
        flex-wrap: wrap;
      }

      .comment-author {
        font-weight: 600;
        font-size: 12px;
        color: var(--nstrc-comment-text-color, #333333);
        text-decoration: none;
      }

      .comment-author:hover {
        color: var(--nstrc-comment-button-background, #007bff);
      }

      .comment-time {
        font-size: 11px;
        color: var(--nstrc-comment-meta-color, #6c757d);
        font-weight: 400;
      }

      .comment-text {
        font-size: 13px;
        line-height: 0.45;
        color: var(--nstrc-comment-text-color, #333333);
        margin-bottom: 3px;
        white-space: pre-line;
        word-wrap: break-word;
        margin-top: 0;
      }

      .comment-actions {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 0;
      }

      .reply-btn {
        display: flex;
        align-items: center;
        gap: 3px;
        background: none;
        border: none;
        color: var(--nstrc-comment-meta-color, #6c757d);
        cursor: pointer;
        font-size: 11px;
        padding: 2px 6px;
        border-radius: 3px;
        transition: all 0.2s ease;
        font-weight: 500;
      }

      .reply-btn:hover {
        background: var(--nstrc-comment-hover-background);
        color: var(--nstrc-comment-text-color);
      }

      .reply-icon {
        font-size: 10px;
      }

      .reply-text {
        font-weight: 500;
      }

      .comment-replies {
        margin-top: 0;
        border-left: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
        padding-left: 12px;
        margin-left: 34px; /* 26px avatar + 8px gap */
      }

      /* Ultra-Compact Inline Reply Form */
      .inline-reply-form {
        margin-top: 8px;
        padding: 8px;
        background: var(--nstrc-comment-hover-background);
        border: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
        border-radius: 4px;
        margin-left: 34px; /* Align with comment text */
      }

      .reply-context {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--nstrc-comment-button-background, #007bff);
        color: white;
        padding: 6px 10px;
        border-radius: 3px;
        margin-bottom: 8px;
        font-size: 12px;
        font-weight: 500;
      }

      .reply-context-text {
        color: white;
      }

      .reply-input-container {
        display: flex;
        gap: 8px;
        align-items: flex-start;
      }

      .reply-input-avatar {
        flex-shrink: 0;
      }

      .reply-input-avatar .user-avatar {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        object-fit: cover;
        background: var(--nstrc-comment-border-color, #e1e5e9);
        border: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
      }

      .reply-form-main {
        flex: 1;
        min-width: 0;
      }

      .reply-form-header {
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .reply-form-header .current-user-name {
        font-size: 12px;
        color: var(--nstrc-comment-meta-color, #6c757d);
        font-weight: 500;
      }

      .reply-form-header .identity-toggle {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .reply-form-header .toggle-label {
        font-size: 11px;
        color: var(--nstrc-comment-meta-color, #6c757d);
        font-weight: 500;
      }

      .reply-form-header .identity-btn {
        padding: 2px 6px;
        font-size: 10px;
        border: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
        background: var(--nstrc-comment-input-background, #ffffff);
        color: var(--nstrc-comment-text-color, #333333);
        border-radius: 3px;
        cursor: pointer;
      }

      .reply-form-header .identity-btn:hover {
        background: var(--nstrc-comment-hover-background);
      }

      .reply-form-header .identity-btn.active {
        background: var(--nstrc-comment-button-background);
        color: var(--nstrc-comment-button-text, #ffffff);
        border-color: var(--nstrc-comment-button-background);
      }

      .reply-form-header .identity-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .reply-input-main {
        flex: 1;
        min-width: 0;
      }

      .reply-input-main textarea {
        width: 100%;
        min-height: 60px;
        padding: 12px;
        border: 2px solid var(--nstrc-comment-border-color, #e1e5e9);
        border-radius: 8px;
        background: var(--nstrc-comment-input-background, #ffffff);
        color: var(--nstrc-comment-text-color, #333333);
        font-family: inherit;
        font-size: 14px;
        resize: vertical;
        box-sizing: border-box;
        transition: all 0.2s ease;
      }

      .reply-input-main textarea:focus {
        outline: none;
        border-color: var(--nstrc-comment-button-background, #007bff);
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
      }

      .reply-input-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 8px;
        padding-top: 8px;
        border-top: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
      }

      .reply-actions {
        display: flex;
        gap: 6px;
        align-items: center;
      }

      .cancel-reply-btn {
        background: none;
        border: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
        color: var(--nstrc-comment-meta-color, #6c757d);
        cursor: pointer;
        font-size: 11px;
        padding: 4px 8px;
        border-radius: 3px;
        transition: all 0.2s ease;
        font-weight: 500;
      }

      .cancel-reply-btn:hover {
        background: var(--nstrc-comment-hover-background);
        color: var(--nstrc-comment-text-color);
        border-color: var(--nstrc-comment-border-color, #e1e5e9);
      }

      .submit-reply-btn {
        display: flex;
        align-items: center;
        gap: 3px;
        background: var(--nstrc-comment-button-background, #007bff);
        color: white;
        border: none;
        border-radius: 3px;
        padding: 4px 8px;
        font-size: 11px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .submit-reply-btn:hover:not(:disabled) {
        background: #0056b3;
        transform: translateY(-1px);
      }

      .submit-reply-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .submit-icon {
        font-size: 14px;
      }

      .powered-by {
        text-align: center;
        padding-top: 16px;
        border-top: 1px solid var(--nstrc-comment-border-color, #e1e5e9);
      }

      .powered-by small {
        color: var(--nstrc-comment-meta-color, #6c757d);
        font-size: 12px;
      }

      .powered-by a {
        color: var(--nstrc-comment-button-background, #007bff);
        text-decoration: none;
      }

      .powered-by a:hover {
        text-decoration: underline;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .comment-input-container,
        .comment-content-wrapper,
        .reply-input-container {
          padding: 10px;
          gap: 8px;
        }

        .comment-avatar,
        .user-avatar {
          width: 24px;
          height: 24px;
        }

        .comment-input-footer {
          flex-direction: column;
          gap: 8px;
          align-items: stretch;
        }

        .identity-toggle {
          justify-content: center;
        }

        .submit-comment-btn {
          width: 100%;
          justify-content: center;
        }
      }

      @media (max-width: 480px) {
        .comment-input-container,
        .comment-content-wrapper,
        .reply-input-container {
          padding: 8px;
          gap: 6px;
        }

        .comment-avatar,
        .user-avatar {
          width: 22px;
          height: 22px;
        }

        .comment-text {
          font-size: 12px;
        }

        .comment-author {
          font-size: 11px;
        }

        .comment-time {
          font-size: 10px;
        }

        .comments-title {
          flex-direction: column;
          gap: 4px;
          align-items: flex-start;
        }

        .comment-replies {
          margin-left: 30px; /* 22px avatar + 8px gap */
          padding-left: 10px;
        }
      }
    </style>
  `}const{entries:Nt,setPrototypeOf:vt,isFrozen:mn,getPrototypeOf:dn,getOwnPropertyDescriptor:pn}=Object;let{freeze:C,seal:M$1,create:Ye}=Object,{apply:qe,construct:Ve}=typeof Reflect<"u"&&Reflect;C||(C=function(s){return s});M$1||(M$1=function(s){return s});qe||(qe=function(s,$n){for(var Dn=arguments.length,Un=new Array(Dn>2?Dn-2:0),Bn=2;Bn<Dn;Bn++)Un[Bn-2]=arguments[Bn];return s.apply($n,Un)});Ve||(Ve=function(s){for(var $n=arguments.length,Dn=new Array($n>1?$n-1:0),Un=1;Un<$n;Un++)Dn[Un-1]=arguments[Un];return new s(...Dn)});const Te=I$2(Array.prototype.forEach),un=I$2(Array.prototype.lastIndexOf),Tt=I$2(Array.prototype.pop),le=I$2(Array.prototype.push),fn=I$2(Array.prototype.splice),Ae=I$2(String.prototype.toLowerCase),$e=I$2(String.prototype.toString),He=I$2(String.prototype.match),ce=I$2(String.prototype.replace),hn=I$2(String.prototype.indexOf),gn=I$2(String.prototype.trim),z$2=I$2(Object.prototype.hasOwnProperty),N$1=I$2(RegExp.prototype.test),me=bn(TypeError);function I$2(s){return function($n){$n instanceof RegExp&&($n.lastIndex=0);for(var Dn=arguments.length,Un=new Array(Dn>1?Dn-1:0),Bn=1;Bn<Dn;Bn++)Un[Bn-1]=arguments[Bn];return qe(s,$n,Un)}}function bn(s){return function(){for(var $n=arguments.length,Dn=new Array($n),Un=0;Un<$n;Un++)Dn[Un]=arguments[Un];return Ve(s,Dn)}}function u(s,$n){let Dn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ae;vt&&vt(s,null);let Un=$n.length;for(;Un--;){let Bn=$n[Un];if(typeof Bn=="string"){const In=Dn(Bn);In!==Bn&&(mn($n)||($n[Un]=In),Bn=In)}s[Bn]=!0}return s}function yn(s){for(let $n=0;$n<s.length;$n++)z$2(s,$n)||(s[$n]=null);return s}function H$2(s){const $n=Ye(null);for(const[Dn,Un]of Nt(s))z$2(s,Dn)&&(Array.isArray(Un)?$n[Dn]=yn(Un):Un&&typeof Un=="object"&&Un.constructor===Object?$n[Dn]=H$2(Un):$n[Dn]=Un);return $n}function de(s,$n){for(;s!==null;){const Un=pn(s,$n);if(Un){if(Un.get)return I$2(Un.get);if(typeof Un.value=="function")return I$2(Un.value)}s=dn(s)}function Dn(){return null}return Dn}const Et=C(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ke=C(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),We=C(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),xn=C(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ge=C(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),vn=C(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),At=C(["#text"]),wt=C(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Be=C(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_t=C(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ee=C(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Tn=M$1(/\{\{[\w\W]*|[\w\W]*\}\}/gm),En=M$1(/<%[\w\W]*|[\w\W]*%>/gm),An=M$1(/\$\{[\w\W]*/gm),wn=M$1(/^data-[\-\w.\u00B7-\uFFFF]+$/),_n=M$1(/^aria-[\-\w]+$/),Ct=M$1(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),kn=M$1(/^(?:\w+script|data):/i),Sn=M$1(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),It=M$1(/^html$/i),Rn=M$1(/^[a-z][.\w]*(-[.\w]+)+$/i);var kt=Object.freeze({__proto__:null,ARIA_ATTR:_n,ATTR_WHITESPACE:Sn,CUSTOM_ELEMENT:Rn,DATA_ATTR:wn,DOCTYPE_NAME:It,ERB_EXPR:En,IS_ALLOWED_URI:Ct,IS_SCRIPT_OR_DATA:kn,MUSTACHE_EXPR:Tn,TMPLIT_EXPR:An});const pe={element:1,text:3,progressingInstruction:7,comment:8,document:9},Ln=function(){return typeof window>"u"?null:window},Pn=function(s,$n){if(typeof s!="object"||typeof s.createPolicy!="function")return null;let Dn=null;const Un="data-tt-policy-suffix";$n&&$n.hasAttribute(Un)&&(Dn=$n.getAttribute(Un));const Bn="dompurify"+(Dn?"#"+Dn:"");try{return s.createPolicy(Bn,{createHTML(In){return In},createScriptURL(In){return In}})}catch{return console.warn("TrustedTypes policy "+Bn+" could not be created."),null}},St=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Dt(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ln();const $n=cr=>Dt(cr);if($n.version="3.3.1",$n.removed=[],!s||!s.document||s.document.nodeType!==pe.document||!s.Element)return $n.isSupported=!1,$n;let{document:Dn}=s;const Un=Dn,Bn=Un.currentScript,{DocumentFragment:In,HTMLTemplateElement:qn,Node:Fn,Element:Kn,NodeFilter:jn,NamedNodeMap:Yn=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:Zn,DOMParser:Xn,trustedTypes:Jn}=s,Wn=Kn.prototype,tr=de(Wn,"cloneNode"),ir=de(Wn,"remove"),sr=de(Wn,"nextSibling"),fr=de(Wn,"childNodes"),ur=de(Wn,"parentNode");if(typeof qn=="function"){const cr=Dn.createElement("template");cr.content&&cr.content.ownerDocument&&(Dn=cr.content.ownerDocument)}let br,Nr="";const{implementation:Ar,createNodeIterator:_r,createDocumentFragment:Rr,getElementsByTagName:Dr}=Dn,{importNode:zr}=Un;let dr=St();$n.isSupported=typeof Nt=="function"&&typeof ur=="function"&&Ar&&Ar.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:pr,ERB_EXPR:lr,TMPLIT_EXPR:mr,DATA_ATTR:ar,ARIA_ATTR:er,IS_SCRIPT_OR_DATA:or,ATTR_WHITESPACE:wr,CUSTOM_ELEMENT:vr}=kt;let{IS_ALLOWED_URI:Sr}=kt,rr=null;const gr=u({},[...Et,...Ke,...We,...Ge,...At]);let Tr=null;const Br=u({},[...wt,...Be,..._t,...Ee]);let Ur=Object.seal(Ye(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),qr=null,Hr=null;const Yr=Object.seal(Ye(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Kr=!0,si=!0,zi=!1,Ai=!0,Li=!1,Ii=!0,ji=!1,Ts=!1,Oo=!1,Ms=!1,sa=!1,aa=!1,Ja=!0,Ul=!1;const Gu="user-content-";let qi=!0,La=!1,Us={},es=null;const oa=u({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ol=null;const Bo=u({},["audio","video","img","source","image","track"]);let zo=null;const Bl=u({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Cs="http://www.w3.org/1998/Math/MathML",Ui="http://www.w3.org/2000/svg",Oi="http://www.w3.org/1999/xhtml";let _i=Oi,Io=!1,qo=null;const Yu=u({},[Cs,Ui,Oi],$e);let Os=u({},["mi","mo","mn","ms","mtext"]),Bs=u({},["annotation-xml"]);const Wa=u({},["title","style","font","a","script"]);let ns=null;const to=["application/xhtml+xml","text/html"],Ma="text/html";let xi=null,zs=null;const Ho=Dn.createElement("form"),la=function(cr){return cr instanceof RegExp||cr instanceof Function},Po=function(){let cr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(zs&&zs===cr)){if((!cr||typeof cr!="object")&&(cr={}),cr=H$2(cr),ns=to.indexOf(cr.PARSER_MEDIA_TYPE)===-1?Ma:cr.PARSER_MEDIA_TYPE,xi=ns==="application/xhtml+xml"?$e:Ae,rr=z$2(cr,"ALLOWED_TAGS")?u({},cr.ALLOWED_TAGS,xi):gr,Tr=z$2(cr,"ALLOWED_ATTR")?u({},cr.ALLOWED_ATTR,xi):Br,qo=z$2(cr,"ALLOWED_NAMESPACES")?u({},cr.ALLOWED_NAMESPACES,$e):Yu,zo=z$2(cr,"ADD_URI_SAFE_ATTR")?u(H$2(Bl),cr.ADD_URI_SAFE_ATTR,xi):Bl,Ol=z$2(cr,"ADD_DATA_URI_TAGS")?u(H$2(Bo),cr.ADD_DATA_URI_TAGS,xi):Bo,es=z$2(cr,"FORBID_CONTENTS")?u({},cr.FORBID_CONTENTS,xi):oa,qr=z$2(cr,"FORBID_TAGS")?u({},cr.FORBID_TAGS,xi):H$2({}),Hr=z$2(cr,"FORBID_ATTR")?u({},cr.FORBID_ATTR,xi):H$2({}),Us=z$2(cr,"USE_PROFILES")?cr.USE_PROFILES:!1,Kr=cr.ALLOW_ARIA_ATTR!==!1,si=cr.ALLOW_DATA_ATTR!==!1,zi=cr.ALLOW_UNKNOWN_PROTOCOLS||!1,Ai=cr.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Li=cr.SAFE_FOR_TEMPLATES||!1,Ii=cr.SAFE_FOR_XML!==!1,ji=cr.WHOLE_DOCUMENT||!1,Ms=cr.RETURN_DOM||!1,sa=cr.RETURN_DOM_FRAGMENT||!1,aa=cr.RETURN_TRUSTED_TYPE||!1,Oo=cr.FORCE_BODY||!1,Ja=cr.SANITIZE_DOM!==!1,Ul=cr.SANITIZE_NAMED_PROPS||!1,qi=cr.KEEP_CONTENT!==!1,La=cr.IN_PLACE||!1,Sr=cr.ALLOWED_URI_REGEXP||Ct,_i=cr.NAMESPACE||Oi,Os=cr.MATHML_TEXT_INTEGRATION_POINTS||Os,Bs=cr.HTML_INTEGRATION_POINTS||Bs,Ur=cr.CUSTOM_ELEMENT_HANDLING||{},cr.CUSTOM_ELEMENT_HANDLING&&la(cr.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ur.tagNameCheck=cr.CUSTOM_ELEMENT_HANDLING.tagNameCheck),cr.CUSTOM_ELEMENT_HANDLING&&la(cr.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ur.attributeNameCheck=cr.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),cr.CUSTOM_ELEMENT_HANDLING&&typeof cr.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ur.allowCustomizedBuiltInElements=cr.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Li&&(si=!1),sa&&(Ms=!0),Us&&(rr=u({},At),Tr=[],Us.html===!0&&(u(rr,Et),u(Tr,wt)),Us.svg===!0&&(u(rr,Ke),u(Tr,Be),u(Tr,Ee)),Us.svgFilters===!0&&(u(rr,We),u(Tr,Be),u(Tr,Ee)),Us.mathMl===!0&&(u(rr,Ge),u(Tr,_t),u(Tr,Ee))),cr.ADD_TAGS&&(typeof cr.ADD_TAGS=="function"?Yr.tagCheck=cr.ADD_TAGS:(rr===gr&&(rr=H$2(rr)),u(rr,cr.ADD_TAGS,xi))),cr.ADD_ATTR&&(typeof cr.ADD_ATTR=="function"?Yr.attributeCheck=cr.ADD_ATTR:(Tr===Br&&(Tr=H$2(Tr)),u(Tr,cr.ADD_ATTR,xi))),cr.ADD_URI_SAFE_ATTR&&u(zo,cr.ADD_URI_SAFE_ATTR,xi),cr.FORBID_CONTENTS&&(es===oa&&(es=H$2(es)),u(es,cr.FORBID_CONTENTS,xi)),cr.ADD_FORBID_CONTENTS&&(es===oa&&(es=H$2(es)),u(es,cr.ADD_FORBID_CONTENTS,xi)),qi&&(rr["#text"]=!0),ji&&u(rr,["html","head","body"]),rr.table&&(u(rr,["tbody"]),delete qr.tbody),cr.TRUSTED_TYPES_POLICY){if(typeof cr.TRUSTED_TYPES_POLICY.createHTML!="function")throw me('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof cr.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw me('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');br=cr.TRUSTED_TYPES_POLICY,Nr=br.createHTML("")}else br===void 0&&(br=Pn(Jn,Bn)),br!==null&&typeof Nr=="string"&&(Nr=br.createHTML(""));C&&C(cr),zs=cr}},Fo=u({},[...Ke,...We,...xn]),Ko=u({},[...Ge,...vn]),zl=function(cr){let Pr=ur(cr);(!Pr||!Pr.tagName)&&(Pr={namespaceURI:_i,tagName:"template"});const Ir=Ae(cr.tagName),Wr=Ae(Pr.tagName);return qo[cr.namespaceURI]?cr.namespaceURI===Ui?Pr.namespaceURI===Oi?Ir==="svg":Pr.namespaceURI===Cs?Ir==="svg"&&(Wr==="annotation-xml"||Os[Wr]):!!Fo[Ir]:cr.namespaceURI===Cs?Pr.namespaceURI===Oi?Ir==="math":Pr.namespaceURI===Ui?Ir==="math"&&Bs[Wr]:!!Ko[Ir]:cr.namespaceURI===Oi?Pr.namespaceURI===Ui&&!Bs[Wr]||Pr.namespaceURI===Cs&&!Os[Wr]?!1:!Ko[Ir]&&(Wa[Ir]||!Fo[Ir]):!!(ns==="application/xhtml+xml"&&qo[cr.namespaceURI]):!1},$s=function(cr){le($n.removed,{element:cr});try{ur(cr).removeChild(cr)}catch{ir(cr)}},xs=function(cr,Pr){try{le($n.removed,{attribute:Pr.getAttributeNode(cr),from:Pr})}catch{le($n.removed,{attribute:null,from:Pr})}if(Pr.removeAttribute(cr),cr==="is")if(Ms||sa)try{$s(Pr)}catch{}else try{Pr.setAttribute(cr,"")}catch{}},Vo=function(cr){let Pr=null,Ir=null;if(Oo)cr="<remove></remove>"+cr;else{const oi=He(cr,/^[\r\n\t ]+/);Ir=oi&&oi[0]}ns==="application/xhtml+xml"&&_i===Oi&&(cr='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+cr+"</body></html>");const Wr=br?br.createHTML(cr):cr;if(_i===Oi)try{Pr=new Xn().parseFromString(Wr,ns)}catch{}if(!Pr||!Pr.documentElement){Pr=Ar.createDocument(_i,"template",null);try{Pr.documentElement.innerHTML=Io?Nr:Wr}catch{}}const wi=Pr.body||Pr.documentElement;return cr&&Ir&&wi.insertBefore(Dn.createTextNode(Ir),wi.childNodes[0]||null),_i===Oi?Dr.call(Pr,ji?"html":"body")[0]:ji?Pr.documentElement:wi},jo=function(cr){return _r.call(cr.ownerDocument||cr,cr,jn.SHOW_ELEMENT|jn.SHOW_COMMENT|jn.SHOW_TEXT|jn.SHOW_PROCESSING_INSTRUCTION|jn.SHOW_CDATA_SECTION,null)},us=function(cr){return cr instanceof Zn&&(typeof cr.nodeName!="string"||typeof cr.textContent!="string"||typeof cr.removeChild!="function"||!(cr.attributes instanceof Yn)||typeof cr.removeAttribute!="function"||typeof cr.setAttribute!="function"||typeof cr.namespaceURI!="string"||typeof cr.insertBefore!="function"||typeof cr.hasChildNodes!="function")},Ti=function(cr){return typeof Fn=="function"&&cr instanceof Fn};function yi(cr,Pr,Ir){Te(cr,Wr=>{Wr.call($n,Pr,Ir,zs)})}const Is=function(cr){let Pr=null;if(yi(dr.beforeSanitizeElements,cr,null),us(cr))return $s(cr),!0;const Ir=xi(cr.nodeName);if(yi(dr.uponSanitizeElement,cr,{tagName:Ir,allowedTags:rr}),Ii&&cr.hasChildNodes()&&!Ti(cr.firstElementChild)&&N$1(/<[/\w!]/g,cr.innerHTML)&&N$1(/<[/\w!]/g,cr.textContent)||cr.nodeType===pe.progressingInstruction||Ii&&cr.nodeType===pe.comment&&N$1(/<[/\w]/g,cr.data))return $s(cr),!0;if(!(Yr.tagCheck instanceof Function&&Yr.tagCheck(Ir))&&(!rr[Ir]||qr[Ir])){if(!qr[Ir]&&Il(Ir)&&(Ur.tagNameCheck instanceof RegExp&&N$1(Ur.tagNameCheck,Ir)||Ur.tagNameCheck instanceof Function&&Ur.tagNameCheck(Ir)))return!1;if(qi&&!es[Ir]){const Wr=ur(cr)||cr.parentNode,wi=fr(cr)||cr.childNodes;if(wi&&Wr){const oi=wi.length;for(let ui=oi-1;ui>=0;--ui){const Gi=tr(wi[ui],!0);Gi.__removalCount=(cr.__removalCount||0)+1,Wr.insertBefore(Gi,sr(cr))}}}return $s(cr),!0}return cr instanceof Kn&&!zl(cr)||(Ir==="noscript"||Ir==="noembed"||Ir==="noframes")&&N$1(/<\/no(script|embed|frames)/i,cr.innerHTML)?($s(cr),!0):(Li&&cr.nodeType===pe.text&&(Pr=cr.textContent,Te([pr,lr,mr],Wr=>{Pr=ce(Pr,Wr," ")}),cr.textContent!==Pr&&(le($n.removed,{element:cr.cloneNode()}),cr.textContent=Pr)),yi(dr.afterSanitizeElements,cr,null),!1)},eo=function(cr,Pr,Ir){if(Ja&&(Pr==="id"||Pr==="name")&&(Ir in Dn||Ir in Ho))return!1;if(!(si&&!Hr[Pr]&&N$1(ar,Pr))&&!(Kr&&N$1(er,Pr))&&!(Yr.attributeCheck instanceof Function&&Yr.attributeCheck(Pr,cr))){if(!Tr[Pr]||Hr[Pr]){if(!(Il(cr)&&(Ur.tagNameCheck instanceof RegExp&&N$1(Ur.tagNameCheck,cr)||Ur.tagNameCheck instanceof Function&&Ur.tagNameCheck(cr))&&(Ur.attributeNameCheck instanceof RegExp&&N$1(Ur.attributeNameCheck,Pr)||Ur.attributeNameCheck instanceof Function&&Ur.attributeNameCheck(Pr,cr))||Pr==="is"&&Ur.allowCustomizedBuiltInElements&&(Ur.tagNameCheck instanceof RegExp&&N$1(Ur.tagNameCheck,Ir)||Ur.tagNameCheck instanceof Function&&Ur.tagNameCheck(Ir))))return!1}else if(!zo[Pr]&&!N$1(Sr,ce(Ir,wr,""))&&!((Pr==="src"||Pr==="xlink:href"||Pr==="href")&&cr!=="script"&&hn(Ir,"data:")===0&&Ol[cr])&&!(zi&&!N$1(or,ce(Ir,wr,"")))&&Ir)return!1}return!0},Il=function(cr){return cr!=="annotation-xml"&&He(cr,vr)},ql=function(cr){yi(dr.beforeSanitizeAttributes,cr,null);const{attributes:Pr}=cr;if(!Pr||us(cr))return;const Ir={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Tr,forceKeepAttr:void 0};let Wr=Pr.length;for(;Wr--;){const wi=Pr[Wr],{name:oi,namespaceURI:ui,value:Gi}=wi,Yi=xi(oi),ks=Gi;let bi=oi==="value"?ks:gn(ks);if(Ir.attrName=Yi,Ir.attrValue=bi,Ir.keepAttr=!0,Ir.forceKeepAttr=void 0,yi(dr.uponSanitizeAttribute,cr,Ir),bi=Ir.attrValue,Ul&&(Yi==="id"||Yi==="name")&&(xs(oi,cr),bi=Gu+bi),Ii&&N$1(/((--!?|])>)|<\/(style|title|textarea)/i,bi)){xs(oi,cr);continue}if(Yi==="attributename"&&He(bi,"href")){xs(oi,cr);continue}if(Ir.forceKeepAttr)continue;if(!Ir.keepAttr){xs(oi,cr);continue}if(!Ai&&N$1(/\/>/i,bi)){xs(oi,cr);continue}Li&&Te([pr,lr,mr],Fl=>{bi=ce(bi,Fl," ")});const Pl=xi(cr.nodeName);if(!eo(Pl,Yi,bi)){xs(oi,cr);continue}if(br&&typeof Jn=="object"&&typeof Jn.getAttributeType=="function"&&!ui)switch(Jn.getAttributeType(Pl,Yi)){case"TrustedHTML":{bi=br.createHTML(bi);break}case"TrustedScriptURL":{bi=br.createScriptURL(bi);break}}if(bi!==ks)try{ui?cr.setAttributeNS(ui,oi,bi):cr.setAttribute(oi,bi),us(cr)?$s(cr):Tt($n.removed)}catch{xs(oi,cr)}}yi(dr.afterSanitizeAttributes,cr,null)},Hl=function cr(Pr){let Ir=null;const Wr=jo(Pr);for(yi(dr.beforeSanitizeShadowDOM,Pr,null);Ir=Wr.nextNode();)yi(dr.uponSanitizeShadowNode,Ir,null),Is(Ir),ql(Ir),Ir.content instanceof In&&cr(Ir.content);yi(dr.afterSanitizeShadowDOM,Pr,null)};return $n.sanitize=function(cr){let Pr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ir=null,Wr=null,wi=null,oi=null;if(Io=!cr,Io&&(cr="<!-->"),typeof cr!="string"&&!Ti(cr))if(typeof cr.toString=="function"){if(cr=cr.toString(),typeof cr!="string")throw me("dirty is not a string, aborting")}else throw me("toString is not a function");if(!$n.isSupported)return cr;if(Ts||Po(Pr),$n.removed=[],typeof cr=="string"&&(La=!1),La){if(cr.nodeName){const Yi=xi(cr.nodeName);if(!rr[Yi]||qr[Yi])throw me("root node is forbidden and cannot be sanitized in-place")}}else if(cr instanceof Fn)Ir=Vo("<!---->"),Wr=Ir.ownerDocument.importNode(cr,!0),Wr.nodeType===pe.element&&Wr.nodeName==="BODY"||Wr.nodeName==="HTML"?Ir=Wr:Ir.appendChild(Wr);else{if(!Ms&&!Li&&!ji&&cr.indexOf("<")===-1)return br&&aa?br.createHTML(cr):cr;if(Ir=Vo(cr),!Ir)return Ms?null:aa?Nr:""}Ir&&Oo&&$s(Ir.firstChild);const ui=jo(La?cr:Ir);for(;wi=ui.nextNode();)Is(wi),ql(wi),wi.content instanceof In&&Hl(wi.content);if(La)return cr;if(Ms){if(sa)for(oi=Rr.call(Ir.ownerDocument);Ir.firstChild;)oi.appendChild(Ir.firstChild);else oi=Ir;return(Tr.shadowroot||Tr.shadowrootmode)&&(oi=zr.call(Un,oi,!0)),oi}let Gi=ji?Ir.outerHTML:Ir.innerHTML;return ji&&rr["!doctype"]&&Ir.ownerDocument&&Ir.ownerDocument.doctype&&Ir.ownerDocument.doctype.name&&N$1(It,Ir.ownerDocument.doctype.name)&&(Gi="<!DOCTYPE "+Ir.ownerDocument.doctype.name+`>
`+Gi),Li&&Te([pr,lr,mr],Yi=>{Gi=ce(Gi,Yi," ")}),br&&aa?br.createHTML(Gi):Gi},$n.setConfig=function(){let cr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Po(cr),Ts=!0},$n.clearConfig=function(){zs=null,Ts=!1},$n.isValidAttribute=function(cr,Pr,Ir){zs||Po({});const Wr=xi(cr),wi=xi(Pr);return eo(Wr,wi,Ir)},$n.addHook=function(cr,Pr){typeof Pr=="function"&&le(dr[cr],Pr)},$n.removeHook=function(cr,Pr){if(Pr!==void 0){const Ir=un(dr[cr],Pr);return Ir===-1?void 0:fn(dr[cr],Ir,1)[0]}return Tt(dr[cr])},$n.removeHooks=function(cr){dr[cr]=[]},$n.removeAllHooks=function(){dr=St()},$n}var Nn=Dt();class Cn extends HTMLElement{constructor(){super(),f$1(this,"rendered",!1),f$1(this,"nostrService",NostrService.getInstance()),f$1(this,"shadow"),f$1(this,"theme","light"),f$1(this,"isLoading",!0),f$1(this,"isError",!1),f$1(this,"errorMessage",""),f$1(this,"comments",[]),f$1(this,"baseUrl",""),f$1(this,"userPublicKey",null),f$1(this,"userPrivateKey",null),f$1(this,"currentUserProfile",null),f$1(this,"isSubmitting",!1),f$1(this,"replyingToComment",null),f$1(this,"commentAs","user"),f$1(this,"hasNip07",!1),f$1(this,"anonPrivateKeyHex",null),f$1(this,"eventListeners",[]),f$1(this,"nip07MonitoringInterval",null),f$1(this,"loadVersion",0),f$1(this,"getRelays",()=>{const $n=this.getAttribute("relays");return $n?$n.split(",").map(Dn=>Dn.trim()):DEFAULT_RELAYS}),f$1(this,"getTheme",()=>{this.theme="light";const $n=this.getAttribute("theme");$n&&(["light","dark"].includes($n)?this.theme=$n:console.warn(`Invalid theme '${$n}'. Accepted values are 'light', 'dark'`))}),f$1(this,"getBaseUrl",()=>{const $n=this.getAttribute("url");return t($n||window.location.href)}),f$1(this,"detectNip07Extension",()=>{const $n=window.nostr;return $n?typeof $n.getPublicKey=="function"&&typeof $n.signEvent=="function"?!0:(console.warn("NIP-07 extension detected but missing required methods"),!1):!1}),f$1(this,"handleNip07StateChange",async()=>{const $n=this.hasNip07,Dn=this.detectNip07Extension();if($n!==Dn&&(console.log("NIP-07 extension state changed:",Dn),this.hasNip07=Dn,Dn&&this.commentAs==="user"))try{await this.initializeUser(),this.render()}catch(Un){console.warn("Failed to reconnect to NIP-07 extension:",Un)}}),f$1(this,"setupNip07StateMonitoring",()=>{const $n=setInterval(async()=>{document.contains(this)&&await this.handleNip07StateChange()},2e3);this.nip07MonitoringInterval=$n}),f$1(this,"loadComments",async()=>{this.loadVersion++;const $n=this.loadVersion;try{this.isLoading=!0,this.isError=!1,this.render();const Dn=this.getRelays();await this.nostrService.connectToNostr(Dn);const Un={kinds:[1111],"#I":[this.baseUrl],limit:200},Bn=await this.nostrService.getNDK().fetchEvents(Un),In=Array.from(Bn),qn=new Map;In.forEach(Jn=>qn.set(Jn.id,{content:Jn.content,id:Jn.id,tags:Jn.tags}));const Fn=[],Kn=new Set;for(const Jn of In){let Wn;const tr=(Jn.tags||[]).filter(sr=>sr[0]==="e");for(let sr=tr.length-1;sr>=0;sr--){const fr=tr[sr];if(fr[3]==="reply"){Wn=fr[1];break}}if(!Wn&&tr.length>0){const sr=tr.filter(fr=>fr[3]!=="root");sr.length>0?Wn=sr[sr.length-1][1]:Wn=tr[tr.length-1][1]}const ir={id:Jn.id,pubkey:Jn.pubkey,content:Jn.content,created_at:Jn.created_at,replies:[],replyTo:Wn,depth:0};Kn.add(Jn.pubkey),Fn.push(ir)}const jn=Array.from(Kn).map(async Jn=>{try{console.log("Fetching profile for pubkey:",Jn);const Wn=await this.nostrService.getProfile({pubkey:Jn});return console.log("Profile fetched for",Jn,":",Wn),{pubkey:Jn,profile:Wn}}catch(Wn){return console.warn("Failed to fetch profile for:",Jn,Wn),{pubkey:Jn,profile:null}}}),Yn=await Promise.allSettled(jn),Zn=new Map;if(Yn.forEach(Jn=>{if(Jn.status==="fulfilled"){const{pubkey:Wn,profile:tr}=Jn.value;Zn.set(Wn,tr)}}),Fn.forEach(Jn=>{Jn.userProfile=Zn.get(Jn.pubkey)||void 0,console.log("Attached profile to comment:",Jn.pubkey,"Profile:",Jn.userProfile)}),$n!==this.loadVersion){console.log("Load operation superseded by newer request, aborting");return}this.comments=this.buildCommentTree(Fn);const Xn=new Map;this.comments.forEach(Jn=>{const Wn=[Jn];for(;Wn.length;){const tr=Wn.pop();Xn.set(tr.id,tr),tr.replies.forEach(ir=>Wn.push(ir))}}),Fn.forEach(Jn=>{const Wn=Jn.replyTo?Xn.get(Jn.replyTo):void 0,tr=Wn?Wn.content:"(no parent)";console.log(`[nostr-comment] recv: "${Jn.content}" -> parent: ${tr}`)})}catch(Dn){if($n!==this.loadVersion){console.log("Load operation superseded by newer request, aborting error handling");return}this.isError=!0,this.errorMessage=Dn instanceof Error?Dn.message:"Failed to load comments",console.error("Error loading comments:",Dn)}finally{if($n!==this.loadVersion){console.log("Load operation superseded by newer request, aborting final state update");return}this.isLoading=!1,this.render()}}),f$1(this,"buildCommentTree",$n=>{const Dn=new Map,Un=[];$n.forEach(In=>{Dn.set(In.id,In)}),$n.forEach(In=>{if(In.replyTo&&Dn.has(In.replyTo)){const qn=Dn.get(In.replyTo);qn.replies.push(In),qn.replies.sort((Fn,Kn)=>Fn.created_at-Kn.created_at)}else Un.push(In)});const Bn=(In,qn)=>{for(const Fn of In)Fn.depth=qn,Fn.replies&&Fn.replies.length&&Bn(Fn.replies,qn+1)};return Bn(Un,0),Un.sort((In,qn)=>qn.created_at-In.created_at)}),f$1(this,"initializeUser",async()=>{if(this.hasNip07=this.detectNip07Extension(),console.log("NIP-07 extension detected:",this.hasNip07),this.hasNip07&&this.commentAs==="user")try{this.userPublicKey=await window.nostr.getPublicKey(),console.log("Successfully connected to NIP-07 extension, public key:",this.userPublicKey),this.userPrivateKey=null,this.anonPrivateKeyHex=null}catch($n){console.warn("NIP-07 extension available but failed to get public key:",$n),this.commentAs="anon",this.userPublicKey=null,this.userPrivateKey=null}if(!this.userPublicKey){const $n=await this.ensureAnonKey();this.anonPrivateKeyHex=$n,this.userPrivateKey=$n;const{getPublicKey:Dn}=await y$2(async()=>{const{getPublicKey:Un}=await __vitePreload(()=>import("./pure-DOoUcNQv-Ddk7BNJi.js"),[]);return{getPublicKey:Un}},__vite__mapDeps$1([0,1]));this.userPublicKey=Dn(new Uint8Array($n.match(/.{1,2}/g).map(Un=>parseInt(Un,16)))),console.log("Using anonymous key for user:",this.userPublicKey)}if(this.commentAs==="anon"&&!this.anonPrivateKeyHex){const $n=await this.ensureAnonKey();this.anonPrivateKeyHex=$n,console.log("Ensured anonymous key is available")}if(this.userPublicKey){try{console.log("Fetching profile for user:",this.userPublicKey);const $n=await this.nostrService.getProfile({pubkey:this.userPublicKey});console.log("Profile fetched for current user:",$n),$n?(this.currentUserProfile=$n,console.log("Set currentUserProfile to:",this.currentUserProfile)):(this.currentUserProfile={name:this.commentAs==="anon"?"Anonymous":`User ${this.userPublicKey.slice(0,8)}`,displayName:this.commentAs==="anon"?"Anonymous":`User ${this.userPublicKey.slice(0,8)}`,image:"../../assets/default_dp.png"},console.log("Set fallback currentUserProfile to:",this.currentUserProfile))}catch($n){console.error("Error fetching current user profile:",$n),this.currentUserProfile={name:this.commentAs==="anon"?"Anonymous":`User ${this.userPublicKey.slice(0,8)}`,displayName:this.commentAs==="anon"?"Anonymous":`User ${this.userPublicKey.slice(0,8)}`,image:"../../assets/default_dp.png"},console.log("Set error fallback currentUserProfile to:",this.currentUserProfile)}this.render()}}),f$1(this,"submitComment",async $n=>{if($n.trim()){this.userPublicKey||await this.initializeUser(),this.isSubmitting=!0,this.render();try{const Dn=[];if(Dn.push(["I",this.baseUrl]),this.replyingToComment){const{rootId:Kn}=this.findRootAndParent(this.replyingToComment);Dn.push(["e",Kn||this.replyingToComment,"","root"]),Dn.push(["e",this.replyingToComment,"","reply"]),Dn.push(["k","1111"])}const Un={kind:1111,pubkey:this.userPublicKey,content:$n.trim(),created_at:Math.floor(Date.now()/1e3),tags:Dn};let Bn;if(console.log(`[nostr-comment] Signing attempt - commentAs: ${this.commentAs}, hasNip07: ${!!window.nostr}, anonKey: ${!!this.anonPrivateKeyHex}, userKey: ${!!this.userPrivateKey}`),this.commentAs==="user"&&this.hasNip07&&window.nostr){console.log("[nostr-comment] Using NIP-07 extension to sign");try{Bn=await window.nostr.signEvent(Un),console.log("[nostr-comment] Successfully signed with NIP-07 extension")}catch(Kn){throw console.error("[nostr-comment] Failed to sign with NIP-07 extension:",Kn),new Error("Failed to sign with NIP-07 extension. Please check if your extension is unlocked.")}}else if(this.commentAs==="anon"&&this.anonPrivateKeyHex){console.log("[nostr-comment] Using anonymous private key to sign");const{finalizeEvent:Kn}=await y$2(async()=>{const{finalizeEvent:Yn}=await __vitePreload(()=>import("./pure-DOoUcNQv-Ddk7BNJi.js"),[]);return{finalizeEvent:Yn}},__vite__mapDeps$1([0,1])),jn=new Uint8Array(this.anonPrivateKeyHex.match(/.{1,2}/g).map(Yn=>parseInt(Yn,16)));Bn=Kn(Un,jn)}else if(this.userPrivateKey){console.log("[nostr-comment] Using local private key to sign (fallback)");const{finalizeEvent:Kn}=await y$2(async()=>{const{finalizeEvent:Yn}=await __vitePreload(()=>import("./pure-DOoUcNQv-Ddk7BNJi.js"),[]);return{finalizeEvent:Yn}},__vite__mapDeps$1([0,1])),jn=new Uint8Array(this.userPrivateKey.match(/.{1,2}/g).map(Yn=>parseInt(Yn,16)));Bn=Kn(Un,jn)}else throw console.error("[nostr-comment] No signing method available - commentAs:",this.commentAs,"hasNip07:",this.hasNip07,"anonKey:",!!this.anonPrivateKeyHex,"userKey:",!!this.userPrivateKey),new Error("No signing method available. Please check your NIP-07 extension or switch to anonymous mode.");await new NDKEvent(this.nostrService.getNDK(),Bn).publish();const In={id:Bn.id,pubkey:Bn.pubkey,content:Bn.content,created_at:Bn.created_at,replies:[],replyTo:this.replyingToComment||void 0,depth:0};if(this.currentUserProfile)In.userProfile=this.currentUserProfile;else{try{const Kn=await this.nostrService.getProfile({pubkey:Bn.pubkey});Kn&&(In.userProfile=Kn,this.currentUserProfile=Kn)}catch{console.warn("Could not fetch profile for new comment")}In.userProfile||(In.userProfile={name:this.commentAs==="anon"?"Anonymous":`User ${Bn.pubkey.slice(0,8)}`,displayName:this.commentAs==="anon"?"Anonymous":`User ${Bn.pubkey.slice(0,8)}`,image:"../../assets/default_dp.png"})}this.replyingToComment?this.addReplyToComment(In,this.replyingToComment):this.comments.unshift(In);const qn=Dn.find(Kn=>Kn[0]==="e"&&Kn[3]==="root"),Fn=Dn.find(Kn=>Kn[0]==="e"&&Kn[3]==="reply");if(console.log(`[nostr-comment] send: "${Un.content}" root=${qn?qn[1]:"(none)"} parent=${Fn?Fn[1]:"(none)"} `),this.replyingToComment){const Kn=this.shadow.querySelector(".inline-reply-form"),jn=Kn?.querySelector('[data-role="comment-input"]');jn&&(jn.value="")}else{const Kn=this.shadow.querySelector(".modern-comment-form"),jn=Kn?.querySelector('[data-role="comment-input"]');jn&&(jn.value="")}this.replyingToComment=null}catch(Dn){console.error("Failed to submit comment:",Dn);let Un="Failed to submit comment: "+(Dn instanceof Error?Dn.message:"Unknown error");Dn instanceof Error&&Dn.message.includes("NIP-07")&&(Dn.message.includes("extension is unlocked")?Un="Please unlock your Nostr extension (nos2x/Alby) and try again.":Dn.message.includes("getPublicKey")?Un="Please authorize this website in your Nostr extension.":Un="Nostr extension error. Please check if your extension is working properly."),this.showError(Un)}finally{this.isSubmitting=!1,this.render()}}}),f$1(this,"addReplyToComment",($n,Dn)=>{const Un=Bn=>{for(const In of Bn){if(In.id===Dn)return $n.depth=(In.depth||0)+1,In.replies.push($n),In.replies.sort((qn,Fn)=>qn.created_at-Fn.created_at),!0;if(In.replies.length>0&&Un(In.replies))return!0}return!1};Un(this.comments)}),f$1(this,"startReply",$n=>{this.replyingToComment=null,this.render(),setTimeout(()=>{this.replyingToComment=$n,this.render(),setTimeout(()=>{const Dn=this.shadow.querySelector(".inline-reply-form"),Un=Dn?.querySelector('[data-role="comment-input"]');Un&&Un.focus()},100)},10)}),f$1(this,"cancelReply",()=>{this.replyingToComment=null,this.render()}),this.shadow=this.attachShadow({mode:"open"})}findRootAndParent($n){let Dn,Un;const Bn=(In,qn,Fn)=>{var Kn;for(const jn of In){const Yn=qn??jn.id;if(jn.id===$n)return Dn=Yn,Un=Fn,!0;if((Kn=jn.replies)!=null&&Kn.length&&Bn(jn.replies,Yn,jn.id))return!0}return!1};return Bn(this.comments),{rootId:Dn,parentId:Un}}async connectedCallback(){if(!this.rendered)try{this.getTheme(),this.baseUrl=this.getBaseUrl(),await this.initializeUser(),await this.loadComments(),this.setupNip07StateMonitoring(),this.rendered=!0}catch($n){console.error("Error in connectedCallback:",$n),this.isError=!0,this.errorMessage="Failed to initialize comment component",this.render()}}static get observedAttributes(){return["relays","theme","url","readonly","placeholder"]}async attributeChangedCallback($n,Dn,Un){$n==="relays"&&(this.nostrService.connectToNostr(this.getRelays()),await this.loadComments()),$n==="theme"&&(this.getTheme(),this.render()),$n==="url"&&(this.baseUrl=this.getBaseUrl(),await this.loadComments()),["readonly","placeholder"].includes($n)&&this.render()}disconnectedCallback(){this.removeEventListeners(),this.nip07MonitoringInterval&&(clearInterval(this.nip07MonitoringInterval),this.nip07MonitoringInterval=null)}attachEventListeners(){this.removeEventListeners(),this.shadow.querySelectorAll('[data-role="submit-comment"]').forEach($n=>{const Dn=Un=>{Un.preventDefault();const Bn=Un.target.closest(".modern-comment-form, .inline-reply-form"),In=Bn?.querySelector('[data-role="comment-input"]');In&&this.submitComment(In.value)};$n.addEventListener("click",Dn),this.eventListeners.push({element:$n,type:"click",handler:Dn})}),this.shadow.querySelectorAll('[data-role="comment-input"]').forEach($n=>{const Dn=Un=>{const Bn=Un;Bn.key==="Enter"&&(Bn.ctrlKey||Bn.metaKey)&&(Bn.preventDefault(),this.submitComment($n.value))};$n.addEventListener("keydown",Dn),this.eventListeners.push({element:$n,type:"keydown",handler:Dn})}),this.shadow.querySelectorAll('[data-role="cancel-reply"]').forEach($n=>{const Dn=Un=>{Un.preventDefault(),this.cancelReply()};$n.addEventListener("click",Dn),this.eventListeners.push({element:$n,type:"click",handler:Dn})}),this.shadow.querySelectorAll(".reply-btn").forEach($n=>{const Dn=Un=>{Un.preventDefault();const Bn=Un.currentTarget.getAttribute("data-comment-id");Bn&&this.startReply(Bn)};$n.addEventListener("click",Dn),this.eventListeners.push({element:$n,type:"click",handler:Dn})}),this.shadow.querySelectorAll('[data-role="toggle-as-user"]').forEach($n=>{if(!this.hasNip07)$n.disabled=!0,$n.title="NIP-07 extension not detected";else{const Dn=async Un=>{Un.preventDefault(),this.commentAs!=="user"&&(this.commentAs="user",this.userPrivateKey=null,this.anonPrivateKeyHex=null,await this.initializeUser())};$n.addEventListener("click",Dn),this.eventListeners.push({element:$n,type:"click",handler:Dn})}}),this.shadow.querySelectorAll('[data-role="toggle-as-anon"]').forEach($n=>{$n.disabled=!1;const Dn=async Un=>{Un.preventDefault(),this.commentAs!=="anon"&&(this.commentAs="anon",this.userPublicKey=null,this.userPrivateKey=null,await this.initializeUser())};$n.addEventListener("click",Dn),this.eventListeners.push({element:$n,type:"click",handler:Dn})})}attachAvatarErrorHandlers(){this.shadow.querySelectorAll("img[src]").forEach($n=>{const Dn=Un=>{const Bn=Un.target;if(Bn.src===this.getDefaultAvatarUrl()){console.warn("Avatar fallback also failed, preventing infinite loop");return}Bn.src=this.getDefaultAvatarUrl()};$n.addEventListener("error",Dn),this.eventListeners.push({element:$n,type:"error",handler:Dn})})}removeEventListeners(){this.eventListeners.forEach(({element:$n,type:Dn,handler:Un})=>{$n.removeEventListener(Dn,Un)}),this.eventListeners=[]}showError($n){const Dn=document.createElement("div");Dn.className="nostr-comment-error",Dn.style.cssText=`
            position: fixed;
            top: 20px;
            right: 20px;
            background: #f44336;
            color: white;
            padding: 12px 20px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 10000;
            max-width: 300px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            line-height: 1.4;
        `,Dn.textContent=$n,document.body.appendChild(Dn);const Un=$n.includes("NIP-07")?8e3:5e3;setTimeout(()=>{Dn.parentNode&&Dn.parentNode.removeChild(Dn)},Un)}getDefaultAvatarUrl(){try{return new URL("/assets/default_dp-NQ3TGrtT.png",import.meta.url).toString()}catch($n){return console.warn("Failed to resolve default avatar URL with import.meta.url, using relative path:",$n),"../../assets/default_dp.png"}}async ensureAnonKey(){const $n="nostr-comment-anon-private-key";try{const Bn=localStorage.getItem($n);if(Bn&&Bn.match(/^[a-f0-9]{64}$/))return Bn}catch(Bn){console.warn("Failed to read from localStorage:",Bn)}const{generateSecretKey:Dn}=await y$2(async()=>{const{generateSecretKey:Bn}=await __vitePreload(()=>import("./pure-DOoUcNQv-Ddk7BNJi.js"),[]);return{generateSecretKey:Bn}},__vite__mapDeps$1([0,1])),Un=Array.from(Dn()).map(Bn=>Bn.toString(16).padStart(2,"0")).join("");try{localStorage.setItem($n,Un)}catch(Bn){console.warn("Failed to write to localStorage, using ephemeral key:",Bn)}return Un}render(){this.classList.toggle("dark",this.theme==="dark"),this.classList.toggle("loading",this.isLoading),this.classList.toggle("error-container",this.isError);const $n=this.hasAttribute("readonly"),Dn=this.getAttribute("placeholder")||"Write a comment...",Un=ln(this.isLoading,this.isError,this.errorMessage,this.comments,$n,Dn,this.isSubmitting,this.currentUserProfile,this.replyingToComment,this.commentAs,this.hasNip07),Bn=Nn.sanitize(Un,{ALLOWED_TAGS:["div","span","button","textarea","img","a","h3","h4","p","ul","li","small","strong","em"],ALLOWED_ATTR:["class","data-role","data-comment-id","data-depth","src","alt","href","target","rel","placeholder","rows","disabled"],ALLOW_DATA_ATTR:!1});this.shadow.innerHTML=`
      ${cn(this.theme)}
      <div class="nostr-comment-wrapper">
        ${Bn}
      </div>
    `,this.attachEventListeners(),this.attachAvatarErrorHandlers()}}customElements.get("nostr-comment")||customElements.define("nostr-comment",Cn);async function f(s,$n=5e3){var Dn;if(!/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(s))throw new Error("Invalid NIP-05 format");const[Un,Bn]=s.split("@");if(!Un||!Bn)throw new Error("Invalid NIP-05: missing name or domain");const In=`https://${Bn}/.well-known/nostr.json?name=${encodeURIComponent(Un)}`,qn=new AbortController,Fn=setTimeout(()=>qn.abort(),$n);try{const Kn=await fetch(In,{headers:{accept:"application/json"},signal:qn.signal});if(!Kn.ok)throw new Error("Unable to resolve NIP-05");const jn=(Dn=(await Kn.json()).names)==null?void 0:Dn[Un];if(!jn)throw new Error("NIP-05 not found");return jn}catch(Kn){throw Kn instanceof Error&&Kn.name==="AbortError"?new Error("NIP-05 resolution timed out"):Kn}finally{clearTimeout(Fn)}}var v=Object.defineProperty,x$1=(s,$n,Dn)=>$n in s?v(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,i=(s,$n,Dn)=>x$1(s,typeof $n!="symbol"?$n+"":$n,Dn);function $$1({theme:s,recipientNpub:$n,recipientName:Dn,recipientPicture:Un,message:Bn,isLoading:In,isFinding:qn,isError:Fn,errorMessage:Kn,isSent:jn}){const Yn=In?"Sending...":"Send DM",Zn=24,Xn=$n?"Type your message here...":"Enter recipient npub/nip05 address...";return`
    ${D$1(s)}
    <div class="nostr-dm-container ${Fn?"nostr-dm-error":""}">
      <div class="nostr-dm-header">
        ${$n&&Dn?`
          <div class="nostr-dm-recipient">
            <img 
              src="${Un||"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ccc' d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z'/%3E%3C/svg%3E"}" 
              alt="${Dn}" 
              class="nostr-dm-recipient-avatar"
              onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ccc' d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z'/%3E%3C/svg%3E';"
            />
            <span class="nostr-dm-recipient-name">${Dn}</span>
          </div>
        `:`
          <div class="nostr-dm-recipient-placeholder">
            ${c$3(Zn,Zn)}
            <span>Nostr Direct Message</span>
          </div>
        `}
      </div>

      <div class="nostr-dm-content">
        ${$n?"":`
          <div class="nostr-dm-npub-input-container">
            <input type="text" class="nostr-dm-npub-input" placeholder="Enter recipient's npub/nip05 address..." />
            <button class="nostr-dm-find-btn" ${qn?"disabled":""}>
              ${qn?`${i$2()} <span>Finding...</span>`:`${c$3(Zn,Zn)} <span>Find</span>`}
            </button>
          </div>
        `}
        
        <textarea 
          class="nostr-dm-textarea" 
          placeholder="${Xn}"
          ${$n?"":"disabled"}
        >${Bn}</textarea>
        
        <div class="nostr-dm-actions">
          <button class="nostr-dm-send-btn" ${!$n||In?"disabled":""}>
            ${In?`${i$2()} <span>Sending...</span>`:`${c$3(Zn,Zn)} <span>${Yn}</span>`}
          </button>
        </div>
      </div>

      ${Fn?`<small class="nostr-dm-error-message">${Kn}</small>`:""}
      ${jn?'<small class="nostr-dm-success-message">Message sent successfully!</small>':""}
    </div>
  `}function D$1(s){return`
    <style>
      :host {
        --nstrc-dm-background-dark: #222222;
        --nstrc-dm-background-light: #FFFFFF;
        --nstrc-dm-text-color-dark: #FFFFFF;
        --nstrc-dm-text-color-light: #000000;
        --nstrc-dm-border-dark: 1px solid #444444;
        --nstrc-dm-border-light: 1px solid #DDDDDD;
        --nstrc-dm-input-background-dark: #333333;
        --nstrc-dm-input-background-light: #F9F9F9;
        --nstrc-dm-button-background-dark: #000000;
        --nstrc-dm-button-background-light: #FFFFFF;
        --nstrc-dm-button-hover-dark: #333333;
        --nstrc-dm-button-hover-light: #F0F0F0;
        --nstrc-dm-button-text-dark: #FFFFFF;
        --nstrc-dm-button-text-light: #000000;
        --nstrc-dm-error-color: #FF4D4F;
        --nstrc-dm-success-color: #52C41A;
        --nstrc-dm-border-radius: 8px;
        
        --nstrc-dm-background: var(--nstrc-dm-background-${s});
        --nstrc-dm-text-color: var(--nstrc-dm-text-color-${s});
        --nstrc-dm-border: var(--nstrc-dm-border-${s});
        --nstrc-dm-input-background: var(--nstrc-dm-input-background-${s});
        --nstrc-dm-button-background: var(--nstrc-dm-button-background-${s});
        --nstrc-dm-button-hover: var(--nstrc-dm-button-hover-${s});
        --nstrc-dm-button-text: var(--nstrc-dm-button-text-${s});
      }

      .nostr-dm-container {
        display: flex;
        flex-direction: column;
        font-family: var(--nostrc-font-family-primary);
        max-width: 500px;
        width: 100%;
        box-sizing: border-box;
        border-radius: var(--nstrc-dm-border-radius);
        border: var(--nstrc-dm-border);
        background-color: var(--nstrc-dm-background);
        color: var(--nstrc-dm-text-color);
        overflow: hidden;
      }

      .nostr-dm-header {
        padding: 12px 16px;
        border-bottom: var(--nstrc-dm-border);
        display: flex;
        align-items: center;
      }

      .nostr-dm-recipient, .nostr-dm-recipient-placeholder {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .nostr-dm-recipient-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        object-fit: cover;
      }

      .nostr-dm-recipient-name {
        font-weight: 600;
        font-size: 16px;
      }

      .nostr-dm-content {
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .nostr-dm-npub-input-container {
        display: flex;
        gap: 8px;
      }

      .nostr-dm-npub-input {
        flex: 1;
        padding: 10px;
        box-sizing: border-box;
        max-width: 100%;
        border-radius: 4px;
        border: var(--nstrc-dm-border);
        background-color: var(--nstrc-dm-input-background);
        color: var(--nstrc-dm-text-color);
      }

      .nostr-dm-find-btn {
        padding: 10px 16px;
        border-radius: 4px;
        border: var(--nstrc-dm-border);
        background-color: var(--nstrc-dm-button-background);
        color: var(--nstrc-dm-button-text);
        cursor: pointer;
      }

      .nostr-dm-find-btn:hover {
        background-color: var(--nstrc-dm-button-hover);
      }

      .nostr-dm-textarea {
        width: 100%;
        min-height: 100px;
        box-sizing: border-box;
        padding: 12px;
        border-radius: 4px;
        border: var(--nstrc-dm-border);
        background-color: var(--nstrc-dm-input-background);
        color: var(--nstrc-dm-text-color);
        font-family: var(--nostrc-font-family-primary);
        resize: vertical;
      }

      .nostr-dm-textarea:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .nostr-dm-actions {
        display: flex;
        justify-content: flex-end;
      }

      .nostr-dm-send-btn {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 16px;
        border-radius: 4px;
        border: var(--nstrc-dm-border);
        background-color: var(--nstrc-dm-button-background);
        color: var(--nstrc-dm-button-text);
        cursor: pointer;
      }

      .nostr-dm-send-btn:hover:not(:disabled) {
        background-color: var(--nstrc-dm-button-hover);
      }

      .nostr-dm-send-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .nostr-dm-send-btn svg {
        width: 24px;
        height: 24px;
        fill: currentColor;
      }

      .nostr-dm-error-message {
        color: var(--nstrc-dm-error-color);
        font-size: 14px;
        padding: 0 16px 16px;
      }

      .nostr-dm-success-message {
        color: var(--nstrc-dm-success-color);
        font-size: 14px;
        padding: 0 16px 16px;
      }
    </style>
  `}function l(s,$n,Dn){s.getAttribute("debug")==="true"&&(Dn?console.log(`[NostrDm] ${$n}`,Dn):console.log(`[NostrDm] ${$n}`))}let R$1=class extends HTMLElement{constructor(){super(),i(this,"rendered",!1),i(this,"nostrService",NostrService.getInstance()),i(this,"theme","light"),i(this,"recipientNpub",null),i(this,"recipientNip05",null),i(this,"recipientName",null),i(this,"recipientPicture",null),i(this,"recipientPubkey",null),i(this,"message",""),i(this,"isLoading",!1),i(this,"isFinding",!1),i(this,"isError",!1),i(this,"errorMessage",""),i(this,"isSent",!1),i(this,"boundHandleFind",null),i(this,"boundHandleSend",null),i(this,"boundHandleTextareaChange",null),i(this,"getRelays",()=>{const $n=this.getAttribute("relays");return $n?$n.split(","):DEFAULT_RELAYS}),i(this,"getTheme",async()=>{this.theme="light";const $n=this.getAttribute("theme");if($n){if(!["light","dark"].includes($n))throw new Error(`Invalid theme '${$n}'. Accepted values are 'light', 'dark'`);this.theme=$n}}),i(this,"getRecipient",()=>{const $n=this.getAttribute("nip05");if($n){this.recipientNip05=$n,this.lookupRecipientByNip05();return}const Dn=this.getAttribute("recipient-npub");Dn&&(this.recipientNpub=Dn,this.lookupRecipient())}),this.attachShadow({mode:"open"})}connectedCallback(){this.rendered||(this.rendered=!0,this.getTheme(),this.getRecipient(),this.nostrService.connectToNostr(this.getRelays()),this.render())}static get observedAttributes(){return["relays","recipient-npub","nip05","theme","debug"]}attributeChangedCallback($n,Dn,Un){$n==="relays"&&this.nostrService.connectToNostr(this.getRelays()),$n==="theme"&&this.getTheme(),$n==="nip05"&&Un&&(this.recipientNip05=Un,this.lookupRecipientByNip05()),$n==="recipient-npub"&&Un&&(this.recipientNpub=Un,this.lookupRecipient()),this.render()}async lookupRecipient($n){const Dn=$n||this.recipientNpub;if(Dn){this.isFinding=!0,this.render();try{const Un=this.nostrService.getNDK().getUser({npub:Dn});await Un.fetchProfile(),Un.profile?(this.recipientName=Un.profile.displayName||Un.profile.name||"Unknown",this.recipientPicture=Un.profile.image||null,this.recipientPubkey=Un.pubkey,this.recipientNpub=Dn):(this.recipientName="Unknown",this.recipientPicture=null,this.recipientPubkey=Un.pubkey,this.recipientNpub=Dn)}catch(Un){this.isError=!0,this.errorMessage=`Failed to find recipient: ${Un.message}`}finally{this.isFinding=!1,this.render()}}}async lookupRecipientByNip05($n){const Dn=$n||this.recipientNip05;if(Dn){this.isFinding=!0,this.render();try{const Un=await f(Dn);if(!Un)throw new Error("Failed to resolve nip05");const Bn=nip19_exports$1.npubEncode(Un);await this.lookupRecipient(Bn)}catch(Un){this.isError=!0,this.errorMessage=`Failed to resolve nip05: ${Un.message}`}finally{this.isFinding=!1,this.render()}}}async handleFindClick(){const $n=this.shadowRoot.querySelector(".nostr-dm-npub-input");if(!$n||!$n.value){this.isError=!0,this.errorMessage="Please enter a valid npub",this.render();return}const Dn=$n.value.trim();Dn.includes("@")?await this.lookupRecipientByNip05(Dn):await this.lookupRecipient(Dn)}async handleSendClick(){if(l(this,"Send button clicked!"),!this.recipientPubkey||!this.message.trim()){this.isError=!0,this.errorMessage=this.recipientPubkey?"Please enter a message":"Recipient not found",this.render();return}if(this.isError=!1,this.isSent=!1,this.isLoading=!0,this.render(),!this.nostrService.hasSigner()){this.isError=!0,this.errorMessage="No Nostr signer available. Please ensure your Nostr extension is installed or provide a private key.",this.isLoading=!1,this.render();return}let $n=null;if(typeof window<"u"&&window.nostr)$n=new NDKNip07Signer;else if(typeof localStorage<"u"){const Dn=localStorage.getItem("nostr_nsec");if(Dn){const{NDKPrivateKeySigner:Un}=await y$2(async()=>{const{NDKPrivateKeySigner:Bn}=await __vitePreload(()=>Promise.resolve().then(()=>nostrServiceCA0Qx4nJ),void 0).then(In=>In.k);return{NDKPrivateKeySigner:Bn}},[]);$n=new Un(Dn)}}if(!$n){this.isError=!0,this.errorMessage="Failed to create signer. Please ensure your Nostr signer (extension or private key) is configured.",this.render();return}this.render();try{const Dn=this.nostrService.getNDK();Dn.signer=$n;const{nip04:Un}=await y$2(async()=>{const{nip04:qn}=await __vitePreload(()=>Promise.resolve().then(()=>nostrServiceCA0Qx4nJ),void 0).then(Fn=>Fn.j);return{nip04:qn}},[]),Bn=new NDKEvent(Dn,{kind:NDKKind.EncryptedDirectMessage,tags:[["p",this.recipientPubkey]],created_at:Math.floor(Date.now()/1e3)});if(typeof window<"u"&&window.nostr){const qn=await window.nostr.nip04.encrypt(this.recipientPubkey,this.message.trim());Bn.content=qn}else if(typeof localStorage<"u"){const qn=localStorage.getItem("nostr_nsec");if(!qn)throw new Error("No private key available");const{nip19:Fn}=await y$2(async()=>{const{nip19:jn}=await __vitePreload(()=>Promise.resolve().then(()=>nostrServiceCA0Qx4nJ),void 0).then(Yn=>Yn.j);return{nip19:jn}},[]);let Kn=qn;if(qn.startsWith("nsec"))try{Kn=Fn.decode(qn).data}catch(jn){throw console.error("Failed to decode nsec:",jn),new Error("Invalid private key format")}try{Bn.content=await Un.encrypt(Kn,this.recipientPubkey,this.message.trim())}catch(jn){throw console.error("Encryption error:",jn),new Error(`Encryption failed: ${jn.message}`)}}l(this,"Sending encrypted DM:",{to:this.recipientPubkey,encryptedContent:Bn.content}),await Bn.publish(),l(this,"DM sent with encrypted content:",Bn),this.isSent=!0,this.message="";const In=this.shadowRoot.querySelector(".nostr-dm-textarea");In&&(In.value="")}catch(Dn){this.isError=!0,this.errorMessage=`Failed to send message: ${Dn.message}`,this.isSent=!1}finally{this.isLoading=!1,this.isFinding=!1,this.render()}}handleTextareaChange($n){const Dn=$n.target;this.message=Dn.value}attachEventListeners(){const $n=this.shadowRoot.querySelector(".nostr-dm-find-btn");$n?(this.boundHandleFind&&$n.removeEventListener("click",this.boundHandleFind),this.boundHandleFind=this.handleFindClick.bind(this),$n.addEventListener("click",this.boundHandleFind),l(this,"Find button event listener attached")):l(this,"Find button not found in DOM");const Dn=this.shadowRoot.querySelector(".nostr-dm-send-btn");Dn?(l(this,"Send button found, disabled:",Dn.hasAttribute("disabled")),this.boundHandleSend&&Dn.removeEventListener("click",this.boundHandleSend),this.boundHandleSend=this.handleSendClick.bind(this),Dn.addEventListener("click",this.boundHandleSend),this.recipientPubkey&&!this.isLoading&&Dn.removeAttribute("disabled"),l(this,"Send button event listener attached")):l(this,"Send button not found in DOM");const Un=this.shadowRoot.querySelector(".nostr-dm-textarea");Un&&(this.boundHandleTextareaChange&&Un.removeEventListener("input",this.boundHandleTextareaChange),this.boundHandleTextareaChange=this.handleTextareaChange.bind(this),Un.addEventListener("input",this.boundHandleTextareaChange));const Bn=this.shadowRoot.querySelector(".nostr-dm-npub-input");Bn&&Bn.addEventListener("keydown",In=>{In.key==="Enter"&&this.handleFindClick()})}disconnectedCallback(){var $n,Dn,Un;const Bn=($n=this.shadowRoot)==null?void 0:$n.querySelector(".nostr-dm-find-btn");Bn&&this.boundHandleFind&&Bn.removeEventListener("click",this.boundHandleFind);const In=(Dn=this.shadowRoot)==null?void 0:Dn.querySelector(".nostr-dm-send-btn");In&&this.boundHandleSend&&In.removeEventListener("click",this.boundHandleSend);const qn=(Un=this.shadowRoot)==null?void 0:Un.querySelector(".nostr-dm-textarea");qn&&this.boundHandleTextareaChange&&qn.removeEventListener("input",this.boundHandleTextareaChange)}render(){l(this,"Rendering with state:",{recipientNpub:this.recipientNpub,recipientPubkey:this.recipientPubkey,message:this.message?"[message content]":"[empty]",isLoading:this.isLoading,isFinding:this.isFinding,isError:this.isError,isSent:this.isSent});const $n={theme:this.theme,recipientNpub:this.recipientNpub,recipientName:this.recipientName,recipientPicture:this.recipientPicture,message:this.message,isLoading:this.isLoading,isFinding:this.isFinding,isError:this.isError,errorMessage:this.errorMessage,isSent:this.isSent};this.shadowRoot.innerHTML=$$1($n),this.attachEventListeners()}};customElements.get("nostr-dm")||customElements.define("nostr-dm",R$1);var P$1=Object.defineProperty,H$1=(s,$n,Dn)=>$n in s?P$1(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,a=(s,$n,Dn)=>H$1(s,typeof $n!="symbol"?$n+"":$n,Dn);function K(s){try{return new Date(s*1e3).toLocaleString()}catch{return""}}function _$1(s){try{const $n=Date.now(),Dn=s*1e3,Un=$n-Dn,Bn=Math.floor(Un/1e3);if(Bn<60)return"just now";if(Bn<3600){const qn=Math.floor(Bn/60);return`${qn} ${qn===1?"min":"mins"} ago`}if(Bn<86400){const qn=Math.floor(Bn/3600);return`${qn} ${qn===1?"hour":"hours"} ago`}if(Bn<2592e3){const qn=Math.floor(Bn/86400);return`${qn} ${qn===1?"day":"days"} ago`}if(Bn<31536e3){const qn=Math.floor(Bn/2592e3);return`${qn} ${qn===1?"month":"months"} ago`}const In=Math.floor(Bn/31536e3);return`${In} ${In===1?"year":"years"} ago`}catch{return""}}function I$1(s){return s==="me"||s==="them"?s:"them"}function y$1(s){return s==null?"":String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function O$1({theme:s,recipientNpub:$n,recipientName:Dn,recipientPicture:Un,message:Bn,messages:In,isLoading:qn,isFinding:Fn,isError:Kn,errorMessage:jn,currentUserName:Yn,currentUserPicture:Zn,showWelcome:Xn,welcomeText:Jn,startChatText:Wn,maxMessageLength:tr}){const ir=typeof tr=="number"?tr:1e3,sr=(Bn||"").length,fr=Math.max(0,ir-sr),ur=fr<=10?"nostr-chat-char-counter warn":"nostr-chat-char-counter";return`
    <div class="nostr-chat-container ${Kn?"nostr-chat-error":""}">
      <div class="nostr-chat-header">
        <div class="nostr-chat-header-left">
          ${$n&&Dn?`
            <div class="nostr-chat-recipient">
              <div class="nostr-chat-recipient-info">
                <img 
                  src="${y$1(Un)||""}" 
                  alt="${y$1(Dn)||""}" 
                  class="nostr-chat-recipient-avatar"
                  onerror="this.onerror=null; this.src='https://via.placeholder.com/40';"
                >
                <span class="nostr-chat-recipient-name">${y$1(Dn)||y$1($n)}</span>
              </div>
            </div>
          `:`
            <div class="nostr-chat-recipient-placeholder">
              ${c$3(24,24)}
              <span>Nostr Live Chat</span>
            </div>
          `}
        </div>
        <div class="nostr-chat-header-right">
          ${Yn?`
          <div class="nostr-chat-self">
            <img 
              src="${y$1(Zn)||""}"
              alt="${y$1(Yn)||"You"}"
              class="nostr-chat-self-avatar"
              onerror="this.onerror=null; this.src='https://via.placeholder.com/32';"
            >
            <span class="nostr-chat-self-name">${y$1(Yn)}</span>
          </div>
        `:""}
          <button class="nostr-chat-close-btn" title="Minimize"></button>
        </div>
      </div>

      <div class="nostr-chat-content">
        ${$n?Xn?`
          <div class="nostr-chat-welcome">
            <div class="nostr-chat-welcome-text">${y$1(Jn)||"Welcome!"}</div>
            <button class="nostr-chat-start-btn">${y$1(Wn)||"Start chat"}</button>
          </div>
        `:`
          <div class="nostr-chat-history">
            ${In.map(br=>`
              <div class="nostr-chat-message-row nostr-chat-message-${I$1(br.sender)} ${br.sender==="me"&&br.status==="sending"?"sending":""} ${br.sender==="me"&&br.status==="failed"?"failed":""}">
                <div class="nostr-chat-message-bubble">${y$1(br.text)}</div>
                <div class="nostr-chat-message-meta">
                  <span class="nostr-chat-message-timestamp" title="${y$1(K(br.timestamp))}">${y$1(_$1(br.timestamp))}</span>
                </div>
              </div>
            `).join("")}
          </div>
          <div class="nostr-chat-actions">
            <textarea 
              class="nostr-chat-textarea" 
              placeholder="Type your message..."
              maxlength="${ir}"
            >${y$1(Bn)}</textarea>
            <div class="${ur}" aria-live="polite">${fr} chars left</div>
            <button class="nostr-chat-send-btn" ${qn?"disabled":""}>
              ${qn?i$2():"Send"}
            </button>
          </div>
        `:`
          <div class="nostr-chat-npub-input-container">
            <input type="text" class="nostr-chat-npub-input" placeholder="Enter recipient's npub/nip05 address..." />
            <button class="nostr-chat-find-btn" ${Fn?"disabled":""}>
              ${Fn?`${i$2()} <span>Finding...</span>`:"<span>Find</span>"}
            </button>
          </div>
        `}
      </div>

      ${Kn?`<small class="nostr-chat-error-message">${y$1(jn)}</small>`:""}
    </div>
  `}function z$1(s){return`
    <style>
      :host {
        --nstrc-chat-background-dark: #222222;
        --nstrc-chat-background-light: #FFFFFF;
        --nstrc-chat-text-color-dark: #FFFFFF;
        --nstrc-chat-text-color-light: #000000;
        --nstrc-chat-border-dark: 1px solid #444444;
        --nstrc-chat-border-light: 1px solid #DDDDDD;
        --nstrc-chat-input-background-dark: #333333;
        --nstrc-chat-input-background-light: #F9F9F9;
        --nstrc-chat-my-message-background-dark: #5A3E85;
        --nstrc-chat-my-message-background-light: #E6DDF4;
        /* Unified accent variables with light/dark variants */
        --nstrc-chat-accent-color-dark: #5A3E85;
        --nstrc-chat-accent-color-light: #7E4FD2;
        --nstrc-chat-accent-text-color-dark: #FFFFFF;
        --nstrc-chat-accent-text-color-light: #FFFFFF;
        --nstrc-chat-their-message-background-dark: #3A3A3A;
        --nstrc-chat-their-message-background-light: #F0F0F0;
        --nstrc-chat-button-background-dark: #5A3E85;
        --nstrc-chat-button-background-light: #7E4FD2;
        --nstrc-chat-button-text-dark: #FFFFFF;
        --nstrc-chat-button-text-light: #FFFFFF;
        --nstrc-chat-error-color: #FF4D4F;
        --nstrc-chat-border-radius: 12px;
        
        --nstrc-chat-background: var(--nstrc-chat-background-${s});
        --nstrc-chat-text-color: var(--nstrc-chat-text-color-${s});
        --nstrc-chat-border: var(--nstrc-chat-border-${s});
        --nstrc-chat-input-background: var(--nstrc-chat-input-background-${s});
        --nstrc-chat-my-message-background: var(--nstrc-chat-my-message-background-${s});
        --nstrc-chat-their-message-background: var(--nstrc-chat-their-message-background-${s});
        --nstrc-chat-button-background: var(--nstrc-chat-button-background-${s});
        --nstrc-chat-button-text: var(--nstrc-chat-button-text-${s});
        --nstrc-chat-accent-color: var(--nstrc-chat-accent-color-${s});
        --nstrc-chat-accent-text-color: var(--nstrc-chat-accent-text-color-${s});
      }

      /* Floating modes shrink the host so it doesn't affect page layout */
      :host([display-type="fab"]),
      :host([display-type="bottom-bar"]),
      :host([display-type="full"]) {
        width: 0;
        height: 0;
      }

      /* Floating panel wrapper */
      .nostr-chat-float-panel {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 2147483000;
        box-shadow: 0 8px 24px rgba(0,0,0,0.18);
        border-radius: var(--nstrc-chat-border-radius);
        display: none;
      }
      .nostr-chat-float-panel.open { display: block; }

      /* Close (minimize) button for floating panel */
      .nostr-chat-close-btn {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 16px;
        cursor: pointer;
        background: rgba(0,0,0,0.1);
        color: var(--nstrc-chat-text-color);
        border: none;
        transition: background-color 0.2s ease;
      }
      .nostr-chat-close-btn:hover {
        background: rgba(0,0,0,0.2);
      }
      
      /* Hide close button in embed mode */
      :host([display-type="embed"]) .nostr-chat-close-btn {
        display: none;
      }

      /* Launcher: FAB */
      .nostr-chat-launcher.fab {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 2147483000;
        display: flex;
        align-items: center;
        gap: 10px;
        font-family: Inter, sans-serif;
      }
      .nostr-chat-launcher .bubble {
        background: var(--nstrc-chat-background);
        color: var(--nstrc-chat-text-color);
        border: var(--nstrc-chat-border);
        border-radius: 14px;
        padding: 10px 12px;
        box-shadow: 0 6px 20px rgba(0,0,0,0.12);
      }
      .nostr-chat-launcher .bubble .title { font-weight: 700; font-size: 14px; }
      .nostr-chat-launcher .bubble .subtitle { font-size: 12px; opacity: 0.8; }
      .nostr-chat-launcher .fab-btn {
        width: 64px;
        height: 64px;
        border-radius: 50%;
        background: var(--nstrc-chat-accent-color);
        color: var(--nstrc-chat-accent-text-color);
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        cursor: pointer;
        box-shadow: 0 6px 20px rgba(0,0,0,0.18);
        font-size: 24px; /* Larger emoji/icon */
      }

      /* Launcher: Bottom bar */
      .nostr-chat-launcher.bottom-bar {
        position: fixed;
        left: 50%;
        transform: translateX(-50%);
        bottom: 20px;
        z-index: 2147483000;
      }
      .nostr-chat-launcher .bar-btn {
        padding: 12px 20px;
        border-radius: 999px;
        background: var(--nstrc-chat-accent-color);
        color: var(--nstrc-chat-accent-text-color);
        border: none;
        cursor: pointer;
        font-weight: 700;
        box-shadow: 0 6px 20px rgba(0,0,0,0.18);
      }

      .nostr-chat-container {
        display: flex;
        flex-direction: column;
        font-family: Inter, sans-serif;
        width: 100%;
        height: 100%;
        max-width: 400px;
        max-height: 600px;
        box-sizing: border-box;
        border-radius: var(--nstrc-chat-border-radius);
        border: var(--nstrc-chat-border);
        background-color: var(--nstrc-chat-background);
        color: var(--nstrc-chat-text-color);
        overflow: hidden;
      }

      .nostr-chat-header {
        padding: 12px 16px;
        border-bottom: var(--nstrc-chat-border);
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-shrink: 0;
      }
      
      .nostr-chat-header-right {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .nostr-chat-recipient, .nostr-chat-recipient-placeholder {
        display: flex;
        align-items: center; /* Ensures vertical centering */
        gap: 12px;
      }

      .nostr-chat-recipient-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        object-fit: cover;
      }

      .nostr-chat-recipient-info {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .nostr-chat-recipient-name {
        font-weight: 600;
        font-size: 16px;
        display: flex;
        align-items: center;
        height: 36px; /* Match avatar height */
      }

      .nostr-chat-self {
        display: flex;
        align-items: center;
        gap: 8px;
        opacity: 0.85;
        font-size: 12px;
      }
      .nostr-chat-self-avatar {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        object-fit: cover;
      }

      .nostr-chat-content {
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
        flex-grow: 1;
        overflow-y: auto;
      }
      
      /* Scrollbar styling for dark theme */
      .nostr-chat-content::-webkit-scrollbar,
      .nostr-chat-history::-webkit-scrollbar {
        width: 8px;
      }
      .nostr-chat-content::-webkit-scrollbar-track,
      .nostr-chat-history::-webkit-scrollbar-track {
        background: transparent;
      }
      .nostr-chat-content::-webkit-scrollbar-thumb,
      .nostr-chat-history::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 4px;
      }
      .nostr-chat-content::-webkit-scrollbar-thumb:hover,
      .nostr-chat-history::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.3);
      }
      
      .nostr-chat-history {
        display: flex;
        flex-direction: column;
        gap: 10px;
        flex-grow: 1;
        overflow-y: auto;
        padding-right: 10px; /* For scrollbar */
        padding-bottom: 16px;
      }

      .nostr-chat-message-row {
        display: flex;
        width: 100%;
        flex-direction: column;
        align-items: flex-start;
      }

      .nostr-chat-message-me {
        justify-content: flex-end;
        align-items: flex-end;
      }

      .nostr-chat-message-them {
        justify-content: flex-start;
        align-items: flex-start;
      }

      .nostr-chat-message-bubble {
        padding: 8px 12px;
        border-radius: 18px;
        max-width: 75%;
        word-wrap: break-word;
      }

      .nostr-chat-message-me .nostr-chat-message-bubble {
        background-color: var(--nstrc-chat-accent-color);
        color: var(--nstrc-chat-accent-text-color);
        border-radius: 15px 15px 0 15px;
        opacity: 1;
      }

      .nostr-chat-message-me.sending .nostr-chat-message-bubble {
        opacity: 0.5;
      }

      .nostr-chat-message-me.failed .nostr-chat-message-bubble {
        opacity: 1;
        border: 1px dashed var(--nstrc-chat-error-color);
      }

      .nostr-chat-message-them .nostr-chat-message-bubble {
        background-color: var(--nstrc-chat-their-message-background);
        border-bottom-left-radius: 4px;
      }

      /* Message timestamp under bubble, always visible but with opacity change on hover */
      .nostr-chat-message-meta {
        font-size: 10px;
        margin-top: 4px;
        opacity: 0.5;
        color: var(--nstrc-chat-text-color);
        max-width: 75%;
        transition: opacity 0.2s ease;
        height: 14px; /* Fixed height to prevent layout jumps */
      }
      .nostr-chat-message-row:hover .nostr-chat-message-meta {
        opacity: 0.9;
      }
      .nostr-chat-message-me .nostr-chat-message-meta {
        text-align: right;
      }
      .nostr-chat-message-them .nostr-chat-message-meta {
        text-align: left;
      }

      /* Slightly highlight timestamp for the last message */
      .nostr-chat-history > .nostr-chat-message-row:last-of-type .nostr-chat-message-meta {
        opacity: 0.75;
      }

      .nostr-chat-npub-input-container {
        display: flex;
        gap: 8px;
        align-items: center;
        padding: 20px 0;
      }

      .nostr-chat-npub-input {
        flex: 1;
        padding: 10px;
        box-sizing: border-box;
        border-radius: 4px;
        border: var(--nstrc-chat-border);
        background-color: var(--nstrc-chat-input-background);
        color: var(--nstrc-chat-text-color);
      }

      .nostr-chat-actions {
        display: flex;
        gap: 8px;
        flex-shrink: 0;
        border-top: var(--nstrc-chat-border);
        padding-top: 12px;
      }

      .nostr-chat-welcome {
        display: flex;
        flex-direction: column;
        gap: 12px;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 12px 8px;
      }
      .nostr-chat-welcome-text {
        opacity: 0.9;
      }
      .nostr-chat-start-btn {
        padding: 10px 16px;
        border-radius: 20px;
        border: none;
        background-color: var(--nstrc-chat-button-background);
        color: var(--nstrc-chat-button-text);
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
      }

      .nostr-chat-textarea {
        flex-grow: 1;
        height: 40px;
        box-sizing: border-box;
        padding: 10px;
        border-radius: 20px;
        border: var(--nstrc-chat-border);
        background-color: var(--nstrc-chat-input-background);
        color: var(--nstrc-chat-text-color);
        font-family: Inter, sans-serif;
        resize: none;
        overflow-y: auto;
      }

      /* Character counter */
      .nostr-chat-char-counter {
        align-self: center;
        font-size: 12px;
        opacity: 0.75;
        color: var(--nstrc-chat-text-color);
        white-space: nowrap;
        min-width: max-content;
      }
      .nostr-chat-char-counter.warn {
        color: #ff8c00; /* Brighter orange color for warning */
        opacity: 1;
        font-weight: 700;
      }

      .nostr-chat-find-btn, .nostr-chat-send-btn {
        padding: 10px 16px;
        border-radius: 20px;
        border: none;
        background-color: var(--nstrc-chat-button-background);
        color: var(--nstrc-chat-button-text);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
      }

      .nostr-chat-error-message {
        color: var(--nstrc-chat-error-color);
        font-size: 14px;
        padding: 0 16px 16px;
        text-align: center;
      }
    </style>
  `}const x=class ia extends HTMLElement{constructor(){super(),a(this,"rendered",!1),a(this,"nostrService",NostrService.getInstance()),a(this,"dmSubscription",null),a(this,"theme","light"),a(this,"recipientNpub",null),a(this,"recipientNip05",null),a(this,"recipientName",null),a(this,"recipientPicture",null),a(this,"recipientPubkey",null),a(this,"message",""),a(this,"messages",[]),a(this,"currentUserPubkey",null),a(this,"currentUserNpub",null),a(this,"currentUserName",null),a(this,"currentUserPicture",null),a(this,"displayType","embed"),a(this,"isOpen",!1),a(this,"showWelcome",!1),a(this,"welcomeText",ia.DEFAULT_WELCOME_TEXT),a(this,"startChatText",ia.DEFAULT_START_CHAT_TEXT),a(this,"onlineText",ia.DEFAULT_ONLINE_TEXT),a(this,"helpText",ia.DEFAULT_HELP_TEXT),a(this,"MESSAGE_MAX_LENGTH",1e3),a(this,"isLoading",!1),a(this,"isFinding",!1),a(this,"isError",!1),a(this,"errorMessage",""),a(this,"keySupplier",null),a(this,"boundHandleFind",null),a(this,"boundHandleSend",null),a(this,"boundHandleTextareaChange",null),a(this,"boundHandleLauncherClick",null),a(this,"boundHandleCloseClick",null),a(this,"boundHandleStartChat",null),a(this,"boundHandleNpubKeydown",null),a(this,"resubscribeTimer",null),a(this,"getRelays",()=>{const $n=this.getAttribute("relays");return $n?$n.split(",").map(Dn=>Dn.trim()).filter(Dn=>Dn.length>0).filter((Dn,Un,Bn)=>Bn.indexOf(Dn)===Un):DEFAULT_RELAYS}),a(this,"getTheme",()=>{const $n=this.getAttribute("theme"),Dn=($n||"").toLowerCase();Dn==="light"||Dn==="dark"?this.theme=Dn:($n&&console.warn(`Invalid theme '${$n}'. Accepted values are 'light', 'dark'. Falling back to 'light'.`),this.theme="light")}),a(this,"getRecipient",()=>{const $n=this.getAttribute("pubkey");if($n)try{this.recipientPubkey=$n,this.recipientNpub=nip19_exports$1.npubEncode($n),this.lookupRecipient(this.recipientNpub);return}catch(Bn){const In=`Invalid recipient pubkey "${$n}": ${Bn instanceof Error?Bn.message:String(Bn)}`;this.isError=!0,this.errorMessage=In,console.error("nostr-live-chat:",In,Bn),this.render();return}const Dn=this.getAttribute("nip05");if(Dn){this.recipientNip05=Dn,this.lookupRecipientByNip05();return}const Un=this.getAttribute("npub");Un&&(this.recipientNpub=Un,this.lookupRecipient())}),this.attachShadow({mode:"open"})}async getCurrentUserInfo(){var $n,Dn,Un,Bn,In,qn,Fn,Kn,jn,Yn;try{const Zn=this.nostrService.getNDK();let Xn=null;if(typeof window<"u"&&window.nostr){const Jn=window.nostr;console.log("Nostr extension found, checking for public key...");try{const Wn=!!(Jn.enable&&typeof Jn.enable=="function"&&Jn.getPublicKey&&typeof Jn.getPublicKey=="function");if(console.log("Is this nos2x extension?",Wn),Wn){console.log("Using nos2x specific flow");try{await Jn.enable(),console.log("nos2x extension enabled"),await new Promise(ir=>setTimeout(ir,100));const tr=await Jn.getPublicKey();console.log("nos2x returned pubkey:",tr),tr&&typeof tr=="string"&&tr.length===64&&(Xn=tr,console.log("Successfully got pubkey from nos2x:",Xn))}catch(tr){console.error("Error with nos2x extension:",tr)}}else{if(typeof Jn.enable=="function"){console.log("Attempting to enable generic extension...");try{await Jn.enable(),console.log("Extension enabled successfully")}catch(tr){console.warn("Extension enable failed, continuing anyway:",tr)}}if(typeof Jn.getPublicKey=="function"){console.log("Calling getPublicKey()...");try{Xn=await Jn.getPublicKey(),console.log("Got pubkey from extension:",Xn)}catch(tr){console.error("Error getting public key:",tr)}}else if(Jn.getPublicKey){console.log("Found getPublicKey property, resolving...");try{Xn=await Promise.resolve(Jn.getPublicKey),console.log("Got pubkey from extension (property):",Xn)}catch(tr){console.error("Error resolving public key:",tr)}}}}catch(Wn){console.error("Error in extension interaction:",Wn)}}if(!Xn){let Jn=null;if(this.keySupplier)try{Jn=await this.keySupplier()}catch{}if(Jn)try{const{NDKPrivateKeySigner:Wn}=await y$2(async()=>{const{NDKPrivateKeySigner:ir}=await __vitePreload(()=>Promise.resolve().then(()=>nostrServiceCA0Qx4nJ),void 0).then(sr=>sr.k);return{NDKPrivateKeySigner:ir}},[]);let tr=Jn;Jn.startsWith("nsec")&&(tr=nip19_exports$1.decode(Jn).data),Xn=(await new Wn(tr).user()).pubkey}catch{}}if(Xn){this.currentUserPubkey=Xn,this.currentUserNpub=nip19_exports$1.npubEncode(Xn),console.log("Got pubkey from extension and will use it:",Xn);try{const Jn=Zn.getUser({pubkey:Xn});console.log("Fetching profile for user:",Xn),await Jn.fetchProfile(),console.log("Fetched profile:",Jn.profile),this.currentUserName=(($n=Jn.profile)==null?void 0:$n.displayName)||((Dn=Jn.profile)==null?void 0:Dn.name)||((Un=this.currentUserNpub)==null?void 0:Un.substring(0,10))||null,this.currentUserPicture=((Bn=Jn.profile)==null?void 0:Bn.image)||null,this.currentUserName||console.warn("No username found in profile"),this.currentUserPicture||console.warn("No profile picture found"),console.log("Profile info set:",{name:this.currentUserName,picture:this.currentUserPicture,npub:this.currentUserNpub})}catch(Jn){console.error("Error fetching profile:",Jn),this.currentUserName=((In=this.currentUserNpub)==null?void 0:In.substring(0,10))||null}this.render()}else{console.log("Checking for direct nos2x logs in console...");try{if(await new Promise(Jn=>setTimeout(Jn,500)),typeof window<"u"&&window.nostr){console.log("Trying direct call to extension again...");try{const Jn=await window.nostr.getPublicKey();if(Jn&&typeof Jn=="string"){console.log("Got pubkey on second try:",Jn),this.currentUserPubkey=Jn,this.currentUserNpub=nip19_exports$1.npubEncode(Jn);try{const Wn=Zn.getUser({pubkey:Jn});console.log("Fetching profile for user on second try:",Jn),await Wn.fetchProfile(),console.log("Fetched profile on second try:",Wn.profile),this.currentUserName=((qn=Wn.profile)==null?void 0:qn.displayName)||((Fn=Wn.profile)==null?void 0:Fn.name)||((Kn=this.currentUserNpub)==null?void 0:Kn.substring(0,10))||null,this.currentUserPicture=((jn=Wn.profile)==null?void 0:jn.image)||null,this.render();return}catch(Wn){console.error("Error fetching profile on second try:",Wn),this.currentUserName=((Yn=this.currentUserNpub)==null?void 0:Yn.substring(0,10))||null,this.render();return}}}catch(Jn){console.error("Error getting pubkey on direct second try:",Jn)}}}catch(Jn){console.error("Error in fallback pubkey detection:",Jn)}console.warn("No pubkey available from extension - trying fallback method")}}catch{}}getDisplayType(){const $n=this.getAttribute("display-type"),Dn=["fab","bottom-bar","full","embed"],Un=($n?String($n):"").toLowerCase(),Bn=Dn.includes(Un)?Un:"embed";this.displayType=Bn,this.displayType==="full"?this.isOpen=!0:this.displayType==="fab"||this.displayType==="bottom-bar"?(this.isOpen===void 0||this.isOpen===null)&&(this.isOpen=!1):this.isOpen=!1,this.getAttribute("display-type")!==Bn&&this.setAttribute("display-type",Bn)}connectedCallback(){if(!this.rendered){this.getTheme(),this.getDisplayType();const $n=this.getAttribute("welcome-text");$n&&(this.welcomeText=$n);const Dn=this.getAttribute("start-chat-text");Dn&&(this.startChatText=Dn);const Un=this.getAttribute("online-text");Un&&(this.onlineText=Un);const Bn=this.getAttribute("help-text");Bn&&(this.helpText=Bn),this.getRecipient(),this.nostrService.connectToNostr(this.getRelays()),this.getCurrentUserInfo(),this.render(),this.rendered=!0}}static get observedAttributes(){return["npub","pubkey","nip05","relays","theme","display-type","welcome-text","start-chat-text","online-text","help-text","history-days"]}unsubscribeFromDms(){if(this.dmSubscription){try{this.dmSubscription.stop()}catch{}this.dmSubscription=null}this.resubscribeTimer&&(clearTimeout(this.resubscribeTimer),this.resubscribeTimer=null)}clearRecipientAndChatState(){this.recipientPubkey=null,this.recipientNpub=null,this.recipientNip05=null,this.recipientName=null,this.recipientPicture=null,this.messages=[],this.message="",this.showWelcome=!1,this.isLoading=!1,this.isFinding=!1,this.isError=!1,this.errorMessage=""}attributeChangedCallback($n,Dn,Un){if(this.rendered)if($n==="npub"){if(Un===null){this.unsubscribeFromDms(),this.clearRecipientAndChatState(),this.render();return}Un!==Dn&&(this.unsubscribeFromDms(),this.clearRecipientAndChatState(),this.recipientNpub=Un,this.lookupRecipient());return}else if($n==="pubkey"){if(Un===null){this.unsubscribeFromDms(),this.clearRecipientAndChatState(),this.render();return}if(Un!==Dn){this.unsubscribeFromDms(),this.clearRecipientAndChatState();try{this.recipientPubkey=Un,this.recipientNpub=nip19_exports$1.npubEncode(Un),this.lookupRecipient(this.recipientNpub)}catch{}}return}else if($n==="nip05"){if(Un===null){this.unsubscribeFromDms(),this.clearRecipientAndChatState(),this.render();return}Un!==Dn&&(this.unsubscribeFromDms(),this.clearRecipientAndChatState(),this.recipientNip05=Un,this.lookupRecipientByNip05());return}else if($n==="relays"){if(Un!==Dn){const Bn=this.getRelays();this.recipientPubkey&&!this.showWelcome?(this.resubscribeTimer&&clearTimeout(this.resubscribeTimer),this.resubscribeTimer=window.setTimeout(()=>{this.unsubscribeFromDms(),this.nostrService.connectToNostr(Bn),this.subscribeToDms()},300)):this.nostrService.connectToNostr(Bn)}}else $n==="theme"?(this.getTheme(),this.render()):$n==="display-type"?(this.getDisplayType(),this.render()):$n==="welcome-text"?(this.welcomeText=Un!==null?Un:ia.DEFAULT_WELCOME_TEXT,this.render()):$n==="start-chat-text"?(this.startChatText=Un!==null?Un:ia.DEFAULT_START_CHAT_TEXT,this.render()):$n==="online-text"?(this.onlineText=Un!==null?Un:ia.DEFAULT_ONLINE_TEXT,this.render()):$n==="help-text"?(this.helpText=Un!==null?Un:ia.DEFAULT_HELP_TEXT,this.render()):$n==="history-days"&&Un!==Dn&&this.recipientPubkey&&!this.showWelcome&&(this.resubscribeTimer&&clearTimeout(this.resubscribeTimer),this.resubscribeTimer=window.setTimeout(()=>{this.subscribeToDms()},250))}async lookupRecipient($n){var Dn,Un,Bn;this.unsubscribeFromDms(),this.messages=[],this.showWelcome=!1,this.isFinding=!0,this.render();try{const In=$n||this.recipientNpub;if(!In)return;const{type:qn,data:Fn}=nip19_exports$1.decode(In);if(qn!=="npub")throw new Error("Invalid npub");this.recipientPubkey=Fn;const Kn=this.nostrService.getNDK().getUser({pubkey:this.recipientPubkey});await Kn.fetchProfile(),this.recipientName=((Dn=Kn.profile)==null?void 0:Dn.displayName)||((Un=Kn.profile)==null?void 0:Un.name)||In.substring(0,10),this.recipientPicture=((Bn=Kn.profile)==null?void 0:Bn.image)||null,this.showWelcome=!0,this.messages=[],this.isError=!1,this.errorMessage="",this.render()}catch(In){this.isError=!0,this.errorMessage=In.message}finally{this.isFinding=!1,this.render()}}async lookupRecipientByNip05($n){this.isFinding=!0,this.render();try{const Dn=$n||this.recipientNip05;if(!Dn)return;const Un=await f(Dn),Bn=nip19_exports$1.npubEncode(Un);this.recipientNpub=Bn,this.isError=!1,this.errorMessage="",await this.lookupRecipient(Bn)}catch(Dn){this.isError=!0,this.errorMessage=Dn.message}finally{this.isFinding=!1,this.render()}}handleFindClick(){const $n=this.shadowRoot.querySelector(".nostr-chat-npub-input").value.trim();this.isError=!1,this.errorMessage="",this.render(),$n&&($n.startsWith("npub")?(this.recipientNpub=$n,this.lookupRecipient()):$n.includes("@")?(this.recipientNip05=$n,this.lookupRecipientByNip05()):(this.isError=!0,this.errorMessage="Invalid input. Please provide an npub or nip05 address.",this.render()))}async handleSendClick(){var $n,Dn;if(!this.message.trim()||!this.recipientPubkey)return;if(this.message.length>this.MESSAGE_MAX_LENGTH){this.isError=!0,this.errorMessage=`Message is too long (max ${this.MESSAGE_MAX_LENGTH} characters).`,this.render();return}this.isLoading=!0,this.render();let Un=null;try{const Bn=this.nostrService.getNDK();let In;if(typeof window<"u"&&window.nostr&&window.nostr.getPublicKey&&window.nostr.signEvent)try{In=new NDKNip07Signer}catch(jn){console.error("Error creating NIP-07 signer:",jn),this.isError=!0,this.errorMessage=`Error connecting to Nostr extension: ${jn.message}`,this.isLoading=!1,this.render();return}if(!In)throw new Error("No signer available. Please install a NIP-07 extension or set a private key.");Bn.signer=In;const qn=new NDKEvent(Bn,{kind:NDKKind.EncryptedDirectMessage,tags:[["p",this.recipientPubkey]],created_at:Math.floor(Date.now()/1e3)});let Fn=!1;if(typeof((Dn=($n=window.nostr)==null?void 0:$n.nip04)==null?void 0:Dn.encrypt)=="function")try{qn.content=await window.nostr.nip04.encrypt(this.recipientPubkey,this.message.trim()),Fn=!0}catch(jn){console.error("NIP-07 encryption failed, falling back to local encryption:",jn)}if(!Fn)throw new Error("No private key available for encryption. Please use a NIP-07 extension.");Un=`temp_${Date.now()}`,this.messages.push({id:Un,text:this.message,sender:"me",timestamp:qn.created_at,status:"sending"}),this.message="",this.render(),await qn.publish();const Kn=this.messages.find(jn=>jn.id===Un);Kn&&(this.messages.find(jn=>jn.id===qn.id&&jn.id!==Un)?this.messages=this.messages.filter(jn=>jn.id!==Un):(Kn.id=qn.id,Kn.status="sent"),this.render())}catch(Bn){if(this.isError=!0,this.errorMessage=Bn.message,Un){const In=this.messages.find(qn=>qn.id===Un);In&&(In.status="failed"),this.render()}}finally{this.isLoading=!1,this.render()}}handleTextareaChange($n){var Dn;const Un=$n.target;this.message=Un.value;const Bn=Math.max(0,this.MESSAGE_MAX_LENGTH-this.message.length),In=(Dn=this.shadowRoot)==null?void 0:Dn.querySelector(".nostr-chat-char-counter");In&&(In.textContent=`${Bn} chars left`,In.classList.toggle("warn",Bn<=10))}handleStartChat(){this.showWelcome=!1,this.subscribeToDms(),this.render()}async subscribeToDms(){if(this.dmSubscription&&this.dmSubscription.stop(),!this.recipientPubkey)return;let $n=null;try{if(typeof window<"u"&&window.nostr&&window.nostr.getPublicKey)$n={pubkey:await window.nostr.getPublicKey()};else{let Kn=null;if(this.keySupplier)try{Kn=await this.keySupplier()}catch{}if(Kn){const{NDKPrivateKeySigner:jn}=await y$2(async()=>{const{NDKPrivateKeySigner:Zn}=await __vitePreload(()=>Promise.resolve().then(()=>nostrServiceCA0Qx4nJ),void 0).then(Xn=>Xn.k);return{NDKPrivateKeySigner:Zn}},[]);let Yn=Kn;Kn.startsWith("nsec")&&(Yn=nip19_exports$1.decode(Kn).data),$n=await new jn(Yn).user()}}}catch(Kn){console.error("Failed to determine current user for subscription",Kn)}if(!$n){this.isError=!0,this.errorMessage="No signer available. Please install a NIP-07 extension or set a private key to start the chat.",this.render();return}this.messages=[];const Dn=this.getAttribute("history-days");let Un;if(!Dn)Un=void 0;else if(Dn.toLowerCase()==="all"||parseInt(Dn,10)<=0)Un=void 0;else{const Kn=Math.max(1,parseInt(Dn,10)||30);Un=Math.floor((Date.now()-Kn*24*60*60*1e3)/1e3)}const Bn={kinds:[NDKKind.EncryptedDirectMessage],"#p":[$n.pubkey],authors:[this.recipientPubkey]},In={kinds:[NDKKind.EncryptedDirectMessage],"#p":[this.recipientPubkey],authors:[$n.pubkey]},qn=Un!==void 0?{...Bn,since:Un}:Bn,Fn=Un!==void 0?{...In,since:Un}:In;this.dmSubscription=this.nostrService.getNDK().subscribe([qn,Fn],{closeOnEose:!1,groupable:!1}),this.dmSubscription.on("event",async Kn=>{var jn;try{!this.currentUserPubkey&&$n&&(this.currentUserPubkey=$n.pubkey,this.currentUserNpub=nip19_exports$1.npubEncode($n.pubkey));const Yn=Kn.pubkey===$n.pubkey,Zn=Yn?(jn=Kn.tags.find(Wn=>Wn[0]==="p"))==null?void 0:jn[1]:Kn.pubkey;if(!Zn){try{console.debug("nostr-live-chat: skipping event with missing peer",Kn.id)}catch{}return}if(Zn!==this.recipientPubkey)return;if(Yn){const Wn=this.messages.find(tr=>tr.id===Kn.id);if(Wn){Wn.status==="sending"&&(Wn.status="sent",this.render());return}}let Xn="";if(!Zn){try{console.debug("nostr-live-chat: missing peer prior to decrypt, skipping",Kn.id)}catch{}return}if(!Kn.content||Kn.content.trim()===""){try{console.debug("nostr-live-chat: missing or empty content prior to decrypt, skipping",Kn.id)}catch{}return}if(window.nostr&&window.nostr.nip04&&typeof window.nostr.nip04.decrypt=="function")try{Xn=await window.nostr.nip04.decrypt(Zn,Kn.content)}catch(Wn){console.error("Failed to decrypt DM content:",Wn);return}else throw new Error("No private key available for decryption. Please use a NIP-07 extension.");if(Yn){const Wn=this.messages.find(tr=>tr.status==="sending"&&tr.sender==="me"&&tr.text===Xn&&Math.abs(tr.timestamp-Kn.created_at)<2);if(Wn){Wn.id=Kn.id,Wn.status="sent",this.render();return}}const Jn={id:Kn.id,text:Xn,sender:Yn?"me":"them",timestamp:Kn.created_at,status:"sent"};this.messages.find(Wn=>Wn.id===Jn.id)||(this.messages.push(Jn),this.messages.sort((Wn,tr)=>Wn.timestamp-tr.timestamp),this.render())}catch(Yn){console.error("Failed to decrypt DM content:",Yn)}})}attachEventListeners(){const $n=this.shadowRoot.querySelector(".nostr-chat-launcher");$n&&(this.boundHandleLauncherClick&&$n.removeEventListener("click",this.boundHandleLauncherClick),this.boundHandleLauncherClick=()=>{this.isOpen=!0,this.render()},$n.addEventListener("click",this.boundHandleLauncherClick));const Dn=this.shadowRoot.querySelector(".nostr-chat-close-btn");Dn&&(this.boundHandleCloseClick&&Dn.removeEventListener("click",this.boundHandleCloseClick),this.boundHandleCloseClick=Kn=>{Kn?.stopPropagation(),(this.displayType==="fab"||this.displayType==="bottom-bar")&&(this.isOpen=!1),this.render()},Dn.addEventListener("click",this.boundHandleCloseClick));const Un=this.shadowRoot.querySelector(".nostr-chat-find-btn");Un&&(this.boundHandleFind&&Un.removeEventListener("click",this.boundHandleFind),this.boundHandleFind=this.handleFindClick.bind(this),Un.addEventListener("click",this.boundHandleFind));const Bn=this.shadowRoot.querySelector(".nostr-chat-send-btn");Bn&&(this.boundHandleSend&&Bn.removeEventListener("click",this.boundHandleSend),this.boundHandleSend=this.handleSendClick.bind(this),Bn.addEventListener("click",this.boundHandleSend));const In=this.shadowRoot.querySelector(".nostr-chat-start-btn");In&&(this.boundHandleStartChat&&In.removeEventListener("click",this.boundHandleStartChat),this.boundHandleStartChat=this.handleStartChat.bind(this),In.addEventListener("click",this.boundHandleStartChat));const qn=this.shadowRoot.querySelector(".nostr-chat-textarea");qn&&(this.boundHandleTextareaChange&&qn.removeEventListener("input",this.boundHandleTextareaChange),this.boundHandleTextareaChange=this.handleTextareaChange.bind(this),qn.addEventListener("input",this.boundHandleTextareaChange));const Fn=this.shadowRoot.querySelector(".nostr-chat-npub-input");Fn&&(this.boundHandleNpubKeydown&&Fn.removeEventListener("keydown",this.boundHandleNpubKeydown),this.boundHandleNpubKeydown=Kn=>{Kn.key==="Enter"&&this.handleFindClick()},Fn.addEventListener("keydown",this.boundHandleNpubKeydown))}disconnectedCallback(){var $n,Dn,Un,Bn,In,qn,Fn;this.dmSubscription&&this.dmSubscription.stop();const Kn=($n=this.shadowRoot)==null?void 0:$n.querySelector(".nostr-chat-launcher");Kn&&this.boundHandleLauncherClick&&Kn.removeEventListener("click",this.boundHandleLauncherClick);const jn=(Dn=this.shadowRoot)==null?void 0:Dn.querySelector(".nostr-chat-close-btn");jn&&this.boundHandleCloseClick&&jn.removeEventListener("click",this.boundHandleCloseClick);const Yn=(Un=this.shadowRoot)==null?void 0:Un.querySelector(".nostr-chat-find-btn");Yn&&this.boundHandleFind&&Yn.removeEventListener("click",this.boundHandleFind);const Zn=(Bn=this.shadowRoot)==null?void 0:Bn.querySelector(".nostr-chat-send-btn");Zn&&this.boundHandleSend&&Zn.removeEventListener("click",this.boundHandleSend);const Xn=(In=this.shadowRoot)==null?void 0:In.querySelector(".nostr-chat-start-btn");Xn&&this.boundHandleStartChat&&Xn.removeEventListener("click",this.boundHandleStartChat);const Jn=(qn=this.shadowRoot)==null?void 0:qn.querySelector(".nostr-chat-textarea");Jn&&this.boundHandleTextareaChange&&Jn.removeEventListener("input",this.boundHandleTextareaChange);const Wn=(Fn=this.shadowRoot)==null?void 0:Fn.querySelector(".nostr-chat-npub-input");Wn&&this.boundHandleNpubKeydown&&Wn.removeEventListener("keydown",this.boundHandleNpubKeydown),this.resubscribeTimer&&(clearTimeout(this.resubscribeTimer),this.resubscribeTimer=null)}setKeySupplier($n){this.keySupplier=$n}escapeHtml($n){return $n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}render(){const $n={theme:this.theme,recipientNpub:this.recipientNpub,recipientName:this.recipientName,recipientPicture:this.recipientPicture,message:this.message,messages:this.messages,isLoading:this.isLoading,isFinding:this.isFinding,isError:this.isError,errorMessage:this.errorMessage,currentUserName:this.currentUserName,currentUserPicture:this.currentUserPicture,showWelcome:this.showWelcome,welcomeText:this.welcomeText,startChatText:this.startChatText,onlineText:this.onlineText,helpText:this.helpText,maxMessageLength:this.MESSAGE_MAX_LENGTH},Dn=z$1(this.theme),{onlineText:Un,helpText:Bn,...In}=$n,qn=O$1(In);let Fn=Dn;this.displayType==="embed"?Fn+=qn:this.displayType==="full"?Fn+=`
        <div class="nostr-chat-float-panel open">${qn}</div>
      `:this.displayType==="fab"?Fn+=`
        ${this.isOpen?"":`
          <div class="nostr-chat-launcher fab" role="button" aria-label="Open live chat">
            <div class="bubble">
              <div class="title">${this.escapeHtml(this.onlineText)}</div>
              <div class="subtitle">${this.escapeHtml(this.helpText)}</div>
            </div>
            <button class="fab-btn" aria-label="Open chat"></button>
          </div>
        `}
        <div class="nostr-chat-float-panel ${this.isOpen?"open":""}">
          ${qn}
        </div>
      `:this.displayType==="bottom-bar"&&(Fn+=`
        ${this.isOpen?"":`
          <div class="nostr-chat-launcher bottom-bar" role="button" aria-label="Open live chat">
            <button class="bar-btn">Live chat</button>
          </div>
        `}
        <div class="nostr-chat-float-panel ${this.isOpen?"open":""}">
          ${qn}
        </div>
      `),this.shadowRoot.innerHTML=Fn,this.attachEventListeners(),setTimeout(()=>{var Kn;const jn=(Kn=this.shadowRoot)==null?void 0:Kn.querySelector(".nostr-chat-history");jn&&(jn.scrollTop=jn.scrollHeight)},0)}};a(x,"DEFAULT_WELCOME_TEXT","Welcome! How can we help you today?"),a(x,"DEFAULT_START_CHAT_TEXT","Start chat"),a(x,"DEFAULT_ONLINE_TEXT","We're Online!"),a(x,"DEFAULT_HELP_TEXT","How may I help you today?");let F$1=x;customElements.get("nostr-live-chat")||customElements.define("nostr-live-chat",F$1);const __vite__mapDeps=(s,$n=__vite__mapDeps,Dn=$n.f||($n.f=["assets/dialog-likers-Bq6kUbS0.js","assets/preload-helper-D7HrI6pR.js","assets/dialog-component-Da1ZIYh9.js","assets/zap-utils-BiKkJPt6.js","assets/nostr-service-CA0Qx4nJ.js","assets/nostr-login-service-D2FmscPI.js","assets/utils--bxLbhGF.js","assets/base-styles-Dmuzg8I4.js"]))=>s.map(Un=>Dn[Un]);var y=Object.defineProperty,w=(s,$n,Dn)=>$n in s?y(s,$n,{enumerable:!0,configurable:!0,writable:!0,value:Dn}):s[$n]=Dn,d=(s,$n,Dn)=>w(s,typeof $n!="symbol"?$n+"":$n,Dn);function U({isLoading:s,isError:$n,errorMessage:Dn,buttonText:Un,isLiked:Bn,likeCount:In,hasLikes:qn=!1,isCountLoading:Fn=!1,theme:Kn="light"}){if($n)return z(Dn||"");const jn=$(Bn,Kn),Yn=Bn?"<span>Liked</span>":`<span>${B(Un)}</span>`;return N(jn,Yn,In,qn,Bn,s,Fn)}function z(s){return D('<div class="error-icon">&#9888;</div>',B(s))}function D(s,$n){return`
    <div class="nostr-like-button-container">
      <div class="nostr-like-button-left-container">
        ${s}
      </div>
      <div class="nostr-like-button-right-container">
        ${$n}
      </div>
    </div>
  `}function N(s,$n,Dn,Un=!1,Bn=!1,In=!1,qn=!1){let Fn="";return qn?Fn='<span class="like-count skeleton"></span>':Dn>0&&(Fn=`<span class="like-count${Un?" clickable":""}">${Dn} ${Dn===1?"like":"likes"}</span>`),`
    <div class="nostr-like-button-container">
      <button class="${Bn?"nostr-like-button liked":"nostr-like-button"}">
        ${s}
        ${In?'<span class="button-text-skeleton"></span>':$n}
      </button>
      ${Fn} <button class="help-icon" title="What is a like?">?</button>
    </div>
  `}function $(s,$n="light"){const Dn=$n==="dark"?"#8ab4f8":"#1877f2",Un=$n==="dark"?"#e0e7ff":"#0d46a1";return s?`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" width="24" height="24">
      <path d="M93.6,53.1c2.6-1.5,4.2-4.4,3.8-7.6c-0.5-4-4.2-6.8-8.2-6.8l-25,0c0.2-0.5,0.5-1.2,0.7-1.8c1.5-3.8,4.3-10.8,4.3-18 c0-8.1-5.7-13-9.6-13.3C57.2,5.5,55.4,7,55,9.7c-0.7,5.1-4.1,12.6-5.5,15.5c-0.4,0.9-0.9,1.7-1.6,2.4c-2.3,2.6-8.1,9-13.6,12.8 c0,0.2,0.1,0.5,0.1,0.7v47.9c0,0.4-0.1,0.8-0.1,1.2c9.4,2.7,17.9,4,27.2,4l21.3,0c3.7,0,7.2-2.5,7.9-6.1c0.6-3-0.5-5.7-2.5-7.5 c3.4-0.8,6-3.9,6-7.5c0-2.3-1-4.4-2.7-5.8c3.4-0.8,6-3.9,6-7.5C97.5,57,96,54.5,93.6,53.1z" fill="${Dn}"/>
      <path d="M23.4,36.9H6.7c-2.3,0-4.2,1.9-4.2,4.2v47.9c0,2.3,1.9,4.2,4.2,4.2h16.7c2.3,0,4.2-1.9,4.2-4.2V41.2 C27.6,38.8,25.8,36.9,23.4,36.9z M15.1,85.9c-2.4,0-4.4-2-4.4-4.4s2-4.4,4.4-4.4c2.4,0,4.4,2,4.4,4.4S17.5,85.9,15.1,85.9z" fill="${Dn}"/>
    </svg>`:`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" width="24" height="24">
      <path d="M93.6,53.1c2.6-1.5,4.2-4.4,3.8-7.6c-0.5-4-4.2-6.8-8.2-6.8l-25,0c0.2-0.5,0.5-1.2,0.7-1.8c1.5-3.8,4.3-10.8,4.3-18 c0-8.1-5.7-13-9.6-13.3C57.2,5.5,55.4,7,55,9.7c-0.7,5.1-4.1,12.6-5.5,15.5c-0.4,0.9-0.9,1.7-1.6,2.4c-2.3,2.6-8.1,9-13.6,12.8 c0,0.2,0.1,0.5,0.1,0.7v47.9c0,0.4-0.1,0.8-0.1,1.2c9.4,2.7,17.9,4,27.2,4l21.3,0c3.7,0,7.2-2.5,7.9-6.1c0.6-3-0.5-5.7-2.5-7.5 c3.4-0.8,6-3.9,6-7.5c0-2.3-1-4.4-2.7-5.8c3.4-0.8,6-3.9,6-7.5C97.5,57,96,54.5,93.6,53.1z" fill="none" stroke="${Un}" stroke-width="2"/>
      <path d="M23.4,36.9H6.7c-2.3,0-4.2,1.9-4.2,4.2v47.9c0,2.3,1.9,4.2,4.2,4.2h16.7c2.3,0,4.2-1.9,4.2-4.2V41.2 C27.6,38.8,25.8,36.9,23.4,36.9z M15.1,85.9c-2.4,0-4.4-2-4.4-4.4s2-4.4,4.4-4.4c2.4,0,4.4,2,4.4,4.4S17.5,85.9,15.1,85.9z" fill="none" stroke="${Un}" stroke-width="2"/>
    </svg>`}function R(){return V$3(`
    /* === LIKE BUTTON CONTAINER PATTERN === */
    :host {
      /* Icon sizing (overridable via CSS variables) */
      --nostrc-icon-height: 25px;
      --nostrc-icon-width: 25px;

      /* Like button CSS variables (overridable by parent components) */
      --nostrc-like-btn-padding: var(--nostrc-spacing-sm) var(--nostrc-spacing-md);
      --nostrc-like-btn-border-radius: var(--nostrc-border-radius-md);
      --nostrc-like-btn-border: var(--nostrc-border-width) solid var(--nostrc-color-border);
      --nostrc-like-btn-min-height: 47px;
      --nostrc-like-btn-width: auto;
      --nostrc-like-btn-horizontal-alignment: left;
      --nostrc-like-btn-bg: var(--nostrc-theme-bg, #ffffff);
      --nostrc-like-btn-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-like-btn-font-family: var(--nostrc-font-family-primary);
      --nostrc-like-btn-font-size: var(--nostrc-font-size-base);
      
      /* Hover state variables */
      --nostrc-like-btn-hover-bg: var(--nostrc-theme-hover-bg, rgba(0, 0, 0, 0.05));
      --nostrc-like-btn-hover-color: var(--nostrc-theme-text-primary, #333333);
      --nostrc-like-btn-hover-border: var(--nostrc-border-width) solid var(--nostrc-theme-border, var(--nostrc-color-border));

      /* Liked state variables */
      --nostrc-like-btn-liked-bg: #e7f3ff;
      --nostrc-like-btn-liked-color: #1877f2;
      --nostrc-like-btn-liked-border: #1877f2;
      --nostrc-like-btn-liked-hover-bg: #d1e7ff;

      /* Make the host a flex container for button + count */
      display: inline-flex;
      flex-direction: row;
      align-items: center;
      gap: var(--nostrc-spacing-md);
      font-family: var(--nostrc-like-btn-font-family);
      font-size: var(--nostrc-like-btn-font-size);
    }

    /* Focus state for accessibility */
    :host(:focus-visible) {
      outline: 2px solid var(--nostrc-color-primary, #007bff);
      outline-offset: 2px;
    }

    :host(.is-error) .nostr-like-button-container {
      border: var(--nostrc-border-width) solid var(--nostrc-color-error-text);
      border-radius: var(--nostrc-border-radius-md);
      padding: var(--nostrc-spacing-sm);
      color: var(--nostrc-color-error-text);
    }

    .nostr-like-button-container {
      display: flex;
      align-items: center;
      gap: var(--nostrc-spacing-md);
      width: fit-content;
    }

    .nostr-like-button-left-container {
      display: flex;
      align-items: center;
    }

    .nostr-like-button-right-container {
      display: flex;
      align-items: center;
    }

    .nostr-like-button {
      display: flex;
      align-items: center;
      justify-content: var(--nostrc-like-btn-horizontal-alignment);
      gap: var(--nostrc-spacing-sm);
      background: var(--nostrc-like-btn-bg);
      color: var(--nostrc-like-btn-color);
      border: var(--nostrc-like-btn-border);
      border-radius: var(--nostrc-like-btn-border-radius);
      padding: var(--nostrc-like-btn-padding);
      min-height: var(--nostrc-like-btn-min-height);
      width: var(--nostrc-like-btn-width);
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
      font-family: inherit;
      font-size: inherit;
    }

    /* Hover state on the button */
    .nostr-like-button:hover {
      background: var(--nostrc-like-btn-hover-bg);
      color: var(--nostrc-like-btn-hover-color);
      border: var(--nostrc-like-btn-hover-border);
    }

    /* Liked state */
    .nostr-like-button.liked {
      background: var(--nostrc-like-btn-liked-bg);
      color: var(--nostrc-like-btn-liked-color);
      border: var(--nostrc-border-width) solid var(--nostrc-like-btn-liked-border);
    }

    .nostr-like-button.liked:hover {
      background: var(--nostrc-like-btn-liked-hover-bg);
    }

    .nostr-like-button:disabled {
      pointer-events: none;
      user-select: none;
      opacity: 0.6;
    }

    :host:not([status="ready"]) .nostr-like-button {
      cursor: not-allowed;
    }

    /* SVG Icon Styles */
    .nostr-like-button svg {
      display: inline-block;
      vertical-align: middle;
      width: var(--nostrc-icon-width);
      height: var(--nostrc-icon-height);
    }

    /* Like count display */
    .like-count {
      font-size: var(--nostrc-font-size-sm);
      color: var(--nostrc-theme-text-secondary, #666666);
      white-space: nowrap;
      text-decoration: underline;
      text-decoration-color: transparent;
      transition: text-decoration-color 0.2s ease, color 0.2s ease;
    }

    /* Clickable like count */
    .like-count.clickable {
      cursor: pointer;
      text-decoration-color: currentColor;
    }

    .like-count.clickable:hover {
      color: var(--nostrc-color-primary, #7f00ff);
      text-decoration-color: var(--nostrc-color-primary, #7f00ff);
    }

    /* Help icon */
    .help-icon {
      background: none;
      border: 1px solid var(--nostrc-color-border, #e0e0e0);
      border-radius: var(--nostrc-border-radius-full, 50%);
      width: var(--nostrc-help-icon-size, 16px);
      height: var(--nostrc-help-icon-size, 16px);
      font-size: calc(var(--nostrc-help-icon-size, 16px) * 0.7);
      font-weight: bold;
      color: var(--nostrc-theme-text-secondary, #666666);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-left: var(--nostrc-spacing-xs, 4px);
      transition: all 0.2s ease;
    }

    .help-icon:hover {
      background: var(--nostrc-color-hover-background, rgba(0, 0, 0, 0.05));
      border-color: var(--nostrc-color-primary, #7f00ff);
      color: var(--nostrc-color-primary, #7f00ff);
    }

    /* Skeleton loader for like count */
    .like-count.skeleton {
      background: linear-gradient(90deg, 
        var(--nostrc-skeleton-color-min) 25%, 
        var(--nostrc-skeleton-color-max) 50%, 
        var(--nostrc-skeleton-color-min) 75%
      );
      background-size: 200% 100%;
      animation: skeleton-loading var(--nostrc-skeleton-duration) var(--nostrc-skeleton-timing-function) var(--nostrc-skeleton-iteration-count);
      border-radius: var(--nostrc-border-radius-sm);
      width: 80px;
      height: 1.2em;
      display: inline-block;
    }

    /* Skeleton loader for button text */
    .button-text-skeleton {
      background: linear-gradient(90deg, 
        var(--nostrc-skeleton-color-min) 25%, 
        var(--nostrc-skeleton-color-max) 50%, 
        var(--nostrc-skeleton-color-min) 75%
      );
      background-size: 200% 100%;
      animation: skeleton-loading var(--nostrc-skeleton-duration) var(--nostrc-skeleton-timing-function) var(--nostrc-skeleton-iteration-count);
      border-radius: var(--nostrc-border-radius-sm);
      width: 60px;
      height: 1em;
      display: inline-block;
    }

    @keyframes skeleton-loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }

    /* Error message styling */
    .nostr-like-button-error small {
      color: var(--nostrc-color-error-text);
      font-size: var(--nostrc-font-size-sm);
      line-height: 1em;
      max-width: 250px;
      white-space: pre-line;
    }
  `)}function I(){return`
    .help-content {
      padding: var(--nostrc-spacing-md, 12px);
    }

    .help-content p {
      margin: 0 0 var(--nostrc-spacing-md, 12px) 0;
      color: var(--nostrc-theme-text-primary, #333333);
      line-height: 1.5;
    }

    .help-content p:last-child {
      margin-bottom: 0;
    }

    .help-content ul {
      margin: 0 0 var(--nostrc-spacing-md, 12px) 0;
      padding-left: var(--nostrc-spacing-lg, 16px);
      color: var(--nostrc-theme-text-primary, #333333);
    }

    .help-content li {
      margin-bottom: var(--nostrc-spacing-xs, 4px);
      line-height: 1.5;
    }

    .help-content li:last-child {
      margin-bottom: 0;
    }

    .help-content strong {
      font-weight: 600;
      color: var(--nostrc-theme-text-primary, #333333);
    }

    .help-content a {
      color: var(--nostrc-theme-primary, #0066cc);
      text-decoration: underline;
    }

    .help-content a:hover {
      color: var(--nostrc-theme-primary-hover, #0052a3);
    }
  `}const M=()=>{if(document.querySelector("style[data-help-dialog-styles]"))return;const s=document.createElement("style");s.setAttribute("data-help-dialog-styles","true"),s.textContent=I(),document.head.appendChild(s)},H=async s=>{M(),customElements.get("dialog-component")||await customElements.whenDefined("dialog-component");const $n=document.createElement("dialog-component");$n.setAttribute("header","What is a Like?"),$n.setAttribute("data-theme",s),$n.innerHTML=`
    <div class="help-content">
      <p>Like any webpage to show your appreciation! Your likes are stored on Nostr, a decentralized network you controlno accounts needed.</p>
      <ul>
        <li>Like any webpage or article</li>
        <li>See who liked the content</li>
        <li>Works with a browser extension like <a href="https://getalby.com" target="_blank" rel="noopener noreferrer">Alby</a> or nos2x</li>
      </ul>
    </div>
  `,$n.showModal()};new TextDecoder("utf-8");new TextEncoder;function k(s){try{s.indexOf("://")===-1&&(s="wss://"+s);let $n=new URL(s);return $n.protocol==="http:"?$n.protocol="ws:":$n.protocol==="https:"&&($n.protocol="wss:"),$n.pathname=$n.pathname.replace(/\/+/g,"/"),$n.pathname.endsWith("/")&&($n.pathname=$n.pathname.slice(0,-1)),($n.port==="80"&&$n.protocol==="ws:"||$n.port==="443"&&$n.protocol==="wss:")&&($n.port=""),$n.searchParams.sort(),$n.hash="",$n.toString()}catch{throw new Error(`Invalid URL: ${s}`)}}async function T(s,$n){const Dn=k(s),Un=new SimplePool;try{const Bn=await Un.querySync($n,{kinds:[17],"#k":["web"],"#i":[Dn],limit:1e3}),In=[];let qn=0,Fn=0;for(const Kn of Bn)In.push({authorPubkey:Kn.pubkey,date:new Date(Kn.created_at*1e3),content:Kn.content}),Kn.content==="-"?Fn++:qn++;return In.sort((Kn,jn)=>jn.date.getTime()-Kn.date.getTime()),{totalCount:qn-Fn,likeDetails:In,likedCount:qn,dislikedCount:Fn}}catch(Bn){throw Bn instanceof Error?Bn:new Error(String(Bn))}finally{Un.close($n)}}function m(s,$n){return{kind:17,content:$n,tags:[["k","web"],["i",s]],created_at:Math.floor(Date.now()/1e3)}}function P(s){return m(s,"+")}function _(s){return m(s,"-")}async function F(s,$n,Dn){const Un=new SimplePool,Bn=s;try{const In=await Un.querySync(Dn,{kinds:[17],authors:[$n],"#k":["web"],"#i":[Bn],limit:1});if(In.length===0)return!1;const qn=In[0];return qn.content==="+"||qn.content===""}catch(In){return console.error("Nostr-Components: Like button: Error checking user like status",In),!1}finally{Un.close(Dn)}}async function q(){try{return await r(),await l$2()}catch(s){return console.error("Nostr-Components: Like button: Error getting user pubkey",s),null}}async function b(s){try{return await r(),await c$2(s)}catch($n){throw console.error("Nostr-Components: Like button: Error signing event",$n),$n}}class O extends K$3{constructor(){super(),d(this,"likeActionStatus",this.channel("likeAction")),d(this,"likeListStatus",this.channel("likeList")),d(this,"currentUrl",""),d(this,"isLiked",!1),d(this,"likeCount",0),d(this,"cachedLikeDetails",null),d(this,"loadSeq",0)}connectedCallback(){var $n;($n=super.connectedCallback)==null||$n.call(this),this.likeListStatus.get()===f$2.Idle&&this.initChannelStatus("likeList",f$2.Loading,{reflectOverall:!1}),this.attachDelegatedListeners(),this.render()}static get observedAttributes(){return[...super.observedAttributes,"url","text"]}attributeChangedCallback($n,Dn,Un){Dn!==Un&&(super.attributeChangedCallback($n,Dn,Un),($n==="url"||$n==="text")&&(this.likeActionStatus.set(f$2.Ready),this.likeListStatus.set(f$2.Loading),this.isLiked=!1,this.errorMessage="",this.updateLikeCount(),this.render()))}validateInputs(){if(!super.validateInputs())return this.likeActionStatus.set(f$2.Idle),this.likeListStatus.set(f$2.Idle),!1;const $n=this.getAttribute("url"),Dn=this.getAttribute("text"),Un=this.tagName.toLowerCase();let Bn=null;return $n&&(F$4($n)||(Bn="Invalid URL format")),Dn&&Dn.length>32&&(Bn="Max text length: 32 characters"),Bn?(this.likeActionStatus.set(f$2.Error,Bn),this.likeListStatus.set(f$2.Error,Bn),console.error(`Nostr-Components: ${Un}: ${Bn}`),!1):!0}onStatusChange($n){this.render()}onNostrRelaysConnected(){this.updateLikeCount(),this.render()}ensureCurrentUrl(){this.currentUrl||(this.currentUrl=k(this.getAttribute("url")||window.location.href))}async updateLikeCount(){const $n=++this.loadSeq;try{await this.ensureNostrConnected(),this.currentUrl=k(this.getAttribute("url")||window.location.href),this.likeListStatus.set(f$2.Loading),this.render();const Dn=await T(this.currentUrl,this.getRelays());if($n!==this.loadSeq)return;this.likeCount=Dn.totalCount,this.cachedLikeDetails=Dn,this.likeListStatus.set(f$2.Ready)}catch(Dn){console.error("[NostrLike] Failed to fetch like count:",Dn),this.likeListStatus.set(f$2.Error,"Failed to load likes")}finally{this.render()}}async handleLikeClick(){if(this.ensureCurrentUrl(),!this.currentUrl){this.likeActionStatus.set(f$2.Error,"Invalid URL"),this.render();return}this.likeActionStatus.set(f$2.Loading),this.render();try{await r();const $n=await q();if($n&&(this.isLiked=await F(this.currentUrl,$n,this.getRelays())),this.isLiked){if(!window.confirm("You have already liked this. Do you want to unlike it?")){this.likeActionStatus.set(f$2.Ready),this.render();return}await this.handleUnlike()}else await this.handleLike()}catch($n){console.error("[NostrLike] Failed to check user like status:",$n);const Dn=$n instanceof Error?$n.message:"Failed to check user like status";this.likeActionStatus.set(f$2.Error,Dn),this.render()}}async handleLike(){if(this.ensureCurrentUrl(),!this.currentUrl){this.likeActionStatus.set(f$2.Error,"Invalid URL"),this.render();return}this.likeActionStatus.set(f$2.Loading),this.render();try{const $n=P(this.currentUrl),Dn=await b($n);await new NDKEvent(this.nostrService.getNDK(),Dn).publish(),this.isLiked=!0,this.likeCount++,this.likeActionStatus.set(f$2.Ready),await this.updateLikeCount()}catch($n){console.error("[NostrLike] Failed to like:",$n),this.isLiked=!1,this.likeCount--;const Dn=$n instanceof Error?$n.message:"Failed to like";this.likeActionStatus.set(f$2.Error,Dn)}finally{this.render()}}async handleUnlike(){if(this.ensureCurrentUrl(),!this.currentUrl){this.likeActionStatus.set(f$2.Error,"Invalid URL"),this.render();return}this.likeActionStatus.set(f$2.Loading),this.render();try{const $n=_(this.currentUrl),Dn=await b($n);await new NDKEvent(this.nostrService.getNDK(),Dn).publish(),this.isLiked=!1,this.likeCount>0&&this.likeCount--,this.likeActionStatus.set(f$2.Ready),await this.updateLikeCount()}catch($n){console.error("[NostrLike] Failed to unlike:",$n),this.isLiked=!0,this.likeCount++;const Dn=$n instanceof Error?$n.message:"Failed to unlike";this.likeActionStatus.set(f$2.Error,Dn)}finally{this.render()}}async handleCountClick(){if(!(this.likeCount===0||!this.cachedLikeDetails))try{const{openLikersDialog:$n}=await y$2(async()=>{const{openLikersDialog:Dn}=await __vitePreload(()=>import("./dialog-likers-Bq6kUbS0-DCQW9HfI.js"),[]);return{openLikersDialog:Dn}},__vite__mapDeps([0,1,2,3,4,5,6,7]));await $n({likeDetails:this.cachedLikeDetails.likeDetails,theme:this.theme==="dark"?"dark":"light"})}catch($n){console.error("[NostrLike] Error opening likers dialog:",$n)}}async handleHelpClick(){try{await H(this.theme==="dark"?"dark":"light")}catch($n){console.error("[NostrLike] Error showing help dialog:",$n)}}attachDelegatedListeners(){this.delegateEvent("click",".nostr-like-button",$n=>{var Dn,Un;(Dn=$n.preventDefault)==null||Dn.call($n),(Un=$n.stopPropagation)==null||Un.call($n),this.handleLikeClick()}),this.delegateEvent("click",".like-count",$n=>{var Dn,Un;(Dn=$n.preventDefault)==null||Dn.call($n),(Un=$n.stopPropagation)==null||Un.call($n),this.handleCountClick()}),this.delegateEvent("click",".help-icon",$n=>{var Dn,Un;(Dn=$n.preventDefault)==null||Dn.call($n),(Un=$n.stopPropagation)==null||Un.call($n),this.handleHelpClick()})}renderContent(){const $n=this.likeActionStatus.get()===f$2.Loading||this.conn.get()===f$2.Loading,Dn=this.likeListStatus.get()===f$2.Loading,Un=this.computeOverall()===f$2.Error,Bn=this.errorMessage,In=this.getAttribute("text")||"Like",qn={isLoading:$n,isError:Un,errorMessage:Bn,buttonText:In,isLiked:this.isLiked,likeCount:this.likeCount,hasLikes:this.likeCount>0,isCountLoading:Dn,theme:this.theme};this.shadowRoot.innerHTML=`
      ${R()}
      ${U(qn)}
    `}}customElements.get("nostr-like")||customElements.define("nostr-like",O);function RegularButton({children:s,handleClick:$n}){return jsxRuntimeExports.jsx("button",{className:"btn btn--text",onClick:$n,children:s})}const data={category:[{name:"Animals and nature",value:"animals-and-nature"},{name:"Food and drink",value:"food-and-drink"},{name:"Travel and places",value:"travel-and-places"},{name:"Objects",value:"objects"},{name:"Symbols",value:"symbols"}],number:[{value:"10"},{value:"20"},{value:"30"},{value:"40"},{value:"50"}]};function Option({valueArray:s}){const $n=s.map(({name:Dn,value:Un})=>jsxRuntimeExports.jsx("option",{value:Un,children:Dn||Un},Un));return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:$n})}function Select({handleChange:s}){const $n=Object.entries(data).map(([Dn,Un])=>jsxRuntimeExports.jsxs("div",{className:"form__inner-wrapper",children:[jsxRuntimeExports.jsxs("label",{htmlFor:Dn,children:["Select a ",Dn]}),jsxRuntimeExports.jsx("select",{name:Dn,id:Dn,onChange:s,children:jsxRuntimeExports.jsx(Option,{valueArray:Un})})]},Dn));return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:$n})}function Form({handleSubmit:s,handleChange:$n,isFirstRender:Dn}){const Un=reactExports.useRef(null);return reactExports.useEffect(()=>{!Dn&&Un.current.focus()},[]),jsxRuntimeExports.jsxs("div",{className:"form-container",ref:Un,tabIndex:-1,children:[jsxRuntimeExports.jsx("p",{className:"p--regular",children:"Customize the game by selecting an emoji category and a number of memory cards."}),jsxRuntimeExports.jsxs("form",{className:"wrapper",children:[jsxRuntimeExports.jsx(Select,{handleChange:$n}),jsxRuntimeExports.jsx(RegularButton,{handleClick:s,children:"Start Game"})]})]})}var __assign$1=function(){return __assign$1=Object.assign||function(s){for(var $n,Dn=1,Un=arguments.length;Dn<Un;Dn++){$n=arguments[Dn];for(var Bn in $n)Object.prototype.hasOwnProperty.call($n,Bn)&&(s[Bn]=$n[Bn])}return s},__assign$1.apply(this,arguments)},pairDivider="~",blockDivider="~~";function generateNamedReferences(s,$n){for(var Dn={},Un={},Bn=s.split(blockDivider),In=!1,qn=0;Bn.length>qn;qn++){for(var Fn=Bn[qn].split(pairDivider),Kn=0;Kn<Fn.length;Kn+=2){var jn=Fn[Kn],Yn=Fn[Kn+1],Zn="&"+jn+";";Dn[Zn]=Yn,In&&(Dn["&"+jn]=Yn),Un[Yn]=Zn}In=!0}return $n?{entities:__assign$1(__assign$1({},Dn),$n.entities),characters:__assign$1(__assign$1({},Un),$n.characters)}:{entities:Dn,characters:Un}}var bodyRegExps={xml:/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html4:/&notin;|&(?:nbsp|iexcl|cent|pound|curren|yen|brvbar|sect|uml|copy|ordf|laquo|not|shy|reg|macr|deg|plusmn|sup2|sup3|acute|micro|para|middot|cedil|sup1|ordm|raquo|frac14|frac12|frac34|iquest|Agrave|Aacute|Acirc|Atilde|Auml|Aring|AElig|Ccedil|Egrave|Eacute|Ecirc|Euml|Igrave|Iacute|Icirc|Iuml|ETH|Ntilde|Ograve|Oacute|Ocirc|Otilde|Ouml|times|Oslash|Ugrave|Uacute|Ucirc|Uuml|Yacute|THORN|szlig|agrave|aacute|acirc|atilde|auml|aring|aelig|ccedil|egrave|eacute|ecirc|euml|igrave|iacute|icirc|iuml|eth|ntilde|ograve|oacute|ocirc|otilde|ouml|divide|oslash|ugrave|uacute|ucirc|uuml|yacute|thorn|yuml|quot|amp|lt|gt|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html5:/&centerdot;|&copysr;|&divideontimes;|&gtcc;|&gtcir;|&gtdot;|&gtlPar;|&gtquest;|&gtrapprox;|&gtrarr;|&gtrdot;|&gtreqless;|&gtreqqless;|&gtrless;|&gtrsim;|&ltcc;|&ltcir;|&ltdot;|&lthree;|&ltimes;|&ltlarr;|&ltquest;|&ltrPar;|&ltri;|&ltrie;|&ltrif;|&notin;|&notinE;|&notindot;|&notinva;|&notinvb;|&notinvc;|&notni;|&notniva;|&notnivb;|&notnivc;|&parallel;|&timesb;|&timesbar;|&timesd;|&(?:AElig|AMP|Aacute|Acirc|Agrave|Aring|Atilde|Auml|COPY|Ccedil|ETH|Eacute|Ecirc|Egrave|Euml|GT|Iacute|Icirc|Igrave|Iuml|LT|Ntilde|Oacute|Ocirc|Ograve|Oslash|Otilde|Ouml|QUOT|REG|THORN|Uacute|Ucirc|Ugrave|Uuml|Yacute|aacute|acirc|acute|aelig|agrave|amp|aring|atilde|auml|brvbar|ccedil|cedil|cent|copy|curren|deg|divide|eacute|ecirc|egrave|eth|euml|frac12|frac14|frac34|gt|iacute|icirc|iexcl|igrave|iquest|iuml|laquo|lt|macr|micro|middot|nbsp|not|ntilde|oacute|ocirc|ograve|ordf|ordm|oslash|otilde|ouml|para|plusmn|pound|quot|raquo|reg|sect|shy|sup1|sup2|sup3|szlig|thorn|times|uacute|ucirc|ugrave|uml|uuml|yacute|yen|yuml|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g},namedReferences={};namedReferences.xml=generateNamedReferences(`lt~<~gt~>~quot~"~apos~'~amp~&`);namedReferences.html4=generateNamedReferences(`apos~'~OElig~~oelig~~Scaron~~scaron~~Yuml~~circ~~tilde~~ensp~~emsp~~thinsp~~zwnj~~zwj~~lrm~~rlm~~ndash~~mdash~~lsquo~~rsquo~~sbquo~~ldquo~~rdquo~~bdquo~~dagger~~Dagger~~permil~~lsaquo~~rsaquo~~euro~~fnof~~Alpha~~Beta~~Gamma~~Delta~~Epsilon~~Zeta~~Eta~~Theta~~Iota~~Kappa~~Lambda~~Mu~~Nu~~Xi~~Omicron~~Pi~~Rho~~Sigma~~Tau~~Upsilon~~Phi~~Chi~~Psi~~Omega~~alpha~~beta~~gamma~~delta~~epsilon~~zeta~~eta~~theta~~iota~~kappa~~lambda~~mu~~nu~~xi~~omicron~~pi~~rho~~sigmaf~~sigma~~tau~~upsilon~~phi~~chi~~psi~~omega~~thetasym~~upsih~~piv~~bull~~hellip~~prime~~Prime~~oline~~frasl~~weierp~~image~~real~~trade~~alefsym~~larr~~uarr~~rarr~~darr~~harr~~crarr~~lArr~~uArr~~rArr~~dArr~~hArr~~forall~~part~~exist~~empty~~nabla~~isin~~notin~~ni~~prod~~sum~~minus~~lowast~~radic~~prop~~infin~~ang~~and~~or~~cap~~cup~~int~~there4~~sim~~cong~~asymp~~ne~~equiv~~le~~ge~~sub~~sup~~nsub~~sube~~supe~~oplus~~otimes~~perp~~sdot~~lceil~~rceil~~lfloor~~rfloor~~lang~~rang~~loz~~spades~~clubs~~hearts~~diams~~~nbsp~~iexcl~~cent~~pound~~curren~~yen~~brvbar~~sect~~uml~~copy~~ordf~~laquo~~not~~shy~~reg~~macr~~deg~~plusmn~~sup2~~sup3~~acute~~micro~~para~~middot~~cedil~~sup1~~ordm~~raquo~~frac14~~frac12~~frac34~~iquest~~Agrave~~Aacute~~Acirc~~Atilde~~Auml~~Aring~~AElig~~Ccedil~~Egrave~~Eacute~~Ecirc~~Euml~~Igrave~~Iacute~~Icirc~~Iuml~~ETH~~Ntilde~~Ograve~~Oacute~~Ocirc~~Otilde~~Ouml~~times~~Oslash~~Ugrave~~Uacute~~Ucirc~~Uuml~~Yacute~~THORN~~szlig~~agrave~~aacute~~acirc~~atilde~~auml~~aring~~aelig~~ccedil~~egrave~~eacute~~ecirc~~euml~~igrave~~iacute~~icirc~~iuml~~eth~~ntilde~~ograve~~oacute~~ocirc~~otilde~~ouml~~divide~~oslash~~ugrave~~uacute~~ucirc~~uuml~~yacute~~thorn~~yuml~~quot~"~amp~&~lt~<~gt~>`);namedReferences.html5=generateNamedReferences('Abreve~~Acy~~Afr~~Amacr~~And~~Aogon~~Aopf~~ApplyFunction~~Ascr~~Assign~~Backslash~~Barv~~Barwed~~Bcy~~Because~~Bernoullis~~Bfr~~Bopf~~Breve~~Bscr~~Bumpeq~~CHcy~~Cacute~~Cap~~CapitalDifferentialD~~Cayleys~~Ccaron~~Ccirc~~Cconint~~Cdot~~Cedilla~~CenterDot~~Cfr~~CircleDot~~CircleMinus~~CirclePlus~~CircleTimes~~ClockwiseContourIntegral~~CloseCurlyDoubleQuote~~CloseCurlyQuote~~Colon~~Colone~~Congruent~~Conint~~ContourIntegral~~Copf~~Coproduct~~CounterClockwiseContourIntegral~~Cross~~Cscr~~Cup~~CupCap~~DD~~DDotrahd~~DJcy~~DScy~~DZcy~~Darr~~Dashv~~Dcaron~~Dcy~~Del~~Dfr~~DiacriticalAcute~~DiacriticalDot~~DiacriticalDoubleAcute~~DiacriticalGrave~`~DiacriticalTilde~~Diamond~~DifferentialD~~Dopf~~Dot~~DotDot~~DotEqual~~DoubleContourIntegral~~DoubleDot~~DoubleDownArrow~~DoubleLeftArrow~~DoubleLeftRightArrow~~DoubleLeftTee~~DoubleLongLeftArrow~~DoubleLongLeftRightArrow~~DoubleLongRightArrow~~DoubleRightArrow~~DoubleRightTee~~DoubleUpArrow~~DoubleUpDownArrow~~DoubleVerticalBar~~DownArrow~~DownArrowBar~~DownArrowUpArrow~~DownBreve~~DownLeftRightVector~~DownLeftTeeVector~~DownLeftVector~~DownLeftVectorBar~~DownRightTeeVector~~DownRightVector~~DownRightVectorBar~~DownTee~~DownTeeArrow~~Downarrow~~Dscr~~Dstrok~~ENG~~Ecaron~~Ecy~~Edot~~Efr~~Element~~Emacr~~EmptySmallSquare~~EmptyVerySmallSquare~~Eogon~~Eopf~~Equal~~EqualTilde~~Equilibrium~~Escr~~Esim~~Exists~~ExponentialE~~Fcy~~Ffr~~FilledSmallSquare~~FilledVerySmallSquare~~Fopf~~ForAll~~Fouriertrf~~Fscr~~GJcy~~Gammad~~Gbreve~~Gcedil~~Gcirc~~Gcy~~Gdot~~Gfr~~Gg~~Gopf~~GreaterEqual~~GreaterEqualLess~~GreaterFullEqual~~GreaterGreater~~GreaterLess~~GreaterSlantEqual~~GreaterTilde~~Gscr~~Gt~~HARDcy~~Hacek~~Hat~^~Hcirc~~Hfr~~HilbertSpace~~Hopf~~HorizontalLine~~Hscr~~Hstrok~~HumpDownHump~~HumpEqual~~IEcy~~IJlig~~IOcy~~Icy~~Idot~~Ifr~~Im~~Imacr~~ImaginaryI~~Implies~~Int~~Integral~~Intersection~~InvisibleComma~~InvisibleTimes~~Iogon~~Iopf~~Iscr~~Itilde~~Iukcy~~Jcirc~~Jcy~~Jfr~~Jopf~~Jscr~~Jsercy~~Jukcy~~KHcy~~KJcy~~Kcedil~~Kcy~~Kfr~~Kopf~~Kscr~~LJcy~~Lacute~~Lang~~Laplacetrf~~Larr~~Lcaron~~Lcedil~~Lcy~~LeftAngleBracket~~LeftArrow~~LeftArrowBar~~LeftArrowRightArrow~~LeftCeiling~~LeftDoubleBracket~~LeftDownTeeVector~~LeftDownVector~~LeftDownVectorBar~~LeftFloor~~LeftRightArrow~~LeftRightVector~~LeftTee~~LeftTeeArrow~~LeftTeeVector~~LeftTriangle~~LeftTriangleBar~~LeftTriangleEqual~~LeftUpDownVector~~LeftUpTeeVector~~LeftUpVector~~LeftUpVectorBar~~LeftVector~~LeftVectorBar~~Leftarrow~~Leftrightarrow~~LessEqualGreater~~LessFullEqual~~LessGreater~~LessLess~~LessSlantEqual~~LessTilde~~Lfr~~Ll~~Lleftarrow~~Lmidot~~LongLeftArrow~~LongLeftRightArrow~~LongRightArrow~~Longleftarrow~~Longleftrightarrow~~Longrightarrow~~Lopf~~LowerLeftArrow~~LowerRightArrow~~Lscr~~Lsh~~Lstrok~~Lt~~Map~~Mcy~~MediumSpace~~Mellintrf~~Mfr~~MinusPlus~~Mopf~~Mscr~~NJcy~~Nacute~~Ncaron~~Ncedil~~Ncy~~NegativeMediumSpace~~NegativeThickSpace~~NegativeThinSpace~~NegativeVeryThinSpace~~NestedGreaterGreater~~NestedLessLess~~NewLine~\n~Nfr~~NoBreak~~NonBreakingSpace~~Nopf~~Not~~NotCongruent~~NotCupCap~~NotDoubleVerticalBar~~NotElement~~NotEqual~~NotEqualTilde~~NotExists~~NotGreater~~NotGreaterEqual~~NotGreaterFullEqual~~NotGreaterGreater~~NotGreaterLess~~NotGreaterSlantEqual~~NotGreaterTilde~~NotHumpDownHump~~NotHumpEqual~~NotLeftTriangle~~NotLeftTriangleBar~~NotLeftTriangleEqual~~NotLess~~NotLessEqual~~NotLessGreater~~NotLessLess~~NotLessSlantEqual~~NotLessTilde~~NotNestedGreaterGreater~~NotNestedLessLess~~NotPrecedes~~NotPrecedesEqual~~NotPrecedesSlantEqual~~NotReverseElement~~NotRightTriangle~~NotRightTriangleBar~~NotRightTriangleEqual~~NotSquareSubset~~NotSquareSubsetEqual~~NotSquareSuperset~~NotSquareSupersetEqual~~NotSubset~~NotSubsetEqual~~NotSucceeds~~NotSucceedsEqual~~NotSucceedsSlantEqual~~NotSucceedsTilde~~NotSuperset~~NotSupersetEqual~~NotTilde~~NotTildeEqual~~NotTildeFullEqual~~NotTildeTilde~~NotVerticalBar~~Nscr~~Ocy~~Odblac~~Ofr~~Omacr~~Oopf~~OpenCurlyDoubleQuote~~OpenCurlyQuote~~Or~~Oscr~~Otimes~~OverBar~~OverBrace~~OverBracket~~OverParenthesis~~PartialD~~Pcy~~Pfr~~PlusMinus~~Poincareplane~~Popf~~Pr~~Precedes~~PrecedesEqual~~PrecedesSlantEqual~~PrecedesTilde~~Product~~Proportion~~Proportional~~Pscr~~Qfr~~Qopf~~Qscr~~RBarr~~Racute~~Rang~~Rarr~~Rarrtl~~Rcaron~~Rcedil~~Rcy~~Re~~ReverseElement~~ReverseEquilibrium~~ReverseUpEquilibrium~~Rfr~~RightAngleBracket~~RightArrow~~RightArrowBar~~RightArrowLeftArrow~~RightCeiling~~RightDoubleBracket~~RightDownTeeVector~~RightDownVector~~RightDownVectorBar~~RightFloor~~RightTee~~RightTeeArrow~~RightTeeVector~~RightTriangle~~RightTriangleBar~~RightTriangleEqual~~RightUpDownVector~~RightUpTeeVector~~RightUpVector~~RightUpVectorBar~~RightVector~~RightVectorBar~~Rightarrow~~Ropf~~RoundImplies~~Rrightarrow~~Rscr~~Rsh~~RuleDelayed~~SHCHcy~~SHcy~~SOFTcy~~Sacute~~Sc~~Scedil~~Scirc~~Scy~~Sfr~~ShortDownArrow~~ShortLeftArrow~~ShortRightArrow~~ShortUpArrow~~SmallCircle~~Sopf~~Sqrt~~Square~~SquareIntersection~~SquareSubset~~SquareSubsetEqual~~SquareSuperset~~SquareSupersetEqual~~SquareUnion~~Sscr~~Star~~Sub~~Subset~~SubsetEqual~~Succeeds~~SucceedsEqual~~SucceedsSlantEqual~~SucceedsTilde~~SuchThat~~Sum~~Sup~~Superset~~SupersetEqual~~Supset~~TRADE~~TSHcy~~TScy~~Tab~	~Tcaron~~Tcedil~~Tcy~~Tfr~~Therefore~~ThickSpace~~ThinSpace~~Tilde~~TildeEqual~~TildeFullEqual~~TildeTilde~~Topf~~TripleDot~~Tscr~~Tstrok~~Uarr~~Uarrocir~~Ubrcy~~Ubreve~~Ucy~~Udblac~~Ufr~~Umacr~~UnderBar~_~UnderBrace~~UnderBracket~~UnderParenthesis~~Union~~UnionPlus~~Uogon~~Uopf~~UpArrow~~UpArrowBar~~UpArrowDownArrow~~UpDownArrow~~UpEquilibrium~~UpTee~~UpTeeArrow~~Uparrow~~Updownarrow~~UpperLeftArrow~~UpperRightArrow~~Upsi~~Uring~~Uscr~~Utilde~~VDash~~Vbar~~Vcy~~Vdash~~Vdashl~~Vee~~Verbar~~Vert~~VerticalBar~~VerticalLine~|~VerticalSeparator~~VerticalTilde~~VeryThinSpace~~Vfr~~Vopf~~Vscr~~Vvdash~~Wcirc~~Wedge~~Wfr~~Wopf~~Wscr~~Xfr~~Xopf~~Xscr~~YAcy~~YIcy~~YUcy~~Ycirc~~Ycy~~Yfr~~Yopf~~Yscr~~ZHcy~~Zacute~~Zcaron~~Zcy~~Zdot~~ZeroWidthSpace~~Zfr~~Zopf~~Zscr~~abreve~~ac~~acE~~acd~~acy~~af~~afr~~aleph~~amacr~~amalg~~andand~~andd~~andslope~~andv~~ange~~angle~~angmsd~~angmsdaa~~angmsdab~~angmsdac~~angmsdad~~angmsdae~~angmsdaf~~angmsdag~~angmsdah~~angrt~~angrtvb~~angrtvbd~~angsph~~angst~~angzarr~~aogon~~aopf~~ap~~apE~~apacir~~ape~~apid~~approx~~approxeq~~ascr~~ast~*~asympeq~~awconint~~awint~~bNot~~backcong~~backepsilon~~backprime~~backsim~~backsimeq~~barvee~~barwed~~barwedge~~bbrk~~bbrktbrk~~bcong~~bcy~~becaus~~because~~bemptyv~~bepsi~~bernou~~beth~~between~~bfr~~bigcap~~bigcirc~~bigcup~~bigodot~~bigoplus~~bigotimes~~bigsqcup~~bigstar~~bigtriangledown~~bigtriangleup~~biguplus~~bigvee~~bigwedge~~bkarow~~blacklozenge~~blacksquare~~blacktriangle~~blacktriangledown~~blacktriangleleft~~blacktriangleright~~blank~~blk12~~blk14~~blk34~~block~~bne~=~bnequiv~~bnot~~bopf~~bot~~bottom~~bowtie~~boxDL~~boxDR~~boxDl~~boxDr~~boxH~~boxHD~~boxHU~~boxHd~~boxHu~~boxUL~~boxUR~~boxUl~~boxUr~~boxV~~boxVH~~boxVL~~boxVR~~boxVh~~boxVl~~boxVr~~boxbox~~boxdL~~boxdR~~boxdl~~boxdr~~boxh~~boxhD~~boxhU~~boxhd~~boxhu~~boxminus~~boxplus~~boxtimes~~boxuL~~boxuR~~boxul~~boxur~~boxv~~boxvH~~boxvL~~boxvR~~boxvh~~boxvl~~boxvr~~bprime~~breve~~bscr~~bsemi~~bsim~~bsime~~bsol~\\~bsolb~~bsolhsub~~bullet~~bump~~bumpE~~bumpe~~bumpeq~~cacute~~capand~~capbrcup~~capcap~~capcup~~capdot~~caps~~caret~~caron~~ccaps~~ccaron~~ccirc~~ccups~~ccupssm~~cdot~~cemptyv~~centerdot~~cfr~~chcy~~check~~checkmark~~cir~~cirE~~circeq~~circlearrowleft~~circlearrowright~~circledR~~circledS~~circledast~~circledcirc~~circleddash~~cire~~cirfnint~~cirmid~~cirscir~~clubsuit~~colon~:~colone~~coloneq~~comma~,~commat~@~comp~~compfn~~complement~~complexes~~congdot~~conint~~copf~~coprod~~copysr~~cross~~cscr~~csub~~csube~~csup~~csupe~~ctdot~~cudarrl~~cudarrr~~cuepr~~cuesc~~cularr~~cularrp~~cupbrcap~~cupcap~~cupcup~~cupdot~~cupor~~cups~~curarr~~curarrm~~curlyeqprec~~curlyeqsucc~~curlyvee~~curlywedge~~curvearrowleft~~curvearrowright~~cuvee~~cuwed~~cwconint~~cwint~~cylcty~~dHar~~daleth~~dash~~dashv~~dbkarow~~dblac~~dcaron~~dcy~~dd~~ddagger~~ddarr~~ddotseq~~demptyv~~dfisht~~dfr~~dharl~~dharr~~diam~~diamond~~diamondsuit~~die~~digamma~~disin~~div~~divideontimes~~divonx~~djcy~~dlcorn~~dlcrop~~dollar~$~dopf~~dot~~doteq~~doteqdot~~dotminus~~dotplus~~dotsquare~~doublebarwedge~~downarrow~~downdownarrows~~downharpoonleft~~downharpoonright~~drbkarow~~drcorn~~drcrop~~dscr~~dscy~~dsol~~dstrok~~dtdot~~dtri~~dtrif~~duarr~~duhar~~dwangle~~dzcy~~dzigrarr~~eDDot~~eDot~~easter~~ecaron~~ecir~~ecolon~~ecy~~edot~~ee~~efDot~~efr~~eg~~egs~~egsdot~~el~~elinters~~ell~~els~~elsdot~~emacr~~emptyset~~emptyv~~emsp13~~emsp14~~eng~~eogon~~eopf~~epar~~eparsl~~eplus~~epsi~~epsiv~~eqcirc~~eqcolon~~eqsim~~eqslantgtr~~eqslantless~~equals~=~equest~~equivDD~~eqvparsl~~erDot~~erarr~~escr~~esdot~~esim~~excl~!~expectation~~exponentiale~~fallingdotseq~~fcy~~female~~ffilig~~fflig~~ffllig~~ffr~~filig~~fjlig~fj~flat~~fllig~~fltns~~fopf~~fork~~forkv~~fpartint~~frac13~~frac15~~frac16~~frac18~~frac23~~frac25~~frac35~~frac38~~frac45~~frac56~~frac58~~frac78~~frown~~fscr~~gE~~gEl~~gacute~~gammad~~gap~~gbreve~~gcirc~~gcy~~gdot~~gel~~geq~~geqq~~geqslant~~ges~~gescc~~gesdot~~gesdoto~~gesdotol~~gesl~~gesles~~gfr~~gg~~ggg~~gimel~~gjcy~~gl~~glE~~gla~~glj~~gnE~~gnap~~gnapprox~~gne~~gneq~~gneqq~~gnsim~~gopf~~grave~`~gscr~~gsim~~gsime~~gsiml~~gtcc~~gtcir~~gtdot~~gtlPar~~gtquest~~gtrapprox~~gtrarr~~gtrdot~~gtreqless~~gtreqqless~~gtrless~~gtrsim~~gvertneqq~~gvnE~~hairsp~~half~~hamilt~~hardcy~~harrcir~~harrw~~hbar~~hcirc~~heartsuit~~hercon~~hfr~~hksearow~~hkswarow~~hoarr~~homtht~~hookleftarrow~~hookrightarrow~~hopf~~horbar~~hscr~~hslash~~hstrok~~hybull~~hyphen~~ic~~icy~~iecy~~iff~~ifr~~ii~~iiiint~~iiint~~iinfin~~iiota~~ijlig~~imacr~~imagline~~imagpart~~imath~~imof~~imped~~in~~incare~~infintie~~inodot~~intcal~~integers~~intercal~~intlarhk~~intprod~~iocy~~iogon~~iopf~~iprod~~iscr~~isinE~~isindot~~isins~~isinsv~~isinv~~it~~itilde~~iukcy~~jcirc~~jcy~~jfr~~jmath~~jopf~~jscr~~jsercy~~jukcy~~kappav~~kcedil~~kcy~~kfr~~kgreen~~khcy~~kjcy~~kopf~~kscr~~lAarr~~lAtail~~lBarr~~lE~~lEg~~lHar~~lacute~~laemptyv~~lagran~~langd~~langle~~lap~~larrb~~larrbfs~~larrfs~~larrhk~~larrlp~~larrpl~~larrsim~~larrtl~~lat~~latail~~late~~lates~~lbarr~~lbbrk~~lbrace~{~lbrack~[~lbrke~~lbrksld~~lbrkslu~~lcaron~~lcedil~~lcub~{~lcy~~ldca~~ldquor~~ldrdhar~~ldrushar~~ldsh~~leftarrow~~leftarrowtail~~leftharpoondown~~leftharpoonup~~leftleftarrows~~leftrightarrow~~leftrightarrows~~leftrightharpoons~~leftrightsquigarrow~~leftthreetimes~~leg~~leq~~leqq~~leqslant~~les~~lescc~~lesdot~~lesdoto~~lesdotor~~lesg~~lesges~~lessapprox~~lessdot~~lesseqgtr~~lesseqqgtr~~lessgtr~~lesssim~~lfisht~~lfr~~lg~~lgE~~lhard~~lharu~~lharul~~lhblk~~ljcy~~ll~~llarr~~llcorner~~llhard~~lltri~~lmidot~~lmoust~~lmoustache~~lnE~~lnap~~lnapprox~~lne~~lneq~~lneqq~~lnsim~~loang~~loarr~~lobrk~~longleftarrow~~longleftrightarrow~~longmapsto~~longrightarrow~~looparrowleft~~looparrowright~~lopar~~lopf~~loplus~~lotimes~~lowbar~_~lozenge~~lozf~~lpar~(~lparlt~~lrarr~~lrcorner~~lrhar~~lrhard~~lrtri~~lscr~~lsh~~lsim~~lsime~~lsimg~~lsqb~[~lsquor~~lstrok~~ltcc~~ltcir~~ltdot~~lthree~~ltimes~~ltlarr~~ltquest~~ltrPar~~ltri~~ltrie~~ltrif~~lurdshar~~luruhar~~lvertneqq~~lvnE~~mDDot~~male~~malt~~maltese~~map~~mapsto~~mapstodown~~mapstoleft~~mapstoup~~marker~~mcomma~~mcy~~measuredangle~~mfr~~mho~~mid~~midast~*~midcir~~minusb~~minusd~~minusdu~~mlcp~~mldr~~mnplus~~models~~mopf~~mp~~mscr~~mstpos~~multimap~~mumap~~nGg~~nGt~~nGtv~~nLeftarrow~~nLeftrightarrow~~nLl~~nLt~~nLtv~~nRightarrow~~nVDash~~nVdash~~nacute~~nang~~nap~~napE~~napid~~napos~~napprox~~natur~~natural~~naturals~~nbump~~nbumpe~~ncap~~ncaron~~ncedil~~ncong~~ncongdot~~ncup~~ncy~~neArr~~nearhk~~nearr~~nearrow~~nedot~~nequiv~~nesear~~nesim~~nexist~~nexists~~nfr~~ngE~~nge~~ngeq~~ngeqq~~ngeqslant~~nges~~ngsim~~ngt~~ngtr~~nhArr~~nharr~~nhpar~~nis~~nisd~~niv~~njcy~~nlArr~~nlE~~nlarr~~nldr~~nle~~nleftarrow~~nleftrightarrow~~nleq~~nleqq~~nleqslant~~nles~~nless~~nlsim~~nlt~~nltri~~nltrie~~nmid~~nopf~~notinE~~notindot~~notinva~~notinvb~~notinvc~~notni~~notniva~~notnivb~~notnivc~~npar~~nparallel~~nparsl~~npart~~npolint~~npr~~nprcue~~npre~~nprec~~npreceq~~nrArr~~nrarr~~nrarrc~~nrarrw~~nrightarrow~~nrtri~~nrtrie~~nsc~~nsccue~~nsce~~nscr~~nshortmid~~nshortparallel~~nsim~~nsime~~nsimeq~~nsmid~~nspar~~nsqsube~~nsqsupe~~nsubE~~nsube~~nsubset~~nsubseteq~~nsubseteqq~~nsucc~~nsucceq~~nsup~~nsupE~~nsupe~~nsupset~~nsupseteq~~nsupseteqq~~ntgl~~ntlg~~ntriangleleft~~ntrianglelefteq~~ntriangleright~~ntrianglerighteq~~num~#~numero~~numsp~~nvDash~~nvHarr~~nvap~~nvdash~~nvge~~nvgt~>~nvinfin~~nvlArr~~nvle~~nvlt~<~nvltrie~~nvrArr~~nvrtrie~~nvsim~~nwArr~~nwarhk~~nwarr~~nwarrow~~nwnear~~oS~~oast~~ocir~~ocy~~odash~~odblac~~odiv~~odot~~odsold~~ofcir~~ofr~~ogon~~ogt~~ohbar~~ohm~~oint~~olarr~~olcir~~olcross~~olt~~omacr~~omid~~ominus~~oopf~~opar~~operp~~orarr~~ord~~order~~orderof~~origof~~oror~~orslope~~orv~~oscr~~osol~~otimesas~~ovbar~~par~~parallel~~parsim~~parsl~~pcy~~percnt~%~period~.~pertenk~~pfr~~phiv~~phmmat~~phone~~pitchfork~~planck~~planckh~~plankv~~plus~+~plusacir~~plusb~~pluscir~~plusdo~~plusdu~~pluse~~plussim~~plustwo~~pm~~pointint~~popf~~pr~~prE~~prap~~prcue~~pre~~prec~~precapprox~~preccurlyeq~~preceq~~precnapprox~~precneqq~~precnsim~~precsim~~primes~~prnE~~prnap~~prnsim~~profalar~~profline~~profsurf~~propto~~prsim~~prurel~~pscr~~puncsp~~qfr~~qint~~qopf~~qprime~~qscr~~quaternions~~quatint~~quest~?~questeq~~rAarr~~rAtail~~rBarr~~rHar~~race~~racute~~raemptyv~~rangd~~range~~rangle~~rarrap~~rarrb~~rarrbfs~~rarrc~~rarrfs~~rarrhk~~rarrlp~~rarrpl~~rarrsim~~rarrtl~~rarrw~~ratail~~ratio~~rationals~~rbarr~~rbbrk~~rbrace~}~rbrack~]~rbrke~~rbrksld~~rbrkslu~~rcaron~~rcedil~~rcub~}~rcy~~rdca~~rdldhar~~rdquor~~rdsh~~realine~~realpart~~reals~~rect~~rfisht~~rfr~~rhard~~rharu~~rharul~~rhov~~rightarrow~~rightarrowtail~~rightharpoondown~~rightharpoonup~~rightleftarrows~~rightleftharpoons~~rightrightarrows~~rightsquigarrow~~rightthreetimes~~ring~~risingdotseq~~rlarr~~rlhar~~rmoust~~rmoustache~~rnmid~~roang~~roarr~~robrk~~ropar~~ropf~~roplus~~rotimes~~rpar~)~rpargt~~rppolint~~rrarr~~rscr~~rsh~~rsqb~]~rsquor~~rthree~~rtimes~~rtri~~rtrie~~rtrif~~rtriltri~~ruluhar~~rx~~sacute~~sc~~scE~~scap~~sccue~~sce~~scedil~~scirc~~scnE~~scnap~~scnsim~~scpolint~~scsim~~scy~~sdotb~~sdote~~seArr~~searhk~~searr~~searrow~~semi~;~seswar~~setminus~~setmn~~sext~~sfr~~sfrown~~sharp~~shchcy~~shcy~~shortmid~~shortparallel~~sigmav~~simdot~~sime~~simeq~~simg~~simgE~~siml~~simlE~~simne~~simplus~~simrarr~~slarr~~smallsetminus~~smashp~~smeparsl~~smid~~smile~~smt~~smte~~smtes~~softcy~~sol~/~solb~~solbar~~sopf~~spadesuit~~spar~~sqcap~~sqcaps~~sqcup~~sqcups~~sqsub~~sqsube~~sqsubset~~sqsubseteq~~sqsup~~sqsupe~~sqsupset~~sqsupseteq~~squ~~square~~squarf~~squf~~srarr~~sscr~~ssetmn~~ssmile~~sstarf~~star~~starf~~straightepsilon~~straightphi~~strns~~subE~~subdot~~subedot~~submult~~subnE~~subne~~subplus~~subrarr~~subset~~subseteq~~subseteqq~~subsetneq~~subsetneqq~~subsim~~subsub~~subsup~~succ~~succapprox~~succcurlyeq~~succeq~~succnapprox~~succneqq~~succnsim~~succsim~~sung~~supE~~supdot~~supdsub~~supedot~~suphsol~~suphsub~~suplarr~~supmult~~supnE~~supne~~supplus~~supset~~supseteq~~supseteqq~~supsetneq~~supsetneqq~~supsim~~supsub~~supsup~~swArr~~swarhk~~swarr~~swarrow~~swnwar~~target~~tbrk~~tcaron~~tcedil~~tcy~~tdot~~telrec~~tfr~~therefore~~thetav~~thickapprox~~thicksim~~thkap~~thksim~~timesb~~timesbar~~timesd~~tint~~toea~~top~~topbot~~topcir~~topf~~topfork~~tosa~~tprime~~triangle~~triangledown~~triangleleft~~trianglelefteq~~triangleq~~triangleright~~trianglerighteq~~tridot~~trie~~triminus~~triplus~~trisb~~tritime~~trpezium~~tscr~~tscy~~tshcy~~tstrok~~twixt~~twoheadleftarrow~~twoheadrightarrow~~uHar~~ubrcy~~ubreve~~ucy~~udarr~~udblac~~udhar~~ufisht~~ufr~~uharl~~uharr~~uhblk~~ulcorn~~ulcorner~~ulcrop~~ultri~~umacr~~uogon~~uopf~~uparrow~~updownarrow~~upharpoonleft~~upharpoonright~~uplus~~upsi~~upuparrows~~urcorn~~urcorner~~urcrop~~uring~~urtri~~uscr~~utdot~~utilde~~utri~~utrif~~uuarr~~uwangle~~vArr~~vBar~~vBarv~~vDash~~vangrt~~varepsilon~~varkappa~~varnothing~~varphi~~varpi~~varpropto~~varr~~varrho~~varsigma~~varsubsetneq~~varsubsetneqq~~varsupsetneq~~varsupsetneqq~~vartheta~~vartriangleleft~~vartriangleright~~vcy~~vdash~~vee~~veebar~~veeeq~~vellip~~verbar~|~vert~|~vfr~~vltri~~vnsub~~vnsup~~vopf~~vprop~~vrtri~~vscr~~vsubnE~~vsubne~~vsupnE~~vsupne~~vzigzag~~wcirc~~wedbar~~wedge~~wedgeq~~wfr~~wopf~~wp~~wr~~wreath~~wscr~~xcap~~xcirc~~xcup~~xdtri~~xfr~~xhArr~~xharr~~xlArr~~xlarr~~xmap~~xnis~~xodot~~xopf~~xoplus~~xotime~~xrArr~~xrarr~~xscr~~xsqcup~~xuplus~~xutri~~xvee~~xwedge~~yacy~~ycirc~~ycy~~yfr~~yicy~~yopf~~yscr~~yucy~~zacute~~zcaron~~zcy~~zdot~~zeetrf~~zfr~~zhcy~~zigrarr~~zopf~~zscr~~~AMP~&~COPY~~GT~>~LT~<~QUOT~"~REG~',namedReferences.html4);var numericUnicodeMap={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376},fromCodePoint=String.fromCodePoint||function(s){return String.fromCharCode(Math.floor((s-65536)/1024)+55296,(s-65536)%1024+56320)},__assign=function(){return __assign=Object.assign||function(s){for(var $n,Dn=1,Un=arguments.length;Dn<Un;Dn++){$n=arguments[Dn];for(var Bn in $n)Object.prototype.hasOwnProperty.call($n,Bn)&&(s[Bn]=$n[Bn])}return s},__assign.apply(this,arguments)},allNamedReferences=__assign(__assign({},namedReferences),{all:namedReferences.html5}),strict=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);/g,attribute=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+)[;=]?/g,baseDecodeRegExps={xml:{strict,attribute,body:bodyRegExps.xml},html4:{strict,attribute,body:bodyRegExps.html4},html5:{strict,attribute,body:bodyRegExps.html5}};__assign(__assign({},baseDecodeRegExps),{all:baseDecodeRegExps.html5});var fromCharCode=String.fromCharCode,outOfBoundsChar=fromCharCode(65533),defaultDecodeEntityOptions={level:"all"};function getDecodedEntity(s,$n,Dn,Un){var Bn=s;s[s.length-1];{var In=$n[s];if(In)Bn=In;else if(s[0]==="&"&&s[1]==="#"){var qn=s[2],Fn=qn=="x"||qn=="X"?parseInt(s.substr(3),16):parseInt(s.substr(2));Bn=Fn>=1114111?outOfBoundsChar:Fn>65535?fromCodePoint(Fn):fromCharCode(numericUnicodeMap[Fn]||Fn)}}return Bn}function decodeEntity(s,$n){var Dn=defaultDecodeEntityOptions,Un=Dn.level,Bn=Un===void 0?"all":Un;return s?getDecodedEntity(s,allNamedReferences[Bn].entities):""}function EmojiButton({emoji:s,handleClick:$n,selectedCardEntry:Dn,matchedCardEntry:Un,index:Bn}){const In=Dn||Un?decodeEntity(s.htmlCode[0]):"?",qn=Un?"btn--emoji__back--matched":Dn?"btn--emoji__back--selected":"btn--emoji__front",Fn=Un?`${decodeEntity(s.name)}. Matched.`:Dn?`${decodeEntity(s.name)}. Not matched yet.`:"Card upside down.";return jsxRuntimeExports.jsx("button",{className:`btn btn--emoji ${qn}`,onClick:Dn?null:$n,disabled:Un,"aria-label":`Position ${Bn+1}: ${Fn}`,"aria-live":"polite",children:In})}function MemoryCard({handleClick:s,data:$n,selectedCards:Dn,matchedCards:Un}){const Bn=$n.map((In,qn)=>{const Fn=Dn.find(Yn=>Yn.index===qn),Kn=Un.find(Yn=>Yn.index===qn),jn=Kn?"card-item--matched":Fn?"card-item--selected":"";return jsxRuntimeExports.jsx("li",{className:`card-item ${jn}`,children:jsxRuntimeExports.jsx(EmojiButton,{emoji:In,handleClick:()=>s(In.name,qn),selectedCardEntry:Fn,matchedCardEntry:Kn,index:qn})},qn)});return jsxRuntimeExports.jsx("ul",{className:"card-container",children:Bn})}function AssistiveTechInfo({emojisData:s,matchedCards:$n}){return jsxRuntimeExports.jsxs("section",{className:"sr-only","aria-live":"polite","aria-atomic":"true",children:[jsxRuntimeExports.jsx("h2",{children:"Game status"}),jsxRuntimeExports.jsxs("p",{children:["Number of matched pairs: ",$n.length/2]}),jsxRuntimeExports.jsxs("p",{children:["Number of cards left to match: ",s.length-$n.length]})]})}function GameOver({handleClick:s}){const $n=reactExports.useRef(null);return reactExports.useEffect(()=>{$n.current.focus()},[]),jsxRuntimeExports.jsxs("div",{className:"wrapper wrapper--accent",tabIndex:0,ref:$n,children:[jsxRuntimeExports.jsx("p",{className:"p--large",children:"You've matched all the memory cards!"}),jsxRuntimeExports.jsx(RegularButton,{handleClick:s,children:"Play again"})]})}function ErrorCard({handleClick:s}){const $n=reactExports.useRef(null);return reactExports.useEffect(()=>{$n.current.focus()},[]),jsxRuntimeExports.jsxs("div",{className:"wrapper wrapper--accent",ref:$n,tabIndex:-1,children:[jsxRuntimeExports.jsx("p",{className:"p--large",children:"Sorry, there was an error."}),jsxRuntimeExports.jsx("p",{className:"p--regular",children:"Please come back later or click the button below to try restarting the game."}),jsxRuntimeExports.jsx(RegularButton,{handleClick:s,children:"Restart game"})]})}function App(){const s={category:"animals-and-nature",number:10},[$n,Dn]=reactExports.useState(!0),[Un,Bn]=reactExports.useState(s),[In,qn]=reactExports.useState(!1),[Fn,Kn]=reactExports.useState([]),[jn,Yn]=reactExports.useState([]),[Zn,Xn]=reactExports.useState([]),[Jn,Wn]=reactExports.useState(!1),[tr,ir]=reactExports.useState(!1);reactExports.useEffect(()=>{jn.length===2&&jn[0].name===jn[1].name&&Xn(Dr=>[...Dr,...jn])},[jn]),reactExports.useEffect(()=>{Fn.length&&Zn.length===Fn.length&&Wn(!0)},[Zn]);function sr(Dr){Bn(zr=>({...zr,[Dr.target.name]:Dr.target.value}))}async function fr(Dr){Dr.preventDefault();try{const zr=await fetch(`https://emojihub.yurace.pro/api/all/category/${Un.category}`);if(!zr.ok)throw new Error("Could not fetch data from API");const dr=await zr.json(),pr=await ur(dr),lr=await Nr(pr);Kn(lr),qn(!0)}catch(zr){console.error(zr),ir(!0)}finally{Dn(!1)}}async function ur(Dr){return br(Dr).reduce((pr,lr)=>(pr.push(Dr[lr]),pr),[])}function br(Dr){const zr=[];for(let dr=0;dr<Un.number/2;dr++){const pr=Math.floor(Math.random()*Dr.length);zr.includes(pr)?dr--:zr.push(pr)}return zr}async function Nr(Dr){const zr=[...Dr,...Dr];for(let dr=zr.length-1;dr>0;dr--){const pr=Math.floor(Math.random()*(dr+1)),lr=zr[dr];zr[dr]=zr[pr],zr[pr]=lr}return zr}function Ar(Dr,zr){jn.length<2?Yn(dr=>[...dr,{name:Dr,index:zr}]):jn.length===2&&Yn([{name:Dr,index:zr}])}function _r(){qn(!1),Yn([]),Xn([]),Wn(!1)}function Rr(){ir(!1)}return jsxRuntimeExports.jsxs("main",{children:[jsxRuntimeExports.jsx("h1",{children:"Memory"}),!In&&!tr&&jsxRuntimeExports.jsx(Form,{handleSubmit:fr,handleChange:sr,isFirstRender:$n}),In&&!Jn&&jsxRuntimeExports.jsx(AssistiveTechInfo,{emojisData:Fn,matchedCards:Zn}),Jn&&jsxRuntimeExports.jsx(GameOver,{handleClick:_r}),In&&jsxRuntimeExports.jsx(MemoryCard,{handleClick:Ar,data:Fn,selectedCards:jn,matchedCards:Zn}),tr&&jsxRuntimeExports.jsx(ErrorCard,{handleClick:Rr}),jsxRuntimeExports.jsx("nostr-like",{style:{width:"150px","--nostrc-like-btn-bg":"linear-gradient(120deg, #d4fc79 0%, #96e6a1 30%, #84fab0 60%, #8fd3f4 100%)","--nostrc-like-btn-color":"#1b2a2f","--nostrc-like-btn-hover-bg":"linear-gradient(120deg, #f4ffa8 0%, #c8f8d0 30%, #b8fdd0 60%, #b8e8ff 100%)","--nostrc-like-btn-text-primary":"#1b2a2f","--nostrc-like-btn-text-secondary":"#1b2a2f","--nostrc-like-btn-border":"1px solid rgba(27,42,47,0.25)","--nostrc-like-btn-hover-color":"#1b2a2f","--nostrc-like-btn-hover-border":"1px solid rgba(27,42,47,0.4)"},url:"https://github.com/gmarav005/memory-game",text:"Like"})]})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));export{B,D$2 as D,F$4 as F,J$1 as J,M$4 as M,__vitePreload as _,sha256$2 as a,bytesToHex$2 as b,q$2 as q,schnorr$1 as s,y$2 as y,zapUtilsBiKkJPt6 as z};
